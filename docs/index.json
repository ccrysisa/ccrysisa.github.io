[{"categories":["draft"],"content":"This post is used to record the process of my English learning. ","date":"2024-03-30","objectID":"/posts/english/:0:0","tags":["draft"],"title":"English Everyday","uri":"/posts/english/"},{"categories":["draft"],"content":"Preface å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ If I had eight hours to chop down a tree, Iâ€™d spend six hours sharpening my axe. å•è¯ä¹¦: Merriam-Websterâ€™s Vocabulary Builder å†™ä½œä¹¦: The Elements of Style è¯­æ³•ä¹¦: https://grammar.codeyu.com/ å‘éŸ³æ•™å­¦: ä¸€äº› YouTube channels: https://www.youtube.com/@LearnEnglishWithTVSeries https://www.youtube.com/@letstalk https://www.youtube.com/@bbclearningenglish https://www.youtube.com/@coachshanesesl ä¸€äº› B ç«™ UP ä¸»: å¦ˆå¦ˆä¸ç”¨æ‹…å¿ƒæˆ‘çš„è‹±è¯­ [è‹±è¯­å…”] ä¸€äº› GitHub ä»“åº“: https://github.com/byoungd/English-level-up-tips https://github.com/xiaolai/everyone-can-use-english https://github.com/IammyselfBOOKS/New_concept_English https://github.com/protogenesis/NewConceptEnglish ","date":"2024-03-30","objectID":"/posts/english/:1:0","tags":["draft"],"title":"English Everyday","uri":"/posts/english/"},{"categories":["draft"],"content":"New Concept English ","date":"2024-03-30","objectID":"/posts/english/:2:0","tags":["draft"],"title":"English Everyday","uri":"/posts/english/"},{"categories":["draft"],"content":"NCE 1 001: Excuse me! 003: Sorry, sir! 005: Nice to meet you! 007ï¼šAre you a teacher? 009: How are you today? 011: Is this your shirt? 013: A new dress 015: Your passports, please 017: How do you do handbag n. a small bag used by a woman to carry everyday personal items. umbrella n. a device consisting of a circular canopy of cloth on a folding metal frame supported by a central rod, used as protection against rain. nationality n. the official right to belong to a particular country. engineer n. a person whose job is to design or build machines, engines, or electrical equipment, or things such as roads, railways, or bridges, using scientific principles. perhaps adv. used to show that something is possible or that you are not certain about something. ","date":"2024-03-30","objectID":"/posts/english/:2:1","tags":["draft"],"title":"English Everyday","uri":"/posts/english/"},{"categories":["Linux Kernel Internals"],"content":" åœ¨ Linux æ ¸å¿ƒè®¾è®¡/å®ä½œ Spring 2023 è¯¾ç¨‹è¿›åº¦é¡µé¢çš„åŸå§‹æ¡£æ¡ˆçš„åŸºç¡€ä¸Šï¼Œç¨ä½œä¿®æ”¹ä»¥è®°å½•æˆ‘çš„å­¦ä¹ è¿›åº¦ åŸå§‹é¡µé¢ | PDF Instructor: Jim Huang (é»ƒæ•¬ç¾¤) \u003cjserv.tw@gmail.com\u003e å¾€å¹´èª²ç¨‹é€²åº¦ Linux æ ¸å¿ƒè¨­è¨ˆ (ç·šä¸Šè¬›åº§) æ³¨æ„: ä¸‹æ–¹èª²ç¨‹é€²åº¦è¡¨æ¨™è¨»æœ‰ * çš„é …ç›®ï¼Œè¡¨ç¤ºå…§é™„éŒ„å½±çš„æ•™æ æ³¨æ„: æ–°é–‹çš„ã€ŒLinux æ ¸å¿ƒå¯¦ä½œã€èª²ç¨‹å…§å®¹å¹¾ä¹èˆ‡ã€ŒLinux æ ¸å¿ƒè¨­è¨ˆã€ä¸€è‡´ï¼Œæ¡ç·šä¸Šç‚ºä¸»çš„é€²è¡Œæ–¹å¼ ","date":"2024-02-28","objectID":"/posts/linux2023/:0:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡/å®ä½œ (Linux Kernel Internals)","uri":"/posts/linux2023/"},{"categories":["Linux Kernel Internals"],"content":"Linux æ ¸å¿ƒè¨­è¨ˆ/å¯¦ä½œ (Spring 2023) èª²ç¨‹é€²åº¦è¡¨æš¨ç·šä¸Šè³‡æº ","date":"2024-02-28","objectID":"/posts/linux2023/:1:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡/å®ä½œ (Linux Kernel Internals)","uri":"/posts/linux2023/"},{"categories":["Linux Kernel Internals"],"content":"ç¬¬ 1 é€±: èª å¯¦é¢å°è‡ªå·± (Feb 13, 14, 16) æ•™æè§£èªª* (åƒ…æ­¢æ–¼æ¦‚æ³ï¼Œè«‹è©³é–±ä¸‹æ–¹æ•™æåŠå€‹åˆ¥çš„å°æ‡‰è§£èªªéŒ„å½±) èª²ç¨‹ç°¡ä»‹å’Œæ³¨æ„é ˆçŸ¥ / èª²ç¨‹ç°¡ä»‹è§£èªªéŒ„å½±* æ¯é€±å‡å®‰æ’éš¨å ‚æ¸¬é©—ï¼Œæ¡è¨ˆå…¶ä¸­æœ€é«˜åˆ†çš„ 9 æ¬¡ å­¸æœŸè©•åˆ†æ–¹å¼: éš¨å ‚æ¸¬é©— (20%) + å€‹äººä½œæ¥­+å ±å‘ŠåŠå°ˆé¡Œ (30%) + è‡ªæˆ‘è©•åˆ† (50%) æ­·å±†ä¿®èª²å­¸ç”Ÿå¿ƒå¾—: å‘æ™¯äº˜, å¼µå®¶æ¦®, è•­å¥•å‡±, æ–¹éˆºå­¸ åˆ†çµ„å ±å‘Šç¤ºç¯„: ARM-Linux, Xvisor GNU/Linux é–‹ç™¼å·¥å…·å…±ç­†*: å‹™å¿… è‡ªä¸» å­¸ç¿’ Linux æ“ä½œ, Git, HackMD, LaTeX èªæ³• (ç‰¹åˆ¥æ˜¯æ•¸å­¸å¼), GNU make, perf, gnuplot ç¢ºèª Ubuntu Linux 22.04-LTS (æˆ–æ›´æ–°çš„ç‰ˆæœ¬) å·²é †åˆ©å®‰è£åˆ°ä½ çš„é›»è…¦ä¸­ é€é Computer Systems: A Programmerâ€™s Perspective å­¸ç¿’ç³»çµ±è»Ÿé«”*: æœ¬èª²ç¨‹æŒ‡å®šçš„æ•™ç§‘æ›¸ (è«‹åŠæ—©è³¼è²·: å¤©ç“æ›¸åº—) è»Ÿé«”ç¼ºå¤±å°è‡´çš„å±å®³ 1970 å¹´ä»£æ¨å‡ºçš„é¦–æ¬¾å»£é«”æ°‘èˆªå®¢æ©Ÿæ³¢éŸ³ 747 è»Ÿé«”ç”±å¤§ç´„ 40 è¬è¡Œç¨‹å¼ç¢¼æ§‹æˆï¼Œè€Œ 2011 å¹´å¼•é€²çš„æ³¢éŸ³ 787 çš„è»Ÿé«”è¦æ¨¡å‰‡æ˜¯æ³¢éŸ³ 747 çš„ 16 å€ï¼Œç´„ 650 è¬è¡Œç¨‹å¼ç¢¼ã€‚æ›è¨€ä¹‹ï¼Œä½ æˆ‘çš„æ€§å‘½ç·Šç¹«æ–¼ä¸€ç³»åˆ—æ¥µç‚ºè¤‡é›œçš„è»Ÿé«”ç³»çµ±ä¹‹ä¸­ï¼Œèƒ½ä¸èŠ±é»æ™‚é–“äº†è§£å—ï¼Ÿ è»Ÿé«”é–‹ç™¼çš„å®‰å…¨æ€§è¨­è¨ˆå’Œæ¸¬è©¦é©—è­‰æ‡‰ç²å¾—æ›´é«˜çš„é‡è¦– The adoption of Rust in Business (2022) æ­é…è§€çœ‹çŸ­ç‰‡: Rust in 100 Seconds è§£è®€è¨ˆç®—æ©Ÿç·¨ç¢¼ äººå€‘å°æ•¸å­¸çš„åŠ æ¸›é‹ç®—å¯è¼•æ˜“åœ¨è…¦ä¸­è¾¨è­˜ç¬¦è™Ÿä¸¦ç†è§£å…¶çµæœï¼Œä½†é›»è…¦åšä»»ä½•äº‹éƒ½å—é™æ–¼å¯¦é«”è³‡æ–™å„²å­˜åŠæ“ä½œæ–¹å¼ï¼Œæ›è¨€ä¹‹ï¼Œé›»è…¦ç¡¬é«”å¯¦éš›åªèªå¾— 0 å’Œ 1ï¼Œå»ä¸çŸ¥é“ç¬¦è™Ÿ + å’Œ - åœ¨æ•¸å­¸åŠæ‡‰ç”¨å ´åŸŸçš„æ„ç¾©ï¼Œæ–¼æ˜¯å·¥ç¨‹äººå“¡å¼•å…¥ã€Œè£œæ•¸ã€ä»¥è¡¨é”äººå€‘èªçŸ¥ä¸Šçš„æ­£è² æ•¸ æ‚¨æœ‰æ²’æœ‰æƒ³éï¼Œç‚ºä½•ã€ŒäºŒè£œæ•¸ã€(2â€™s complement) è¢«é›»è…¦å»£æ³›æ¡ç”¨å‘¢ï¼ŸèƒŒå¾Œçš„è¨­è¨ˆè€ƒé‡æ˜¯ä»€éº¼ï¼Ÿæœ¬æ–‡å˜—è©¦å¾æ•¸å­¸è§€é»å»è§£è®€ç·¨ç¢¼èƒŒå¾Œçš„åŸç† ä½ æ‰€ä¸çŸ¥é“çš„ C èªè¨€ï¼šæŒ‡æ¨™ç¯‡* linked list å’Œéé€£çºŒè¨˜æ†¶é«”æ“ä½œ* å®‰æ’ linked list ä½œç‚ºç¬¬ä¸€ä»½ä½œæ¥­åŠéš¨å ‚æ¸¬é©—çš„è€ƒé‡é»: æª¢é©—å­¸å“¡å°æ–¼ C èªè¨€æŒ‡æ¨™æ“ä½œçš„ç†Ÿæ‚‰ç¨‹åº¦ (é™„å¸¶æ€è€ƒï¼šå°æ–¼ Java ç¨‹å¼èªè¨€ä¾†èªªï¼Œè©²å¦‚ä½•å¯¦ä½œ linked list å‘¢ï¼Ÿ) linked list æœ¬è³ªä¸Šå°±æ˜¯å°éé€£çºŒè¨˜æ†¶é«”çš„æ“ä½œï¼Œä¹çœ‹åƒ…æ˜¯ä¸€ç¨®å–®ç´”çš„è³‡æ–™çµæ§‹ï¼Œä½†å°æ‡‰çš„æ¼”ç®—æ³•è®ŠåŒ–å¤šç«¯ï¼Œåƒæ˜¯ã€Œå¦‚ä½•åµæ¸¬ linked list æ˜¯å¦å­˜åœ¨ç’°ç‹€çµæ§‹ï¼Ÿã€å’Œã€Œå¦‚ä½•å° linked list æ’åºä¸¦ç¢ºä¿ç©ºé–“è¤‡é›œåº¦ç‚º O(1) å‘¢ï¼Ÿã€ linked list çš„æ“ä½œï¼Œä¾‹å¦‚èµ°è¨ª (traverse) æ‰€æœ‰ç¯€é»ï¼Œåæ˜ å‡º Locality of reference (cache ç”¨èª) çš„è¡¨ç¾å’Œè¨˜æ†¶é«”éšå±¤æ¶æ§‹ (memory hierarchy) é«˜åº¦ç›¸é—œï¼Œå­¸å“¡å¾ˆå®¹æ˜“å¾å¯¦é©—å¾—çŸ¥ç³»çµ±çš„è¡Œç‚ºï¼Œå¾è€Œæ€è€ƒå…¶è¡æ“Šå’Œæ•ˆèƒ½æ”¹é€²æ–¹æ¡ˆ ç„¡è«–æ˜¯ä½œæ¥­ç³»çµ±æ ¸å¿ƒã€C èªè¨€å‡½å¼åº«å…§éƒ¨ã€æ‡‰ç”¨ç¨‹å¼æ¡†æ¶ï¼Œåˆ°æ‡‰ç”¨ç¨‹å¼ï¼Œéƒ½ä¸é›£è¦‹åˆ° linked list çš„èº«å½±ï¼ŒåŒ…å«å¤šç¨®é‡å°æ•ˆèƒ½å’Œå®‰å…¨è­°é¡Œæ‰€åšçš„ linked list è®Šå½¢ï¼Œåˆé‚„è¦è€ƒæ…®åˆ°æ‡‰ç”¨ç¨‹å¼çš„æ³›ç”¨æ€§ (generic programming)ï¼Œæ˜¯å¾ˆå¥½çš„é€²éšé¡Œæ é¡Œç›® 1 + åˆ†æ* é¡Œç›®2 / åƒè€ƒé¡Œè§£1, åƒè€ƒé¡Œè§£2 é¡Œç›®3 / åƒè€ƒé¡Œè§£ é¡Œç›®4 / åƒè€ƒé¡Œè§£ é¡Œç›®5 / åƒè€ƒé¡Œè§£ ä½³å¥å¶å¾—ï¼šã€Œå¤§éƒ¨åˆ†çš„äººä¸€è¼©å­æ´å¯ŸåŠ›ä¸å½°ï¼ŒåŸå› ä¹‹ä¸€æ˜¯æ€•è¬›éŒ¯è¢«ç¬‘ã€‚æƒ³äº†ä¸€é»é»å°±ä¸æ•¢ç¹¼çºŒä¹Ÿæ²’è¨˜éŒ„æˆ–åˆ†äº«ï¼Œæ™‚é–“éƒ½èŠ±åœ¨è®€æ›¸æŸ¥è³‡æ–™çœ‹åˆ¥äººæ€éº¼æƒ³ã€‚çœ‹å®Œå°±çœŸçš„æ²’æœ‰è‡ªå·±çš„æ´å¯Ÿäº†ã€(å‡ºè™•) ä½œæ¥­: æˆªæ­¢ç¹³äº¤æ—¥: Feb 28, 2023 lab0* quiz1 ç¬¬ 1 é€±éš¨å ‚æ¸¬é©—: é¡Œç›® (å…§å«ä½œç­”è¡¨å–®) èª²å ‚å•ç­”ç°¡è¨˜ ","date":"2024-02-28","objectID":"/posts/linux2023/:1:1","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡/å®ä½œ (Linux Kernel Internals)","uri":"/posts/linux2023/"},{"categories":["Linux Kernel Internals"],"content":"ç¬¬ 2 é€±: C èªè¨€ç¨‹å¼è¨­è¨ˆ (Feb 20, 21, 23) æ•™æè§£èªª* (åƒ…æ­¢æ–¼æ¦‚æ³ï¼Œè«‹è©³é–±ä¸‹æ–¹æ•™æåŠå€‹åˆ¥çš„å°æ‡‰è§£èªªéŒ„å½±) Linux v6.2 ç™¼å¸ƒ: æ¥ä¸‹ä¾†æœƒæ˜¯è®“å­¸å“¡çœ¼èŠ±æ’©äº‚çš„ä¸»ç‰ˆè™Ÿ/æ¬¡ç‰ˆè™Ÿçš„é£›å¿«è·³èº / kernel.org Linux: ä½œæ¥­ç³»çµ±è¡“èªåŠæ¦‚å¿µ* ç³»çµ±è»Ÿé«”é–‹ç™¼æ€ç¶­ C èªè¨€: æ•¸å€¼ç³»çµ±* å„˜ç®¡æ•¸å€¼ç³»çµ±ä¸¦é C èªè¨€æ‰€ç‰¹æœ‰ï¼Œä½†åœ¨ Linux æ ¸å¿ƒå¤§é‡å­˜åœ¨ u8/u16/u32/u64 é€™æ¨£é€é typedef æ‰€å®šç¾©çš„å‹æ…‹ï¼Œä¼´éš¨è‘—å„å¼ alignment å­˜å–ï¼Œè‹¥å­¸å“¡å°æ•¸å€¼ç³»çµ±çš„èªçŸ¥ä¸å¤ å……åˆ†ï¼Œå¯èƒ½ç«‹å³å°±è¢«é˜»æ“‹åœ¨æ¢ç´¢ Linux æ ¸å¿ƒä¹‹å¤– â€”â€” ç•¢ç«Ÿä½ å®Œå…¨æä¸æ¸…æ¥šï¼Œç‚ºä½•åœ¨ Linux æ ¸å¿ƒå­˜å–ç‰¹å®šè³‡æ–™éœ€è¦ç¹ä¸€å¤§åœˆã€‚ C èªè¨€: Bitwise æ“ä½œ* Linux æ ¸å¿ƒåŸå§‹ç¨‹å¼ç¢¼å­˜åœ¨å¤§é‡ bit(-wise) operations (ç°¡ç¨± bitops)ï¼Œé —å¤šä¹çœ‹åƒæ˜¯é­”æ³•çš„ C ç¨‹å¼ç¢¼å°±æ˜¯ bitops çš„çµ„åˆ é¡ç¥ç¶“ç¶²è·¯çš„ ReLU åŠå…¶å¸¸æ•¸æ™‚é–“è¤‡é›œåº¦å¯¦ä½œ å¾ âˆš2 çš„å­˜åœ¨è«‡é–‹å¹³æ–¹æ ¹çš„å¿«é€Ÿé‹ç®— Linux æ ¸å¿ƒçš„ hash table å¯¦ä½œ ç‚ºä»€éº¼è¦æ·±å…¥å­¸ç¿’ C èªè¨€ï¼Ÿ* C èªè¨€ç™¼æ˜è€… Dennis M. Ritchie èªªï¼šã€ŒC å¾ˆå½†æ‰­åˆç¼ºé™·é‡é‡ï¼Œå»ç•°å¸¸æˆåŠŸã€‚å›ºç„¶æœ‰æ­·å²çš„å·§åˆæ¨æ³¢åŠ©ç€¾ï¼Œå¯ä¹Ÿçš„ç¢ºæ˜¯å› ç‚ºå®ƒèƒ½æ»¿è¶³æ–¼ç³»çµ±è»Ÿé«”å¯¦ä½œçš„ç¨‹å¼èªè¨€æœŸå¾…ï¼šæ—¢æœ‰ç›¸ç•¶çš„æ•ˆç‡ä¾†å–ä»£çµ„åˆèªè¨€ï¼Œåˆå¯å……åˆ†é”åˆ°æŠ½è±¡ä¸”æµæš¢ï¼Œèƒ½ç”¨æ–¼æè¿°åœ¨å¤šæ¨£ç’°å¢ƒçš„æ¼”ç®—æ³•ã€‚ã€ Linux æ ¸å¿ƒä½œç‚ºä¸–ç•Œä¸Šæœ€æˆåŠŸçš„é–‹æ”¾åŸå§‹ç¢¼è¨ˆç•«ï¼Œä¹Ÿæ˜¯ C èªè¨€åœ¨å·¥ç¨‹é ˜åŸŸçš„ç‘°å¯¶ï¼Œè£¡é ­å……æ–¥å„å¼ã€Œè—è¡“ã€ï¼Œå¾€å¾€æœƒåš‡åˆ°åˆæ¬¡æ¥è§¸çš„äººå€‘ï¼Œä½†ç¸½æ˜¯èƒ½å¤ ç”¨ C èªè¨€æ¨™æº–å’Œé–‹ç™¼å·¥å…·æä¾›çš„æ“´å±• (ä¸»è¦ä¾†è‡ª gcc çš„ GNU extensions) ä¾†è§£é‡‹ã€‚ åŸºæ–¼ C èªè¨€æ¨™æº–ç ”ç©¶èˆ‡ç³»çµ±ç¨‹å¼å®‰å…¨è­°é¡Œ è—‰ç”±ç ”è®€æ¼æ´ç¨‹å¼ç¢¼åŠ C èªè¨€æ¨™æº–ï¼Œè¨è«–ç³»çµ±ç¨‹å¼çš„å®‰å…¨è­°é¡Œ é€éé™¤éŒ¯å™¨è¿½è¹¤ç¨‹å¼ç¢¼å¯¦éš›é‹è¡Œçš„ç‹€æ³ï¼Œäº†è§£å…¶é‹ä½œåŸç†; å–æè‡ª dangling pointer, CWE-416 Use After Free, CVE-2017-16943 ä»¥åŠ integer overflow çš„è­°é¡Œ; C èªè¨€ï¼šè¨˜æ†¶é«”ç®¡ç†ã€å°é½ŠåŠç¡¬é«”ç‰¹æ€§* æ­é…é–±è®€: The Lost Art of Structure Packing å¾è™›æ“¬è¨˜æ†¶é«”è«‡èµ·ï¼Œæ­¸ç´å‡ºç¾ä»£éŠ€è¡Œå’Œè™›æ“¬è¨˜æ†¶é«”å…©è€…é«˜åº¦ç›¸ä¼¼: malloc çµ¦å‡º valid pointer ä¸è¦å¤ªé«˜èˆˆï¼Œç­‰ä½ è¦é–‹å§‹ç”¨çš„æ™‚å€™æä¸å¥½ä½œæ¥­ç³»çµ±çµ¦å€‹ OOM â€”â€”ç°¡å–®ä¾†èªªå°±æ˜¯ä¸€å¼µæ”¯ç¥¨ï¼Œèƒ½ä¸èƒ½æ‹¿ä¾†é–‹ç­‰åˆ°å…Œç¾æ‰çŸ¥é“ã€‚ æ¢è¨ heap (å‹•æ…‹é…ç½®ç”¢ç”Ÿï¼Œç³»çµ±æœƒå­˜æ”¾åœ¨å¦å¤–ä¸€å¡Šç©ºé–“)ã€data alignmentï¼Œå’Œ malloc å¯¦ä½œæ©Ÿåˆ¶ç­‰è­°é¡Œã€‚é€™äº›éƒ½æ˜¯ç†è§£ Linux æ ¸å¿ƒé‹ä½œçš„é—œéµæ¦‚å¿µã€‚ C èªè¨€: bit-field bit field æ˜¯ C èªè¨€ä¸€å€‹å¾ˆè¢«å¿½ç•¥çš„ç‰¹å¾µï¼Œä½†åœ¨ Linux å’Œ gcc é€™é¡ç³»çµ±è»Ÿé«”å¾ˆå¸¸å‡ºç¾ï¼Œä¸åƒ…æ˜¯ç²¾æº–è¦ç¯„æ¯å€‹ bit çš„ä½œç”¨ï¼Œç”šè‡³ç”¨ä¾†ã€Œæ“´å……ã€C èªè¨€ åƒè€ƒé¡Œç›® / åƒè€ƒé¡Œç›®* / åƒè€ƒé¡Œè§£ 1, åƒè€ƒé¡Œè§£ 2, åƒè€ƒé¡Œè§£ 3 ä½œæ¥­: æˆªæ­¢ç¹³äº¤æ—¥ Mar 7 quiz2 ç¬¬ 2 é€±éš¨å ‚æ¸¬é©—: é¡Œç›® (å…§å«ä½œç­”è¡¨å–®) èª²å ‚å•ç­”ç°¡è¨˜ ","date":"2024-02-28","objectID":"/posts/linux2023/:1:2","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡/å®ä½œ (Linux Kernel Internals)","uri":"/posts/linux2023/"},{"categories":["Linux Kernel Internals"],"content":"ç¬¬ 3 é€±: ä¸¦è¡Œå’Œ C èªè¨€ç¨‹å¼è¨­è¨ˆ (Feb 27, 28, Mar 2) æ•™æè§£èªª* (åƒ…æ­¢æ–¼æ¦‚æ³ï¼Œè«‹è©³é–±ä¸‹æ–¹æ•™æåŠå€‹åˆ¥çš„å°æ‡‰è§£èªªéŒ„å½±) å…¬å‘Š 2 æœˆ 28 æ—¥æ²’æœ‰å¯¦é«”èª²ç¨‹ï¼Œä½†å®‰æ’ç·šä¸Šæ¸¬é©— (ã€ŒLinux æ ¸å¿ƒè¨­è¨ˆã€èª²ç¨‹çš„å­¸å“¡å‹™å¿…åƒåŠ )ï¼Œåœ¨ 15:20-23:59 ä¹‹é–“ä¾æ“š Google Calendar é€²è¡Œä½œç­” ç¬¬äºŒæ¬¡ä½œæ¥­å·²æŒ‡æ´¾ï¼Œå¯åœ¨ 2 æœˆ 28 æ—¥æ™šé–“èµ·é–‹å§‹ç¹³äº¤ï¼Œæˆªæ­¢ç¹³äº¤æ—¥ Mar 7 3 æœˆ 1 æ—¥æ™šé–“å®‰æ’ç¬¬ä¸€æ¬¡ä½œæ¥­çš„æª¢è¨ç›´æ’­ (äº‹å¾Œæœ‰éŒ„å½±)ï¼Œè«‹åƒè¦‹ Google Calendar Linux: ç™¼å±•å‹•æ…‹å›é¡§* å¾ Revolution OS çœ‹ä½œæ¥­ç³»çµ±ç”Ÿæ…‹è®ŠåŒ–* ä¸¦è¡Œå’Œå¤šåŸ·è¡Œç·’ç¨‹å¼è¨­è¨ˆ*: æ‡‰æ¶µè“‹ Part 1 åˆ° Part 4 Part 1: æ¦‚å¿µã€æ‰§è¡Œé¡ºåº Part 2 Part 3 Part 4 C èªè¨€: å‡½å¼å‘¼å«* è‘—é‡åœ¨è¨ˆç®—æ©Ÿæ¶æ§‹å°æ‡‰çš„æ”¯æ´å’Œè¡Œç‚ºåˆ†æ C èªè¨€: éè¿´å‘¼å«* æˆ–è¨±è·Ÿä½ æƒ³åƒä¸­ä¸åŒï¼ŒLinux æ ¸å¿ƒçš„åŸå§‹ç¨‹å¼ç¢¼è£¡é ­ä¹Ÿç”¨åˆ°éè¿´å‡½å¼å‘¼å«ï¼Œç‰¹åˆ¥åœ¨è¼ƒè¤‡é›œçš„å¯¦ä½œï¼Œä¾‹å¦‚æª”æ¡ˆç³»çµ±ï¼Œå–„ç”¨éè¿´å¯å¤§å¹…ç¸®æ¸›ç¨‹å¼ç¢¼ï¼Œä½†é€™ä¹Ÿå°è‡´è¿½è¹¤ç¨‹å¼é‹ä½œçš„é›£åº¦å¤§å¢ C èªè¨€: å‰ç½®è™•ç†å™¨æ‡‰ç”¨* C èªè¨€ä¹‹æ‰€ä»¥ä¸éœ€è¦æ™‚å¸¸ç™¼ä½ˆæ–°çš„èªè¨€ç‰¹å¾µåˆå¯ä»¥ä¿æŒæ´»åŠ›ï¼Œå‰ç½®è™•ç†å™¨ (preprocessor) æ˜¯å¾ˆé‡è¦çš„å› ç´ ï¼Œæœ‰å¿ƒè€…å¯é€•è¡Œã€Œæ“´å……ã€C èªè¨€ C èªè¨€: goto å’Œæµç¨‹æ§åˆ¶* goto åœ¨ C èªè¨€è¢«æŸäº›äººçœ‹åšæ˜¯å¦–é­”èˆ¬çš„å­˜åœ¨ï¼Œä¸éå¯¦åœ¨ä¸ç”¨é€™æ¨£çœ‹å¾…ï¼Œè‡³å°‘åœ¨ Linux æ ¸å¿ƒåŸå§‹ç¨‹å¼ç¢¼ä¸­ï¼Œgoto æ˜¯å¤§é‡å­˜åœ¨ (è·Ÿä½ æƒ³åƒä¸­ä¸åŒå§)ã€‚æœ‰æ™‚ä¸ç”¨ goto æœƒå¯«å‡ºæ›´å¯æ€•çš„ç¨‹å¼ç¢¼ C èªè¨€ç¨‹å¼è¨­è¨ˆæŠ€å·§* ä½œæ¥­: æˆªæ­¢ç¹³äº¤æ—¥: Mar 21 fibdrv*, quiz3, review* Week3 éš¨å ‚æ¸¬é©—: é¡Œç›® (å…§å«ä½œç­”è¡¨å–®) ç¬¬ 4 é€± (Mar 6, 7, 9): æ•¸å€¼ç³»çµ± + ç·¨è­¯å™¨ æ•™æè§£èªª* (åƒ…æ­¢æ–¼æ¦‚æ³ï¼Œè«‹è©³é–±ä¸‹æ–¹æ•™æåŠå€‹åˆ¥çš„å°æ‡‰è§£èªªéŒ„å½±) å…¬å‘Š: è«‹å¡«å¯« Google è¡¨å–®ï¼Œä»¥åˆ©å¾ŒçºŒè¿½è¹¤ ã€ŠDemystifying the Linux CPU Schedulerã€‹çš„æ›¸ç¨¿å·²å¯„é€çµ¦æˆåŠŸå¤§å­¸çš„é¸èª²å­¸ç”Ÿï¼Œæ—è½çš„å­¸å“¡é è¨ˆåœ¨ 3 æœˆ 13 æ—¥å–å¾— (ç¬¬ 5 é€±é€²åº¦) è²¢ç»ç¨‹å¼ç¢¼åˆ° Linux æ ¸å¿ƒ ç¬¬ä¸€æ¬¡çµ¦ Linux Kernel ç™¼ patch æäº¤ç¬¬ä¸€ä»½ Patch åˆ° Linux Kernel ç¬¬ä¸€æ¬¡ç™¼ patch åˆ° LKML è¿½æ±‚ç¥ä¹å…¶æŠ€çš„ç¨‹å¼è¨­è¨ˆä¹‹é“ ã€Œå¯ä»¥çœ‹å‡ºæŠ„è¥²é¢¨æ°£åœ¨å°ç£ä¸¦ä¸åªæ˜¯å°æ™‚å€™åœ¨å­¸æ ¡æŠ„æŠ„ä½œæ¥­è€Œå·²ï¼›åª’é«”å·¥ä½œè€…åœ¨å ±å°ä¸­ä»»æ„æŠ„è¥²åŠè½‰è¼‰æ˜¯ç¨®ä¸å°Šé‡è‡ªå·±å°ˆæ¥­çš„è¡¨ç¾ï¼Œä¸ä½†éš±å«è‘—ä¸€ç¨®æ‡‰ä»˜äº†äº‹çš„å¿ƒæ…‹ï¼Œæ›´ä»£è¡¨è‘—é€™äº›äººå°æ–¼è‡ªå·±çš„å·¥ä½œæ²’æœ‰ç†±æƒ…ï¼Œæ›´æ²’æœ‰è‘—ä¸€é»å …æŒã€‚å¦‚æœè¦èªªæˆ‘åœ¨ç¾åœ‹çœ‹åˆ°é€™é‚Šå’Œå°ç£æœ‰ä»€éº¼æœ€å¤§çš„ä¸åŒï¼Œæˆ‘æƒ³é—œéµçš„å·®ç•°å°±åœ¨å°è‡ªå·±çš„å·¥ä½œæœ‰æ²’æœ‰ç†±æƒ…å’Œå …æŒè€Œå·²äº†ã€‚ã€ ã€Œç¨‹å¼è—è¡“å®¶ä¹Ÿä¸éæ˜¯åœ¨ã€ç°¡æ½”ã€ã€ã€å½ˆæ€§ã€ã€ã€æ•ˆç‡ã€é€™ä¸‰å¤§ç›®æ¨™ä¸Šé€²è¡Œä¸€é€£ä¸²çš„å–æ¨ (trade-off) å’Œæœ€ä½³åŒ–ã€‚ã€ Linux æ ¸å¿ƒçš„ç´…é»‘æ¨¹ CS:APP ç¬¬ 2 ç« é‡é»æç¤ºå’Œç·´ç¿’* æ ¸å¿ƒé–‹ç™¼è€…ç•¶ç„¶è¦ç†Ÿæ‚‰ç·¨è­¯å™¨è¡Œç‚º Linus Torvalds æ•™ä½ åˆ†æ gcc è¡Œç‚º Pointers are more abstract than you might expect in C / HackerNews è¨è«– C ç·¨è­¯å™¨åŸç†å’Œæ¡ˆä¾‹åˆ†æ* C èªè¨€: æœªå®šç¾©è¡Œç‚º*: C èªè¨€æœ€åˆç‚ºäº†é–‹ç™¼ UNIX å’Œç³»çµ±è»Ÿé«”è€Œç”Ÿï¼Œæœ¬è³ªæ˜¯ä½éšçš„ç¨‹å¼èªè¨€ï¼Œåœ¨èªè¨€è¦ç¯„å±¤ç´šå­˜åœ¨ undefined behaviorï¼Œå¯å…è¨±ç·¨è­¯å™¨å¼•å…¥æ›´å¤šæœ€ä½³åŒ– C èªè¨€: ç·¨è­¯å™¨å’Œæœ€ä½³åŒ–åŸç†* ã€ŠDemystifying the Linux CPU Schedulerã€‹ç¬¬ 1 ç«  ä½œæ¥­: æˆªæ­¢ç¹³äº¤æ—¥: Mar 30 quiz4 Week4 éš¨å ‚æ¸¬é©—: é¡Œç›® (å…§å«ä½œç­”è¡¨å–®) èª²å ‚å•ç­”ç°¡è¨˜ ç¬¬ 5 é€± (Mar 13, 14, 16): Linux CPU scheduler æ•™æè§£èªª* (åƒ…æ­¢æ–¼æ¦‚æ³ï¼Œè«‹è©³é–±ä¸‹æ–¹æ•™æåŠå€‹åˆ¥çš„å°æ‡‰è§£èªªéŒ„å½±) å…¬å‘Š: æœ¬é€±å°å…¥å®¢è£½åŒ–ä½œæ¥­ï¼Œè®“å­¸å“¡é¸æ“‡æ”¹é€²å‰å››é€±çš„ä½œæ¥­æˆ–è‡ªè¨‚é¡Œç›® (ä¾‹å¦‚è²¢ç»ç¨‹å¼ç¢¼åˆ° Linux æ ¸å¿ƒ)ï¼Œéš¨å¾Œå®‰æ’æˆèª²æ•™å¸«å’Œå­¸å“¡çš„ç·šä¸Šä¸€å°ä¸€è¨è«– æµ®é»æ•¸é‹ç®—*: å·¥ç¨‹é ˜åŸŸå¾€å¾€æ˜¯ä¸€ç³»åˆ—çš„å–æ¨çµæœï¼Œæµ®é»æ•¸æ›´æ˜¯å¦‚æ­¤ï¼Œåœ¨è»Ÿé«”ç™¼é–‹ç™¼æœ‰å¤ªå¤šå¤±èª¤æ¡ˆä¾‹æºè‡ªå·¥ç¨‹äººå“¡å°æµ®é»æ•¸é‹ç®—çš„æŒæ¡ä¸è¶³ï¼Œæœ¬è­°ç¨‹å¸Œæœ›è—‰ç”±æ¢è¨çœŸå¯¦ä¸–ç•Œçš„è¡€æ·‹æ·‹æ¡ˆä¾‹ï¼Œå¸¶è‘—å­¸å“¡æ€è€ƒ IEEE 754 è¦æ ¼å’Œç›¸é—œè»Ÿç¡¬é«”è€ƒé‡é»ï¼Œæœ€å¾Œä¹Ÿæœƒæ¢è¨åœ¨æ·±åº¦å­¸ç¿’é ˜åŸŸç‚ºäº†æ”¹å–„è³‡æ–™è™•ç†æ•ˆç‡ï¼Œè€Œå¼•å…¥çš„ BFloat16 é€™æ¨£çš„æ–°æ¨™æº– float16 vs. bfloat16 è¨˜æ†¶é«”é…ç½®å™¨æ¶‰åŠ bitwise æ“ä½œåŠæµ®é»æ•¸é‹ç®—ã€‚å‚³çµ±çš„å³æ™‚ç³»çµ±å’Œè©²é ˜åŸŸçš„ä½œæ¥­ç³»çµ± (å³ RTOS) ç‚ºäº†è®“ç³»çµ±è¡Œç‚ºæ›´å¯é æ¸¬ï¼Œå¾€å¾€æ¨æ£„å‹•æ…‹è¨˜æ†¶é«”é…ç½®çš„èƒ½åŠ›ï¼Œä½†é€™é¡¯ç„¶è®“ç³»çµ±çš„æ“´å……èƒ½åŠ›å¤§å¹…å—é™ã€‚å¾Œä¾†ç ”ç©¶äººå“¡æå‡º TLSF (Two-Level Segregated Fit) å˜—è©¦è®“å³æ™‚ç³»çµ±ä¹Ÿèƒ½äº«ç”¨å‹•æ…‹è¨˜æ†¶é«”ç®¡ç†ï¼Œå…¶é—œéµè¨´æ±‚æ˜¯ â€œO(1) cost for malloc, free, realloc, aligned_allocâ€ Benchmarking Malloc with Doom 3 tlsf-bsd TLSF: Part 1: Background, Part 2: The floating point Linux æ ¸å¿ƒæ¨¡çµ„é‹ä½œåŸç† Linux: ä¸åªæŒ‘é¸ä»»å‹™çš„æ’ç¨‹å™¨*: æ’ç¨‹å™¨ (scheduler) æ˜¯ä»»ä½•ä¸€å€‹å¤šå·¥ä½œæ¥­ç³»çµ±æ ¸å¿ƒéƒ½å…·å‚™çš„æ©Ÿåˆ¶ï¼Œä½†å½¼æ­¤è½å·®æ¥µå¤§ï¼Œè€ƒé‡é»ä¸åƒ…æ˜¯æ¼”ç®—æ³•ï¼Œé‚„æœ‰ç•¶æ‡‰ç”¨è¦æ¨¡ææ˜‡æ™‚ (æ‰€è¬‚çš„ scalability) å’Œæ¶‰åŠå³æ™‚è™•ç†ä¹‹éš›ï¼Œæœƒæ‹›è‡´ä¸å¯é çŸ¥çš„ç‹€æ³ (non-determinism)ï¼Œä¸åƒ…å³æ™‚ç³»çµ±åœ¨æ„ï¼Œä»»ä½•å»ºæ§‹åœ¨ Linux æ ¸å¿ƒä¹‹ä¸Šçš„å¤§å‹æœå‹™éƒ½æœƒæ·±å—è¡æ“Šã€‚æ˜¯æ­¤ï¼ŒLinux æ ¸å¿ƒçš„æ’ç¨‹å™¨ç¶“æ­·å¤šæ¬¡è®Šé©ï¼Œéœ€è¦ç•™æ„çš„æ˜¯ï¼Œæ’ç¨‹çš„é›£åº¦ä¸åœ¨æ–¼æŒ‘é¸ä¸‹ä¸€å€‹å¯åŸ·è¡Œçš„è¡Œç¨‹ (process)ï¼Œè€Œæ˜¯è®“åŸ·è¡Œå®Œçš„è¡Œç¨‹å¾—ä»¥å®‰æ’åˆ°åˆé©çš„ä½ç½®ï¼Œä½¿å¾— runqueue ä¾ç„¶ä¾æ“šç¬¦åˆé æœŸçš„é †åºã€‚ C èªè¨€: å‹•æ…‹é€£çµå™¨* C èªè¨€: é€£çµå™¨å’ŒåŸ·è¡Œæª”è³‡è¨Š* C èªè¨€: åŸ·è¡Œéšæ®µç¨‹å¼åº« (CRT)* ä½œæ¥­: æˆªæ­¢ç¹³äº¤ Apr 10 assessment Week5 éš¨å ‚æ¸¬é©—: é¡Œç›® (å…§å«ä½œç­”è¡¨å–®) èª²å ‚å•ç­”ç°¡è¨˜ ç¬¬ 6 é€± (Mar 20, 21, 23): System call + CPU Scheduler æ•™æè§£èªª* (åƒ…æ­¢æ–¼æ¦‚æ³ï¼Œè«‹è©³é–±ä¸‹æ–¹æ•™æåŠå€‹åˆ¥çš„å°æ‡‰è§£èªªéŒ„å½±) å…¬å‘Š è‡ª 3 æœˆ 22 æ—¥èµ·ï¼Œé–‹æ”¾è®“å­¸å“¡ (é¸èª²çš„å­¸ç”Ÿ + å®Œæˆå‰äºŒæ¬¡ä½œæ¥­éåŠè¦æ±‚çš„æ—è½è€…) è·Ÿæˆèª²æ•™å¸«é ç´„ä¸€å°ä¸€ç·šä¸Šè¨è«–ï¼Œè«‹åƒç…§èª²ç¨‹è¡Œäº‹æ›†è£¡é ­æ¨™æ³¨ â€œOffice hourâ€ çš„æ™‚æ®µï¼Œç™¼è¨Šæ¯åˆ° Facebook ç²‰çµ²å°ˆé ï¼Œç°¡è¿°ä½ çš„å­¸ç¿’ç‹€æ³ä¸¦é¸å®šåå¥½çš„æ™‚æ®µ (å»ºè­°æ˜¯ 30 åˆ†é˜)ã€‚ç•™æ„èª²ç¨‹ç™¼é€çš„å…¬å‘Šä¿¡ä»¶ é¸ä¿®èª²ç¨‹çš„å­¸å“¡åœ¨æœ¬å­¸æœŸè‡³å°‘è¦å®‰æ’ä¸€æ¬¡ä¸€å°ä¸€è¨è«–ï¼Œå¦å‰‡æˆèª²æ•™å¸«é›£ä»¥è©•ä¼°å­¸ç¿’ç‹€æ³ï¼Œå¾è€Œæœƒå½±éŸ¿è©•åˆ†ï¼Œè«‹é‡è¦–è‡ªå·±çš„æ¬Šç›Šã€‚ coroutine Linux: è³¦äºˆæ‡‰ç”¨ç¨‹å¼ç”Ÿå‘½çš„ç³»çµ±å‘¼å« vDSO: å¿«é€Ÿçš„ Linux ç³»çµ±å‘¼å«æ©Ÿåˆ¶ UNIX ä½œæ¥­ç³»çµ± fork/exec ç³»çµ±å‘¼å«çš„å‰ä¸–ä»Šç”Ÿ ã€ŠDemystifying the Linux CPU Schedulerã€‹ 1.2.1 System calls 1.2.2 A different kind of software 1.2.3 User and kernel stacks 1.3 Process management 2.1 Introduction 2.2 Prior to CFS 2.3 Completely Fair Scheduler (CFS) 3.1 Structs and their role ä½œæ¥­: æˆªæ­¢ç¹³äº¤ Apr 17 quiz5, quiz6 Week6 éš¨å ‚æ¸¬é©—: é¡Œç›® (å…§å«ä½œç­”è¡¨å–®) èª²å ‚å•ç­”ç°¡è¨˜ ç¬¬ 7 é€± (Mar 27, 28, 30): Process, ä¸¦è¡Œå’Œå¤šåŸ·è¡Œç·’ æ•™æè§£èªª-1*, æ•™æè§£èªª-2* (åƒ…æ­¢æ–¼æ¦‚æ³ï¼Œè«‹è©³é–±ä¸‹æ–¹æ•™æåŠå€‹åˆ¥çš„å°æ‡‰è§£èªªéŒ„å½±) å…¬å‘Š: ç¬¬ 5 æ¬¡ä½œæ¥­ å’Œ ç¬¬ 6 æ¬¡ä½œæ¥­ ä½œæ¥­å·²æŒ‡æ´¾ æœ¬é€±æ¸¬é©—é †å»¶åˆ° 4 æœˆ 4 æ—¥å’Œ 4 æœˆ 6 æ—¥ï¼Œ3 æœˆ 30 æ—¥æ™šé–“å®‰æ’èª²ç¨‹è¬›è§£ 4 æœˆ 3 æ—¥æ™šé–“ä¾èˆŠè¬›èª² (äº‹å¾Œæœ‰éŒ„å½±)ã€4 æœˆ 4 æ—¥ä¸‹åˆåˆ°æ™šé–“å®‰æ’åœ¨å®¶æ¸¬é©—ï¼Œ4 æœˆ 6 æ—¥æ™šé–“å®‰æ’æ¸¬é©— Linux: ä¸åƒ…æ˜¯å€‹åŸ·è¡Œå–®å…ƒçš„ Process*: Linux æ ¸å¿ƒå°æ–¼ UNIX Process çš„å¯¦ä½œç›¸ç•¶è¤‡é›œï¼Œä¸åƒ…è˜Šå«æ­·å²æ„ç¾© (å¹¾ä¹æ¯å€‹æ¬„ä½éƒ½å€¼å¾—è¬›å¤)ï¼Œæ›´æ˜¯åæ˜ å‡ºè³‡è¨Šç§‘æŠ€ç”¢æ¥­çš„è®Šé·ï¼Œæ ¸å¿ƒç¨‹å¼ç¢¼çš„ task_struct çµæ§‹é«”æ›´æ˜¯ä¸€çµ•ï¼Œå»£æ³›æ¶µè“‹ process ç‹€æ…‹ã€è™•ç†å™¨ã€æª”æ¡ˆç³»çµ±ã€signal è™•ç†ã€åº•å±¤è¿½è¹¤æ©Ÿåˆ¶ç­‰ç­‰è³‡è¨Šï¼Œæ›´ç”šè€…ï¼Œé‚„å¾ˆæ›–æ˜§åœ°ä¿å­˜è‘— thread çš„å¿…è¦æ¬„ä½ï¼Œå¥½ä¼¼é€™å…©è€…å¤©ç”Ÿå°±è„«ä¸äº†å¹²ä¿‚ æ¢è¨ Linux æ ¸å¿ƒè¨­è¨ˆçš„ç‰¹æœ‰æ€ç¶­ï¼Œåƒæ˜¯å¦‚ä½•é€é LWP å’Œ NPTL å¯¦ä½œåŸ·è¡Œç·’ï¼Œåˆå¦‚ä½•é€éè¡Œç¨‹å»ºç«‹è¨˜æ†¶é«”ç®¡ç†çš„ä¸€ç¨®æŠ½è±¡å±¤ï¼Œå†è€…å›é¡§è¡Œç¨‹é–“çš„ context switch åŠæ’ç¨‹æ©Ÿåˆ¶ï¼Œæ­é… signal è™•ç† æ¸¬è©¦ Linux æ ¸å¿ƒçš„è™›æ“¬åŒ–ç’°å¢ƒ å»ºæ§‹ User-Mode Linux çš„å¯¦é©—ç’°å¢ƒ* ã€ˆConcurrency Primerã€‰å°è®€ The C11 and C++11 Concurrency Model Time to move to C11","date":"2024-02-28","objectID":"/posts/linux2023/:1:3","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡/å®ä½œ (Linux Kernel Internals)","uri":"/posts/linux2023/"},{"categories":["C","Linux Kernel Internals"],"content":" goto åœ¨ C èªè¨€è¢«æŸäº›äººçœ‹åšæ˜¯å¦–é­”èˆ¬çš„å­˜åœ¨ï¼Œä¸éå¯¦åœ¨ä¸ç”¨é€™æ¨£çœ‹å¾…ï¼Œè‡³å°‘åœ¨ Linux æ ¸å¿ƒåŸå§‹ç¨‹å¼ç¢¼ä¸­ï¼Œgoto æ˜¯å¤§é‡å­˜åœ¨ (è·Ÿä½ æƒ³åƒä¸­ä¸åŒå§)ã€‚æœ‰æ™‚ä¸ç”¨ goto æœƒå¯«å‡ºæ›´å¯æ€•çš„ç¨‹å¼ç¢¼ åŸæ–‡åœ°å€ Stack Overflow: GOTO still considered harmful? ","date":"2024-04-05","objectID":"/posts/c-control-flow/:0:0","tags":["Sysprog","C"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: goto å’Œæµç¨‹æ§åˆ¶ç¯‡","uri":"/posts/c-control-flow/"},{"categories":["C","Linux Kernel Internals"],"content":"MISRA C MISRA-C:2004 Guidelines for the use of the C language in critical systems MISRA C ç¦ç”¨ goto å’Œ continueï¼Œä½†å¯ç”¨ break: Rule 14.4 (required): The goto statement shall not be used. Rule 14.5 (required): The continue statement shall not be used. Rule 14.6 (required): For any iteration statement there shall be at most one break statement used for loop termination. These rules are in the interests of good structured programming. One break statement is allowed in a loop since this allows, for example, for dual outcome loops or for optimal coding. Stack Overflow ä¸Šçš„ç›¸å…³è®¨è®º: Why â€œcontinueâ€ is considered as a C violation in MISRA C:2004? ä½¿ç”¨ goto å¯èƒ½ä¼šæ··æ·†é™æ€åˆ†æçš„å·¥å…· (å½“ç„¶ä½¿ç”¨ goto ä¼šæå¤§å¯èƒ½å†™å‡º ugly çš„ç¨‹å¼ç ): Case in point: MISRA C forbids goto statements primarily because it can mess up static analysis. Yet this rule is gratuitously followed even when no static analysis tools are used, thus yielding none of the gains that you trade off for occasionally writing ugly code. ","date":"2024-04-05","objectID":"/posts/c-control-flow/:1:0","tags":["Sysprog","C"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: goto å’Œæµç¨‹æ§åˆ¶ç¯‡","uri":"/posts/c-control-flow/"},{"categories":["C","Linux Kernel Internals"],"content":"GOTO æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆå¯æ€• è™½ç„¶ MISRA C è¿™ç±»è§„èŒƒéƒ½æ˜ç¡®ç¦æ­¢äº†ä½¿ç”¨ gotoï¼Œä½† goto å¹¶æ²¡æœ‰æƒ³åƒä¸­çš„é‚£ä¹ˆå¯æ€•ï¼Œåœ¨ä¸€äº›é¢†åŸŸè¿˜æ˜¯æå…·æ´»åŠ›çš„ã€‚ åœ¨ C è¯­è¨€ä¸­ goto è¯­å¥æ˜¯å®ä½œé”™è¯¯å¤„ç†çš„æä½³é€‰æ‹© (å¦‚æœä½ çœ‹è¿‡ xv6 åº”è¯¥ä¸é™Œç”Ÿ): Using goto for error handling in C ç›¸å…³å®ä½œ: goto åœ¨ Linux æ ¸å¿ƒå¹¿æ³›åº”ç”¨ OpenBSDâ€™s httpd Linux kernel é‡Œ NFS inode éªŒè¯çš„å‡½æ•°: fs/nfs/inode.c Wikipedia: Common usage patterns of Goto ","date":"2024-04-05","objectID":"/posts/c-control-flow/:2:0","tags":["Sysprog","C"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: goto å’Œæµç¨‹æ§åˆ¶ç¯‡","uri":"/posts/c-control-flow/"},{"categories":["C","Linux Kernel Internals"],"content":"switch \u0026 goto Computed goto for efficient dispatch tables ","date":"2024-04-05","objectID":"/posts/c-control-flow/:3:0","tags":["Sysprog","C"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: goto å’Œæµç¨‹æ§åˆ¶ç¯‡","uri":"/posts/c-control-flow/"},{"categories":["C","Linux Kernel Internals"],"content":"do {â€¦} while (0) å® æˆ‘å†™äº† ç›¸å…³ç¬”è®° åœ¨å‰ç½®å¤„ç†å™¨ç¯‡ã€‚ ","date":"2024-04-05","objectID":"/posts/c-control-flow/:4:0","tags":["Sysprog","C"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: goto å’Œæµç¨‹æ§åˆ¶ç¯‡","uri":"/posts/c-control-flow/"},{"categories":["Operating Systems"],"content":" ç†è§£ä¸€ä¸ªç³»ç»Ÿçš„æœ€ä½³å®è·µå°±æ˜¯å»å®ç°å®ƒã€‚å› æ­¤åœ¨æœ¬è¯¾ç¨‹çš„PA éƒ¨åˆ†ï¼Œä½ å°†ä¼šåœ¨æ¡†æ¶ä»£ç çš„åŸºç¡€ä¸Šå®ç°ä¸€ä¸ª RISC-V å…¨ç³»ç»Ÿæ¨¡æ‹Ÿå™¨ NEMUï¼Œå®ƒä¸ä»…èƒ½è¿è¡Œå„ç±»æµ‹è¯•ç¨‹åºï¼Œç”šè‡³è¿˜å¯ä»¥è¿è¡Œæ“ä½œç³»ç»Ÿå’Œ â€œä»™å‰‘å¥‡ä¾ ä¼ â€ã€‚æ¨¡æ‹Ÿè¿‡ç¡¬ä»¶çš„æ‰§è¡Œï¼Œè‡ªç„¶å°±èƒ½æ·± (ç—›) å…¥ (è‹¦) ç†è§£è®¡ç®—æœºç³»ç»Ÿäº†ã€‚ è¯¾ç¨‹ç½‘é¡µ ç›´æ’­å½•å½± å®éªŒè®²ä¹‰ ä¿¡æ¯ æˆè¯¾è§†é¢‘çš„ç›´æ’­å½•å½±ä¸ PA/Lab å¹¶æ²¡æœ‰å…ˆåæ¬¡åºçš„å¼ºå…³è”æ€§ï¼Œæˆè¯¾ä¸»è¦æ˜¯åˆ†äº«ä¸€äº›åœ¨ PA/Lab æ—¶å¯æ´¾ä¸Šç”¨åœºçš„å°å·¥å…·ï¼Œæ‰€ä»¥æˆè¯¾è§†é¢‘ä¹‹é—´ä¹Ÿæ²¡æœ‰å…ˆåæ¬¡åºï¼ŒæŒ‰éœ€è§‚çœ‹å³å¯ã€‚ ","date":"2024-03-31","objectID":"/posts/nju-ics/:0:0","tags":["Linux"],"title":"å—äº¬å¤§å­¦ è®¡ç®—æœºç³»ç»ŸåŸºç¡€ é‡ç‚¹æç¤º","uri":"/posts/nju-ics/"},{"categories":["Operating Systems"],"content":"PA ","date":"2024-03-31","objectID":"/posts/nju-ics/:1:0","tags":["Linux"],"title":"å—äº¬å¤§å­¦ è®¡ç®—æœºç³»ç»ŸåŸºç¡€ é‡ç‚¹æç¤º","uri":"/posts/nju-ics/"},{"categories":["Operating Systems"],"content":"PA0: ç¯å¢ƒå®‰è£…ä¸é…ç½® Installing GNU/Linux First Exploration with GNU/Linux Installing Tools Configuring vim More Exploration Getting Source Code for PAs å®‰è£…æ–‡æ¡£è¿›è¡Œé…ç½®å³å¯ï¼Œæˆ‘ä½¿ç”¨çš„ Linux å‘è¡Œç‰ˆæ˜¯ deepin 20.9 ä¸€äº›æœ‰æ„æ€çš„è¶…é“¾æ¥: Wikipedia: Unix philosophy Command line vs. GUI ","date":"2024-03-31","objectID":"/posts/nju-ics/:1:1","tags":["Linux"],"title":"å—äº¬å¤§å­¦ è®¡ç®—æœºç³»ç»ŸåŸºç¡€ é‡ç‚¹æç¤º","uri":"/posts/nju-ics/"},{"categories":["RISC-V"],"content":" pretask ä½œä¸ºç¤¾åŒºå…¥é—¨æ¢ç´¢ï¼Œç›®çš„æ˜¯å¸®åŠ©å®ä¹ ç”Ÿä¸€èµ·æ­å»ºå·¥ä½œç¯å¢ƒï¼Œç†Ÿæ‚‰ oerv çš„å·¥ä½œæµç¨‹å’Œåˆä½œæ–¹å¼ã€‚pretask åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤: ä»»åŠ¡ä¸€ï¼šé€šè¿‡ QEMU ä»¿çœŸ RISC-V ç¯å¢ƒå¹¶å¯åŠ¨ openEuler RISC-V ç³»ç»Ÿï¼Œè®¾æ³•è¾“å‡º neofetch ç»“æœå¹¶æˆªå›¾æäº¤ ä»»åŠ¡äºŒï¼šåœ¨ openEuler RISC-V ç³»ç»Ÿä¸Šé€šè¿‡ obs å‘½ä»¤è¡Œå·¥å…· oscï¼Œä»æºä»£ç æ„å»º RISC-V ç‰ˆæœ¬çš„ rpm åŒ…ï¼Œæ¯”å¦‚ pcre2ã€‚æç¤ºé¦–å…ˆéœ€è¦åœ¨ openEuler çš„ OBS ä¸Šæ³¨å†Œè´¦å· ä»»åŠ¡ä¸‰ï¼šå°è¯•ä½¿ç”¨ qemu user \u0026 nspawn æˆ–è€… docker åŠ é€Ÿå®Œæˆä»»åŠ¡äºŒ ","date":"2024-03-28","objectID":"/posts/oerv-pretask/:0:0","tags":["RISC-V","openEuler","QEMU","Neofetch","Container","chroot","nspawn"],"title":"OERV ä¹‹ Pretask","uri":"/posts/oerv-pretask/"},{"categories":["RISC-V"],"content":"Pretask 1: Neofetch ä»»åŠ¡ä¸€ï¼šé€šè¿‡ QEMU ä»¿çœŸ RISC-V ç¯å¢ƒå¹¶å¯åŠ¨ openEuler RISC-V ç³»ç»Ÿï¼Œè®¾æ³•è¾“å‡º neofetch ç»“æœå¹¶æˆªå›¾æäº¤ ç”±äºå·¥ä½œå†…å®¹æ˜¯å¯¹è½¯ä»¶åŒ…è¿›è¡Œ: ç¼–è¯‘ -\u003e å¤±è´¥ -\u003e å®šä½é—®é¢˜ -\u003e ä¿®å¤ -\u003e é‡æ–°ç¼–è¯‘ï¼Œæ‰€ä»¥æˆ‘ä»¬å€¾å‘äºç›´æ¥ä»æºç ç¼–è¯‘ï¼Œæ ¹æ® neofetch wiki ä» git æ‹‰å–æœ€æ–°æ•°æ®è¿›è¡Œæ„å»º: # enter into euler openEuler RISC-V QEMU $ git clone https://github.com/dylanaraps/neofetch $ cd neofetch $ make install $ neofetch ","date":"2024-03-28","objectID":"/posts/oerv-pretask/:1:0","tags":["RISC-V","openEuler","QEMU","Neofetch","Container","chroot","nspawn"],"title":"OERV ä¹‹ Pretask","uri":"/posts/oerv-pretask/"},{"categories":["RISC-V"],"content":"Pretask 2: Open Build Service (OBS) ä»»åŠ¡äºŒï¼šåœ¨ openEuler RISC-V ç³»ç»Ÿä¸Šé€šè¿‡ obs å‘½ä»¤è¡Œå·¥å…· oscï¼Œä»æºä»£ç æ„å»º RISC-V ç‰ˆæœ¬çš„ rpm åŒ…ï¼Œæ¯”å¦‚ pcre2ã€‚æç¤ºé¦–å…ˆéœ€è¦åœ¨ openEuler çš„ OBS ä¸Šæ³¨å†Œè´¦å· è§‚çœ‹æ•™å­¦å½±ç‰‡: openEuleræ„å»ºä¹‹OBSä½¿ç”¨æŒ‡å¯¼ - bilibili å¹¶å¯¹æ¯”é˜…è¯» BeginnerÊ¼s Guide openSUSE:Build Service æ–°æ‰‹å…¥é—¨ å¦‚ä½•é€šè¿‡OpenSUSE Open Build Serviceï¼ˆOBSï¼‰æ„å»ºDebianåŒ… for RISCV-64 äº†è§£æŒæ¡ OBS çš„åŸºæœ¬æ¦‚å¿µã€OBS ç½‘é¡µ ä»¥åŠ OSC å‘½ä»¤è¡Œå·¥å…· çš„ä½¿ç”¨æ–¹æ³•ã€‚ è¿™éƒ¨åˆ†å†…å®¹å¾ˆé‡è¦ï¼Œå’Œåç»­å·¥ä½œå†…å®¹æ¯æ¯ç›¸å…³ï¼Œåœ¨è¿™é‡Œä¸è¦å›¾å¿«ï¼Œæ‰“ç‰¢åŸºç¡€æ¯”è¾ƒå¥½ã€‚ OBS çš„ Package ä¸­ _service é…ç½®æ–‡ä»¶ï¼Œrevision å­—æ®µæ˜¯å¯¹åº”ä¸ Git ä»“åº“çš„ commit id (å¦‚æœä½ ä½¿ç”¨çš„ Source Code Management (SCM) æ–¹å¼æ˜¯ Git æ‰˜ç®¡çš„è¯) å‚è€ƒä»“åº“: https://gitee.com/zxs-un/doc-port2riscv64-openEuler å†…çš„ç›¸å…³æ–‡æ¡£ oscå‘½ä»¤å·¥å…·çš„å®‰è£…ä¸~/.oscrcé…ç½®æ–‡ä»¶ åœ¨ openEuler ä¸Šå®‰è£… osc build æœ¬åœ°æ„å»ºå·¥å…· ä½¿ç”¨ osc build åœ¨æœ¬åœ°æ„å»º openEuler OBS æœåŠ¡ç«¯çš„å†…å®¹ åœ¨ openEuler RISC-V QEMU è™šæ‹Ÿæœºå†…å®Œæˆ OBSã€OSC ç›¸å…³åŸºç¡€è®¾æ–½çš„å®‰è£…: # install osc and build $ sudo yum install osc build # configure osc in ~/.oscrc [general] apiurl = https://build.openeuler.openatom.cn no_verify = 1 # æœªé…ç½®è¯ä¹¦æƒ…å†µä¸‹ä¸éªŒè¯ [https://build.openeuler.openatom.cn] user=username # ç”¨æˆ·å pass=password # æ˜æ–‡å¯†ç  trusted_prj=openEuler:selfbuild:function # æ­¤é¡¹ç›®ä¸ºopenEuler:Mailine:RISC-Vé¡¹ç›®çš„ä¾èµ–åº“ åœ¨ openEuler RISC-V QEMU è™šæ‹Ÿæœºå†…å®Œæˆ pcre2 çš„æœ¬åœ°ç¼–è¯‘æ„å»º: # é€‰å®š pcre2 åŒ… $ osc co openEuler:Mainline:RISC-V/pcre2 $ cd openEuler\\:Mainline\\:RISC-V/pcre2/ # æ›´æ–°å¹¶ä¸‹è½½ç›¸å…³æ–‡ä»¶åˆ°æœ¬åœ° $ osc up -S # é‡å‘½ååˆšåˆšä¸‹è½½çš„æ–‡ä»¶ $ rm -f _service;for file in `ls | grep -v .osc`;do new_file=${file##*:};mv $file $new_file;done # æŸ¥çœ‹ä¸€ä¸‹ä»“åº“ä¿¡æ¯ï¼Œæ–¹ä¾¿åç»­æ„å»º $ osc repos standard_riscv64 riscv64 mainline_gcc riscv64 # æŒ‡å®šä»“åº“å’Œæ¶æ„å¹¶è¿›è¡Œæœ¬åœ°æ„å»º $ osc build standard_riscv64 riscv64 æ€»è®¡ç”¨æ—¶ 1301s ","date":"2024-03-28","objectID":"/posts/oerv-pretask/:2:0","tags":["RISC-V","openEuler","QEMU","Neofetch","Container","chroot","nspawn"],"title":"OERV ä¹‹ Pretask","uri":"/posts/oerv-pretask/"},{"categories":["RISC-V"],"content":"Pretask 3: å®¹å™¨åŠ é€Ÿæ„å»º ä»»åŠ¡ä¸‰ï¼šå°è¯•ä½¿ç”¨ qemu user \u0026 nspawn æˆ–è€… docker åŠ é€Ÿå®Œæˆä»»åŠ¡äºŒ å‚è€ƒ æ–‡æ¡£ ç”±äº deepin 20.9 çš„ Python3 ç‰ˆæœ¬ä»…ä¸º 3.7ï¼Œæ„å»º osc å’Œ qemu æ˜¾ç„¶ä¸å¤ªå¤Ÿï¼Œæ‰€ä»¥æˆ‘é€šè¿‡ KVM æ„å»ºäº†ä¸€ä¸ª openEuler 22.03 LTS SP3 çš„è™šæ‹Ÿæœºï¼Œåœ¨ä¸Šé¢è¿›è¡Œè¿™é¡¹ä»»åŠ¡ã€‚ Deepin 20.9 KVM å®‰è£…å’Œç®¡ç† openEuler 22.03 LTS SP3 ç¼–è¯‘ QEMU æ—¶å¸¸è§é”™è¯¯ä¿®æ­£: ERROR: Python package 'sphinx' was not found nor installed. $ sudo yum install python3-sphinx ERROR: cannot find ninja $ sudo yum install ninja-build openEuler 22.03 LTS SP3 æ²¡æœ‰é¢„å…ˆå®‰è£…å¥½ nspawnï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨å®‰è£…: $ sudo yum install systemd-container systemd-nspawn å…¶ä½™åŒä»»åŠ¡äºŒã€‚ å°è¯•ä½¿ç”¨ nspawn æ¥æ„å»º pcre2: $ osc build standard_riscv64 riscv64 --vm-type=nspawn ä¼šé‡åˆ°ä»¥ä¸‹æŠ¥é”™ (ä¸”ç»è¿‡ç›¸å½“å¤šæ—¶é—´æ’é”™ï¼Œä»æ— æ³•è§£å†³è¯¥é—®é¢˜ï¼Œä¸ªäººçŒœæµ‹æ˜¯å¹³å°é—®é¢˜): can't locate file/copy.pm: /usr/lib64/perl5/vendor_perl/file/copy.pm: permission denied at /usr/bin/autoreconf line 49. æ‰€ä»¥é€€è€Œæ±‚å…¶æ¬¡ï¼Œä½¿ç”¨ chroot æ¥æ„å»º: $ osc build standard_riscv64 riscv64 --vm-type=chroot æ€»è®¡ç”¨æ—¶ 749sï¼Œæ¯” qemu-system-riscv64 å¿«äº†å°†è¿‘ 2 å€ï¼Œæ•ˆèƒ½æå‡ç›¸å½“å¯è§‚ã€‚ ","date":"2024-03-28","objectID":"/posts/oerv-pretask/:3:0","tags":["RISC-V","openEuler","QEMU","Neofetch","Container","chroot","nspawn"],"title":"OERV ä¹‹ Pretask","uri":"/posts/oerv-pretask/"},{"categories":["RISC-V"],"content":"References https://gitee.com/zxs-un/doc-port2riscv64-openEuler/blob/master/doc/build-osc-config-oscrc.md https://gitee.com/zxs-un/doc-port2riscv64-openEuler/blob/master/doc/build-osc-build-tools.md https://gitee.com/zxs-un/doc-port2riscv64-openEuler/blob/master/doc/build-osc-obs-service.md https://gitee.com/openeuler/RISC-V/blob/master/doc/tutorials/qemu-user-mode.md https://stackoverflow.com/questions/5308816/how-can-i-merge-multiple-commits-onto-another-branch-as-a-single-squashed-commit ","date":"2024-03-28","objectID":"/posts/oerv-pretask/:4:0","tags":["RISC-V","openEuler","QEMU","Neofetch","Container","chroot","nspawn"],"title":"OERV ä¹‹ Pretask","uri":"/posts/oerv-pretask/"},{"categories":["Operating Systems"],"content":"æœ¬ç¯‡ä¸»è¦ä»‹ç»åœ¨ deepin20.9 æ“ä½œç³»ç»Ÿå¹³å°ä¸‹ï¼Œä½¿ç”¨ KVM è™šæ‹ŸåŒ–æŠ€æœ¯æ¥åˆ›å»ºå’Œå®‰è£… Linux å‘è¡Œç‰ˆï¼Œå¹¶ä»¥åˆ›å»ºå®‰è£… openEuler 22.03 LTS SP3 çš„ KVM è™šæ‹Ÿæœºä½œä¸ºç¤ºèŒƒï¼Œè®©å­¦å‘˜é¢†ç•¥ KVM è™šæ‹ŸåŒ–æŠ€æœ¯çš„å¼ºå¤§é­…åŠ›ã€‚ ","date":"2024-03-28","objectID":"/posts/deepin-kvm/:0:0","tags":["Linux","Deepin","KVM","QEMU","openEuler"],"title":"Deepin 20.9 KVM å®‰è£…å’Œç®¡ç†","uri":"/posts/deepin-kvm/"},{"categories":["Operating Systems"],"content":"ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–? ä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–æŠ€æœ¯ï¼ŸKVM è™šæ‹ŸåŒ–å’Œ Virtual Boxã€VMware è¿™ç±»è™šæ‹Ÿæœºè½¯ä»¶çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿè¯·é˜…è¯»ä¸‹é¢çš„è¿™ç¯‡æ–‡ç« ã€‚ KVM ä¸ VMware çš„åŒºåˆ«ç›˜ç‚¹ ","date":"2024-03-28","objectID":"/posts/deepin-kvm/:1:0","tags":["Linux","Deepin","KVM","QEMU","openEuler"],"title":"Deepin 20.9 KVM å®‰è£…å’Œç®¡ç†","uri":"/posts/deepin-kvm/"},{"categories":["Operating Systems"],"content":"é…ç½®è™šæ‹ŸåŒ–ç¯å¢ƒ é¦–å…ˆéœ€è¦æ£€æŸ¥ CPU æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ– (ä»¥ Intel å¤„ç†å™¨ä¸ºä¾‹): # intel vmxï¼Œamd svm $ egrep '(vmx|svm)' /proc/cpuinfo ...vmx... $ lscpu | grep Virtualization Virtualization: VT-x æ£€æŸ¥ KVM æ¨¡å—æ˜¯å¦å·²åŠ è½½: $ lsmod | grep -i kvm kvm_intel 278528 11 kvm 901120 1 kvm_intel ç¡®ä¿ CPU æ”¯æŒè™šæ‹ŸåŒ–å¹¶ä¸” KVM æ¨¡å—å·²è¢«åŠ è½½ï¼Œæ¥ä¸‹æ¥æ˜¯å®‰è£… QEMU å’Œ virt-manager (è™šæ‹Ÿç³»ç»Ÿç®¡ç†å™¨)ã€‚ç›´æ¥é€šè¿‡ apt å®‰è£…çš„ QEMU ç‰ˆæœ¬è¿‡ä½ï¼Œè€Œé€šè¿‡ GitHub ä¸‹è½½æœ€æ–°çš„ QEMU æºç ç¼–è¯‘å®‰è£…éœ€è¦Python3.9ï¼Œè€Œ deepin 20.9 çš„ Python 3 ç‰ˆæœ¬æ˜¯ 3.7 (ä¿é™©èµ·è§ä¸è¦éšä¾¿å‡çº§)ï¼Œæ‰€ä»¥æŠ˜ä¸­ä¸€ä¸‹ï¼Œç¼–è¯‘å®‰è£… QEMU 7.2.0 ğŸ¤£ å®‰è£… QEMU: $ wget https://download.qemu.org/qemu-7.2.0.tar.xz $ tar xvJf qemu-7.2.0.tar.xz $ mv qemu-7.2.0 qemu $./configure $ sudo make -j$(nproc) # in ~/.bashrc export PATH=$PATH:/path/to/qemu/build å®‰è£… virt-manager: $ sudo apt install virt-manager ","date":"2024-03-28","objectID":"/posts/deepin-kvm/:2:0","tags":["Linux","Deepin","KVM","QEMU","openEuler"],"title":"Deepin 20.9 KVM å®‰è£…å’Œç®¡ç†","uri":"/posts/deepin-kvm/"},{"categories":["Operating Systems"],"content":"å®‰è£… openEuler KVM è™šæ‹Ÿæœº å¯ä»¥åœ¨å¯åŠ¨å™¨çœ‹åˆ°ä¸€ä¸ªè™šæ‹Ÿæœºç®¡ç†åº”ç”¨å›¾æ ‡ï¼Œå¦‚ä¸‹: ç‚¹å‡»æ‰“å¼€ (éœ€è¦è¾“å…¥å¯†ç è®¤è¯ï¼Œä»¥ä¸‹å›¾ç‰‡ä¸­çš„ â€œæœ¬åœ°â€ å¯èƒ½ä¼šæ˜¾ç¤ºä¸º â€œQEMU/KVMâ€): æ¥ä¸‹æ¥åˆ›å»ºè™šæ‹Ÿæœº: ä¸‹å›¾çš„æ“ä½œç³»ç»Ÿé€‰æ‹©å¯¹åº”çš„ç±»å‹ (å¯ä»¥åœ¨ è¿™é‡Œ ä¸‹è½½ openEuler 22.03 LTS SP3 é•œåƒï¼Œå¯¹äº openEuler è¿™ç±»æœªè¢«æ”¶å½•çš„ç±»å‹ï¼Œé€‰æ‹© Generic): è¿™é‡Œé€‰æ‹© iso é•œåƒåå¯èƒ½ä¼šæ˜¾ç¤ºè·¯å¾„æœç´¢é—®é¢˜ï¼Œé€‰æ‹© â€œæ˜¯â€ å°†è¯¥è·¯å¾„åŠ å…¥å­˜å‚¨æ± å³å¯ æ¥ä¸‹æ¥æ˜¯å¤„ç†å™¨å’Œå†…å­˜é…ç½®ï¼Œå»ºè®®é…ç½® 8 æ ¸ 8G å†…å­˜ï¼Œæ ¹æ®è‡ªå·±ç‰©ç†æœºé…ç½®é€‰æ‹©å³å¯: æ¥ä¸‹æ¥æ˜¯è™šæ‹Ÿç£ç›˜çš„å¤§å°è®¾ç½®å’Œå­˜æ”¾ä½ç½®ï¼Œå»ºè®®é€‰æ‹©è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„ï¼Œå¹¶æ­é… æ›´æ”¹ KVM è™šæ‹Ÿæœºé»˜è®¤å­˜å‚¨è·¯å¾„ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä½ çš„æ ¹ç›®å½•ç©ºé—´ä¸å¤ªå¤Ÿçš„æƒ…å†µï¼š åœ¨å¯¹åº”çš„å­˜å‚¨å·ä¸­åˆ›å»ºè™šæ‹Ÿç£ç›˜ (æ³¨æ„: å¦‚æœä½ æ›´æ”¹äº†é»˜è®¤å­˜å‚¨è·¯å¾„ï¼Œè¯·é€‰æ‹©å¯¹åº”çš„å­˜å‚¨æ± è€Œä¸æ˜¯ default): åˆ›å»ºè™šæ‹Ÿç£ç›˜ (åç§°å¯ä»¥è‡ªå®šä¹‰ï¼Œåˆ†é…é»˜è®¤åˆå§‹ä¸º 0ï¼Œå®ƒä¼šéšç€è™šæ‹Ÿæœºä½¿ç”¨è€Œå¢å¤§ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥å°†åˆ†é…ç­‰äºæœ€å¤§å®¹é‡ï¼Œè¿™æ ·å°±ä¼šç›´æ¥åˆ†é…ç›¸åº”çš„ç£ç›˜ç©ºé—´ï¼Œç©è¿‡è™šæ‹Ÿæœºçš„å­¦å‘˜åº”è¯¥å¾ˆç†Ÿæ‚‰): æ¥ä¸‹æ¥è‡ªå®šä¹‰è™šæ‹Ÿæœºåç§°å¹¶ç”Ÿæˆè™šæ‹Ÿæœºå³å¯: æœ€åå°±æ˜¯ç†Ÿæ‚‰çš„å®‰è£…ç•Œé¢: å‚è€ƒ è¿™é‡Œ å®‰è£… openEuler å³å¯ã€‚ ","date":"2024-03-28","objectID":"/posts/deepin-kvm/:3:0","tags":["Linux","Deepin","KVM","QEMU","openEuler"],"title":"Deepin 20.9 KVM å®‰è£…å’Œç®¡ç†","uri":"/posts/deepin-kvm/"},{"categories":["Operating Systems"],"content":"é€è¿‡ SSH è¿æ¥ KVM è™šæ‹Ÿæœº é¦–å…ˆå…ˆæ£€æŸ¥ Guest OS ä¸Š ssh æœåŠ¡æ˜¯å¦å¼€å¯ (ä¸€èˆ¬æ˜¯å¼€å¯çš„): $ sudo systemctl status sshd sshd.service - OpenSSH server daemon Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; vendor preset: enabled) Active: active (running) since Thu 2024-03-28 14:40:15 CST; 20min ago ... ç„¶ååœ¨ Guest OS ä¸Šè·å–å…¶ IP åœ°å€ (ens3 çš„ inet åçš„æ•°å­—å³æ˜¯ï¼ŒopenEuler å¯åŠ¨æ—¶ä¹Ÿä¼šè¾“å‡ºä¸€ä¸‹ IP åœ°å€): $ ip addr åœ¨ Host OS ä¸Šé€šè¿‡ ssh è¿æ¥ç™»å½• GuestOS: $ ssh user@ip # user: user name in the guest os # ip ip addr of guest os ","date":"2024-03-28","objectID":"/posts/deepin-kvm/:4:0","tags":["Linux","Deepin","KVM","QEMU","openEuler"],"title":"Deepin 20.9 KVM å®‰è£…å’Œç®¡ç†","uri":"/posts/deepin-kvm/"},{"categories":["Operating Systems"],"content":"Development Tools ç”±äºæ˜¯æœ€å°å®‰è£…ï¼Œå¾ˆå¤šè¶æ‰‹çš„å·¥å…·éƒ½æ²¡æœ‰ï¼Œä¿—è¯è¯´â€œå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨â€ï¼Œæ‰€ä»¥å…ˆå®‰è£…å¿…è¦çš„å¼€å‘å·¥å…·ã€‚å¹¸å¥½ openEuler æä¾›äº†æ•´åˆåŒ… Development Toolsï¼Œç›´æ¥å®‰è£…å³å¯: $ sudo yum group install -y \"Development Tools\" ","date":"2024-03-28","objectID":"/posts/deepin-kvm/:5:0","tags":["Linux","Deepin","KVM","QEMU","openEuler"],"title":"Deepin 20.9 KVM å®‰è£…å’Œç®¡ç†","uri":"/posts/deepin-kvm/"},{"categories":["Operating Systems"],"content":"Neofetch å®‰è£… neofetch æ¥é…·ç‚«åœ°è¾“å‡ºä¸€ä¸‹ç³»ç»Ÿä¿¡æ¯: $ git clone https://github.com/dylanaraps/neofetch $ cd neofetch $ make install $ neofetch ","date":"2024-03-28","objectID":"/posts/deepin-kvm/:6:0","tags":["Linux","Deepin","KVM","QEMU","openEuler"],"title":"Deepin 20.9 KVM å®‰è£…å’Œç®¡ç†","uri":"/posts/deepin-kvm/"},{"categories":["Operating Systems"],"content":"References ä½¿ç”¨ KVM å®‰è£…å’Œç®¡ç† deepin Linux ä¸‹ä½¿ç”¨ KVM è™šæ‹Ÿæœºå®‰è£… OpenEuler ç³»ç»Ÿ KVM æ›´æ”¹è™šæ‹Ÿæœºé»˜è®¤å­˜å‚¨è·¯å¾„ å®è·µ KVM on Deepin ","date":"2024-03-28","objectID":"/posts/deepin-kvm/:7:0","tags":["Linux","Deepin","KVM","QEMU","openEuler"],"title":"Deepin 20.9 KVM å®‰è£…å’Œç®¡ç†","uri":"/posts/deepin-kvm/"},{"categories":["C","Linux Kernel Internals"],"content":" ç›¸è¼ƒæ–¼é »ç¹ç´å…¥æ–°èªæ³•çš„ç¨‹å¼èªè¨€ (å¦‚ C++ å’Œ Java)ï¼ŒC èªè¨€é¡¯å¾—å¾ˆä¿å®ˆï¼Œä½†ç¸½æ˜¯èƒ½è—‰ç”±å‰ç½®è™•ç†å™¨ (preprocessor) å°èªæ³•é€²è¡Œæ“´å……ï¼Œç”šè‡³æ­é…å·¥å…·éˆ (toolchain) çš„è‹¥å¹²é€²éšæ©Ÿåˆ¶ï¼Œåšåˆ°å¤§å¤§è¶…å‡ºç¨‹å¼èªè¨€è¦ç¯„çš„è¤‡é›œæ©Ÿåˆ¶ã€‚ä¾‹å¦‚ä¸»è¦ä»¥ C èªè¨€é–‹ç™¼çš„ Linux æ ¸å¿ƒå°±æ­é…å‰ç½®è™•ç†å™¨å’Œé€£çµå™¨ (linker) çš„ç‰¹å¾µï¼Œå¯¦ä½œå‡º Linux æ ¸å¿ƒæ¨¡çµ„ï¼Œå…è¨±é–‹ç™¼è€…å‹•æ…‹æ›è¼‰/å¸è¼‰ï¼Œå› å·¨é›†åŒ…è£å¾—å¥½ï¼Œå¤šæ•¸ Linux æ ¸å¿ƒæ ¸å¿ƒæ¨¡çµ„çš„é–‹ç™¼è€…åªè¦å°ˆæ³¨åœ¨èˆ‡ Linux æ ¸å¿ƒäº’å‹•çš„éƒ¨åˆ†ã€‚ æœ¬è­°ç¨‹å›é¡§ C99/C11 çš„å·¨é›† (macro) ç‰¹å¾µï¼Œæ¢è¨ C11 æ–°çš„é—œéµå­— _Generic æ­é… macro ä¾†é”åˆ° C++ template çš„ä½œç”¨ã€‚æ¢è¨ C èªè¨€ç¨‹å¼çš„ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆã€æŠ½è±¡è³‡æ–™å‹æ…‹ (ADT) / æ³›å‹ç¨‹å¼è¨­è¨ˆ (Generics)ã€ç¨‹å¼ç¢¼ç”¢ç”Ÿå™¨ã€æ¨¡ä»¿å…¶ä»–ç¨‹å¼èªè¨€ï¼Œä»¥åŠç”¨å‰ç½®è™•ç†å™¨æ­é…å¤šç¨®å·¥å…·ç¨‹å¼çš„æŠ€å·§ï¼Œé‚„æ¢è¨ Linux æ ¸å¿ƒåŸå§‹ç¨‹å¼ç¢¼å–„ç”¨å·¨é›†ä¾†æ“´å……ç¨‹å¼é–‹ç™¼çš„è±å¯Œåº¦ï¼Œä¾‹å¦‚: BUILD_BUG_ON_ZERO, max, min, å’Œ container_of ç­‰å·¨é›†ã€‚ åŸæ–‡åœ°å€ ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:0:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"ä¸è¦å°çœ‹ preprocessor man gcc -D name Predefine name as a macro, with definition 1. -D name=definition The contents of definition are tokenized and processed as if they appeared during translation phase three in a #define directive. In particular, the definition is truncated by embedded newline characters. åœ¨ Makefile ä¸­å¾€ CFLAGS åŠ å…¥ -Dâ€™;â€™=â€™Í¾â€™ è¿™ç±»ææ€ªä¿¡æ¯ï¼Œä¼šå¯¼è‡´ç¼–è¯‘æ—¶å‡ºç°ä¸€äº›ä¸æ˜æ‰€ä»¥çš„ç¼–è¯‘é”™è¯¯ (æ¶æä¸“ç”¨ ğŸ¤£) æ—©æœŸçš„ C++ æ˜¯å’Œ C è¯­è¨€å…¼å®¹çš„ï¼Œé‚£æ—¶å€™çš„ C++ ç›¸å½“äº C è¯­è¨€çš„ä¸€ç§ preprocessorï¼Œå°† C++ ä»£ç é¢„ç¼–è¯‘ä¸ºå¯¹åº”çš„ C è¯­è¨€ä»£ç ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ C with Classesã€‚äº‹å®ä¸Šç°åœ¨çš„ C++ å’Œ C è¯­è¨€æ—©å·²åˆ†é“æ‰¬é•³ï¼Œå½¢åŒé™Œè·¯ï¼Œè™½ç„¶è¯­æ³•ä¸Šæœ‰ç›¸ä¼¼çš„åœ°æ–¹ï¼Œä½†è¯·æŠŠè¿™ä¸¤ä¸ªè¯­è¨€å½“æˆä¸åŒçš„è¯­è¨€çœ‹å¾… ğŸ¤£ ä½“éªŒä¸€ä¸‹ C++ æ¨¡ç‰ˆ (template) çš„å¨åŠ› âŒ ä¸‘é™‹ âœ”ï¸ : C è¯­è¨€: å¤§é“è‡³ç®€ âœ… ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:1:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"Object Oriented Programming é¢å‘å¯¹è±¡ç¼–ç¨‹æ—¶ï¼Œå–„ç”¨å‰ç½®å¤„ç†å™¨å¯å¤§å¹…ç®€åŒ–å’Œå¼€å‘ #: Stringizing convert a macro argument into a string constant ##: Concatenation merge two tokens into one while expanding macros. å®çš„å®é™…ä½œç”¨: generate (äº§ç”Ÿ/ç”Ÿæˆ) ç¨‹å¼ç  Rust çš„è¿‡ç¨‹å® (procedural macros) è¿›ä¸€æ­¥å¼ºåŒ–äº†è¿™ä¸€ç›®çš„ï¼Œå¯ä»¥è‡ªå®šä¹‰è¯­æ³•æ ‘è¿›è¡Œä»£ç ç”Ÿæˆã€‚ å¯ä»¥ gcc -E -P æ¥è§‚å¯Ÿé¢„å¤„ç†åçš„è¾“å‡º: man gcc -E Stop after the preprocessing stage; do not run the compiler proper. The output is in the form of preprocessed source code, which is sent to the standard output. Input files that don't require preprocessing are ignored. -P Inhibit generation of linemarkers in the output from the preprocessor. This might be useful when running the preprocessor on something that is not C code, and will be sent to a program which might be confused by the linemarkers. å¯ä»¥ä¾æ®ä¸åŒæ—¶æœŸçš„æ ‡å‡†æ¥å¯¹ C æºç¨‹åºç¼–è¯‘ç”Ÿæˆç›®æ ‡æ–‡ä»¶: Feature Test Macros The exact set of features available when you compile a source file is controlled by which feature test macros you define. ä½¿ç”¨ gcc -E -P è§‚å¯Ÿ objects.h é¢„å¤„ç†åçš„è¾“å‡ºï¼Œé€è¿‡ make å’Œ make check ç©ä¸€ä¸‹è¿™ä¸ªæœ€ç®€å•å…‰çº¿è¿½è¸ªå¼•æ“ GitHub: raytracing object oriented programming ä¸ç­‰äº class based programming, åªéœ€è¦æ»¡è¶³ Object-oriented programming (OOP) is a computer programming model that organizes software design around data, or objects, rather than functions and logic. è¿™ä¸ªæ¦‚å¿µçš„å°±æ˜¯ OOPã€‚ Source ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:2:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"C11: _Generic é˜…è¯» C11 è§„æ ¼ä¹¦ 6.5.1.1 Generic selection The controlling expression of a generic selection is not evaluated. If a generic selection has a generic association with a type name that is compatible with the type of the controlling expression, then the result expression of the generic selection is the expression in that generic association. Otherwise, the result expression of the generic selection is the expression in the default generic association. None of the expressions from any other generic association of the generic selection is evaluated. #define cbrt(X) \\ _Generic((X), \\ long double: cbrtl, \\ default: cbrt, \\ const float: cbrtf, \\ float: cbrtf \\ )(X) ç»è¿‡ func.c/func.cpp çš„è¾“å‡ºå¯¹æ¯”ï¼ŒC++ æ¨¡ç‰ˆåœ¨å­—ç¬¦ç±»å‹çš„çš„åˆ¤å®šæ¯”è¾ƒå‡†ç¡®ï¼ŒC11 çš„ _Generic ä¼šå…ˆå°† char è½¬æ¢æˆ int å¯¼è‡´ç»“æœç¨æœ‰ç‘•ç–µï¼Œè¿™æ˜¯å› ä¸ºåœ¨ C è¯­è¨€ä¸­å­—ç¬¦å¸¸é‡ (ä¾‹å¦‚ â€˜aâ€™) çš„ç±»å‹æ˜¯ int è€Œä¸æ˜¯ charã€‚ Stack Overflow: What to do to make â€˜_Generic(â€˜aâ€™, char : 1, int : 2) == 1â€™ true ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:3:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"Block Wikipedia: Blocks (C language extension) Blocks are a non-standard extension added by Apple Inc. to Clangâ€™s implementations of the C, C++, and Objective-C programming languages that uses a lambda expression-like syntax to create closures within these languages. Like function definitions, blocks can take arguments, and declare their own variables internally. Unlike ordinary C function definitions, their value can capture state from their surrounding context. A block definition produces an opaque value which contains both a reference to the code within the block and a snapshot of the current state of local stack variables at the time of its definition. The block may be later invoked in the same manner as a function pointer. The block may be assigned to variables, passed to functions, and otherwise treated like a normal function pointer, although the application programmer (or the API) must mark the block with a special operator (Block_copy) if itâ€™s to be used outside the scope in which it was defined. ä½¿ç”¨ BLock å¯ä»¥å‡å°‘å®å±•å¼€æ—¶çš„é‡å¤è®¡ç®—æ¬¡æ•°ã€‚ç›®å‰ clang æ˜¯æ”¯æŒ Block è¿™ä¸ªæ‰©å±•çš„ï¼Œä½†æ˜¯åœ¨ç¼–è¯‘æ—¶éœ€è¦åŠ ä¸Šå‚æ•° -fblocks: $ clang -fblocks blocks-test.c -lBlocksRuntime åŒæ—¶è¿˜éœ€è¦ BlocksRuntime è¿™ä¸ªåº“ï¼ŒæŒ‰ç…§ä»“åº“ README å®‰è£…å³å¯: # clone repo $ git clone https://github.com/mackyle/blocksruntime.git $ cd blocksruntime/ # building $ ./buildlib # testing $ ./checktests # installing $ sudo ./installlib é™¤äº† Block ä¹‹å¤–ï¼Œå¸¸è§çš„é¿å… double evaluation çš„æ–¹æ³•è¿˜æœ‰åˆ©ç”¨ typeof æå‰è®¡ç®—: #define DOUBLE(a) ((a) + (a)) #define DOUBLE(a) ({ \\ __typeof__(a) _x_in_DOUBLE = (a); \\ _x_in_DOUBLE + _x_in_DOUBLE; \\ }) ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:4:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"ARRAY_SIZE å® // get the number of elements in array #define ARRAY_SIZE(arr) (sizeof(arr) / sizeof((arr)[0])) è¿™æ ·å®ä½œçš„ ARRAY_SIZE å®æœ‰å¾ˆå¤§çš„éšæ‚£ï¼Œä¾‹å¦‚å®ƒæ— æ³•å¯¹ä¼ å…¥çš„ arr è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œå¦‚æœç¢°ä¸Šä¸åˆæ ¼çš„ C ç¨‹åºå‘˜ï¼Œåœ¨æ•°ç»„éšå¼è½¬æ¢æˆæŒ‡é’ˆåä½¿ç”¨ ARRAY_SIZE å®ä¼šå¾—åˆ°éé¢„æœŸçš„ç»“æœï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¼–è¯‘å™¨å°±æé†’ç¨‹åºå‘˜ä¸è¦é”™ç”¨è¿™ä¸ªå®ã€‚ æ³¨æ„ é˜…è¯»ä»¥ä¸‹åšå®¢ä»¥ç†è§£ Linux æ ¸å¿ƒçš„ ARRAY_SIZE åŸç†æœºåˆ¶å’Œå®ä½œæ‰‹æ³•: Linux Kernel: ARRAY_SIZE() Linux æ ¸å¿ƒçš„ ARRAY_SIZE å®åœ¨ä¸Šé¢é‚£ä¸ªç®€é™‹ç‰ˆçš„å®çš„åŸºç¡€ä¸Šï¼ŒåŠ ä¸Šäº†ç±»å‹æ£€æŸ¥ï¼Œä¿è¯ä¼ å…¥çš„æ˜¯æ•°ç»„è€Œä¸æ˜¯æŒ‡é’ˆï¼š #define ARRAY_SIZE(arr) (sizeof(arr) / sizeof((arr)[0]) + __must_be_array(arr)) /* \u0026a[0] degrades to a pointer: a different type from an array */ #define __must_be_array(a) BUILD_BUG_ON_ZERO(__same_type((a), \u0026(a)[0])) /* Are two types/vars the same type (ignoring qualifiers)? */ #ifndef __same_type # define __same_type(a, b) __builtin_types_compatible_p(typeof(a), typeof(b)) #endif 6.54 Other built-in functions provided by GCC You can use the built-in function __builtin_types_compatible_p to determine whether two types are the same. This built-in function returns 1 if the unqualified versions of the types type1 and type2 (which are types, not expressions) are compatible, 0 otherwise. The result of this built-in function can be used in integer constant expressions. 6.6 Referring to a Type with typeof Another way to refer to the type of an expression is with typeof. The syntax of using of this keyword looks like sizeof, but the construct acts semantically like a type name defined with typedef. æ‰€ä»¥ Linux æ ¸å¿ƒçš„ ARRAY_SIZE å®é¢å¤–åŠ ä¸Šäº† __must_be_array å®ï¼Œä½†æ˜¯è¿™ä¸ªå®åœ¨ç¼–è¯‘æˆåŠŸæ—¶ä¼šè¿”å› 0ï¼Œç¼–è¯‘å¤±è´¥è‡ªç„¶å°±ä¸éœ€è¦è€ƒè™‘è¿”å›å€¼äº† ğŸ¤£ æ‰€ä»¥å®ƒèµ·åˆ°çš„ä½œç”¨æ˜¯ä¹‹å‰æåˆ°çš„ç±»å‹æ£€æŸ¥ï¼Œé€è¿‡ BUILD_BUG_ON_ZERO å®å’Œ __same_type å®ã€‚ ä» Linux æ ¸å¿ƒ ã€Œæç‚¼ã€ å‡ºçš„ array_size _countof Macro ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:5:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"do { â€¦ } while (0) å® ç”¨äºé¿å… dangling elseï¼Œå³ if å’Œ else æœªç¬¦åˆé¢„æœŸçš„é…å¯¹ (å¸¸è§äºæœªä½¿ç”¨ {} åŒ…è£¹) è€ƒè™‘ä»¥ä¸‹æƒ…å½¢: #define handler(cond) if (cond) foo() if (\u003ccondition1\u003e) handler(\u003cconditional2\u003e) else bar() è¿™ä¸ªå†™æ³•ä¹ä¸€çœ‹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬æŠŠå®ƒå±•å¼€æ¥çœ‹ä¸€ä¸‹: if (\u003ccondition1\u003e) if (\u003cconditional2\u003e) foo() else bar() æ˜¾ç„¶æ­¤æ—¶ç”±äºæœªä½¿ç”¨ {} åŒºå—è¿›è¡ŒåŒ…è£¹ï¼Œå¯¼è‡´ else éƒ¨åˆ†ä¸ handler å®çš„ if é€»è¾‘è¿›è¡Œé…å¯¹äº†ã€‚do {...} while (0) å®çš„ä½œç”¨å°±æ˜¯æä¾›ç±»ä¼¼äº {} åŒºå—çš„éš”ç¦»æ€§ (å› ä¸ºå®ƒçš„å¾ªç¯ä½“åªèƒ½æ‰§è¡Œä¸€é ğŸ¤£) æ³¨æ„ ä¸‹é¢çš„è®¨è®ºæ˜¯å…³äºä¸ºä»€ä¹ˆè¦ä½¿ç”¨ do {...} while(0) è€Œä¸æ˜¯ {}ï¼Œéå¸¸å€¼å¾—ä¸€è¯»: Stack Overflow: C multi-line macro: do/while(0) vs scope block The more elegant solution is to make sure that macro expand into a regular statement, not into a compound one. ä¸»è¦æ˜¯è€ƒè™‘åˆ°å¯¹åŒ…å« {} çš„å®ï¼Œåƒä¸€èˆ¬çš„ statement ä¸€æ ·åŠ ä¸Š ; ä¼šå¯¼è‡´ä¹‹å‰çš„ if è¯­å¥ç»“æŸï¼Œä»è€Œå¯¼è‡´åé¢çš„ else è¯­å¥æ— æ³•é…å¯¹è¿›è€Œç¼–è¯‘å¤±è´¥ï¼Œè€Œä½¿ç”¨ do {...} while (0) åé¢åŠ ä¸Š ; å¹¶ä¸ä¼šå¯¼è‡´è¿™ä¸ªé—®é¢˜ã€‚ ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:6:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"åº”ç”¨: String switch in C è¿™ç¯‡åšæ–‡å±•ç¤ºäº†å¦‚ä½•åœ¨ C è¯­è¨€ä¸­å¯¹ string ä½¿ç”¨ switch case: String switch in C #define STRING_SWITCH_L(s) switch (*((int32_t *)(s)) | 0x20202020) #define MULTICHAR_CONSTANT(a,b,c,d) ((int32_t)((a) | (b) \u003c\u003c 8 | (c) \u003c\u003c 16 | (d) \u003c\u003c 24)) Note that STRING_SWITCH_L performs a bitwise OR with the 32-bit integral value â€“ this is a fast means of lowering the case of four characters at once. ç„¶å MULTICHAR_CONSTANT åˆ™æ˜¯å°†å‚æ•°æŒ‰å°ç«¯å­—èŠ‚åºè®¡ç®—å‡ºå¯¹åº”çš„æ•°å€¼ã€‚ è¿™ç¯‡åšæ–‡è¯´æ˜äº†åœ¨ C è¯­è¨€ä¸­å¯¹ string ä½¿ç”¨ switch case æå‡æ•ˆèƒ½çš„åŸç† (é™¤æ­¤ä¹‹å¤–è¿˜è®²è§£äº†å†…å­˜å¯¹é½ç›¸å…³çš„æ•ˆèƒ½é—®é¢˜): [cx] More on string switch in C ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:7:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"åº”ç”¨: Linked List çš„å„å¼å˜ç§ å®å’Œå‡½æ•°è°ƒç”¨çš„æ•ˆèƒ½å¯¹æ¯”: Simple code for checking the speed difference between function call and macro åœ¨é€²è¡Œå‡½å¼å‘¼å«æ™‚ï¼Œæˆ‘å€‘é™¤äº†éœ€è¦æŠŠåƒæ•¸æ¨å…¥ç‰¹å®šçš„æš«å­˜å™¨æˆ–æ˜¯å †ç–Šï¼Œé‚„è¦å„²å­˜ç›®å‰æš«å­˜å™¨çš„å€¼åˆ°å †ç–Šã€‚åœ¨å‡½å¼å‘¼å«æ•¸é‡å°‘çš„ç‹€æ³ï¼Œå½±éŸ¿ä¸é¡¯è‘—ï¼Œä½†éš¨è‘—æ•¸é‡å¢é•·ï¼Œå°±æœƒå°è‡´ç¨‹å¼é‹ä½œæ¯”ç”¨ macro å¯¦ä½œæ™‚æ…¢ã€‚ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Linux æ ¸å¿ƒå¯¹äº linked list çš„åŠŸèƒ½å¤§é‡é‡‡ç”¨å®æ¥å®ç°ã€‚ é™æ€çš„ linked list åˆå§‹åŒ–éœ€è¦ä½¿ç”¨åˆ° compound literal: C99 6.5.2.5 Compound literals The type name shall specify an object type or an array of unknown size, but not a variable length array type. A postfix expression that consists of a parenthesized type name followed by a braceenclosed list of initializers is a compound literal. It provides an unnamed object whose value is given by the initializer list. If the type name specifies an array of unknown size, the size is determined by the initializer list as specified in 6.7.8, and the type of the compound literal is that of the completed array type. Otherwise (when the type name specifies an object type), the type of the compound literal is that specified by the type name. In either case, the result is an lvalue. C99 6.7.8 Initialization Each brace-enclosed initializer list has an associated current object. When no designations are present, subobjects of the current object are initialized in order according to the type of the current object: array elements in increasing subscript order, structure members in declaration order, and the first named member of a union. In contrast, a designation causes the following initializer to begin initialization of the subobject described by the designator. Initialization then continues forward in order, beginning with the next subobject after that described by the designator. ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:8:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"å…¶å®ƒåº”ç”¨ ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:9:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"Unit Test æµ‹è¯•æ¡†æ¶æœ¬è´¨æ˜¯æä¾›ä¸€ä¸ªæ¡†æ¶æ¨¡ç‰ˆï¼Œè®©ç¨‹åºå‘˜å°†ç²¾åŠ›æ”¾åœ¨æµ‹è¯•é€»è¾‘çš„ç¼–å†™ä¸Šã€‚ä½¿ç”¨ C è¯­è¨€çš„å®é…åˆå‰ç½®å¤„ç†å™¨ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚ unity/unity_fixture.h Google Test ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:9:1","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"Object Model åŒæ ·çš„ï¼Œä½¿ç”¨ C è¯­è¨€çš„å®å’Œå‰ç½®å¤„ç†å™¨ï¼Œå¯ä»¥è®© C è¯­è¨€æ‹¥æœ‰ OOP çš„è¡¨è¾¾èƒ½åŠ›: ObjectC: use as a superset of the C language adding a lot of modern concepts missing in C ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:9:2","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"Exception Handling é€šè¿‡å®å’Œ setjmp/longjmp å¯ä»¥å¾ˆè½»æ¾åœ°å®ä½œå‡º C è¯­è¨€çš„å¼‚å¸¸æœºåˆ¶: ExtendedC library extends the C programming language through complex macros and other tricks that increase productivity, safety, and code reuse without needing to use a higher-level language such as C++, Objective-C, or D. include/exception.h ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:9:3","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"ADT ä¸ä¹‹å‰æ‰€æçš„ Linux æ ¸å¿ƒçš„ linked list ç±»ä¼¼ï¼Œä½¿ç”¨å®å–ä»£å‡½æ•°è°ƒç”¨å¯ä»¥é™ä½ ADT çš„ç›¸å…³æ“ä½œçš„æ•ˆèƒ½æŸå¤±: pearldb: A Lightweight Durable HTTP Key-Value Pair Database in C klib/ksort.h é€šè¿‡å®å±•å¼€å®ä½œçš„æ’åºç®—æ³• æˆåŠŸ Linux æ ¸å¿ƒåŸå§‹ç¨‹å¼ç ä¹Ÿå–„ç”¨å®æ¥æ‰©å…… ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:9:4","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"Linux æ ¸å¿ƒå®: BUILD_BUG_ON_ZERO åŸæ–‡åœ°å€ ç®€å•æ¥è¯´å°±æ˜¯ç¼–è¯‘å™¨å°±è¿›è¡Œæ£€æŸ¥çš„ assertï¼Œæˆ‘å†™äº† ç›¸å…³ç¬”è®° æ¥è¯´æ˜å®ƒçš„åŸç†ã€‚ ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:10:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"Linux æ ¸å¿ƒåŸå§‹ç¨‹å¼ç å®: max, min åŸæ–‡åœ°å€ ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:11:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["C","Linux Kernel Internals"],"content":"Linux æ ¸å¿ƒåŸå§‹ç¨‹å¼ç å®: contain_of åŸæ–‡åœ°å€ ","date":"2024-03-25","objectID":"/posts/c-preprocessor/:12:0","tags":["Sysprog","C","Preprocessor"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‰ç½®å¤„ç†å™¨åº”ç”¨ç¯‡","uri":"/posts/c-preprocessor/"},{"categories":["Operating Systems"],"content":"æ“ä½œç³»ç»Ÿä½¿ç”¨æ­£ç¡®çš„æŠ½è±¡ä½¿æ„é€ åºå¤§çš„è®¡ç®—æœºè½¯ä»¶/ç¡¬ä»¶ç”Ÿæ€ä»ä¸å¯èƒ½å˜ä¸ºå¯èƒ½ã€‚è¿™é—¨è¯¾å›´ç»•æ“ä½œç³»ç»Ÿæ˜¯ å¦‚ä½•è®¾è®¡ (åº”ç”¨ç¨‹åºè§†è§’)ã€æ€æ ·å®ç° (ç¡¬ä»¶è§†è§’) ä¸¤ä¸ªè§’åº¦å±•å¼€ï¼Œåˆ†ä¸ºä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼š åŸç†è¯¾ (å¹¶å‘/è™šæ‹ŸåŒ–/æŒä¹…åŒ–)ï¼šä»¥æ•™ç§‘ä¹¦å†…å®¹ä¸ºä¸»ï¼Œä»‹ç»æ“ä½œç³»ç»Ÿçš„åŸç†æ€§å†…å®¹ã€‚è¯¾ç¨‹åŒæ—¶æ³¨é‡è®²è§£æ“ä½œç³»ç»Ÿç›¸å…³çš„ä»£ç å®ç°å’Œç¼–ç¨‹æŠ€å·§ï¼ŒåŒ…æ‹¬æ“ä½œç³»ç»Ÿä¸­å¸¸ç”¨çš„å‘½ä»¤è¡Œ/ä»£ç å·¥å…·ã€æ•™å­¦æ“ä½œç³»ç»Ÿ xv6 çš„ä»£ç è®²è§£ç­‰ ç†è§£æ“ä½œç³»ç»Ÿæœ€é‡è¦çš„å®éªŒéƒ¨åˆ†: Mini labs (åº”ç”¨ç¨‹åºè§†è§’ï¼›è®¾è®¡)ï¼šé€šè¿‡å®ç°ä¸€ç³»åˆ—æœ‰è¶£çš„ (é»‘ç§‘æŠ€) ä»£ç ç†è§£æ“ä½œç³»ç»Ÿä¸­å¯¹è±¡å­˜åœ¨çš„æ„ä¹‰å’Œæ“ä½œç³»ç»Ÿ API çš„ä½¿ç”¨æ–¹æ³•ã€è®¾è®¡ç†å¿µ OS labs (è®¡ç®—æœºç¡¬ä»¶è§†è§’ï¼›å®ç°)ï¼šåŸºäºä¸€ä¸ªç®€åŒ–çš„ç¡¬ä»¶æŠ½è±¡å±‚å®ç°å¤šå¤„ç†å™¨æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œå‘åº”ç”¨ç¨‹åºæä¾›ä¸€äº›åŸºç¡€æ“ä½œç³»ç»Ÿ API æ—¶éš”ä¸€å¹´ï¼Œåœ¨è·Ÿéš B ç«™ up ä¸» @è¸Œèº‡æœˆå…‰ ä»é›¶ç¼–å†™ä¸€ä¸ªåŸºäº x86 æ¶æ„çš„å†…æ ¸ Txics åï¼Œç»ˆäºå¯ä»¥è·Ÿå¾—ä¸Š @ç»¿å¯¼å¸ˆ çš„è¯¾ç¨‹äº† ğŸ¤£ è¿™æ¬¡ä»¥ 2022 å¹´çš„ OS è¯¾ç¨‹ ä½œä¸ºä¸»çº¿å­¦ä¹ ï¼Œè¾…ä»¥ 2023 å¹´è¯¾ç¨‹ å’Œ 2024 å¹´è¯¾ç¨‹ çš„å†…å®¹åŠ ä»¥è¡¥å……ã€æ‰©å±•ï¼Œå¹¶æ­é…å—å¤§çš„ ICS è¯¾ç¨‹è¿›è¡Œä½œä¸šï¼ŒåæœŸå¯èƒ½ä¼šåŠ å…¥æ¸…åå¤§å­¦çš„ rCore å®éªŒ (å¾…å®š)ã€‚ tux é—®é¢˜ JYY 2022 å¹´çš„ OSDI è¯¾ç¨‹è®²ä¹‰å’Œé˜…è¯»ææ–™æ˜¯åˆ†å¼€çš„ï¼Œ2023 å¹´å’Œ 2024 å¹´è¿›è¡Œäº†æ”¹è¿›ï¼Œè®²ä¹‰å’Œé˜…è¯»ææ–™åˆå¹¶æˆç±»ä¼¼äºå…±ç¬”çš„ææ–™ï¼Œæ‰€ä»¥ä¸‹é¢æœ‰ä¸€äº› lectures æ˜¯æ²¡æœ‰é˜…è¯»ææ–™é“¾æ¥çš„ã€‚ ","date":"2024-03-24","objectID":"/posts/nju-osdi/:0:0","tags":["Linux","QEMU","RISC-V"],"title":"å—äº¬å¤§å­¦ æ“ä½œç³»ç»Ÿ: è®¾è®¡ä¸å®ç° é‡ç‚¹æç¤º","uri":"/posts/nju-osdi/"},{"categories":["Operating Systems"],"content":"ç¬¬ 1 å‘¨: ç»ªè®º ","date":"2024-03-24","objectID":"/posts/nju-osdi/:1:0","tags":["Linux","QEMU","RISC-V"],"title":"å—äº¬å¤§å­¦ æ“ä½œç³»ç»Ÿ: è®¾è®¡ä¸å®ç° é‡ç‚¹æç¤º","uri":"/posts/nju-osdi/"},{"categories":["Operating Systems"],"content":"æ“ä½œç³»ç»Ÿæ¦‚è¿° (ä¸ºä»€ä¹ˆè¦å­¦æ“ä½œç³»ç»Ÿ) ç›´æ’­å½•å½± | è®²ä¹‰é¡µé¢ ä¸€ä¸ª Talk çš„ç»å…¸ä¸‰æ®µå¼ç»“æ„: Why? What? How? (è¿™ä¸ªçœŸæ˜¯æ±‡æŠ¥çš„å¤§æ€å™¨ ğŸ¤£) 1950s çš„è®¡ç®—æœº I/O è®¾å¤‡çš„é€Ÿåº¦å·²ç»ä¸¥é‡ä½äºå¤„ç†å™¨çš„é€Ÿåº¦ï¼Œä¸­æ–­æœºåˆ¶å‡ºç° (1953) å¸Œæœ›ä½¿ç”¨è®¡ç®—æœºçš„äººè¶Šæ¥è¶Šå¤šï¼›å¸Œæœ›è°ƒç”¨ API è€Œä¸æ˜¯ç›´æ¥è®¿é—®è®¾å¤‡ æ‰¹å¤„ç†ç³»ç»Ÿ = ç¨‹åºçš„è‡ªåŠ¨åˆ‡æ¢ (æ¢å¡) + åº“å‡½æ•° API æ“ä½œç³»ç»Ÿä¸­å¼€å§‹å‡ºç° è®¾å¤‡ã€æ–‡ä»¶ã€ä»»åŠ¡ ç­‰å¯¹è±¡å’Œ API 1960s çš„è®¡ç®—æœº å¯ä»¥åŒæ—¶è½½å…¥å¤šä¸ªç¨‹åºè€Œä¸ç”¨ â€œæ¢å¡â€ äº† èƒ½è½½å…¥å¤šä¸ªç¨‹åºåˆ°å†…å­˜ä¸”çµæ´»è°ƒåº¦å®ƒä»¬çš„ç®¡ç†ç¨‹åºï¼ŒåŒ…æ‹¬ç¨‹åºå¯ä»¥è°ƒç”¨çš„ API æ—¢ç„¶æ“ä½œç³»ç»Ÿå·²ç»å¯ä»¥åœ¨ç¨‹åºä¹‹é—´åˆ‡æ¢ï¼Œä¸ºä»€ä¹ˆä¸è®©å®ƒä»¬å®šæ—¶åˆ‡æ¢å‘¢ï¼Ÿ æ“ä½œç³»ç»Ÿæœºåˆ¶å‡ºç°å’Œå‘å±•çš„åŸå› ï¼Œä¸éœ€è¦æ­»è®°ç¡¬èƒŒï¼Œè¿™äº›æœºåˆ¶éƒ½æ˜¯åº”éœ€æ±‚è€Œè¯ç”Ÿã€å‘å±•çš„ï¼Œéå¸¸çš„è‡ªç„¶ã€‚ ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿï¼Ÿ ç¨‹åºè§†è§’ï¼šå¯¹è±¡ + API ç¡¬ä»¶è§†è§’ï¼šä¸€ä¸ª C ç¨‹åº å®éªŒç¯å¢ƒ: deepin 20.9 $ uname -a Linux cai-PC 5.15.77-amd64-desktop #2 SMP Thu Jun 15 16:06:18 CST 2023 x86_64 GNU/Linux å®‰è£… tldr: $ sudo apt install tldr æœ‰äº›ç³»ç»Ÿå¯èƒ½æ²¡æœ‰é¢„è£… man æ‰‹å†Œ: $ sudo apt install manpages manpages-de manpages-de-dev manpages-dev manpages-posix manpages-posix-dev glibc-doc ","date":"2024-03-24","objectID":"/posts/nju-osdi/:1:1","tags":["Linux","QEMU","RISC-V"],"title":"å—äº¬å¤§å­¦ æ“ä½œç³»ç»Ÿ: è®¾è®¡ä¸å®ç° é‡ç‚¹æç¤º","uri":"/posts/nju-osdi/"},{"categories":["Operating Systems"],"content":"æ“ä½œç³»ç»Ÿä¸Šçš„ç¨‹åº (ä»€ä¹ˆæ˜¯ç¨‹åºå’Œç¼–è¯‘å™¨) ç›´æ’­å½•å½± | è®²ä¹‰é¡µé¢ | é˜…è¯»ææ–™ UNIX å“²å­¦: Make each program do one thing well Expect the output of every program to become the input to another ä»€ä¹ˆæ˜¯ç¨‹åº è®¡ç®—æœºæ˜¯æ„å»ºåœ¨çŠ¶æ€æœº (æ•°å­—ç”µè·¯) ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥è¿è¡Œåœ¨è®¡ç®—æœºä¹‹ä¸Šçš„ç¨‹åº (ä¸ç®¡æ˜¯æ“ä½œç³»ç»Ÿè¿˜æ˜¯åº”ç”¨ï¼Œæ— è®ºæ˜¯æºä»£ç è¿˜æ˜¯äºŒè¿›åˆ¶) éƒ½æ˜¯çŠ¶æ€æœºã€‚Cç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹ä¸­ï¼ŒçŠ¶æ€æ˜¯ç”±å †æ ˆç¡®å®šçš„ï¼Œæ‰€ä»¥å‡½æ•°è°ƒç”¨æ˜¯çŠ¶æ€è¿ç§»ï¼Œå› ä¸ºå®ƒæ”¹å˜äº†å †æ ˆï¼Œå³æ”¹å˜äº†çŠ¶æ€æœºçš„çŠ¶æ€ã€‚æ˜ç¡®è¿™ä¸€ç‚¹ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿå †æ ˆçš„æ–¹å¼ï¼Œæ¥å°†ä»»æ„çš„é€’å½’ç¨‹åºæ”¹å†™ä¸ºéé€’å½’ç¨‹åºï¼Œä¾‹å¦‚ç»å…¸çš„æ±‰è¯ºå¡”ç¨‹åºã€‚ ç¨‹åº = çŠ¶æ€æœº æºä»£ç  $S$ (çŠ¶æ€æœº): çŠ¶æ€è¿ç§» = æ‰§è¡Œè¯­å¥ äºŒè¿›åˆ¶ä»£ç  $C$ (çŠ¶æ€æœº): çŠ¶æ€è¿ç§» = æ‰§è¡ŒæŒ‡ä»¤ æ³¨æ„ jyy æ‰€ç»™çš„éé€’å½’æ±‰è¯ºå¡”ç¨‹åºä¹Ÿæ˜¯é€šè¿‡æ¨¡æ‹Ÿå †æ ˆçŠ¶æ€è½¬ç§»å®ç°çš„ï¼Œä½†æ˜¯æ¯”è¾ƒæ™¦æ¶©çš„ä¸€ç‚¹æ˜¯ï¼Œå¯¹äºæ¯ä¸€ä¸ªå †æ ˆçŠ¶æ€ï¼Œéƒ½æœ‰å¯èƒ½éœ€è¦æ‰§è¡Œæœ€å¤š 4 æ¡è¯­å¥ (å¯¹åº” for å¾ªç¯å’Œ pc)ï¼Œè¿™ä¸€ç‚¹æ¯”è¾ƒéš¾æ‡‚ã€‚ åªä½¿ç”¨çº¯\"è®¡ç®—\"çš„æŒ‡ä»¤ (æ— è®ºæ˜¯ deterministic è¿˜æ˜¯ non-deterministic) æ— æ³•ä½¿ç¨‹åºåœä¸‹æ¥ï¼Œå› ä¸ºå°†ç¨‹åºæœ¬è´¨æ˜¯çŠ¶æ€æœºï¼Œè€ŒçŠ¶æ€æœºé€šè¿‡â€œè®¡ç®—â€çš„æŒ‡ä»¤åªèƒ½ä»ä¸€ä¸ªçŠ¶æ€è¿ç§»åˆ°å¦ä¸€ä¸ªçŠ¶æ€ï¼Œæ— æ³•å®ç°é”€æ¯çŠ¶æ€æœºçš„æ“ä½œ (å¯¹åº”é€€å‡º/åœä¸‹ç¨‹åº)ï¼Œè¦ä¹ˆæ­»å¾ªç¯ï¼Œè¦ä¹ˆ undefined behaviorã€‚è¿™æ—¶éœ€è¦ç¨‹åºå¯¹åº”çš„çŠ¶æ€æœºä¹‹å¤–çš„å¦ä¸€ä¸ªä¸œè¥¿æ¥æ§åˆ¶ã€ç®¡ç†è¯¥çŠ¶æ€æœºï¼Œä»¥å®ç°ç¨‹åºçš„åœä¸‹/é€€å‡ºæ“ä½œï¼Œè¿™å°±æ˜¯ OS çš„ syscall å­˜åœ¨çš„æ„ä¹‰ï¼Œå®ƒå¯ä»¥æ¸¸ç¦»åœ¨ç¨‹åºå¯¹åº”çš„çŠ¶æ€æœºä¹‹å¤–ï¼Œå¹¶ä¿®æ”¹çŠ¶æ€æœºçš„å†…å®¹ (å› ä¸ºç¨‹åºå‘¼å« syscall æ—¶å·²ç»å…¨æƒæˆäºˆ OS å¯¹å…¶çŠ¶æ€å†…å®¹è¿›è¡Œä¿®æ”¹)ã€‚ ç©ºçš„ _start å‡½æ•°å¯ä»¥æˆåŠŸç¼–è¯‘å¹¶é“¾æ¥ï¼Œä½†æ˜¯ç”±äºå‡½æ•°æ˜¯ç©ºçš„ï¼Œå®ƒä¼šç¼–è¯‘ç”Ÿæˆ retq æŒ‡ä»¤ï¼Œè¿™ä¼šå¯¼è‡´ pc è·³è½¬åˆ°ä¸åˆæ³•çš„åŒºåŸŸï¼Œè€Œæ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯ä½¿ç”¨ syscall exit æ¥ç»“æŸè¯¥ç¨‹åº (ç†Ÿæ‚‰ C è¯­è¨€å‡½æ•°è°ƒç”¨çš„åŒå­¦åº”è¯¥èƒ½çœ‹æ‡‚è¿™æ®µæè¿°)ã€‚ // start.c int _start() {} // start.o 0000000000000000 \u003c_start\u003e: 0: 55 push %rbp 1: 48 89 e5 mov %rsp,%rbp 4: 90 nop 5: 5d pop %rbp 6: c3 retq é€šè¿‡ syscall å®ç°äº†å’Œ mininal.S åŠŸèƒ½ä¸€è‡´çš„æœ€å° C è¯­è¨€ hello, world ç¨‹åº mininal.c: #include \u003csys/syscall.h\u003e #include \u003cunistd.h\u003e int main() { char buf[] = \"\\033[01;31mHello, OS World\\033[0m\\n\"; syscall(SYS_write, 1, buf, sizeof(buf)); syscall(SYS_exit, 42); } System Calls Manual å¦‚ä½•åœ¨ç¨‹åºçš„ä¸¤ä¸ªè§†è§’ä¹‹é—´åˆ‡æ¢ï¼Ÿ ä»â€œçŠ¶æ€æœºâ€çš„è§’åº¦å¯ä»¥å¸®æˆ‘ä»¬è§£å†³ä¸€ä¸ªé‡è¦çš„åŸºæœ¬é—®é¢˜: ä»€ä¹ˆæ˜¯ç¼–è¯‘å™¨ï¼Ÿï¼Ÿï¼Ÿ ç¼–è¯‘å™¨: æºä»£ç  S (çŠ¶æ€æœº) $\\rightarrow$ äºŒè¿›åˆ¶ä»£ç  C (çŠ¶æ€æœº) $$C=compile(S)$$ å³ç¼–è¯‘å™¨çš„åŠŸèƒ½æ˜¯å°†æºä»£ç å¯¹åº”çš„çŠ¶æ€æœº $S$ è½¬æ¢æˆäºŒè¿›åˆ¶ä»£ç å¯¹åº”çš„çŠ¶æ€æœº $C$ã€‚ä½†æ˜¯è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œè¿™ä¸¤ä¸ªçŠ¶æ€æœºä¸éœ€è¦å®Œå…¨ç­‰ä»·ï¼Œåªéœ€è¦æ»¡è¶³ $S$ ä¸ $C$ çš„å¯è§‚æµ‹è¡Œä¸ºä¸¥æ ¼ä¸€è‡´ å³å¯ï¼Œè¿™ä¹Ÿæ˜¯ç¼–è¯‘ä¼˜åŒ–çš„ç†è®ºåŸºç¡€ï¼šåœ¨ä¿è¯è§‚æµ‹ä¸€è‡´æ€§ (sound) çš„å‰æä¸‹æ”¹å†™ä»£ç  (rewriting)ã€‚ Jserv çš„è®²åº§ ä¸¦è¡Œç¨‹å¼è¨­è¨ˆ: åŸ·è¡Œé †åº å¯¹è¿™ä¸ªæœ‰æ›´æ¸…æ™°çš„è®²è§£ å¯ä»¥é€šè¿‡ä»¥ä¸‹æŒ‡ä»¤æ¥è§‚å¯Ÿç¼–è¯‘å™¨çš„ä¼˜åŒ–æƒ…å†µï¼Œä»¥ç†è§£ä»€ä¹ˆæ˜¯è§‚æµ‹ä¸€è‡´æ€§: $ gcc -On -c a.c # n couldbe 0, 1, 2, 3 $ objdump -d a.o æ“ä½œç³»ç»Ÿä¸­çš„ä¸€èˆ¬ç¨‹åº å¯¹äºæ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„ç¨‹åºï¼Œå®ƒä»¬çœ‹å¾…æ“ä½œç³»ç»Ÿçš„è§†è§’æ˜¯ API (syscall)ï¼Œæ‰€ä»¥è¿™é—¨è¯¾ä¸­æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„å·¥å…·ï¼šstrace (system call trace è¿½è¸ªç¨‹åºè¿è¡Œæ—¶ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¯ä»¥æŸ¥çœ‹ç¨‹åºå’Œæ“ä½œç³»ç»Ÿçš„äº¤äº’): $ sudo apt install strace $ strace ./hello-goodbye Linux manual page: strace æŠ€å·§ å¯ä»¥é€šè¿‡ apt-file æ¥æ£€ç´¢æ–‡ä»¶åå¯èƒ½åœ¨é‚£äº› package é‡Œï¼Œä¾‹å¦‚: $ sudo apt install apt-file $ sudo apt-file update $ sudo apt-file search \u003cfilename\u003e ","date":"2024-03-24","objectID":"/posts/nju-osdi/:1:2","tags":["Linux","QEMU","RISC-V"],"title":"å—äº¬å¤§å­¦ æ“ä½œç³»ç»Ÿ: è®¾è®¡ä¸å®ç° é‡ç‚¹æç¤º","uri":"/posts/nju-osdi/"},{"categories":["Operating Systems"],"content":"ç¬¬ 2 å‘¨: å¹¶å‘","date":"2024-03-24","objectID":"/posts/nju-osdi/:2:0","tags":["Linux","QEMU","RISC-V"],"title":"å—äº¬å¤§å­¦ æ“ä½œç³»ç»Ÿ: è®¾è®¡ä¸å®ç° é‡ç‚¹æç¤º","uri":"/posts/nju-osdi/"},{"categories":["Rust"],"content":" In this episode of Crust of Rust, we go over subtyping and variance â€” a niche part of Rust that most people donâ€™t have to think about, but which is deeply ingrained in some of Rustâ€™s borrow ergonomics, and occasionally manifests in confusing ways. In particular, we explore how trying to implement the relatively straightforward strtok function from C/C++ in Rust quickly lands us in a place where the function is more or less impossible to call due to variance! æ•´ç†è‡ª John Gjengset çš„å½±ç‰‡ ","date":"2024-03-17","objectID":"/posts/subtying-and-variance/:0:0","tags":["Rust","Subtying","Variance"],"title":"Crust of Rust: Subtying and Variance","uri":"/posts/subtying-and-variance/"},{"categories":["Rust"],"content":"å½±ç‰‡æ³¨è§£ ","date":"2024-03-17","objectID":"/posts/subtying-and-variance/:1:0","tags":["Rust","Subtying","Variance"],"title":"Crust of Rust: Subtying and Variance","uri":"/posts/subtying-and-variance/"},{"categories":["Rust"],"content":"strtok A sequence of calls to this function split str into tokens, which are sequences of contiguous characters separated by any of the characters that are part of delimiters. cplusplus: strtok cppreference: strtok ","date":"2024-03-17","objectID":"/posts/subtying-and-variance/:1:1","tags":["Rust","Subtying","Variance"],"title":"Crust of Rust: Subtying and Variance","uri":"/posts/subtying-and-variance/"},{"categories":["Rust"],"content":"shortening lifetimes å½±ç‰‡å¤§æ¦‚ 19 åˆ†æ—¶ç»™å‡ºäº†ä¸ºä½• cargo test å¤±è´¥çš„æ¨å¯¼ï¼Œä¸ªäººè§‰å¾—éå¸¸å·§å¦™ pub fn strtok\u003c'a\u003e(s: \u0026'a mut \u0026'a str, delimiter: char) { ... } let mut x = \"hello world\"; strtok(\u0026mut x, ' '); ä¸ºäº†æ›´ç›´è§‚åœ°è¡¨ç¤ºå’Œå‡½æ•° strtok çš„è¿”å›å€¼ lifetime æ— å…³ï¼Œè¿™é‡Œå°†è¿”å›å€¼å…ˆå»æ‰äº†ã€‚åœ¨è°ƒç”¨ strtok æ—¶ï¼Œç¼–è¯‘å™¨å¯¹äºå‚æ•° s çš„ lifetime æ¨å¯¼å¦‚ä¸‹: \u0026'a mut \u0026'a str \u0026 mut x \u0026'a mut \u0026'a str \u0026 mut \u0026'static str \u0026'a mut \u0026'static str \u0026 mut \u0026'static str \u0026'static mut \u0026'static str \u0026 mut \u0026'static str \u0026'static mut \u0026'static str \u0026'static mut \u0026'static str æ‰€ä»¥ strtok åœ¨æ¥æ”¶å‚æ•° s å (é€šè¿‡ä¼ å…¥ \u0026mut x)ï¼Œä¼šæ¨å¯¼å…¶ lifetime ä¸º staticï¼Œè¿™å°±ä¼šå¯¼è‡´åé¢ä½¿ç”¨ x çš„ä¸å¯å˜å¼•ç”¨ (\u0026x) æ—¶å‘ç”Ÿå†²çªã€‚ ","date":"2024-03-17","objectID":"/posts/subtying-and-variance/:1:2","tags":["Rust","Subtying","Variance"],"title":"Crust of Rust: Subtying and Variance","uri":"/posts/subtying-and-variance/"},{"categories":["Rust"],"content":"Documentations è¿™é‡Œåˆ—ä¸¾è§†é¢‘ä¸­ä¸€äº›æ¦‚å¿µç›¸å…³çš„ documentation å­¦ä¹ çš„ä¸€æ‰‹èµ„æ–™æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œè¯·åŠ¡å¿…è‡ªä¸»å­¦ä¼šé˜…è¯»è§„æ ¼ä¹¦ä¹‹ç±»çš„èµ„æ–™ ","date":"2024-03-17","objectID":"/posts/subtying-and-variance/:2:0","tags":["Rust","Subtying","Variance"],"title":"Crust of Rust: Subtying and Variance","uri":"/posts/subtying-and-variance/"},{"categories":["Rust"],"content":"Crate std å¯ä»¥ä½¿ç”¨è¿™é‡Œæä¾›çš„æœç´ æ è¿›è¡Œæœç´¢ (BTW ä¸è¦æµªè´¹æ—¶é—´åœ¨ Google æœå¯»ä¸Šï¼) method str::find ","date":"2024-03-17","objectID":"/posts/subtying-and-variance/:2:1","tags":["Rust","Subtying","Variance"],"title":"Crust of Rust: Subtying and Variance","uri":"/posts/subtying-and-variance/"},{"categories":["Rust"],"content":"References The Rust Reference: Subtyping and Variance The Rustonomicon: Subtyping and Variance ","date":"2024-03-17","objectID":"/posts/subtying-and-variance/:3:0","tags":["Rust","Subtying","Variance"],"title":"Crust of Rust: Subtying and Variance","uri":"/posts/subtying-and-variance/"},{"categories":["C","Linux Kernel Internals"],"content":" åœ¨è®¸å¤šåº”ç”¨ç¨‹åºä¸­ï¼Œé€’å½’ (recursion) å¯ä»¥ç®€å•åˆä¼˜é›…åœ°è§£å†³è²Œä¼¼ç¹ççš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ä¸æ–­åœ°æ‹†è§£åŸæœ‰é—®é¢˜ä¸ºç›¸ä¼¼çš„å­é—®é¢˜ï¼Œç›´åˆ°æ— æ³•æ‹†è§£ä¸ºæ­¢ï¼Œå¹¶ä¸”å®šä¹‰æœ€ç®€åŒ–çŠ¶å†µçš„å¤„ç†æœºåˆ¶ï¼Œä¸€å¦‚æ•°å­¦æ€ç»´ã€‚é€’å½’å¯¹ C è¯­è¨€ç¨‹åºå¼€å‘è€…æ¥è¯´ï¼Œç»å¯¹ä¸ä¼šé™Œç”Ÿï¼Œä½†èƒ½æŒæ¡è€…å´å°‘ï¼Œå¾ˆå¤šäººç”šè‡³éš¾ä»¥è®²å‡ºæ±‰è¯ºå¡”ä¹‹å¤–çš„ä½¿ç”¨æ¡ˆä¾‹ã€‚ ç©¶ç«Ÿé€’å½’æ˜¯å¦‚ä½•ä¼˜é›…åœ°è§£å†³çœŸå®ä¸–ç•Œçš„é—®é¢˜ï¼Œåˆå¦‚ä½•å…¼é¡¾æ‰§è¡Œæ•ˆç‡å‘¢ã€‹æˆ‘ä»¬ä»è¿ä½œåŸç†å¼€å§‹æ¢è®¨ï¼Œæ­é…è‹¥å¹² C ç¨‹åºè§£è¯´ï¼Œå¹¶ä¸”æˆ‘ä»¬å°†ä»¥ç®€åŒ–è¿‡çš„ UNIX å·¥å…·ä¸ºä¾‹ï¼Œåˆ†æé€è¿‡é€’å½’æ¥å¤§å¹…ç¼©å‡ç¨‹å¼ç ã€‚ æˆ–è®¸è·Ÿä½ æƒ³è±¡ä¸­ä¸åŒï¼ŒLinux æ ¸å¿ƒçš„åŸå§‹ç¨‹å¼ç é‡Œå¤´ä¹Ÿç”¨åˆ°é€’å½’å‡½æ•°å‘¼å«ï¼Œç‰¹åˆ«åœ¨è¾ƒå¤æ‚çš„å®ä½œï¼Œä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿï¼Œå–„ç”¨é€’å½’å¯å¤§å¹…ç¼©å‡ç¨‹å¼ç ï¼Œä½†è¿™ä¹Ÿå¯¼è‡´è¿½è¸ªç¨‹åºè¿ä½œçš„éš¾åº¦å¤§å¢ã€‚ åŸæ–‡åœ°å€ ","date":"2024-03-16","objectID":"/posts/c-recursion/:0:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"Recursion To Iterate is Human, to Recurse, Divine. http://coder.aqualuna.me/2011/07/to-iterate-is-human-to-recurse-divine.html æ³¨æ„ ç¬”è€…çš„é€’å½’ (Recursion) æ˜¯é€šè¿‡ UC Berkeley çš„ CS61A: Structure and Interpretation of Computer Programs CS70: Discrete Mathematics and Probability Theory å­¦ä¹ çš„ï¼Œè¿™ä¸ªæ­é…å¼çš„å­¦ä¹ æ¨¡å¼ä½¿å¾—æˆ‘åœ¨å®ä½œâ€”â€”é€’å½’ (cs61a) å’Œç†è®ºâ€”â€”å½’çº³æ³• (cs70) ä¸Šç›¸äº’é…åˆç†è§£ï¼Œä»è€Œå¯¹é€’å½’åœ¨å®ä½œå’Œç†è®ºä¸Šéƒ½æœ‰äº†å……åˆ†è®¤çŸ¥ã€‚ ","date":"2024-03-16","objectID":"/posts/c-recursion/:1:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"é€’å½’å¹¶æ²¡æœ‰æƒ³è±¡çš„é‚£ä¹ˆæ…¢ ä»¥æœ€å¤§å…¬å› æ•° (Greatest Common Divisor, GCD) ä¸ºä¾‹ï¼Œåˆ†åˆ«ä»¥å¾ªç¯å’Œé€’å½’è¿›è¡Œå®ä½œ: unsigned gcd_rec(unsigned a, unsigned b) { if (!b) return a; return gcd_rec(b, a % b); } unsigned gcd_itr(unsigned a, unsigned b) { while (b) { unsigned t = b; b = a % b; a = t; } return a; } è¿™ä¸¤ä¸ªå‡½æ•°åœ¨ clang/llvm ä¼˜åŒ–åçš„ç¼–è¯‘è¾“å‡º (clang -S -O2 gcd.c) çš„æ±‡ç¼–æ˜¯ä¸€æ ·çš„: .LBB0_2: movl %edx, %ecx xorl %edx, %edx divl %ecx movl %ecx, %eax testl %edx, %edx jne .LBB1_2 æŠ€å·§ éè¿´ (Recursion) Tail recursion å¯ä»¥è¢«ç¼–è¯‘å™¨è¿›è¡Œkç©ºé—´åˆ©ç”¨æœ€ä¼˜åŒ–ï¼Œä»è€Œè¾¾åˆ°å’Œå¾ªç¯ä¸€æ ·èŠ‚çœç©ºé—´ï¼Œä½†è¿™éœ€è¦ç¼–è¯‘å™¨æ”¯æŒï¼Œæœ‰äº›ç¼–è¯‘å™¨å¹¶ä¸æ”¯æŒ tail recursion ä¼˜åŒ– ğŸ¤£ è™½ç„¶å¦‚æ­¤ï¼Œå°†ä¸€èˆ¬çš„é€’å½’æ”¹å†™ä¸º tail recursion è¿˜æ˜¯å¯ä»¥è·å¾—æå¤§çš„æ•ˆèƒ½æå‡ã€‚ Source ","date":"2024-03-16","objectID":"/posts/c-recursion/:2:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"æ¡ˆä¾‹åˆ†æ: ç­‰æ•ˆç”µé˜» r ----------###------------- A -------- A | | | # # # R(r, n - 1) # r # ==\u003e # R(r, n) # # # | | | --------------------------- B -------- B $$ R(r,n)= \\begin{cases} r \u0026 \\text{if n = 1}\\\\ 1 / (\\frac1r + \\frac1{R(r, n - 1) + r}) \u0026 \\text{if n \u003e 1} \\end{cases} $$ def circuit(n, r): if n == 1: return r else: return 1 / (1 / r + 1 / (circuit(n - 1, r) + r)) ","date":"2024-03-16","objectID":"/posts/c-recursion/:3:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"æ¡ˆä¾‹åˆ†æ: æ•°åˆ—è¾“å‡º man 3 printf RETURN VALUE Upon successful return, these functions return the number of characters printed (excluding the null byte used to end output to strings). å¯ä»¥é€šè¿‡ ulimit -s æ¥æ”¹ stack sizeï¼Œé¢„è®¾ä¸º 8MB ulimit User limits - limit the use of system-wide resources. -s The maximum stack size. ç°ä»£ç¼–è¯‘å™¨çš„æœ€ä¼˜åŒ–å¯èƒ½ä¼šé€ æˆé€’å½’å®ä½œçš„éé¢„æœŸæ”¹å˜ï¼Œå› ä¸ºç¼–è¯‘å™¨å¯èƒ½ä¼šå¯¹é€’å½’å®ä½œåœ¨ç¼–è¯‘æ—¶æœŸè¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œä»è€Œæé«˜æ•ˆèƒ½å’Œé™ä½å†…å­˜ä½¿ç”¨ã€‚ ","date":"2024-03-16","objectID":"/posts/c-recursion/:4:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"é€’å½’ç¨‹åºè®¾è®¡ Recursive Programming ","date":"2024-03-16","objectID":"/posts/c-recursion/:5:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"Fibonacci sequence ä½¿ç”¨çŸ©é˜µé…åˆå¿«é€Ÿå¹‚ç®—æ³•ï¼Œå¯ä»¥å°†æ—¶é—´å¤æ‚åº¦ä» $O(n)$ é™ä½åˆ° $O(\\log n)$ æ–¹æ³• æ—¶é—´å¤æ‚åº¦ ç©ºé—´å¤æ‚åº¦ Rcursive $O(2^n)$ $O(n)$ Iterative $O(n)$ $O(1)$ Tail recursion $O(n)$ $O(1)$ Q-Matrix $O(\\log n)$ $O(n)$ Fast doubling $O(\\log n)$ $O(1)$ åŸæ–‡çš„ Q-Matrix å®ä½œæŒºå¤šæ¼æ´çš„ï¼Œä¸‹é¢ä¸ºä¿®æ­£åçš„å®ä½œ (æ³¨æ„çŸ©é˜µä¹˜æ³•çš„ memset æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™ä¼šä½¿ç”¨åˆ°æ ˆä¸Šè¶…å‡ºç”Ÿå‘½å‘¨æœŸçš„ obeject): void matrix_multiply(int a[2][2], int b[2][2], int t[2][2]) { memset(t, 0, sizeof(int) * 2 * 2); for (int i = 0; i \u003c 2; i++) for (int j = 0; j \u003c 2; j++) for (int k = 0; k \u003c 2; k++) t[i][j] += a[i][k] * b[k][j]; } void matrix_pow(int a[2][2], int n, int t[2][2]) { if (n == 1) { t[0][0] = a[0][0]; t[0][1] = a[0][1]; t[1][0] = a[1][0]; t[1][1] = a[1][1]; return; } if (n % 2 == 0) { int t1[2][2]; matrix_pow(a, n \u003e\u003e 1, t1); matrix_multiply(t1, t1, t); return; } else { int t1[2][2], t2[2][2]; matrix_pow(a, n \u003e\u003e 1, t1); matrix_pow(a, (n \u003e\u003e 1) + 1, t2); matrix_multiply(t1, t2, t); return; } } int fib(int n) { if (n \u003c= 0) return 0; int A1[2][2] = {{1, 1}, {1, 0}}; int result[2][2]; matrix_pow(A1, n, result); return result[0][1]; } Fast doubling å…¬å¼: $$ \\begin{split} F(2k) \u0026= F(k)[2F(k+1) - F(k)] \\\\ F(2k+1) \u0026= F(k+1)^2+F(k)^2 \\end{split} $$ å…·ä½“æ¨å¯¼: $$ \\begin{split} \\begin{bmatrix} F(2n+1) \\\\ F(2n) \\end{bmatrix} \u0026= \\begin{bmatrix} 1 \u0026 1 \\\\ 1 \u0026 0 \\end{bmatrix}^{2n} \\begin{bmatrix} F(1) \\\\ F(0) \\end{bmatrix}\\\\ \\\\ \u0026= \\begin{bmatrix} 1 \u0026 1 \\\\ 1 \u0026 0 \\end{bmatrix}^n \\begin{bmatrix} 1 \u0026 1 \\\\ 1 \u0026 0 \\end{bmatrix}^n \\begin{bmatrix} F(1) \\\\ F(0) \\end{bmatrix}\\\\ \\\\ \u0026= \\begin{bmatrix} F(n+1) \u0026 F(n) \\\\ F(n) \u0026 F(n-1) \\end{bmatrix} \\begin{bmatrix} F(n+1) \u0026 F(n) \\\\ F(n) \u0026 F(n-1) \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}\\\\ \\\\ \u0026= \\begin{bmatrix} F(n+1)^2 + F(n)^2\\\\ F(n)F(n+1) + F(n-1)F(n) \\end{bmatrix} \\end{split} $$ ç„¶åæ ¹æ® $F(k + 1) = F(k) + F(k - 1)$ å¯å¾— $F(2k)$ æƒ…å†µçš„å…¬å¼ã€‚ åŸæ–‡ä¸­éé€’å¢æƒ…å½¢æ¯”è¾ƒæ™¦æ¶©ï¼Œä½†å…¶æœ¬è´¨æ˜¯é€šè¿‡ç´¯åŠ æ¥é€¼è¿‘ç›®æ ‡å€¼: else { t0 = t3; // F(n-2); t3 = t4; // F(n-1); t4 = t0 + t4; // F(n) i++; } ","date":"2024-03-16","objectID":"/posts/c-recursion/:6:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"æ¡ˆä¾‹åˆ†æ: å­—ç¬¦ä¸²åè½¬ åŸæ–‡å¯¹äºæ—¶é—´å¤æ‚åº¦çš„åˆ†æè²Œä¼¼æœ‰äº›é—®é¢˜ï¼Œä¸‹é¢ç»™å‡ºæœ¬äººçš„è§è§£ã€‚ç¬¬ä¸€ç§æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º: $$ T(n) = 2T(n-1) + T(n-2) $$ æ‰€ä»¥ç¬¬ä¸€ç§æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(2^n)$ã€‚ ç¬¬äºŒç§æ–¹æ³•åªæ˜¯åˆ—å‡ºäº†ç¨‹å¼ç ï¼Œè€Œæ²¡æœ‰è¯´æ˜é€’å½’å‡½æ•°çš„ä½œç”¨ï¼Œåœ¨æœ¬äººçœ‹æ¥ï¼Œé€’å½’å‡½æ•°ä¸€å®šè¦æ˜ç¡®è¯´æ˜å…¶ç›®çš„ï¼Œæ‰èƒ½æ¯”è¾ƒå¥½ç†è§£é€’å½’çš„ä½œç”¨ï¼Œæ‰€ä»¥ä¸‹é¢ç»™å‡ºé€’å½’å‡½æ•° rev_core çš„åŠŸèƒ½è¯´æ˜: // è¿”å›å­—ç¬¦ä¸² head çš„æœ€å¤§ä¸‹æ ‡ (ä¸‹æ ‡ç›¸å¯¹äº idx åç§»)ï¼Œå¹¶ä¸”å°†å­—ç¬¦ä¸² head ç›¸å¯¹äº // æ•´æ¡å­—ç¬¦ä¸²çš„ä¸­é—´å¯¹ç§°ç‚¹è¿›è¡Œåè½¬ int rev_core(char *head, int idx) { if (head[idx] != '\\0') { int end = rev_core(head, idx + 1); if (idx \u003e end / 2) swap(head + idx, head + end - idx); return end; } return idx - 1; } char *reverse(char *s) { rev_core(s, 0); return s; } æ—¶é—´å¤æ‚åº¦æ˜¾ç„¶ä¸º $O(n)$ ","date":"2024-03-16","objectID":"/posts/c-recursion/:7:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"æ¡ˆä¾‹åˆ†æ: å»ºç«‹ç›®å½• mkdir [Linux manual page (2)] DESCRIPTION Create the DIRECTORY(ies), if they do not already exist. è¡¥å……ä¸€ä¸‹é€’å½’å‡½æ•° mkdir_r çš„åŠŸèƒ½æè¿°: // ä»è·¯å¾„ `path` çš„ç¬¬ `level` å±‚å¼€å§‹åˆ›å»ºç›®å½• int mkdir_r(const char *path, int level); ","date":"2024-03-16","objectID":"/posts/c-recursion/:8:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"æ¡ˆä¾‹åˆ†æ: ç±»ä¼¼ find çš„ç¨‹åº opendir [Linux manual page (3)] RETURN VALUE The opendir() and fdopendir() functions return a pointer to the directory stream. On error, NULL is returned, and errno is set to indicate the error. readdir [Linux manual page (3)] RETURN VALUE On success, readdir() returns a pointer to a dirent structure. (This structure may be statically allocated; do not attempt to free(3) it.) If the end of the directory stream is reached, NULL is returned and errno is not changed. If an error occurs, NULL is returned and errno is set to indicate the error. To distinguish end of stream from an error, set errno to zero before calling readdir() and then check the value of errno if NULL is returned. ç»ƒä¹ : è¿åŒæ–‡ä»¶ä¸€èµ·è¾“å‡º ç»ƒä¹ : å°†è¾“å‡ºçš„ . å’Œ .. è¿‡æ»¤æ‰ ","date":"2024-03-16","objectID":"/posts/c-recursion/:9:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"æ¡ˆä¾‹åˆ†æ: Merge Sort Program for Merge Sort in C MapReduce with POSIX Thread ","date":"2024-03-16","objectID":"/posts/c-recursion/:10:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"å‡½æ•°å¼ç¨‹åºå¼€å‘ Toward Concurrency Functional programming in C Functional Programming é£æ ¼çš„ C è¯­è¨€å®ä½œ ","date":"2024-03-16","objectID":"/posts/c-recursion/:11:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["C","Linux Kernel Internals"],"content":"é€’å½’èƒŒåçš„ç†è®º YouTube: Lambda Calculus - Computerphile YouTube: Essentials: Functional Programmingâ€™s Y Combinator - Computerphile ç¬¬ä¸€ä¸ªå½±ç‰‡ç›¸å¯¹è¿˜è›®å¥½æ‡‚ï¼Œç¬¬äºŒä¸ªå½±ç‰‡å¯¹äºé PL èƒŒæ™¯çš„äººæ¥è¯´å®Œå…¨æ˜¯çœ‹ä¸æ‡‚ï¼Œæ‰€ä»¥æš‚æ—¶å…ˆæ”¾å¼ƒäº† ç¬¬ä¸€ä¸ªå½±ç‰‡ä¸»è¦ä»‹ç»å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µ: å‡½æ•°å¯ä»¥åƒå…¶å®ƒ object ä¸€æ ·è¢«ä¼ é€’ä½¿ç”¨ï¼Œæ²¡æœ‰é¢å¤–çš„é™åˆ¶ï¼Œå¹¶ä¸” object æ˜¯å¯ä»¥ç”±å‡½æ•°æ¥å®šä¹‰ã€æ„å»ºçš„ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥å®šä¹‰ true å’Œ false: TRUE: $\\lambda x.\\ \\lambda y.\\ x$ FALSE: $\\lambda x.\\ \\lambda y.\\ y$ å› ä¸º true å’Œ false å°±æ˜¯ç”¨æ¥æ§åˆ¶æµç¨‹çš„ï¼Œä¸º true æ—¶æˆ‘ä»¬ do somthingï¼Œä¸º false æˆ‘ä»¬ do otherï¼Œæ‰€ä»¥ä¸Šé¢è¿™ç§å®šä¹‰æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥å®šä¹‰ä¸ºå…¶å®ƒï¼Œæ¯•ç«Ÿå‡½æ•°å¼ç¼–ç¨‹è®©æˆ‘ä»¬å¯ä»¥å®šä¹‰ä»»æ„æˆ‘ä»¬æƒ³å®šä¹‰çš„ä¸œè¥¿ ğŸ¤£ æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å…ˆå‰å®šä¹‰çš„ TRUE å’Œ FALSE æ¥å®ç° NOT, AND, OR è¿™ç±»æ“ä½œäº†: NOT: $\\lambda b.\\ b.$ FALSE TRUE AND: $\\lambda x.\\ \\lambda y.\\ x.\\ y.$ FALSE OR: $\\lambda x.\\ \\lambda y.\\ x$ TRUE $y.$ ä¹ä¸€çœ‹è¿™ä¸ªæŒºæŠ½è±¡çš„ï¼Œå…¶å®ä¸Šé¢çš„å®ç°æ­£ä½“ç°äº†å‡½æ•°å¼ç¼–ç¨‹çš„å¨åŠ›ï¼Œæˆ‘ä»¬ä»¥ NOT TRUE çš„æ¨å¯¼å¸¦å¤§å®¶ä½“ä¼šä¸€ä¸‹: NOT TRUE $\\ \\ \\ \\ $ $b.$ FALSE TRUE $\\ \\ \\ \\ $ TRUE FALSE TRUE $\\ \\ \\ \\ $ TRUE (FALSE TRUE) $\\ \\ \\ \\ $ FALSE å…¶ä½™æ¨å¯¼åŒç† ","date":"2024-03-16","objectID":"/posts/c-recursion/:12:0","tags":["Sysprog","C","Recursion"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: é€’å½’è°ƒç”¨ç¯‡","uri":"/posts/c-recursion/"},{"categories":["Linux","Linux Kernel Internals"],"content":" Linux æ ¸å¿ƒå¦‚åŒå…¶å®ƒå¤æ‚çš„èµ„è®¯ç³»ç»Ÿï¼Œä¹Ÿæä¾› hash table çš„å®ä½œï¼Œä½†å…¶åŸå§‹ç¨‹å¼ç ä¸­å´è—æœ‰é—´æ¥æŒ‡é’ˆ (å¯å‚è§ ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜) çš„å·§å¦™å’Œæ•°å­¦å¥¥ç§˜ã€‚ åŸæ–‡åœ°å€ ","date":"2024-03-16","objectID":"/posts/linux-hashtable/:0:0","tags":["Sysprog","Linux","Hash table"],"title":"Linux æ ¸å¿ƒçš„ hash table å®ä½œ","uri":"/posts/linux-hashtable/"},{"categories":["Linux","Linux Kernel Internals"],"content":"é—´æ¥æŒ‡é’ˆ Linux æ ¸å¿ƒçš„ hashtable ç»“æ„ç¤ºæ„å›¾ï¼š ä¸éš¾çœ‹å‡ºï¼Œpprev æ˜¯æŒ‡å‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹ next çš„æŒ‡é’ˆï¼Œå³æ˜¯æŒ‡å‘ hlist_node * çš„æŒ‡é’ˆï¼Œè€Œä¸æ˜¯æŒ‡å‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹ (hlist_node) çš„æŒ‡é’ˆï¼Œå› ä¸º hashtable çš„æ•°ç»„ä¸­å­˜æ”¾çš„æ˜¯ hlist_node *ï¼Œæ‰€ä»¥è¿™æ ·ä¹Ÿç®€åŒ–äº†è¡¨ç¤ºæ–¹æ³•ï¼Œå°†æ‹‰é“¾å’Œæ•°ç»„å…ƒç´ ç›¸äº’è”ç³»äº†èµ·æ¥ã€‚éœ€è¦ä½¿ç”¨é—´æ¥æŒ‡é’ˆæ¥å®ç° doubly linked æœ¬è´¨ä¸Šæ˜¯å› ä¸ºï¼šæ‹‰é“¾èŠ‚ç‚¹å’Œæ•°ç»„èŠ‚ç‚¹åœ¨è¡¨ç¤ºå’Œæ“ä½œä¸Šçš„ä¸ç­‰ä»·ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥å°†æ•°ç»„å…ƒç´ å’Œæ‹‰é“¾å…ƒç´ éƒ½ç»Ÿä¸€ä¸ºå¸¦æœ‰ä¸¤ä¸ªæŒ‡é’ˆ prev å’Œ next çš„ doubly linked list nodeï¼Œè¿™æ ·è§£å†³äº†ä¹‹å‰æ‰€æçš„ä¸ç­‰ä»·ï¼Œå¯ä»¥æ¶ˆé™¤ç‰¹åˆ¤ï¼Œä½†è¿™æ ·ä¼šå¯¼è‡´å­˜å–æ•°ç»„å…ƒç´ æ—¶å†…å­˜å¼€é”€å¢å¤§ï¼Œè¿›è€Œé™ä½ cache çš„åˆ©ç”¨ç‡ã€‚ ä¿¡æ¯ List, HList, and Hash Table å†…æ ¸åŸºç¡€è®¾æ–½â€”â€”hlist_head/hlist_node ç»“æ„è§£æ hlistæ•°æ®ç»“æ„å›¾ç¤ºè¯´æ˜ ","date":"2024-03-16","objectID":"/posts/linux-hashtable/:1:0","tags":["Sysprog","Linux","Hash table"],"title":"Linux æ ¸å¿ƒçš„ hash table å®ä½œ","uri":"/posts/linux-hashtable/"},{"categories":["Linux","Linux Kernel Internals"],"content":"hash å‡½æ•° Wikipedia: Hash function A hash function is any function that can be used to map data of arbitrary size to fixed-size values, though there are some hash functions that support variable length output. ","date":"2024-03-16","objectID":"/posts/linux-hashtable/:2:0","tags":["Sysprog","Linux","Hash table"],"title":"Linux æ ¸å¿ƒçš„ hash table å®ä½œ","uri":"/posts/linux-hashtable/"},{"categories":["Linux","Linux Kernel Internals"],"content":"å¸¸è§ hash ç­–ç•¥ Division method $$ h(k) = k % N $$ Mid-square $$ h(k) = bits_{i,i+r-1}(k^2) $$ Folding addition $$ key = 3823749374 \\\\ 382\\ |\\ 374\\ |\\ 937\\ |\\ 4 \\\\ index = 382 + 374 + 937 + 4 = 1697 \\\\ $$ å…ˆå°† key åˆ‡æˆç‰‡æ®µåå†ç›¸åŠ ï¼Œä¹Ÿå¯ä»¥å¯¹ç›¸åŠ åçš„ç»“æœåšå…¶ä»–è¿ç®— Multiplication Method ","date":"2024-03-16","objectID":"/posts/linux-hashtable/:2:1","tags":["Sysprog","Linux","Hash table"],"title":"Linux æ ¸å¿ƒçš„ hash table å®ä½œ","uri":"/posts/linux-hashtable/"},{"categories":["Linux","Linux Kernel Internals"],"content":"Linux æ ¸å¿ƒçš„ hash å‡½æ•° Linux æ ¸å¿ƒçš„ hash.h ä½¿ç”¨çš„æ˜¯ Multiplication Method ç­–ç•¥ï¼Œä½†æ˜¯æ˜¯é€šè¿‡æ•´æ•°å’Œä½è¿ç®—å®ç°çš„ï¼Œæ²¡æœ‰ä½¿ç”¨åˆ°æµ®ç‚¹æ•°ã€‚ $$ \\begin{split} h(K) \u0026= \\lfloor m \\cdot (KA - \\lfloor KA \\rfloor) \\rfloor \\\\ h(K) \u0026= K \\cdot 2^w \\cdot A \u003e\u003e (w - p) \\end{split} $$ ä¸Šé¢ä¸¤æ¡å¼å­çš„ç­‰ä»·å…³é”®åœ¨äºï¼Œä½¿ç”¨ äºŒè¿›åˆ¶ç¼–ç  è¡¨ç¤ºçš„æ•´æ•°å’Œå°æ•°é…åˆè¿›è¡Œæ¨å¯¼ï¼Œè¿›è€Œåªä½¿ç”¨æ•´æ•°æ¥å®ç°ï¼Œå…·ä½“æ¨å¯¼è§åŸæ–‡ã€‚ $(\\sqrt{5} - 1 ) / 2 = 0.618033989$ $2654435761 / 4294967296 = 0.618033987$ $2^{32} = 4294967296$ å› æ­¤ val * GOLDEN_RATIO_32 \u003e\u003e (32 - bits) $\\equiv K \\times A \\times 2^w \u003e\u003e (w - p)$ï¼Œå…¶ä¸­ GOLDEN_RATIO_32 ç­‰äº $2654435761$ Linux æ ¸å¿ƒçš„ 64 bit çš„ hash å‡½æ•°: #ifndef HAVE_ARCH_HASH_64 #define hash_64 hash_64_generic #endif static __always_inline u32 hash_64_generic(u64 val, unsigned int bits) { #if BITS_PER_LONG == 64 /* 64x64-bit multiply is efficient on all 64-bit processors */ return val * GOLDEN_RATIO_64 \u003e\u003e (64 - bits); #else /* Hash 64 bits using only 32x32-bit multiply. */ return hash_32((u32)val ^ __hash_32(val \u003e\u003e 32), bits); #endif } Linux æ ¸å¿ƒé‡‡ç”¨ golden ratio ä½œä¸º $A$ï¼Œè¿™æ˜¯å› ä¸ºè¿™æ ·ç¢°æ’è¾ƒå°‘ï¼Œä¸”åˆ†å¸ƒå‡åŒ€: ","date":"2024-03-16","objectID":"/posts/linux-hashtable/:3:0","tags":["Sysprog","Linux","Hash table"],"title":"Linux æ ¸å¿ƒçš„ hash table å®ä½œ","uri":"/posts/linux-hashtable/"},{"categories":["C","Linux Kernel Internals"],"content":" æœ¬è®²åº§å°†å¸¦ç€å­¦å‘˜é‡æ–°æ¢ç´¢å‡½æ•°å‘¼å«èƒŒåçš„åŸç†ï¼Œä»ç¨‹åºè¯­è¨€å’Œè®¡ç®—æœºç»“æ„çš„å‘å±•ç®€å²è°ˆèµ·ï¼Œè®©å­¦å‘˜è‡ªç”µè„‘è½¯ç¡¬ä»¶æ¼”åŒ–è¿‡ç¨‹å»æŒæ¡ calling convention çš„è€ƒé‡ï¼Œä¼´éšç€ stack å’Œ heap çš„æ“ä½œï¼Œå†æ¢è®¨ C ç¨‹åºå¦‚ä½•å¤„ç†å‡½æ•°å‘¼å«ã€è·¨è¶Šå‡½æ•°é—´çš„è·³è·ƒ (å¦‚ setjmp å’Œ longjmp)ï¼Œå†æ¥æ€ç´¢èµ„è®¯å®‰å…¨å’Œæ‰§è¡Œæ•ˆç‡çš„è®®é¢˜ã€‚ç€é‡åœ¨è®¡ç®—æœºæ¶æ„å¯¹åº”çš„æ”¯æ´å’Œè¡Œä¸ºåˆ†æã€‚ åŸæ–‡åœ°å€ ","date":"2024-03-15","objectID":"/posts/c-function/:0:0","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"function prototype Very early C compilers and language ä¸€ä¸ªå°æ•…äº‹ï¼Œå¯ä»¥è§£é‡Š C è¯­è¨€çš„ä¸€äº›è®¾è®¡ç†å¿µï¼Œä¾‹å¦‚ switch-case ä¸­æ¯ä¸ª case éƒ½éœ€è¦ break The Development of the C Language Dennis M. Ritchie è®²è¿° C è¯­è¨€æ¼«é•¿çš„å‘å±•å²ï¼Œå¹¶æ­é…ç¨‹å¼ç æ¥è¯´æ˜å½“åˆä¸ºä½•å¦‚æ­¤è®¾è®¡ã€å–èˆè€ƒé‡ã€‚äº†è§£è¿™äº›å†å²èƒŒæ™¯å¯ä»¥è®©æˆ‘ä»¬æˆä¸ºæ›´ä¸“ä¸šçš„ C è¯­è¨€ Programmer Rationale for International Standard â€“ Programming Languages â€“ C è®²è¿° C è¯­è¨€æ ‡å‡†çš„å˜æ›´ï¼Œå¹¶æ­é…ç¨‹å¼ç è§£é‡Šå˜æ›´çš„åŸç†å’Œè€ƒé‡ åœ¨æ—©æœŸçš„ C è¯­è¨€ä¸­ï¼Œå¹¶ä¸éœ€è¦ function prototypeï¼Œå› ä¸ºå½“ç¼–è¯‘å™¨å‘ç°ä¸€ä¸ªå‡½æ•°åå‡ºç°åœ¨è¡¨è¾¾å¼å¹¶ä¸”åé¢è·Ÿç€å·¦æ‹¬å· (ï¼Œä¾‹å¦‚ a = func(...)ï¼Œå°±ä¼šå°†è¯¥å‡½æ•°è§£è¯»ä¸ºï¼šè¿”å›å€¼ç±»å‹é¢„è®¾ä¸º intï¼Œå‚æ•°ç±»å‹å’Œä¸ªæ•°ç”±è°ƒç”¨è€…æä¾›æ¥å†³å®šï¼ŒæŒ‰ç…§è¿™æ ·è§„åˆ™ç¼–å†™ç¨‹å¼ç ï¼Œå¯ä»¥åœ¨æ— éœ€äº‹å…ˆå®šä¹‰å‡½æ•°å³å¯å…ˆå†™è°ƒç”¨å‡½æ•°çš„é€»è¾‘ã€‚ä½†æ˜¯è¿™æ ·è®¾è®¡ä¹Ÿä¼šé€ æˆæ½œåœ¨é—®é¢˜ï¼šç¨‹åºå‘˜åœ¨è°ƒç”¨å‡½æ•°æ—¶éœ€è¦è°¨æ…å¤„ç†ï¼Œéœ€è¦è‡ªå·±æ£€æŸ¥è°ƒç”¨æ—¶çš„å‚æ•°ç±»å‹å’Œä¸ªæ•°ç¬¦åˆå‡½æ•°å®šä¹‰ (å› ä¸ºå½“æ—¶çš„ç¼–è¯‘å™¨æ— æ³•æ­£ç¡®åˆ¤æ–­è°ƒç”¨å‡½æ•°æ—¶çš„å‚æ•°æ˜¯å¦ç¬¦åˆé¢„æœŸçš„ç±»å‹å’Œä¸ªæ•°ï¼Œå½“æ—¶ç¼–è¯‘å™¨çš„èƒ½åŠ›ä¸å…ˆå‰æåˆ°çš„è§„åˆ™æ˜¯ä¸€ä½“ä¸¤é¢)ï¼Œå¹¶ä¸”è¿”å›å€¼ç±»å‹é¢„è®¾ä¸º int (å½“æ—¶è¿˜æ²¡æœ‰ void ç±»å‹)ï¼Œæ‰€ä»¥å¯¹äºå‡½æ•°è¿”å›å€¼ï¼Œä¹Ÿéœ€è¦è°¨æ…å¤„ç†ã€‚ æ˜¾ç„¶ function prototype çš„ç¼ºå¤±å¯¼è‡´ç¨‹å¼ç ç¼–å†™æå…¶å®¹æ˜“å‡ºé”™ï¼Œæ‰€ä»¥ä» C99 å¼€å§‹å°±è§„èŒƒäº† function prototypeï¼Œè¿™ä¸ªè§„èŒƒé™¤äº†å¯ä»¥é™ä½ programmer å¿ƒæ™ºè´Ÿæ‹…ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æé«˜ç¨‹åºæ•ˆèƒ½ã€‚ç¼–è¯‘å™¨çš„æœ€ä½³åŒ–é˜¶æ®µ (optimizer) å¯ä»¥é€šè¿‡ function prototype æ¥å¾—çŸ¥å†…å­˜ç©ºé—´çš„ä½¿ç”¨æƒ…å½¢ï¼Œä»è€Œå…è®¸ç¼–è¯‘å™¨åœ¨å‡½æ•°è°ƒç”¨è¡¨è¾¾å¼çš„ä¸Šä¸‹æ–‡è¿›è¡Œæ¿€è¿›çš„æœ€ä½³åŒ–ç­–ç•¥ï¼Œä¾‹å¦‚ const çš„ä½¿ç”¨å¯ä»¥è®©ç¼–è¯‘å™¨çŸ¥é“åªä¼šè¯»å–å†…å­˜æ•°æ®è€Œä¸ä¼šä¿®æ”¹å†…å­˜æ•°æ®ï¼Œä»è€Œæ²¡æœ‰ side effectï¼Œå¯ä»¥è¿›è¡Œæ¿€è¿›çš„æœ€ä¼˜åŒ–ã€‚ int compare(const char *string1, const char *string2); void func2(int x) { char *str1, *str2; // ... x = compare(str1, str2); // ... } Rust çš„ä¸å¯å˜å¼•ç”¨ä¹Ÿæ˜¯ç¼–è¯‘å™¨å¯ä»¥è¿›è¡Œæ›´æ¿€è¿›çš„æœ€ä¼˜åŒ–å¤„ç†çš„ä¸€ä¸ªä¾‹å­ æ³¨æ„ ä¸ºä»€ä¹ˆæ—©æœŸçš„ C è¯­è¨€æ²¡æœ‰ function prototype å‘¢ï¼Ÿå› ä¸ºæ—©æœŸçš„ C è¯­è¨€ï¼Œä¸ç®¡æœ‰å¤šå°‘ä¸ªæºç¨‹åºæ–‡ä»¶ï¼Œéƒ½æ˜¯å…ˆé€šè¿‡ cat åˆå¹¶æˆä¸€ä¸ªå•å…ƒæ–‡ä»¶ï¼Œåœ¨è¿›è¡Œç¼–è¯‘é“¾æ¥ç”Ÿæˆç›®æ ‡æ–‡ä»¶ã€‚è¿™æ ·å°±å¯¼è‡´äº†å°±ç®—å†™äº† function prototyeï¼Œä½¿ç”¨ cat åˆå¹¶æ—¶ï¼Œè¿™äº› prototype ä¸ä¸€å®šä¼šå‡ºç°åœ¨æˆ‘ä»¬æœŸæœ›çš„ç¨‹åºå¼€å§‹å¤„ï¼Œå³æ— æ³•åˆ©ç”¨ prototype å¯¹äºå‡½æ•°è°ƒç”¨è¿›è¡Œæ£€æŸ¥ï¼Œæ‰€ä»¥å¹²è„†ä¸å†™ prototypeã€‚ åœ¨ preprocessor å‡ºç°åï¼Œé€šè¿‡ #include è¿™ç±»è¯­æ³•å¹¶æ­é… preprocessor å¯ä»¥ä¿è¯å¯¹äºæ¯ä¸ªæºæ–‡ä»¶ï¼Œéƒ½å¯ä»¥é€šè¿‡ function prototype å¯¹å‡½æ•°è°ƒç”¨è¿›è¡Œå‚æ•°ä¸ªæ•°ã€ç±»å‹æ£€æŸ¥ï¼Œå› ä¸º #include è¯­å¥ä½äºæºæ–‡ä»¶èµ·å§‹å¤„ï¼Œå¹¶ä¸”æ­¤æ—¶ C è¯­è¨€ç¨‹åºçš„ç¼–è¯‘è¿‡ç¨‹æ”¹å˜äº†: å¯¹å•ä¸€æºæ–‡ä»¶è¿›è¡Œé¢„å¤„ç†ã€ç¼–è¯‘ï¼Œç„¶åå†å¯¹å¾—åˆ°çš„ç›®æ ‡æ–‡ä»¶è¿›è¡Œé“¾æ¥ã€‚æ‰€ä»¥æ­¤æ—¶é€è¿‡ preprocessor å¯ä»¥ä¿è¯ function prototype ä½äºå‡½æ•°è°ƒç”¨ä¹‹å‰ï¼Œå¯ä»¥è¿›è¡Œä¸¥æ ¼åœ°æ£€æŸ¥ã€‚ ","date":"2024-03-15","objectID":"/posts/c-function/:1:0","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"ç¼–ç¨‹è¯­è¨€çš„ function C è¯­è¨€ä¸å…è®¸ nested function ä»¥ç®€åŒ–ç¼–è¯‘å™¨çš„è®¾è®¡ (å½“ç„¶ç°åœ¨çš„ gcc æä¾› nested funtion çš„æ‰©å±•)ï¼Œå³ C è¯­è¨€çš„ function æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œä½äºè¯­æ³•æœ€é¡¶å±‚ (top-level)ï¼Œå› ä¸ºæ”¯æŒ nested function éœ€è¦ staic link æœºåˆ¶æ¥ç¡®è®¤å¤–å±‚å‡½æ•°ã€‚ ç¼–ç¨‹è¯­è¨€ä¸­çš„å‡½æ•°ï¼Œä¸æ•°å­¦çš„å‡½æ•°ä¸å®Œå…¨ä¸€è‡´ï¼Œç¼–ç¨‹è¯­è¨€çš„å‡½æ•°éšå«äº†çŠ¶æ€æœºçš„è½¬æ¢è¿‡ç¨‹ (å³æœ‰ side effect)ï¼Œåªæœ‰æ‹¥æœ‰ Referential Transparency ç‰¹æ€§çš„å‡½æ•°ï¼Œæ‰èƒ½å’Œæ•°å­¦ä¸Šçš„å‡½æ•°ç­‰ä»·ã€‚ ","date":"2024-03-15","objectID":"/posts/c-function/:2:0","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"Process ä¸ C ç¨‹åº ç¨‹åºå­˜æ”¾åœ¨ç£ç›˜æ—¶å« Programï¼ŒåŠ è½½åˆ°å†…å­˜åå« â€œProcessâ€ Wikipedia: Application binary interface In computer software, an application binary interface (ABI) is an interface between two binary program modules. Often, one of these modules is a library or operating system facility, and the other is a program that is being run by a user. åœ¨ Intel x86 æ¶æ„ä¸­ï¼Œå½“è¿”å›å€¼å¯ä»¥æ”¾åœ¨å¯„å­˜å™¨æ—¶å°±æ”¾åœ¨å¯„å­˜å™¨ä¸­è¿”å›ï¼Œä»¥æé«˜æ•ˆèƒ½ï¼Œå¦‚æœæ”¾ä¸ä¸‹ï¼Œåˆ™å°†è¿”å›å€¼çš„èµ·å§‹åœ°å€æ”¾åœ¨å¯„å­˜å™¨ä¸­è¿”å›ã€‚ ","date":"2024-03-15","objectID":"/posts/c-function/:3:0","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"stack ","date":"2024-03-15","objectID":"/posts/c-function/:4:0","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"Layout System V Application Binary Interface AMD64 Architecture Processor Supplement [PDF] ","date":"2024-03-15","objectID":"/posts/c-function/:4:1","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"PEDA å®éªŒéœ€è¦ä½¿ç”¨åˆ° GDB çš„ PEDA æ‰©å±•: Enhance the display of gdb: colorize and display disassembly codes, registers, memory information during debugging. $ git clone https://github.com/longld/peda.git ~/peda $ echo \"source ~/peda/peda.py\" \u003e\u003e ~/.gdbinit æŠ€å·§ åŠ¨æ€è¿½è¸ª Stack å®éªŒçš„ call funcA å¯ä»¥é€šè¿‡ GDB æŒ‡ä»¤ stepi æˆ– si æ¥å®ç° ","date":"2024-03-15","objectID":"/posts/c-function/:4:2","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"stack-based buffer overflow ","date":"2024-03-15","objectID":"/posts/c-function/:4:3","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"ROP ","date":"2024-03-15","objectID":"/posts/c-function/:5:0","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"heap ä½¿ç”¨ malloc æ—¶æ“ä½œç³»ç»Ÿå¯èƒ½ä¼š overcommitï¼Œè€Œæ­£å› ä¸ºè¿™ä¸ª overcommit çš„ç‰¹æ€§ï¼Œmalloc è¿”å›æœ‰æ•ˆåœ°å€ä¹Ÿä¸è§å¾—æ˜¯å®‰å…¨çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå› ä¸º overcommitï¼Œä½¿ç”¨ malloc åç«‹å³æ­é…ä½¿ç”¨ memset ä»£ä»·ä¹Ÿå¾ˆé«˜ (å› ä¸ºæ“ä½œç³»ç»Ÿ overcommit å¯èƒ½ä¼šå…ˆåˆ†é…ä¸€ä¸ªå°ç©ºé—´è€Œä¸æ˜¯ä¸€ä¸‹å­åˆ†é…å…¨éƒ¨ï¼Œå› ä¸ºå®ƒä¼˜å…ˆé‡å¤ä½¿ç”¨ä¹‹å‰å·²ä½¿ç”¨è¿‡çš„å°å—ç©ºé—´)ï¼Œå¹¶ä¸”å¦‚æœæ˜¯è®¾ç½®ä¸º 0ï¼Œåˆ™æœ‰å¯èƒ½ä¼šå¯¹åŸæœ¬ä¸º 0 çš„ç©ºé—´è¿›è¡Œé‡å¤è®¾ç½®ï¼Œé™ä½æ•ˆèƒ½ã€‚æ­¤æ—¶å¯ä»¥åº”è¯¥å–„ç”¨ callocï¼Œè™½ç„¶ä¹Ÿä¼š overcommitï¼Œä½†æ˜¯ä¼šä¿è¯åˆ†é…ç©ºé—´çš„å‰é¢éƒ½æ˜¯ 0 (å› ä¸ºä¼˜å…ˆåˆ†é…çš„æ˜¯éœ€è¦æ“ä½œç³»ç»Ÿå‚ä¸çš„å¤§å—ç©ºé—´)ï¼Œæ— éœ€ä½¿ç”¨ memset è¿™ç±»æ“ä½œè€Œé™ä½æ•ˆèƒ½ã€‚ ","date":"2024-03-15","objectID":"/posts/c-function/:6:0","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"malloc / free ","date":"2024-03-15","objectID":"/posts/c-function/:6:1","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"RAII ","date":"2024-03-15","objectID":"/posts/c-function/:7:0","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["C","Linux Kernel Internals"],"content":"setjmp \u0026 longjmp setjmp(3) â€” Linux manual page The functions described on this page are used for performing â€œnonlocal gotosâ€: transferring execution from one function to a predetermined location in another function. The setjmp() function dynamically establishes the target to which control will later be transferred, and longjmp() performs the transfer of execution. å…·ä½“è§£è¯´å¯ä»¥é˜…è¯» lab0-c çš„ã€Œè‡ªå‹•æ¸¬è©¦ç¨‹å¼ã€éƒ¨åˆ† ","date":"2024-03-15","objectID":"/posts/c-function/:8:0","tags":["Sysprog","C","Function"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°è°ƒç”¨ç¯‡","uri":"/posts/c-function/"},{"categories":["Concurrency","Linux Kernel Internals"],"content":"Happens-before çŸ­ç‰‡: Happened Before Relationship Happened Before Relation (cont) ","date":"2024-03-11","objectID":"/posts/concurrency-ordering/:1:0","tags":["Sysprog","Linux","Concurrency"],"title":"å¹¶è¡Œç¨‹åºè®¾è®¡: æ‰§è¡Œé¡ºåº","uri":"/posts/concurrency-ordering/"},{"categories":["Concurrency","Linux Kernel Internals"],"content":"Memory Consistency Models æŠ€å·§ ç›¸å…³è®ºæ–‡/æŠ€æœ¯æŠ¥å‘Š (å¯ä»¥ç”¨æ¥å‚è€ƒç†è§£): Shared Memory Consistency Models: A Tutorial 1995 Sarita V. Adve, Kourosh Gharachorloo ","date":"2024-03-11","objectID":"/posts/concurrency-ordering/:2:0","tags":["Sysprog","Linux","Concurrency"],"title":"å¹¶è¡Œç¨‹åºè®¾è®¡: æ‰§è¡Œé¡ºåº","uri":"/posts/concurrency-ordering/"},{"categories":["Concurrency","Linux Kernel Internals"],"content":" é€è¿‡å»ºç«‹ Concurrency å’Œ Parallelismã€Mutex ä¸ Semaphore çš„åŸºæœ¬æ¦‚å¿µï¼Œæœ¬è®²åº§å°†é€è¿‡ POSIX Tread æ¢è®¨ thread pool, Lock-Free Programming, lock-free ä½¿ç”¨çš„ atomic æ“ä½œ, memory ordering, M:N threading model ç­‰è¿›é˜¶è®®é¢˜ã€‚ åŸæ–‡åœ°å€ ","date":"2024-03-08","objectID":"/posts/concurrency-concepts/:0:0","tags":["Sysprog","Linux","Concurrency"],"title":"å¹¶è¡Œç¨‹åºè®¾è®¡: æ¦‚å¿µ","uri":"/posts/concurrency-concepts/"},{"categories":["Concurrency","Linux Kernel Internals"],"content":"Mutex ä¸ Semaphore Mutex å’Œ Semaphore åœ¨å®ä½œä¸Šå¯èƒ½æ˜¯æ²¡æœ‰å·®å¼‚çš„ (ä¾‹å¦‚æ—©æœŸçš„ Linux)ï¼Œä½†æ˜¯ Mutex ä¸ Semaphore åœ¨ä½¿ç”¨ä¸Šæ˜¯æœ‰æ˜¾è‘—å·®å¼‚çš„: process ä½¿ç”¨ Mutex å°±åƒä½¿ç”¨ä¸€æŠŠé”ï¼Œè°å…ˆè·‘å¾—å¿«å°±èƒ½å…ˆè·å¾—é”ï¼Œé‡Šæ”¾é” â€œè§£é“ƒè¿˜é¡»ç³»é“ƒäººâ€ï¼Œå¹¶ä¸”é‡Šæ”¾é”åä¸ä¸€å®šèƒ½ç«‹å³è°ƒåº¦åˆ°ç­‰å¾…é”çš„ process (å¦‚æœæƒ³ç«‹å³è°ƒåº¦åˆ°ç­‰å¾…é”çš„ process éœ€è¦è¿›è¡Œæ˜¾å¼è°ƒåº¦) process ä½¿ç”¨ Semaphore å°±å¦‚åŒå®ƒçš„åå­—ç±»ä¼¼ â€œä¿¡å·æªâ€ï¼Œprocess è¦ä¹ˆæ˜¯ç­‰å¾…ä¿¡å·çš„é€‰æ‰‹ï¼Œè¦ä¹ˆæ˜¯å‘å‡ºä¿¡å·çš„è£åˆ¤ï¼Œå¹¶ä¸”è£åˆ¤åœ¨å‘å‡ºä¿¡å·åï¼Œé€‰æ‰‹å¯ä»¥ç«‹å³æ”¶åˆ°ä¿¡å·å¹¶è°ƒåº¦ (æ— éœ€æ˜¾å¼è°ƒåº¦)ã€‚å¹¶ä¸æ˜¯ä½ è·‘å¾—å¿«å°±å¯ä»¥å…ˆè·å¾—ï¼Œå¦‚æœä½ æ˜¯é€‰æ‰‹ï¼Œè·‘å¾—å¿«ä½ ä¹Ÿå¾—åœä¸‹æ¥ç­‰è£åˆ¤åˆ°åœºå‘å‡ºä¿¡å· ğŸ¤£ æ³¨æ„ å…³äº Mutex ä¸ Semphore åœ¨ä½¿ç”¨æ‰‹æ³•ä¸Šçš„å·®å¼‚ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä½¿ç”¨ Rust å®ç°çš„ Channelï¼Œé‡Œé¢çš„ Share\u003cT\u003e ç»“æ„ä½“åŒ…å«äº† Mutex å’Œ Semphoreï¼ŒæŸ¥çœ‹ç›¸å…³æ–¹æ³• (send å’Œ recv) æ¥ç ”ç©¶å®ƒä»¬åœ¨ä½¿ç”¨æ‰‹æ³•çš„å·®å¼‚ã€‚ é™¤æ­¤ä¹‹å¤–ï¼ŒSemaphore çš„é€‰æ‰‹å’Œè£åˆ¤çš„æ•°é‡æ¯”ä¾‹ä¸ä¸€å®šæ˜¯ $1:1$ï¼Œå¯ä»¥æ˜¯ $m:n$ ","date":"2024-03-08","objectID":"/posts/concurrency-concepts/:1:0","tags":["Sysprog","Linux","Concurrency"],"title":"å¹¶è¡Œç¨‹åºè®¾è®¡: æ¦‚å¿µ","uri":"/posts/concurrency-concepts/"},{"categories":["Concurrency","Linux Kernel Internals"],"content":"CTSS Fernando J. Corbato: 1963 Timesharing: A Solution to Computer Bottlenecks ","date":"2024-03-08","objectID":"/posts/concurrency-concepts/:2:0","tags":["Sysprog","Linux","Concurrency"],"title":"å¹¶è¡Œç¨‹åºè®¾è®¡: æ¦‚å¿µ","uri":"/posts/concurrency-concepts/"},{"categories":["Concurrency","Linux Kernel Internals"],"content":"å¯é‡å…¥æ€§ (Reentrancy) ä¸€å€‹å¯å†é€²å…¥ (reentrancy) çš„å‡½å¼æ˜¯å¯è¢«å¤šå€‹å·¥ä½œåŒæ™‚å‘¼å«ï¼Œè€Œä¸æœƒæœ‰è³‡æ–™ä¸ä¸€è‡´çš„å•é¡Œã€‚ç°¡å–®ä¾†èªªï¼Œä¸€å€‹å¯å†é€²å…¥çš„å‡½å¼ï¼Œæœƒé¿å…åœ¨å‡½å¼ä¸­ä½¿ç”¨ä»»ä½•å…±äº«è¨˜æ†¶å€ (global memory)ï¼Œæ‰€æœ‰çš„è®Šæ•¸èˆ‡è³‡æ–™å‡å­˜åœ¨å‘¼å«è€…çš„è³‡æ–™å€æˆ–å‡½å¼æœ¬èº«çš„å †ç–Šå€ (stack memory)ã€‚ ","date":"2024-03-08","objectID":"/posts/concurrency-concepts/:3:0","tags":["Sysprog","Linux","Concurrency"],"title":"å¹¶è¡Œç¨‹åºè®¾è®¡: æ¦‚å¿µ","uri":"/posts/concurrency-concepts/"},{"categories":["Concurrency","Linux Kernel Internals"],"content":"Concurrency å’Œ Parallelism Rob Pike: Concurrency Is Not Parallelism / slides Stack Overflow ä¸Šçš„ç›¸å…³è®¨è®º Concurrency æ˜¯æŒ‡ç¨‹å¼æ¶æ§‹ï¼Œå°‡ç¨‹å¼æ‹†é–‹æˆå¤šå€‹å¯ç¨ç«‹é‹ä½œçš„å·¥ä½œã€‚æ¡ˆä¾‹: è£ç½®é©…å‹•ç¨‹å¼ï¼Œå¯ç¨ç«‹é‹ä½œï¼Œä½†ä¸éœ€è¦å¹³è¡ŒåŒ–ã€‚ Parallelism æ˜¯æŒ‡ç¨‹å¼åŸ·è¡Œï¼ŒåŒæ™‚åŸ·è¡Œå¤šå€‹ç¨‹å¼ã€‚Concurrency å¯èƒ½æœƒç”¨åˆ° parallelismï¼Œä½†ä¸ä¸€å®šè¦ç”¨ parallelism æ‰èƒ½å¯¦ç¾ concurrencyã€‚æ¡ˆä¾‹: å‘é‡å…§ç©è¨ˆç®— Concurrent, non-parallel execution Concurrent, parallel execution Tim Mattson (Intel): Introduction to OpenMP [YouTube] ","date":"2024-03-08","objectID":"/posts/concurrency-concepts/:4:0","tags":["Sysprog","Linux","Concurrency"],"title":"å¹¶è¡Œç¨‹åºè®¾è®¡: æ¦‚å¿µ","uri":"/posts/concurrency-concepts/"},{"categories":["RISC-V","Operating Systems"],"content":" æœ¬æ–‡å¯¹é€šè¿‡ QEMU ä»¿çœŸ RISC-V ç¯å¢ƒå¹¶å¯åŠ¨ OpenEuler RISC-V ç³»ç»Ÿçš„æµç¨‹è¿›è¡Œè¯¦ç»†ä»‹ç»ï¼Œä»¥åŠä»‹ç»å¦‚ä½•é€šè¿‡ mugen æµ‹è¯•æ¡†æ¶æ¥å¯¹ RISC-V ç‰ˆæœ¬çš„ openEuler è¿›è¡Œç³»ç»Ÿã€è½¯ä»¶ç­‰æ–¹é¢æµ‹è¯•ï¼Œå¹¶æ ¹æ®æµ‹è¯•æ—¥å¿—å¯¹é”™è¯¯åŸå› è¿›è¡Œåˆ†æã€‚ ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:0:0","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"å®éªŒç¯å¢ƒ æ“ä½œç³»ç»Ÿ: deepin 20.9 ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:1:0","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"å®‰è£…æ”¯æŒ RISC-V æ¶æ„çš„ QEMU æ¨¡æ‹Ÿå™¨ $ sudo apt install qemu-system-misc $ qemu-system-riscv64 --version QEMU emulator version 5.2.0 (Debian 1:5.2+dfsg-11+deb11u1) Copyright (c) 2003-2020 Fabrice Bellard and the QEMU Project developers è™½ç„¶ deepin ä»“åº“æä¾›çš„ QEMU è½¯ä»¶åŒ…ç‰ˆæœ¬æ¯”è¾ƒä½ (5.2.0)ï¼Œä½†æ˜¯æ ¹æ®ã€Œå¼•ç”¨æ–‡æ¡£ã€çš„è¯´æ˜ï¼Œä¸ä½äº 5.0 å³å¯ é€šè¿‡ä¸Šé¢å®‰è£…çš„ QEMU ç‰ˆæœ¬è¿‡ä½ï¼Œæ— æ³•æ”¯æŒ VGA è¿™ç±»è™šæ‹Ÿå¤–è®¾ (virtio)ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–è¯‘å®‰è£…: å¦‚æœä¹‹å‰é€šè¿‡ apt å®‰è£…äº† QEMU çš„å¯ä»¥å…ˆè¿›è¡Œå¸è½½: $ sudo apt remove qemu-system-risc $ sudo apt autoremove å®‰è£…å¿…è¦çš„æ„å»ºå·¥å…·: $ sudo apt install build-essential git libglib2.0-dev libfdt-dev libpixman-1-dev zlib1g-dev ninja-build libslirp-dev ä¸‹è½½ QEMU æºç åŒ… (æ­¤å¤„ä»¥ 7.2 ç‰ˆæœ¬ä¸ºä¾‹): $ wget https://download.qemu.org/qemu-7.2.0.tar.xz è§£å‹æºç åŒ…ã€ä¿®æ”¹åç§°: $ tar xvJf qemu-7.2.0.tar.xz $ mv qemu-7.2.0 qemu è¿›å…¥ qemu å¯¹åº”ç›®å½•å¹¶é…ç½®ç¼–è¯‘é€‰é¡¹: $./configure ç¼–è¯‘å®‰è£…: $ sudo make -j$(nproc) åœ¨ ~/.bashrc ä¸­æ·»åŠ ç¯å¢ƒå˜é‡: export PATH=$PATH:/path/to/qemu/build åˆ·æ–°ä¸€ä¸‹ ~/.bashrc (æˆ–æ–°å¼€ä¸€ä¸ªç»ˆç«¯) æŸ¥çœ‹ä¸€ä¸‹ QEMU æ˜¯å¦å®‰è£…æˆåŠŸ: $ source ~/.bashrc $ qemu-system-riscv64 --version QEMU emulator version 7.2.0 Copyright (c) 2003-2022 Fabrice Bellard and the QEMU Project developers ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:2:0","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"ä¸‹è½½ openEuler RISC-V ç³»ç»Ÿé•œåƒ å®éªŒæŒ‡å®šçš„æµ‹è¯•é•œåƒ (å½“ç„¶å¦‚æœä¸æ˜¯å®éªŒæŒ‡å®šçš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„é•œåƒ): https://repo.tarsier-infra.com/openEuler-RISC-V/preview/openEuler-23.09-V1-riscv64/QEMU/ ç”±äºæˆ‘æ˜¯ç›´æ¥ä½¿ç”¨ ssh è¿æ¥ openEuler RISC-V çš„ QEMU è™šæ‹Ÿæœºï¼Œæ‰€ä»¥åªä¸‹è½½äº†: fw_payload_oe_uboot_2304.bin å¯åŠ¨ç”¨å†…æ ¸ openEuler-23.09-V1-base-qemu-preview.qcow2.zst ä¸å¸¦æœ‰æ¡Œé¢é•œåƒçš„æ ¹æ–‡ä»¶ç³»ç»Ÿ start_vm.sh å¯åŠ¨ä¸å¸¦æœ‰æ¡Œé¢é•œåƒçš„æ ¹æ–‡ä»¶ç³»ç»Ÿç”¨è„šæœ¬ $ wget https://repo.tarsier-infra.com/openEuler-RISC-V/preview/openEuler-23.09-V1-riscv64/QEMU/fw_payload_oe_uboot_2304.bin $ wget https://repo.tarsier-infra.com/openEuler-RISC-V/preview/openEuler-23.09-V1-riscv64/QEMU/openEuler-23.09-V1-base-qemu-preview.qcow2.zst $ wget https://repo.tarsier-infra.com/openEuler-RISC-V/preview/openEuler-23.09-V1-riscv64/QEMU/start_vm.sh è§£å‹ç¼©æ ¹æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜æ˜ åƒ: # install unzip tool zstd for zst $ sudo apt install zstd $ unzstd openEuler-23.09-V1-base-qemu-preview.qcow2.zst ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:3:0","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"å¯åŠ¨ openEuler RISC-V ç³»ç»Ÿå¹¶è¿æ¥ ç¡®è®¤å½“å‰åœ¨åˆšåˆšä¸‹è½½äº†å†…æ ¸ã€æ ¹æ–‡ä»¶ç³»ç»Ÿã€å¯åŠ¨è„šæœ¬çš„ç›®å½•ï¼Œç„¶ååœ¨ä¸€ä¸ªç»ˆç«¯ä¸Šæ‰§è¡Œå¯åŠ¨è„šæœ¬: $ bash start_vm.sh å®‰å¿ƒç­‰å¾…è¾“å‡ºå®Œæ¯•å‡ºç°æç¤ºç™»å½•ç•Œé¢ (æ—¶é—´å¯èƒ½ä¼šæœ‰ç‚¹é•¿)ï¼Œç„¶åè¾“å…¥è´¦å·å’Œå¯†ç è¿›è¡Œç™»å½•å³å¯ æˆ–è€…å¯åŠ¨ QEMU è™šæ‹Ÿæœºåï¼Œæ–°å¼€ä¸€ä¸ªç»ˆç«¯é€šè¿‡ ssh è¿›è¡Œç™»å½•: $ ssh -p 12055 root@localhost $ ssh -p 12055 openeuler@localhost é€šè¿‡ exit å‘½ä»¤å¯ä»¥é€€å‡ºå½“å‰ç™»å½•è´¦å·ï¼Œé€šè¿‡å¿«æ·é”® Ctrl + A, X å¯ä»¥å…³é—­ QEMU è™šæ‹Ÿæœº (æœ¬è´¨ä¸Šæ˜¯ä¿¡å· signal å¤„ç† ğŸ¤£) å»ºè®®ç™»å½•åä¿®æ”¹è´¦å·çš„å¯†ç  (ç›¸å…³å‘½ä»¤: passwd) ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:4:0","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"Mugen æµ‹è¯•æ¡†æ¶ æ ¹æ® ã€Œmugenã€ README çš„ä½¿ç”¨æ•™ç¨‹ï¼Œåœ¨æŒ‡å®šæµ‹è¯•é•œåƒä¸Šå®Œæˆ ã€Œå®‰è£…ä¾èµ–è½¯ä»¶ã€ã€Œé…ç½®æµ‹è¯•å¥—ç¯å¢ƒå˜é‡ã€ã€Œç”¨ä¾‹æ‰§è¡Œã€è¿™ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå¹¶ç»™å‡ºå®éªŒæ€»ç»“ ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:5:0","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"å®‰è£… git \u0026 å…‹éš† mugen ä»“åº“ ç™»å½•æ™®é€šç”¨æˆ· openeuler ç„¶åå‘ç°æ­¤æ—¶æ²¡æœ‰å®‰è£… git æ— æ³•å…‹éš† mugen ä»“åº“ï¼Œå…ˆå®‰è£… git: $ sudo dnf install git $ git clone https://gitee.com/openeuler/mugen.git åŸå§‹è®¾å®šçš„ vim é…ç½®ä¸å¤ªä¼˜é›…ï¼Œæˆ‘æ ¹æ®æˆ‘çš„ vim é…ç½®è¿›è¡Œäº†è®¾ç½®ï¼Œå…·ä½“è§ ã€ŒVim é…ç½®ã€ ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:5:1","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"å®‰è£…ä¾èµ–è½¯ä»¶ è¿›å…¥ mugen ç›®å½•æ‰§è¡Œå®‰è£…ä¾èµ–è½¯ä»¶è„šæœ¬ (å› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯æ™®é€šç”¨æˆ·ï¼Œéœ€è¦ä½¿ç”¨ sudo æé«˜æƒçº§): $ sudo bash dep_install.sh ... Complete! ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:5:2","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"é…ç½®æµ‹è¯•å¥—ç¯å¢ƒå˜é‡ $ sudo bash mugen.sh -c --ip $ip --password $passwd --user $user --port $port è¿™éƒ¨åˆ†ä»“åº“çš„æ–‡æ¡£å¯¹äºæœ¬æœºæµ‹è¯•æ²¡æœ‰å¾ˆæ¸…æ¥šåœ°è¯´æ˜ï¼Œå‚è€ƒæ–‡ç«  ã€ŒåŸºäºopenEulerè™šæ‹Ÿæœºæœ¬åœ°æ‰§è¡Œmugenæµ‹è¯•è„šæœ¬ã€å®Œæˆé…ç½® æ‰§è¡Œå®Œæˆåä¼šå¤šå‡ºä¸€ä¸ªç¯å¢ƒå˜é‡æ–‡ä»¶ ./conf/env.json ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:5:3","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"ç”¨ä¾‹æ‰§è¡Œ \u0026 ç»“æœåˆ†æ æˆ‘å¯¹äº openEuler RISC-V æ˜¯å¦æ”¯æŒäº† binutils æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œä¾¿è¿›è¡Œäº†æµ‹è¯•: $ sudo bash mugen.sh -f binutils -x ... INFO - A total of 8 use cases were executed, with 8 successes 0 failures and 0 skips. æ‰§è¡Œç»“æœæ˜¾ç¤ºå·²æ­£ç¡®æ”¯æŒ binutils æ¥ä¸‹æ¥å¯¹ç¨‹åºé™æ€åˆ†æå·¥å…· cppcheck çš„æ”¯æŒè¿›è¡Œæµ‹è¯•: $ sudo bash mugen.sh -f cppcheck -x ... INFO - A total of 2 use cases were executed, with 1 successes 1 failures and 0 skips. æ ¹æ®æ–‡æ¡£ suite2cases ä¸­ jsonæ–‡ä»¶çš„å†™æ³• çš„è§£é‡Šï¼Œåˆ†æåˆšåˆšæ‰§è¡Œçš„æµ‹è¯•å¥— suit2cases/cppcheck.jsonï¼Œæ˜¯æµ‹è¯•ç”¨ä¾‹ oe_test_cppcheck å¤±è´¥äº†ã€‚ è§‚å¯Ÿè¯¥ç”¨ä¾‹å¯¹åº”çš„è„šæœ¬ testcases/cli-test/cppcheck/oe_test_cppcheck/oe_test_cppcheck.shï¼Œå¹¶æ‰“å¼€å¯¹åº”çš„æ—¥å¿— logs/cppcheck/oe_test_cppcheck/$(date).log åœ¨é‡Œé¢æ£€ç´¢ LOG_ERRORï¼Œæ‰¾åˆ°ä¸¤å¤„ç›¸å…³é”™è¯¯: + LOG_ERROR 'oe_test_cppcheck.sh line 70' + LOG_ERROR 'oe_test_cppcheck.sh line 95' æ¯”ç…§ç”¨ä¾‹è„šæœ¬ï¼Œå¯¹åº”çš„æµ‹è¯•é€»è¾‘æ˜¯: cppcheck --std=c99 --std=posix test.cpp 70--\u003e CHECK_RESULT $? if [ $VERSION_ID != \"22.03\" ]; then cppcheck -DA --force file.c | grep \"A=1\" 95--\u003e CHECK_RESULT $? 1 else cppcheck -DA --force file.c | grep \"A=1\" CHECK_RESULT $? fi Cppcheck manual P11 The flag -D tells Cppcheck that a name is defined. There will be no Cppcheck analysis without this define. The flag â€“force and â€“max-configs is used to control how many combinations are checked. When -D is used, Cppcheck will only check 1 configuration unless these are used. è¿™é‡Œé¢ CHECK_RESULT æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ shell å‡½æ•°ï¼Œæ‰«ä¸€ä¸‹ mugen çš„åº“ç›®å½• libsï¼Œåœ¨ locallibs/common_lib.sh é‡Œæ‰¾åˆ°è¯¥å‡½æ•°çš„å®šä¹‰ï¼Œå®ƒçš„é€»è¾‘æ¯”è¾ƒå¥½æ‡‚ (ç±»ä¼¼äº assert)ï¼Œä½†æ˜¯å‡½æ•°å¼€å¤´çš„å˜é‡å®šä¹‰è®©æˆ‘æœ‰äº›è¿·ç³Šï¼Œäºæ˜¯æ±‚æ•™äº GPT: actual_result=$1 expect_result=${2-0} mode=${3-0} error_log=$4 GPT: actual_result å˜é‡è¢«èµ‹å€¼ä¸ºç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ã€‚ expect_result å˜é‡è¢«èµ‹å€¼ä¸ºç¬¬äºŒä¸ªå‚æ•°çš„å€¼ï¼Œå¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸å­˜åœ¨ï¼Œåˆ™é»˜è®¤ä¸º 0ã€‚ mode å˜é‡è¢«èµ‹å€¼ä¸ºç¬¬ä¸‰ä¸ªå‚æ•°çš„å€¼ï¼Œå¦‚æœç¬¬ä¸‰ä¸ªå‚æ•°ä¸å­˜åœ¨ï¼Œåˆ™é»˜è®¤ä¸º 0ã€‚ error_log å˜é‡è¢«èµ‹å€¼ä¸ºç¬¬å››ä¸ªå‚æ•°çš„å€¼ã€‚ æ‰€ä»¥ï¼Œæ¶‰åŠé”™è¯¯çš„ä¸¤ä¸ªæµ‹è¯•é€»è¾‘éƒ½å¾ˆå¥½ç†è§£äº†: CHECK_RESULT $? è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤è¿”å›å€¼çš„é¢„æœŸæ˜¯ 0 CHECK_RESULT $? 1 è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤è¿”å›å€¼çš„é¢„æœŸæ˜¯ 1 æ¥ä¸‹æ¥æˆ‘ä»¬å°±å®é™…æµ‹è¯•ä¸€ä¸‹è¿™ä¸¤ä¸ªç”¨ä¾‹: å®‰è£… cppcheck: $ sudo dnf install cppcheck æ‰§è¡Œæµ‹è¯•è„šæœ¬ 70 è¡Œå¯¹åº”çš„ä¸Šä¸€æ¡å‘½ä»¤: $ cppcheck --std=c99 --std=posix test.cpp cppcheck: error: unknown --std value 'posix' $ echo $? 1 æµ‹è¯•å¤±è´¥åŸå› æ˜¯ cppcheck risc-v ç‰ˆæœ¬ä¸æ”¯æŒæŒ‡å®š C/C++ æ ‡å‡†ä¸º posix (åŒæ—¶æŸ¥è¯¢äº†ä¸‹ ã€Œcppcheck manualã€ç›®å‰ cppcheck æ”¯æŒçš„æ ‡å‡†é‡Œå¹¶æœªåŒ…æ‹¬ posix) æ‰§è¡Œæµ‹è¯•è„šæœ¬ 95 è¡Œå¯¹åº”çš„ä¸Šä¸€æ¡å‘½ä»¤: $ cppcheck -DA --force file.c | grep \"A=1\" Checking file.c: A=1... file.c:5:6: error: Array 'a[10]' accessed at index 10, which is out of bounds. [arrayIndexOutOfBounds] a[10] = 0; ^ $ echo $? 0 æµ‹è¯•å¤±è´¥åŸå› æ˜¯ grep åœ¨ä¹‹å‰çš„ cppcheck çš„è¾“å‡ºé‡ŒåŒ¹é…åˆ° A=1ï¼Œæ‰€ä»¥å¯¼è‡´è¿”å›å€¼ä¸º 0ã€‚è¿™éƒ¨åˆ†æµ‹è¯•çš„é€»è¾‘æ˜¯: ä»…å¯¹äº 22.03 ç‰ˆæœ¬ openEuler ä¸Šçš„ cppcheck åœ¨ä»¥å‚æ•° -DA æ‰§è¡Œæ—¶æ‰ä¼šè¾“å‡ºåŒ…å« A=1 çš„ä¿¡æ¯ï¼Œä½†æ˜¯ä¸ªäººçŒœæµ‹æ˜¯åœ¨æ¯” 22.03 åŠæ›´é«˜ç‰ˆæœ¬çš„ openEuler ä¸Šä½¿ç”¨ cppcheck æ­é… -DA éƒ½å¯ä»¥è¾“å‡ºåŒ…å« A=1 çš„ä¿¡æ¯ ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:5:4","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"å®éªŒæ€»ç»“å’Œè®¨è®º åˆæ­¥ä½“éªŒäº†ä½¿ç”¨ QEMU æ„å»º openEuler RISC-V ç³»ç»Ÿè™šæ‹Ÿæœºçš„æµç¨‹ï¼Œä»¥åŠä½¿ç”¨ ssh è¿æ¥ QEMU è™šæ‹Ÿæœºçš„æŠ€å·§ã€‚å®éªŒè¿‡ç¨‹ä¸­æœ€å¤§æ„Ÿè§¦æ˜¯ mugen çš„æ–‡æ¡£ï¼Œç›¸å¯¹äº cppcheck è¿™ç±»äº§å“çš„æ–‡æ¡£ï¼Œä¸å¤Ÿè¯¦ç»†ï¼Œå¾ˆå¤šå†…å®¹éœ€è¦é˜…è¯»æºç æ¥ç†è§£ (å¥½å¤„æ˜¯ç²¾è¿›äº†æˆ‘å¯¹ shell è„šæœ¬ç¼–ç¨‹çš„ç†è§£ ğŸ¤£)ã€‚ æˆ‘ä¸ªäººæ¯”è¾ƒæœŸå¾… RISC-V é…åˆ nommu åœ¨åµŒå…¥å¼è¿™ç±»ä½åŠŸè€—é¢†åŸŸçš„å‘å±•ï¼ŒåŒæ—¶ä¹Ÿå¯¹ RISC-V Hypervisor Extension åœ¨è™šæ‹ŸåŒ–æ–¹é¢çš„å‘å±•æ„Ÿå…´è¶£ã€‚ ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:5:5","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["RISC-V","Operating Systems"],"content":"References openEuler RISC-V: é€šè¿‡ QEMU ä»¿çœŸ RISC-V ç¯å¢ƒå¹¶å¯åŠ¨ OpenEuler RISC-V ç³»ç»Ÿ openEuler RISC-V: ä½¿ç”¨ QEMU å®‰è£… openEuler RISC-V 23.03 Ariel Heleneto: é€šè¿‡ QEMU ä»¿çœŸ RISC-V ç¯å¢ƒå¹¶å¯åŠ¨ OpenEuler RISC-V ç³»ç»Ÿ openEuler: mugen openEuler Docs: ä½¿ç”¨ DNF ç®¡ç†è½¯ä»¶åŒ… åŸºäº openEuler è™šæ‹Ÿæœºæœ¬åœ°æ‰§è¡Œ mugen æµ‹è¯•è„šæœ¬ Video: Mugen æ¡†æ¶çš„ä½¿ç”¨ https://openbuildservice.org/help/manuals/obs-user-guide/ https://gitee.com/openEuler/RISC-V#/openeuler/RISC-V/ https://gitee.com/zxs-un/doc-port2riscv64-openEuler ","date":"2024-03-07","objectID":"/posts/openeuler-riscv-qemu/:6:0","tags":["RISC-V","openEuler","QEMU","Mugen"],"title":"openEuler RISC-V ç³»ç»Ÿ: QEMU ä»¿çœŸ","uri":"/posts/openeuler-riscv-qemu/"},{"categories":["C","Linux Kernel Internals"],"content":" å€Ÿç”±é˜…è¯» C è¯­è¨€æ ‡å‡†ç†è§£è§„èŒƒæ˜¯ç ”ç©¶ç³»ç»Ÿå®‰å…¨æœ€åŸºç¡€çš„æ­¥éª¤ï¼Œä½†å¾ˆå¤šäººéƒ½å¿½ç•¥é˜…è¯»è§„èŒƒè¿™ç‚¹ï¼Œè€Œæ­£å› å¯¹äºè§„èŒƒçš„ä¸äº†è§£ã€æ’°å†™ç¨‹åºçš„ä¸ä¸¥è°¨ï¼Œå¯¼è‡´æ¼æ´çš„äº§ç”Ÿçš„æ¡ˆä¾‹æ¯”æ¯”çš†æ˜¯ï¼Œä¾‹å¦‚ 2014 å¹´çš„ OpenSSL Heartbleed Attack1 ä¾¿æ˜¯ä¾¿æ˜¯å› ä¸ºä½¿ç”¨ memcpy ä¹‹é™…ç¼ºä¹å¯¹åº”å†…å­˜èŒƒå›´æ£€æŸ¥ï¼Œé€ æˆç›¸å½“å¤§çš„å±å®³ã€‚æœ¬æ–‡é‡æ–°æ¢³ç† C è¯­è¨€ç¨‹åºè®¾è®¡çš„ç»†èŠ‚ï¼Œå¹¶å€Ÿç”±è°ƒè¯•å™¨å¸®åŠ©ç†è§£ç¨‹åºçš„è¿ä½œã€‚ åŸæ–‡åœ°å€ ","date":"2024-03-05","objectID":"/posts/c-std-security/:0:0","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"ç›®æ ‡ å€Ÿç”±ç ”è¯»æ¼æ´ç¨‹åºåŠ C è¯­è¨€æ ‡å‡†ï¼Œè®¨è®ºç³»ç»Ÿç¨‹åºçš„å®‰å…¨è®®é¢˜ é€šè¿‡è°ƒè¯•å™¨è¿½è¸ªç¨‹åºå®é™…è¿è¡Œçš„çŠ¶å†µï¼Œäº†è§£å…¶è¿ä½œåŸç† å–æè‡ª dangling pointer, CWE-416 Use After Free, CVE-2017-16943 ä»¥åŠ integer overflow çš„è®®é¢˜ ","date":"2024-03-05","objectID":"/posts/c-std-security/:1:0","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"å®éªŒç¯å¢ƒ ç¼–è¯‘å™¨ç‰ˆæœ¬: gcc 11 è°ƒè¯•å™¨: GDB æ“ä½œç³»ç»Ÿ: Ubuntu Linux 22.04 ","date":"2024-03-05","objectID":"/posts/c-std-security/:2:0","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"ä¸»é¢˜ (ä¸€): Integer type èµ„æ–™å¤„ç† ","date":"2024-03-05","objectID":"/posts/c-std-security/:3:0","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"I. Integer Conversion \u0026 Integer Promotion #include \u003cstdint.h\u003e #include \u003cstdio.h\u003e unsigned int ui = 0; unsigned short us = 0; signed int si = -1; int main() { int64_t r1 = ui + si; int64_t r2 = us + si; printf(\"%lld %lld\\n\", r1, r2); } ä¸Šè¿°ç¨‹å¼ç æ‰§è¡Œç»“æœä¸º: r1 è¾“å‡ºä¸ºåè¿›åˆ¶çš„ 4294967295ï¼Œr2 è¾“å‡ºä¸ºåè¿›åˆ¶çš„ -1ã€‚è¿™ä¸ªç»“æœå’Œ C11 è§„æ ¼ä¹¦ä¸­æåˆ°çš„ Integer çš„ä¸¤ä¸ªç‰¹æ€§æœ‰å…³: Integer Conversion å’Œ Integer Promotionã€‚ (1) Integer Conversion C11 6.3.1.1 Boolean, characters, and integers Every integer type has an integer conversion rank defined as follows: No two signed integer types shall have the same rank, even if they hav e the same representation. The rank of a signed integer type shall be greater than the rank of any signed integer type with less precision. The rank of long long int shall be greater than the rank of long int, which shall be greater than the rank of int, which shall be greater than the rank of short int, which shall be greater than the rank of signed char. The rank of any unsigned integer type shall equal the rank of the corresponding signed integer type, if any. The rank of any standard integer type shall be greater than the rank of any extended integer type with the same width. The rank of any extended signed integer type relative to another extended signed integer type with the same precision is implementation-defined, but still subject to the other rules for determining the integer conversion rank. ä¾æ®ä¸Šè¿°æ ‡å‡†å¯æ’å‡º integer çš„ rank: long long int \u003e long int \u003e int \u003e short int \u003e signed char unsigned int == signed int, if they are both in same precision and same size (2) Integer Promotion å½“ integer è¿›è¡Œé€šå¸¸çš„ç®—æ•°è¿ç®— (Usual arithmetic) æ—¶ï¼Œä¼šå…ˆè¿›è¡Œ integer promotions è½¬æ¢æˆ int æˆ– unsigned int æˆ–è€…ä¿æŒä¸å˜ (è½¬æ¢åçš„è¿ç®—å­è¢«ç§°ä¸º promoted operands)ï¼Œç„¶å promoted operands å†æ ¹æ®è‡ªèº«ç±»å‹ä»¥åŠå¯¹åº”çš„ rank è¿›è¡Œ arithmetic conversionsï¼Œæœ€ç»ˆå¾—åˆ°ç»“æœçš„ç±»å‹ã€‚ C11 6.3.1.1 Boolean, characters, and integers If an int can represent all values of the original type (as restricted by the width, for a bit-field), the value is converted to an int; otherwise, it is converted to an unsigned int. These are called the integer promotions. All other types are unchanged by the integer promotions. C11 6.3.1.8 Usual arithmetic conversions Otherwise, the integer promotions are performed on both operands. Then the following rules are applied to the promoted operands: If both operands have the same type, then no further conversion is needed. Otherwise, if both operands have signed integer types or both have unsigned integer types, the operand with the type of lesser integer conversion rank is converted to the type of the operand with greater rank. Otherwise, if the operand that has unsigned integer type has rank greater or equal to the rank of the type of the other operand, then the operand with signed integer type is converted to the type of the operand with unsigned integer type. Otherwise, if the type of the operand with signed integer type can represent all of the values of the type of the operand with unsigned integer type, then the operand with unsigned integer type is converted to the type of the operand with signed integer type. Otherwise, both operands are converted to the unsigned integer type corresponding to the type of the operand with signed integer type. /* In the case that the rank is smaller than int */ char c1, c2; // Both of them are char c1 = c1 + c2; // Both are promoted to int, thus result of c1 becomes to integer /* In the case that the rank is same as int */ signed int si = -1; /* si \u0026 ui are at the same rank both are unchanged by the integer promotions */ unsigned int ui = 0; int result = si + ui; // si is converted to unsigned int, result is unsigned ","date":"2024-03-05","objectID":"/posts/c-std-security/:3:1","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"II. è¡ç”Ÿçš„å®‰å…¨è®®é¢˜: Integer Overflow Stack Overflow: What is an integer overflow error? ","date":"2024-03-05","objectID":"/posts/c-std-security/:3:2","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"ä¸»é¢˜ (äºŒ): Object çš„ç”Ÿå‘½å‘¨æœŸ ","date":"2024-03-05","objectID":"/posts/c-std-security/:4:0","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"I. Dangling Pointer C11 6.2.4 Storage durations of objects (2) The lifetime of an object is the portion of program execution during which storage is guaranteed to be reserved for it. An object exists, has a constant address, and retains its last-stored value throughout its lifetime. If an object is referred to outside of its lifetime, the behavior is undefined. The value of a pointer becomes indeterminate when the object it points to (or just past) reaches the end of its lifetime. Stack Overflow: What is a dangling pointer? When a pointer is pointing at the memory address of a variable but after some time that variable is deleted from that memory location while the pointer is still pointing to it, then such a pointer is known as a dangling pointer and this problem is known as the dangling pointer problem. æ‰€ä»¥åœ¨ object çš„ç”Ÿå‘½å‘¨æœŸç»“æŸåï¼Œåº”å°†æŒ‡å‘ object åŸæœ¬å¤„äºçš„å†…å­˜ç©ºé—´çš„æŒ‡é’ˆç½®ä¸º NULLï¼Œé¿å… dangling pointerã€‚ ","date":"2024-03-05","objectID":"/posts/c-std-security/:4:1","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"II. CWE-416 Use After Free OWASP: Using freed memory Referencing memory after it has been freed can cause a program to crash. The use of heap allocated memory after it has been freed or deleted leads to undefined system behavior and, in many cases, to a write-what-where condition. ","date":"2024-03-05","objectID":"/posts/c-std-security/:4:2","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"III. æ¡ˆä¾‹æ¢è®¨: CVE-2017-16943 Abusing UAF leads to Exim RCE Road to Exim RCE - Abusing Unsafe Memory Allocator in the Most Popular MTA ","date":"2024-03-05","objectID":"/posts/c-std-security/:4:3","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"å®éªŒç»“æœä¸éªŒè¯ Source ","date":"2024-03-05","objectID":"/posts/c-std-security/:5:0","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"(ã„§) Integer Promotion éªŒè¯ æµ‹è¯•ç¨‹å¼ç : #include \u003cstdint.h\u003e #include \u003cstdio.h\u003e unsigned int ui = 0; unsigned short us = 0; signed int si = -1; int main() { int64_t r1 = ui + si; int64_t r2 = us + si; printf(\"%lld %lld\\n\", r1, r2); } éªŒè¯ç»“æœ: $ gcc -g -o integer-promotion.o integer-promotion.c $ ./integer-promotion.o 4294967295 -1 ","date":"2024-03-05","objectID":"/posts/c-std-security/:5:1","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["C","Linux Kernel Internals"],"content":"(äºŒ) Object ç”Ÿå‘½å‘¨æœŸ æµ‹è¯•ç¨‹å¼ç : #include \u003cinttypes.h\u003e #include \u003cstdint.h\u003e #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e int main(int argc, char *argv[]) { char *p, *q; uintptr_t pv, qv; { char a = 3; p = \u0026a; pv = (uintptr_t) p; } { char b = 4; q = \u0026b; qv = (uintptr_t) q; } if (p != q) { printf(\"%p is different from %p\\n\", (void *) p, (void *) q); printf(\"%\" PRIxPTR \" is not the same as %\" PRIxPTR \"\\n\", pv, qv); } else { printf(\"Surprise!\\n\"); } return 0; } éªŒè¯ç»“æœ: $ gcc -g -o uaf.o uaf.c $ ./uaf.o Surprise! $ gcc -g -o uaf.o uaf.c -fsanitize-address-use-after-scope $ ./uaf.o 0x7ffca405c596 is different from 0x7ffca405c597 7ffca405c596 is not the same as 7ffca405c597 $ clang -g -o uaf.o uaf.c $ ./uaf.o 0x7fff86b298ff is different from 0x7fff86b298fe 7fff86b298ff is not the same as 7fff86b298fe gcc å¯ä»¥é€šè¿‡æ˜¾å¼æŒ‡å®šå‚æ•° -fsanitize-address-use-after-scope æ¥é¿å… Use-After-Scope çš„é—®é¢˜ï¼Œå¦åˆ™åœ¨ scope ç»“æŸåï¼Œæ¥ä¸‹æ¥çš„å…¶ä»– scope ä¼šä½¿ç”¨ä¹‹å‰å·²ç»“æŸçš„ scope çš„å†…å­˜ç©ºé—´ï¼Œä»è€Œé€ æˆ Use-After-Scope é—®é¢˜ (ä½¿ç”¨ GDB åœ¨ä¸Šé¢ä¸¤ç§ä¸åŒçš„æƒ…å†µä¸‹ï¼ŒæŸ¥çœ‹å˜é‡ a, b æ‰€åœ¨çš„åœ°å€)ï¼Œè€Œ clang åˆ™æ˜¯é»˜è®¤å¼€å¯ç›¸å…³ä¿æŠ¤ã€‚ â€œOpenSSL Heartbleedâ€, SynopsysÂ â†©ï¸ ","date":"2024-03-05","objectID":"/posts/c-std-security/:5:2","tags":["Sysprog","C","Security"],"title":"åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜","uri":"/posts/c-std-security/"},{"categories":["Rust"],"content":" In this Crust of Rust episode, we implement some common sorting algorithms in Rust. This episode doesn't aim to explain any single concept, but rather showcase what writing â€œnormalâ€ Rust code is like, and explaining various â€œodd bitsâ€ we come across along the way. The thinking here is that sorting algorithms are both familiar and easy to compare across languages, so this might serve as a good bridge into Rust if you are familiar with other languages. æ•´ç†è‡ª John Gjengset çš„å½±ç‰‡ é—®é¢˜ You may note that the url of this posy is â€œorstâ€. Why was it given this name? Since â€œsortâ€ when sorted becomes â€œorstâ€. ğŸ¤£ ","date":"2024-03-04","objectID":"/posts/orst/:0:0","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"å½±ç‰‡æ³¨è§£ ","date":"2024-03-04","objectID":"/posts/orst/:1:0","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Total order vs Partial order Wikipedia: Total order Wikipedia: Partial order Stack Overflow: What does it mean by â€œpartial orderingâ€ and â€œtotal orderingâ€ in the discussion of Lamport's synchronization Algorithm? This definition says that in a total order any two things are comparable. Wheras in a partial order a thing needs neither to be â€œsmallerâ€ than an other nor the other way around, in a total order each thing is either â€œsmallerâ€ than an other or the other way around. ç®€å•æ¥è¯´ï¼Œåœ¨ total order ä¸­ä»»æ„ä¸¤ä¸ªå…ƒç´ éƒ½å¯ä»¥è¿›è¡Œæ¯”è¾ƒï¼Œè€Œåœ¨ partial order ä¸­åˆ™ä¸ä¸€å®šæ»¡è¶³ã€‚ä¾‹å¦‚å¯¹äºé›†åˆ $$ S = \\{a,\\ b,\\ c\\} $$ åœ¨ total order ä¸­ï¼Œ$a, b, c$ ä»»æ„ä¸¤ä¸ªå…ƒç´ ä¹‹é—´éƒ½å¿…é¡»èƒ½è¿›è¡Œæ¯”è¾ƒï¼Œè€Œåœ¨ partial order ä¸­æ²¡æœ‰æ€ä¹ˆä¸¥æ ¼çš„è¦æ±‚ï¼Œå¯èƒ½åªæœ‰ $a \u003c b, b \u003c c$ è¿™ä¸¤æ¡æ¯”è¾ƒè§„åˆ™ã€‚ åœ¨ Rust ä¸­ï¼Œæµ®ç‚¹æ•° (f32, f64) åªå®ç°äº† PartialOrd è¿™ä¸ª Trait è€Œæ²¡æœ‰å®ç° Ordï¼Œå› ä¸ºæ ¹æ® IEEE 754ï¼Œæµ®ç‚¹æ•°ä¸­å­˜åœ¨ä¸€äº›ç‰¹æ®Šå€¼ï¼Œä¾‹å¦‚ NaNï¼Œå®ƒä»¬æ˜¯æ²¡æ³•è¿›è¡Œæ¯”è¾ƒçš„ã€‚å‡ºäºç›¸åŒåŸå› ï¼Œæµ®ç‚¹æ•°ä¹Ÿåªå®ç°äº† PartialEq è€Œæ²¡æœ‰å®ç° Eq traitã€‚ ","date":"2024-03-04","objectID":"/posts/orst/:1:1","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Trait \u0026 Generic pub fn sort\u003cT, S\u003e(slice: \u0026mut [T]) where T: Ord, S: Sorter\u003cT\u003e, { S::sort(slice); } sort::\u003c_, StdSorter\u003e(\u0026mut things); è¿™æ®µä»£ç å·§å¦™åœ°åˆ©ç”¨æ³›å‹ (generic) æ¥ä¼ é€’äº†\"å‚æ•°\"ï¼Œå½“ç„¶è¿™ç§æŠ€å·§åªé™äºå¯ä»¥é€šè¿‡ç±»å‹æ¥è°ƒç”¨æ–¹æ³•çš„æƒ…å†µ (ä¸Šé¢ä»£ç æ®µçš„ S::sort(...) ä»¥åŠ sort::\u003c_, StdSorter\u003e(...) ç‰‡æ®µ)ã€‚ æ€è€ƒä»¥ä¸‹ä»£ç è¡¨ç¤ºçš„æ„ä¹‰: pub trait Sorter\u003cT\u003e { fn sort(slice: \u0026mut [T]) where T: Ord; } pub trait Sorter { fn sort\u003cT\u003e(slice: \u0026mut [T]) where T: Ord; } ç¬¬ä¸€ä¸ªè¡¨ç¤ºçš„æ˜¯æœ‰å¤šä¸ª taitï¼Œä¾‹å¦‚ Sorter\u003ci32\u003e, Sorter\u003ci64\u003e ç­‰ï¼Œç¬¬äºŒä¸ªè¡¨ç¤ºåªæœ‰ä¸€ä¸ª trait Sorterï¼Œä½†æ˜¯å®ç°è¿™ä¸ª trait éœ€è¦å®ç°å¤šä¸ªæ–¹æ³•ï¼Œä¾‹å¦‚ sort\u003ci32\u003e, sort\u003ci64\u003e ç­‰ï¼Œæ‰€ä»¥ç¬¬ä¸€ç§å†™æ³•æ›´åŠ æ™®é€‚å’Œä½¿ç”¨ (å› ä¸ºæœªå¿…èƒ½å®Œå…¨å®ç°ç¬¬äºŒç§ trait è¦æ±‚çš„æ‰€æœ‰æ–¹æ³•)ã€‚ ","date":"2024-03-04","objectID":"/posts/orst/:1:2","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Bubble sort Wikipedia: Bubble sort n := length(A) repeat swapped := false for i := 1 to n-1 inclusive do { if this pair is out of order } if A[i-1] \u003e A[i] then { swap them and remember something changed } swap(A[i-1], A[i]) swapped := true end if end for until not swapped ","date":"2024-03-04","objectID":"/posts/orst/:1:3","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Insertion sort Wikipedia: Insertion sort i â† 1 while i \u003c length(A) j â† i while j \u003e 0 and A[j-1] \u003e A[j] swap A[j] and A[j-1] j â† j - 1 end while i â† i + 1 end while ä½¿ç”¨ Binary search algorithm å¯ä»¥å°† insertion sort çš„ comparsion æ¬¡æ•°é™åˆ° $O(nlogn)$ï¼Œä½†æ˜¯ swap æ¬¡æ•°ä»ç„¶æ˜¯ $O(n^2)$ ğŸ¤£ // use binary search to find index // then use .insert to splice in i let i = match slice[..unsorted].binary_search(\u0026slice[unsorted]) { // [ a, c, e].binary_search(c) =\u003e Ok(1) Ok(i) =\u003e i, // [ a, c, e].binary_search(b) =\u003e Err(1) Err(i) =\u003e i, }; slice[i..=unsorted].rotate_right(1); match çš„å†…éƒ¨é€»è¾‘ä¹Ÿå¯ä»¥æ”¹å†™ä¸º OK(i) | Err(i) =\u003e i ","date":"2024-03-04","objectID":"/posts/orst/:1:4","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Selection sort Wikipedia: Selection sort å¼•ç”¨ There are many different ways to sort the cards. Hereâ€™s a simple one, called selection sort, possibly similar to how you sorted the cards above: Find the smallest card. Swap it with the first card. Find the second-smallest card. Swap it with the second card. Find the third-smallest card. Swap it with the third card. Repeat finding the next-smallest card, and swapping it into the correct position until the array is sorted. source ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹å¯ä»¥å†™æˆç›¸å½“ readable çš„ç¨‹å¼ç ï¼Œä»¥ä¸‹ä¸ºè·å– slice æœ€å°å€¼å¯¹åº”çš„ index: let smallest_in_rest = slice[unsorted..] .iter() .enumerate() .min_by_key(|\u0026(_, v)| v) .map(|(i, _)| unsorted + i) .expect(\"slice is not empty\"); ","date":"2024-03-04","objectID":"/posts/orst/:1:5","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Quicksort Wikipedia: Quicksort å¯ä»¥é€šè¿‡ extra allocation å’Œ in-place ä¸¤ç§æ–¹å¼æ¥å®ç° quicksortï¼Œå…¶ä¸­ extra allocation æ¯”è¾ƒå¥½ç†è§£ï¼Œin-place æ–¹å¼çš„ pseudocode å¦‚ä¸‹: Quicksort(A,p,r) { if (p \u003c r) { q \u003c- Partition(A,p,r) Quicksort(A,p,q) Quicksort(A,q+1,r) } } Partition(A,p,r) x \u003c- A[p] i \u003c- p-1 j \u003c- r+1 while (True) { repeat { j \u003c- j-1 } until (A[j] \u003c= x) repeat { i \u003c- i+1 } until (A[i] \u003e= x) if (i \u003c j) swap(A[i], A[j]) else return(j) } } source method slice::split_at_mut å®ç° Quick sort æ—¶ä½¿ç”¨äº† split_at_mut æ¥ç»•å¼€å¼•ç”¨æ£€æŸ¥ï¼Œå› ä¸ºå¦‚æœä½ æ­¤æ—¶æ‹¥æœ‰ä¸€ä¸ªæŒ‡å‘ pivot çš„ä¸å¯å˜å¼•ç”¨ï¼Œå°±æ— æ³•å¯¹ slice å‰©ä½™çš„éƒ¨åˆ†ä½¿ç”¨å¯å˜å¼•ç”¨ï¼Œè€Œ split_at_mut åˆ™ä½¿å¾—åŸæœ¬çš„ slice è¢«åˆ†ä¸ºä¸¤ä¸ªå¯å˜å¼•ç”¨ï¼Œä»è€Œç»•å¼€äº†ä¹‹å‰çš„å•ä¸€å¼•ç”¨æ£€æŸ¥ã€‚ åé¢å‘ç°å¯ä»¥ä½¿ç”¨æ›´ç¬¦åˆè¯­ä¹‰çš„ split_first_mutï¼Œå½“ç„¶æ€è·¯è¿˜æ˜¯ä¸€æ ·çš„ æ³¨æ„ æˆ‘ä¸ªäººè®¤ä¸ºå®ç° Quick sort çš„å…³é”®åœ¨äºæŠŠæ¡ä»¥ä¸‹ä¸¤ä¸ª invariants: left: current checking index for element which is equal or less than the pivot right: current checking index for element which is greater than the pivot å³è¿™ä¸¤ä¸ªä¸‹æ ‡å¯¹åº”çš„å…ƒç´ åªæ˜¯å½“å‰å‡†å¤‡æ£€æŸ¥çš„ï¼Œä¸ä¸€å®šç¬¦åˆå…ƒç´ çš„æ’åˆ—è§„èŒƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º: [ \u003c= pivot ] [ ] [ ... ] [ ] [ \u003e pivot ] ^ ^ | | left right æ‰€ä»¥å½“ left == right æ—¶ä¸¤è¾¹éƒ½æ²¡æœ‰å¯¹æ‰€æŒ‡å‘çš„å…ƒç´ è¿›è¡Œæ£€æŸ¥ï¼Œåˆ†æƒ…å†µè®¨è®º (è¯¥å…ƒç´ æ˜¯ $\u003c= pivot$ æˆ– $\u003e pivot$) å¯ä»¥å¾—å‡º: å½“ left \u003e right æ—¶ï¼Œright æŒ‡å‘çš„æ˜¯ $\u003c= pivot$ çš„å…ƒç´ ï¼Œå°†å…¶ä¸ pivot è¿›è¡Œ swap å³å¯å®ç° partition æ“ä½œã€‚(å…¶å®æ­¤æ—¶ left æŒ‡å‘çš„æ˜¯ $\u003e pivot$ éƒ¨åˆ†çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œright æŒ‡å‘çš„æ˜¯ $\u003c= pivot$ éƒ¨åˆ†çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ rest ä¸ slice ä¹‹é—´çš„ä¸‹æ ‡è½¬æ¢) ","date":"2024-03-04","objectID":"/posts/orst/:1:6","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Benchmark é€šè¿‡å°è£…ç±»å‹ SortEvaluator åŠå®ç° trait PartialEq, Eq, PartialOrd, Ord æ¥ç»Ÿè®¡æ’åºè¿‡ç¨‹ä¸­çš„æ¯”è¾ƒæ“ä½œ (eq, partial_cmp, cmp) çš„æ¬¡æ•°ã€‚ Stack Overflow: Why can't the Ord trait provide default implementations for the required methods from the inherited traits using the cmp function? ","date":"2024-03-04","objectID":"/posts/orst/:1:7","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"R and ggplot2 # install R $ sudo apt install r-base # install ggplot2 by R $ R \u003e install.packages(\"ggplot2\") Are there Unix-like binaries for R? https://ggplot2.tidyverse.org/ é—®é¢˜ deepin è½¯ä»¶æºä¸‹è½½çš„ R è¯­è¨€åŒ…å¯èƒ½ç‰ˆæœ¬è¿‡ä½ (3.5)ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ åº“æºçš„æ–¹å¼æ¥ä¸‹è½½é«˜ç‰ˆæœ¬çš„ R è¯­è¨€åŒ…: 1.æ·»åŠ  Debian buster (oldstable) åº“æºåˆ° /etc/apt/sourcelist é‡Œ: # https://mirrors.tuna.tsinghua.edu.cn/CRAN/ deb http://cloud.r-project.org/bin/linux/debian buster-cran40/ 2.æ›´æ–°è½¯ä»¶ï¼Œå¯èƒ½ä¼šé‡åˆ°æ²¡æœ‰å…¬é’¥çš„é—®é¢˜ (å³å‡ºç°ä¸‹æ–¹çš„ NO_PUBKEY): $ sudo apt update ... NO_PUBKEY XXXXXX ... æ­¤æ—¶å¯ä»¥ NO_PUBKEY åçš„ XXXXXX å°±æ˜¯å…¬é’¥ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å…¶æ·»åŠ ä¸€ä¸‹å³å¯: $ sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys XXXXXX æ·»åŠ å®Œå…¬é’¥åå†é‡æ–°æ›´æ–°ä¸€æ¬¡è½¯ä»¶æº 3.é€šè¿‡æŒ‡å®šåº“æºçš„æ–¹å¼æ¥å®‰è£… R (å¦‚æœæœªæŒ‡å®šåº“æºåˆ™è¿˜æ˜¯ä»é»˜è®¤æºè¿›è¡Œä¸‹è½½ 3.5 ç‰ˆæœ¬): $ sudo apt install buster-cran40 r-base $ R --version R version 4.3.3 (2024-02-29) å¤§åŠŸå‘Šæˆï¼ŒæŒ‰ç…§ä¸Šé¢å®‰è£… ggplot2 å³å¯ ","date":"2024-03-04","objectID":"/posts/orst/:1:8","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Homework ä¿¡æ¯ å®ä½œè¯´æ˜: æ·»åŠ æ ‡å‡†åº“çš„ sort_unstable è¿›å…¥åŸºå‡†æµ‹è¯• å°†äº¤æ¢æ“ä½œ (swap) çº³å…¥åŸºå‡†æµ‹è¯• å°è¯•å®ç° Merge sort å°è¯•å®ç° Heapsort å‚è€ƒèµ„æ–™: Wikipedia: Merge sort Wikipedia: Heapsort ","date":"2024-03-04","objectID":"/posts/orst/:2:0","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Documentations è¿™é‡Œåˆ—ä¸¾è§†é¢‘ä¸­ä¸€äº›æ¦‚å¿µç›¸å…³çš„ documentation å­¦ä¹ çš„ä¸€æ‰‹èµ„æ–™æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œè¯·åŠ¡å¿…è‡ªä¸»å­¦ä¼šé˜…è¯»è§„æ ¼ä¹¦ä¹‹ç±»çš„èµ„æ–™ ","date":"2024-03-04","objectID":"/posts/orst/:3:0","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Crate std å¯ä»¥ä½¿ç”¨è¿™é‡Œæä¾›çš„æœç´ æ è¿›è¡Œæœç´¢ (BTW ä¸è¦æµªè´¹æ—¶é—´åœ¨ Google æœå¯»ä¸Šï¼) Module std::cmp Trait std::cmp::Ord Trait std::cmp::PartialOrd Trait std::cmp::Eq Trait std::cmp::PartialEq Primitive Type slice method slice::sort method slice::sort_unstable method slice::sort_by method slice::sort_by_key method slice::swap method slice::binary_search method slice::rotate_right method slice::split_at_mut method slice::split_first_mut method slice::to_vec Trait std::iter::Iterator method std::iter::Iterator::min method std::iter::Iterator::min_by_key method std::iter::Iterator::enumerate Enum std::option::Option method std::option::Option::expect method std::option::Option::map Enum std::result::Result method std::result::Result::expect method std::result::Result::map Module std::time method std::time::Instant::now method std::time::Instant::elapsed method std::time::Duration::as_secs_f64 ","date":"2024-03-04","objectID":"/posts/orst/:3:1","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"Crate rand Function rand::thread_rng method rand::seq::SliceRandom::shuffle ","date":"2024-03-04","objectID":"/posts/orst/:3:2","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Rust"],"content":"References orst [Github] Sorting algorithm [Wikipedia] Timsort [Wikipedia] Difference between Benchmarking and Profiling [Stack Overflow] ","date":"2024-03-04","objectID":"/posts/orst/:4:0","tags":["Rust","Sort","Algorithm"],"title":"Crust of Rust: Sorting Algorithms","uri":"/posts/orst/"},{"categories":["Linux","Linux Kernel Internals"],"content":" æœ¬è¬›åº§å°‡ä»¥ Thorsten Leemhuis åœ¨ FOSDEM 2020 é–‹å ´æ¼”èªª â€œLinux kernel â€“ Solving big problems in small steps for more than 20 yearsâ€ (slides) ç‚ºä¸»è»¸ï¼Œå˜—è©¦æ­¸ç´è‡ª 21 ä¸–ç´€ç¬¬ä¸€å¹´é–‹å§‹çš„ Linux æ ¸å¿ƒ 2.4 ç‰ˆåˆ°å¦‚ä»Šçš„ 5.x ç‰ˆï¼Œä¸­é–“æ ¸å¿ƒé–‹ç™¼è€…å¦‚ä½•å…‹æœ SMP (Symmetric multiprocessing), scalability, åŠå„å¼ç¡¬é«”æ¶æ§‹å’Œå‘¨é‚Šè£ç½®æ”¯æ´ç­‰é›£é¡Œï¼Œéç¨‹ä¸­æå‡ºå…¨é¢ç§»é™¤ BKL (Big kernel lock)ã€å¯¦ä½œè™›æ“¬åŒ–æŠ€è¡“ (å¦‚ Xen å’Œ KVM)ã€æå‡º namespace å’Œ cgroups å¾è€Œç¢ºç«‹å®¹å™¨åŒ– (container) çš„èƒ½åŠ›ï¼Œå†ä¾†æ˜¯æ ¸å¿ƒç™¼å±•çš„æ˜æ˜ŸæŠ€è¡“ eBPF æœƒåœ¨æ—¢æœ‰çš„åŸºç¤ä¹‹ä¸Šï¼Œå¸¶ä¾† XDP å’Œå“ªäº›ä»¤äººé©šè±”çš„æ©Ÿåˆ¶å‘¢ï¼Ÿåˆï¼ŒLinux æ ¸å¿ƒçµ‚æ–¼æ­£å¼ç´å…¥ç™¼å±•åé¤˜å¹´çš„ PREEMPT_RTï¼Œä½¿å¾— Linux æ ¸å¿ƒå¾—ä»¥æˆç‚ºç¡¬å³æ™‚çš„ä½œæ¥­ç³»çµ±ï¼Œå°å…§éƒ¨è¨­è¨ˆæœ‰å“ªäº›è¡æ“Šï¼ŸAIO å¾Œç¹¼çš„ io_uring è®“ Linux æœ‰æ›´å„ªé›…ä¸”é«˜æ•ˆçš„éåŒæ­¥ I/O å­˜å–ï¼Œæˆ‘å€‘è©²å¦‚ä½•çœ‹å¾…ï¼Ÿ åŸæ–‡åœ°å€ ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:0:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"å¼€ç¯‡ç‚¹é¢˜ å‰ç½®çŸ¥è¯†: Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ FOSDEM 2020, T. Leemhuis: YouTube: Linux kernel â€“ Solving big problems in small steps for more than 20 years slides (è¿™ä¸ªæŠ•å½±ç‰‡å…±æœ‰ 248 é¡µï¼Œæ‰€ä»¥åŠ è½½æ—¶å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ ğŸ¤£) ä»¥ä¸Šé¢çš„è®²åº§ä¸ºä¸»è½´ï¼Œå›é¡¾ Linux çš„å‘å±•åŠ¨æ€ï¼Œç”±æ­¤å±•æœ› Linux æœªæ¥çš„å‘å±•æ–¹å‘ã€‚ SMP (Symmetric multiprocessing) scalability BKL (Big kernel lock) Xen, KVM namespace, cgroups, container - äº‘æœåŠ¡ eBPF, XDP - ç½‘ç»œå°åŒ…çš„é«˜æ•ˆè¿‡æ»¤ (åœ¨å†…æ ¸å³å¯å¤„ç†å°åŒ…çš„è¿‡æ»¤ï¼Œæ— éœ€åœ¨ç”¨æˆ·æ€åˆ¶å®šè§„åˆ™) PREEMPT_RT - ç¡¬å³æ—¶æ“ä½œç³»ç»Ÿ (hard real time os) io_uring - é«˜æ•ˆçš„éåŒæ­¥ I/O (Linux å¤§éƒ¨åˆ†ç³»ç»Ÿè°ƒç”¨éƒ½æ˜¯éåŒæ­¥çš„) nommu - ç”¨äºåµŒå…¥å¼é™ä½åŠŸè€— Linux ç›¸å…³äººç‰© (å¯åœ¨ YouTube ä¸Šæ‰¾åˆ°ä»–ä»¬çš„ä¸€äº›æ¼”è®²): Jonathan Corbet ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:1:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"Linux 2.4 Version 2.4 of the LINUX KERNELâ€“Why Should a System Administrator Upgrade? è‡ª 2004 å¹´é–‹å§‹ï¼Œé‡‹å‡ºéç¨‹ç™¼ç”Ÿè®ŠåŒ–ï¼Œæ–°æ ¸å¿ƒæ¯éš” 2-3 å€‹æœˆå®šæœŸé‡‹å‡ºï¼Œç·¨è™Ÿç‚º 2.6.0, 2.6.1ï¼Œç›´åˆ° 2.6.39 è¿™ä»¶äº‹å¯¹äºæ“ä½œç³»ç»Ÿçš„å¼€å‘æœ‰å¾ˆå¤§çš„å½±å“ï¼Œæ˜¯ä¸€ä¸ªå·¨å¤§çš„å˜é©ã€‚é€è¿‡è¿™ç§å‘è¡Œæœºåˆ¶ï¼ŒCPU å‚å•†å¯ä»¥ç›´æ¥åœ¨æœ€æ–°çš„ Linux kernel ä¸Šé€‚é…æ­£åœ¨å¼€å‘çš„ CPU åŠç›¸å…³ç¡¬ä½“ï¼Œè€Œæ— éœ€æ‹¿åˆ°çœŸæ­£çš„ CPU ç¡¬ä½“å†è¿›è¡Œç›¸åº”çš„å¼€å‘ï¼Œè¿™ä½¿å¾— Linux è·å¾—äº†æ›´å¤šå‚å•†çš„æ”¯æŒå’ŒæŠ•å…¥ï¼Œè¿›è€Œè¿›å…¥äº†é£é€Ÿå‘å±•æœŸã€‚ LInux æ ¸å¿ƒçš„é“è·¯: åªæä¾›æœºåˆ¶ä¸æä¾›ç­–ç•¥ã€‚ä¾‹å¦‚ khttp (in-kernel httpd) çš„å¼ƒç”¨ï¼Œé€šè¿‡æä¾›æ›´é«˜æ•ˆçš„ç³»ç»Ÿè°ƒç”¨æ¥æé«˜ç½‘é¡µæœåŠ¡å™¨çš„æ•ˆèƒ½ï¼Œè€Œä¸æ˜¯åƒ Windows NT ä¸€æ ·ç”¨æˆ·æ€æ€§èƒ½ä¸å¤Ÿå°±æŠŠç¨‹å¼æ¬è¿› kernel ğŸ¤£ ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:2:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"SMP æ”¯æ´ ç›¸å…³æ•…äº‹: Digital Domain and TITANIC (æ³°å¦å°¼å…‹å·) Red Hat Sinks Titanic Linux Helps Bring Titanic to Life Digital Domain: TITANIC Industrial Light and Magic MaterialX Joins the Academy Software Foundation as a Hosted Project åˆ¶ä½œã€Šæ³°å¦å°¼å…‹å·ã€‹çš„ç‰¹æ•ˆæ—¶ï¼Œä½¿ç”¨äº†å®‰è£… Linux æ“ä½œç³»ç»Ÿçš„ Alpha å¤„ç†å™¨ï¼Œè€Œ Alpha æ˜¯å¤šæ ¸å¤„ç†å™¨ï¼Œæ‰€ä»¥å½“å¹´å°† Linux å®‰è£…åˆ° Alpha ä¸Šéœ€è¦æ”¯æ´ SMPï¼Œç”±æ­¤å»¶ä¼¸å‡ºäº† BLK (Big kernel lock)ã€‚ Linux 2.4 åœ¨ SMP çš„æ•ˆç‡é—®é¢˜ä¹Ÿæ­£æ˜¯ BLK æ‰€å¼•èµ·çš„: BLK ç”¨äºé”å®šæ•´ä¸ª Linux kernelï¼Œè€Œæ•´ä¸ª Linux kernel åªæœ‰ä¸€ä¸ª BLK å®ä½œæœºåˆ¶: åœ¨æ‰§è¡Œ schedule æ—¶å½“å‰æŒæœ‰ BLK çš„ process éœ€è¦é‡Šæ”¾ BLK ä»¥è®©å…¶ä»– process å¯ä»¥è·å¾— BLKï¼Œå½“è½®åˆ°è¯¥ process æ‰§è¡Œæ—¶ï¼Œå¯ä»¥é‡æ–°è·å¾— BLK ä»ä¸Šé¢çš„å®ä½œæœºåˆ¶å¯ä»¥çœ‹å‡ºï¼Œè¿™æ ·çš„æœºåˆ¶æ•ˆç‡æ˜¯å¾ˆä½çš„ï¼Œè™½ç„¶æœ‰å¤šæ ¸ (core)ï¼Œä½†æ˜¯å½“ä¸€ä¸ª process è·å¾— BLK æ—¶ï¼Œåªæœ‰è¯¥ process æ‰€åœ¨çš„ core å¯ä»¥æ‰§è¡Œï¼Œå…¶ä»– core åªèƒ½ç­‰å¾… BLK å·²äº v.6.39 ç‰ˆæœ¬ä¸­è¢«å½»åº•å»é™¤ Linux 5.5â€™s Scheduler Sees A Load Balancing Rework For Better Perf But Risks Regressions âœ… When testing on a dual quad-core ARM64 system they found the performance ranged from less than 1% to upwards of 10% for the Hackbench scheduler test. With a 224-core ARM64 server, the performance ranged from less than 1% improvements to 12% better performance with Hackbench and up to 33% better performance with Dbench. More numbers and details via the v4 patch revision. ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:3:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"è™šæ‹ŸåŒ– Cloud Hypervisor Xen and the Art of Virtualization ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:4:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"DPDK (Data Plane Development Kit) ä¸€è¨€ä»¥è”½ä¹‹: Kernel-bypass networkingï¼Œå³ç•¥è¿‡ kernel ç›´æ¥è®© User programs å¤„ç†ç½‘ç»œå°åŒ…ï¼Œä»¥æå‡æ•ˆèƒ½ã€‚ä¸€èˆ¬å®ä½œäºé«˜é¢‘äº¤æ˜“çš„åœºæ™¯ã€‚ YouTube: Kernel-bypass networking for fun and profit Stack Overflowâ€œzero copy networkingâ€ vs â€œkernel bypassâ€? ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:5:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"XDP: eXpress Data Path å¸¸å’Œ eBPF é…åˆå®ç°åœ¨ kernel è¿›è¡Œå®šåˆ¶åŒ–çš„å°åŒ…è¿‡æ»¤ï¼Œä»è€Œå‡å°‘ cop to/from kernel/user è¿™ç±»æ“ä½œçš„æ•ˆèƒ½æŸå¤±ã€‚ LPC2018 - Path to DPDK speeds for AF XDP / slides ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:6:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"AIO Synchronous / Asynchronous I/Oï¼šåœ¨å¾/å‘æ ¸å¿ƒç©ºé–“è®€å–/å¯«å…¥è³‡æ–™ (i.e. å¯¦éš›é€²è¡Œ I/O æ“ä½œ) çš„éç¨‹ï¼Œä½¿ç”¨è€…å±¤ç´šçš„è¡Œç¨‹æ˜¯å¦æœƒè¢« blockedã€‚ AIO åœ¨æŸäº›æƒ…æ™¯ä¸‹å¤„ç†ä¸å½“ï¼Œæ€§èƒ½ç”šè‡³ä½äº blocked çš„ I/O æ–¹æ³•ï¼Œè¿™ä¹Ÿå¼•å¯¼å‡ºäº† io_uring æŠ€å·§ UNIX å“²å­¦: Everything is a file. Linux ä¸æˆæ–‡è§„èŒƒ: Everything is a file descriptor. Kernel Recipes 2019 - Faster IO through io_uring / slides io_uring ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:7:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"Container Container æ„å»ºåœ¨ Linux æ ¸å¿ƒçš„åŸºç¡€å»ºè®¾ä¸Š: namespace, cgroups, capabilities, seccomp +----------------------+ | +------------------+ | | | cgroup | | | | namespace | | | | union-capable fs | | | | | | | | Container | | | +------------------+ | | | | +------------------+ | | | Container | | | +------------------+ | | | | +------------------+ | | | Container | | | +------------------+ | | | | Linux kernel (host) | +----------------------+ YouTube: Containers: cgroups, Linux kernel namespaces, ufs, Docker, and intro to Kubernetes pods Stack Overflow: difference between cgroups and namespaces cgroup: Control Groups provide a mechanism for aggregating/partitioning sets of tasks, and all their future children, into hierarchical groups with specialized behaviour. namespace: wraps a global system resource in an abstraction that makes it appear to the processes within the namespace that they have their own isolated instance of the global resource. Wikipedia: UnionFS Wikipedia: Microservices ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:8:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"BPF/cBPF/eBPF æŠ€å·§ run small programs in kernel mode 20 years ago, this idea would likely have been shot down immediately Netflix talks about Extended BPF - A new software type / slides ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:9:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"Real-Time Linux æ ¸å¿ƒè®¾è®¡: PREEMPT_RT ä½œä¸ºè¿ˆå‘ç¡¬å³æ—¶æ“ä½œç³»ç»Ÿçš„æœºåˆ¶ ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:10:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"printk Why printk() is so complicated (and how to fix it) ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:11:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"ZFS, BtrFS, RAID ZFS versus RAID: Eight Ironwolf disks, two filesystems, one winner ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:12:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["Linux","Linux Kernel Internals"],"content":"Rust Linux æ ¸å¿ƒé‡‡çº³ Rust çš„çŠ¶å†µ ","date":"2024-03-03","objectID":"/posts/linux-dev-review/:13:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: å‘å±•åŠ¨æ€å›é¡¾","uri":"/posts/linux-dev-review/"},{"categories":["draft","RISC-V"],"content":" The intention is to give specific actionable optimization recommendations for software developers writing code for RISC-V application processors. è¿‘æ—¥ RISE åŸºé‡‘ä¼šå‘å¸ƒäº†ä¸€ç‰ˆ ã€ŠRISC-V Optimization Guideã€‹ï¼Œå…¶ç›®çš„æ˜¯ä¸ºç»™ RISC-V åº”ç”¨å¤„ç†å™¨ç¼–å†™ä»£ç çš„è½¯ä»¶å¼€å‘äººå‘˜æä¾›å…·ä½“å¯è¡Œçš„ä¼˜åŒ–å»ºè®®ã€‚æœ¬æ¬¡æ´»åŠ¨çš„ä¸»è¦å†…å®¹æ˜¯è§£è¯»å’Œè®¨è®ºè¯¥æ–‡æ¡£å†…å®¹ã€‚ åŸæ–‡åœ°å€ åŸæ–‡ PDF è§£è¯´å½•å½± ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:0:0","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"ç›¸å…³çŸ¥è¯† RISC-V ISA è§„æ ¼ä¹¦: https://riscv.org/technical/specifications/ æ¨èå‚è€ƒ ä½“ç³»ç»“æ„å¦‚ä½•ä½œç”¨äºç¼–è¯‘å™¨åç«¯-é‚±å‰ [bilibili] è¿™ä¸ªè®²åº§æ˜¯å…³äºå¾®æ¶æ„ã€æŒ‡ä»¤é›†æ˜¯æ€æ ·å’Œç¼–è¯‘å™¨ã€è½¯ä»¶ç›¸äº’åä½œã€ç›¸äº’å½±å“çš„ Overview è¿™ä¸ªè®²åº§ä»‹ç»çš„æ˜¯é€šç”¨ CPU å¹¶ä¸ä»…é™äº RISC-V ä¸Š ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:1:0","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"Detecting RISC-V Extensions on Linux å‚è€ƒä»¥ä¸‹æ–‡ç« æ„å»º Linux RISC-V ç„¶åè¿›è¡ŒåŸæ–‡çš„ riscv_hwprobe ç³»ç»Ÿè°ƒç”¨å®éªŒ: How To Set Up The Environment for RISCV-64 Linux Kernel Development In Ubuntu 20.04 Running 64- and 32-bit RISC-V Linux on QEMU ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:2:0","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"Multi-versioning æœ€æ–°è¿›å±•: https://reviews.llvm.org/D151730 ç›¸å…³ä»‹ç»: https://maskray.me/blog/2023-02-05-function-multi-versioning ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:2:1","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"Optimizing Scalar Integer ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:3:0","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"Materializing Constants RV64I 5.2 Integer Computational Instructions Additional instruction variants are provided to manipulate 32-bit values in RV64I, indicated by a â€˜Wâ€™ suffix to the opcode. These â€œ*Wâ€ instructions ignore the upper 32 bits of their inputs and always produce 32-bit signed values, i.e. bits XLEN-1 through 31 are equal. ADDIW is an RV64I instruction that adds the sign-extended 12-bit immediate to register rs1 and produces the proper sign-extension of a 32-bit result in rd. åŸæ–‡ Prefer idiomatic LUI/ADDI sequence for 32 bit constants éƒ¨åˆ†ä½¿ç”¨ lui å’Œ addiw æ„å»º 0x1fffff çš„è¯´æ˜æ¯”è¾ƒæ™¦æ¶©éš¾æ‡‚ (è¯´å®è¯æˆ‘æ²¡çœ‹æ‡‚åŸæ–‡çš„ addiw ä¸ºä»€ä¹ˆéœ€è¦å‡å» 4096 ğŸ˜‡) æ³¨æ„ æ ¹æ®ä¸‹é¢çš„å‚è€ƒæ–‡ç« ï¼Œå¦‚æœ addiw çš„ç«‹å³æ•°çš„ MSB è¢«ç½®ä¸º 1 æ—¶ï¼Œåªéœ€åœ¨ lui æ—¶å¤šåŠ ä¸€ä¸ª 1 å³å¯æ„å»ºæˆ‘ä»¬æƒ³è¦çš„ 32-bit æ•°å€¼ã€‚è€ŒåŸæ–‡ä¸­é™¤äº†å¯¹ lui åŠ  1 å¤–ï¼Œè¿˜å¯¹ addiw è¿›è¡Œå‡å» 4096 çš„æ“ä½œ: addiw a0, a0, (0xfff - 4096) ; addiw a0, a0, -1 è¿™ä¹ä¸€çœ‹ä¸çŸ¥é“ä¸ºä½•éœ€è¦å‡å» 4096ï¼Œå…¶å®æœ¬è´¨å¾ˆç®€å•ï¼Œæ ¹æ®ä¸Šé¢çš„ ISA manual addiw çš„ç«‹å³æ•°æ˜¯ 12-bit çš„ signed numberï¼Œå³åº”è¯¥ä¼ å…¥çš„æ˜¯æ•°å€¼ã€‚ä½†æ˜¯ç›´æ¥ä½¿ç”¨ 0xfff è¡¨ç¤ºä¼ å…¥çš„ä»…ä»…æ˜¯ 0xfff è¿™ä¸ªç¼–ç å¯¹åº”çš„æ•°å€¼ (å¯ä»¥è¡¨ç¤º 12-bit signed ä¸‹çš„æ•°å€¼ -1ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤º unsigned ç¼–ç ä¸‹ 0xfff å¯¹åº”çš„æ•°å€¼ 4095ï¼Œåœ¨ 12-bit signed ä¸‹ integer overflow)ï¼Œä¸ºäº†ä¿è¯ addiw çš„ç«‹å³æ•°çš„æ•°å€¼ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸ (å³ 0xfff åœ¨ 12-bit signed ä¸‹æ•°å€¼æ˜¯ -1) ä»¥åŠé¿å… integer overflowï¼Œæ‰€ä»¥éœ€è¦å°† 0xfff - 4096 å¾—åˆ° 12-bit signed æ•°å€¼ -1 (è™½ç„¶è¿™ä¸ªç¼–ç å’Œ 0xfff æ˜¯ä¸€æ ·çš„â€¦)ã€‚ addiw a0, a0, -1 ; right addiw a0, a0, 4095 ; integer overflow è§£è¯»è®¡ç®—æœºç¼–ç  C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡ RV32G ä¸‹ lui/auipc å’Œ addi ç»“åˆåŠ è½½ç«‹å³æ•°æ—¶çš„è¡¥å€¼é—®é¢˜ [zhihu] RISC-V build 32-bit constants with LUI and ADDI [Stack Overflow] åŸæ–‡ Fold immediates into consuming instructions where possible éƒ¨åˆ†ï¼Œç›¸å…³çš„ RISC-V çš„ imm ä¼˜åŒ–: Craig Topper: 2022 LLVM Dev Mtg: RISC-V Sign Extension Optimizations æ”¹è¿›RISC-Vçš„ä»£ç ç”Ÿæˆ-å»–æ˜¥ç‰ [bilibili] ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:3:1","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"Avoid branches using conditional moves Zicond extension æä¾›äº†æˆ‘ä»¬åœ¨ RISC-V ä¸Šå®ä½œå¸¸æ•°æ—¶é—´å‡½æ•° (contant-time function) çš„èƒ½åŠ›ï¼Œç”¨äºé¿å…åˆ†æ”¯é¢„æµ‹ï¼Œä»è€Œå‡å°‘å› åˆ†æ”¯é¢„æµ‹å¤±è´¥å¸¦æ¥çš„é«˜æ˜‚ä»£ä»·ã€‚ $$ a0 = \\begin{cases} constant1 \u0026 \\text{if } x \\neq 0 \\newline constant2 \u0026 \\text{if } x = 0 \\end{cases} $$ åŸæ–‡ä½¿ç”¨äº† CZERO.NEZï¼Œä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ CZERO.EQZ æ¥å®ä½œåŸæ–‡çš„ä¾‹å­: li t2, constant2 li t3, (constant1 - constant2) CZERO.EQZ t3, t3, a0 add a0, t3, t2 åŸæ–‡ä¹Ÿä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ seqz æ¥å®ä½œ constant-time functionï¼Œä¸‹é¢ä½¿ç”¨ snez æ¥å®ä½œåŸæ–‡çš„ä¾‹å­: li t2, constant1 li t3, constant2 snez t0, a0 addi t0, t0, -1 xor t1, t2, t3 and t1, t1, t0 xor a0, t1, t2 å¦‚æœæœ‰ \\â€˜M\\â€™ æ‰©å±•å¯ä»¥é€šè¿‡ mul æŒ‡ä»¤è¿›è¡Œç®€åŒ– (é€šè¿‡ snez æ¥å®ä½œåŸæ–‡ä¾‹å­): li t2, constant1 li t3, constant2 xor t1, t2, t3 snez t0, a0 mul t1, t1, t0 xor a0, t1, t3 ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:3:2","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"Padding Use canonical NOPs, NOP ( ADDI X0, X0, 0 ) and C.NOP ( C.ADDI X0, 0 ), to add padding within a function. Use the canonical illegal instruction ( either 2 or 4 bytes of zeros depending on whether the C extension is supported ) to add padding between functions. å› ä¸ºåœ¨å‡½æ•°å†…éƒ¨çš„æ‰§è¡Œé¢‘ç‡é«˜ï¼Œä½¿ç”¨åˆæ³•çš„ NOPs è¿›è¡Œå¯¹é½ paddingï¼Œé˜²æ­¢åœ¨ä¹±åºæ‰§è¡Œæ—¶ï¼Œæµæ°´çº¿åœ¨é‡è§éæ³•æŒ‡ä»¤åå°±ä¸å†æ‰§è¡Œåç»­æŒ‡ä»¤ï¼Œé€ æˆæ•ˆèƒ½æŸå¤± å¦‚æœæ§åˆ¶æµè¢«ä¼ é€’åˆ°ä¸¤ä¸ªå‡½æ•°ä¹‹é—´ï¼Œé‚£ä¹ˆåŠ å¤§å¯èƒ½æ˜¯ç¨‹åºæ‰§è¡Œå‡ºé”™äº†ï¼Œä½¿ç”¨éæ³•çš„æŒ‡ä»¤è¿›è¡Œå¯¹é½ padding å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½æ›´å¿«åœ° debug ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:3:3","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"Align char array to greater alignment Why use wider load/store usage for memory copy? C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§ ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:3:4","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"Use shifts to clear leading/trailing bits å®ä½œ 64-bit ç‰ˆæœ¬çš„åŸæ–‡ä¾‹å­ (retain the highest 12 bits): slli x6, x5, 52 slri x7, x5, 52 RV64I 5.2 Integer Computational Instructions LUI (load upper immediate) uses the same opcode as RV32I. LUI places the 20-bit U-immediate into bits 31â€“12 of register rd and places zero in the lowest 12 bits. The 32-bit result is sign-extended to 64 bits. ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:3:5","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"Optimizing Scalar Floating Point ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:4:0","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["draft","RISC-V"],"content":"Optimizing Vector What about vector instructions? YouTube: Introduction to SIMD Introduction to the RISC-V Vector Extension [PDF] 2020 RISC-V Summit: Tutorial: RISC-V Vector Extension Demystified ","date":"2024-02-29","objectID":"/posts/riscv-optimization-guide/:5:0","tags":["RISC-V","Optimization","Architecture"],"title":"RISC-V Optimization Guide","uri":"/posts/riscv-optimization-guide/"},{"categories":["Rust"],"content":" In this (fifth) Crust of Rust video, we cover multi-produce/single-consumer (mpsc) channels, by re-implementing some of the std::sync::mpsc types from the standard library. As part of that, we cover what channels are used for, how they work at a high level, different common channel variants, and common channel implementations. In the process, we go over some common Rust concurrency primitives like Mutex and Condvar. æ•´ç†è‡ª John Gjengset çš„å½±ç‰‡ ","date":"2024-02-29","objectID":"/posts/channels/:0:0","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Channel Wikipedia: Channel å¼•ç”¨ In computing, a channel is a model for interprocess communication and synchronization via message passing. A message may be sent over a channel, and another process or thread is able to receive messages sent over a channel it has a reference to, as a stream. YouTube: Channels in Rust Source ","date":"2024-02-29","objectID":"/posts/channels/:1:0","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Concurrency vs Parallelism What is the difference between concurrency and parallelism? Concurrency vs. Parallelism â€” A brief view ","date":"2024-02-29","objectID":"/posts/channels/:1:1","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"å½±ç‰‡æ³¨è§£ ","date":"2024-02-29","objectID":"/posts/channels/:2:0","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Sender \u0026 Receiver multi-produce/single-consumer (mpsc) Why does the recevier type need to have an arc protected by mutex if the channel may only have a single consumer thread? Because a send and a recevie might happen at the same time, and they need to be mutually exclusive to each other as well. Why not use a boolean semaphore over the implementation in mutex? A boolean semaphore is basically a boolean flag that you check and atomically update. The problem there is if the flag is currently set (someone else is in the critical section), with a boolean semaphore, you have to spin, you have to repeatedly check it. Whereas with a mutex, the operating system can put the thread to sleep and wake it back up when the mutex is available, which is generally more efficient although adds a little bit of latency. ","date":"2024-02-29","objectID":"/posts/channels/:2:1","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Condition Variable method std::sync::Condvar::wait This function will atomically unlock the mutex specified (represented by guard) and block the current thread. This means that any calls to notify_one or notify_all which happen logically after the mutex is unlocked are candidates to wake this thread up. When this function call returns, the lock specified will have been re-acquired. method std::sync::Condvar::notify_one If there is a blocked thread on this condition variable, then it will be woken up from its call to wait or wait_timeout. Calls to notify_one are not buffered in any way. wait \u0026 notify ","date":"2024-02-29","objectID":"/posts/channels/:2:2","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Clone å¯¹ struct Sender\u003cT\u003e æ ‡æ³¨å±æ€§å® #[derive(clone)] ä¼šå®ç°ä»¥ä¸‹çš„ triat: impl\u003cT: Clone\u003e Clone for Sender\u003cT\u003e { ... } ä½†æ˜¯å¯¹äº Sender\u003cT\u003e çš„æˆå‘˜ Arc\u003cInner\u003cT\u003e\u003e æ¥è¯´ï¼ŒArc å¯ä»¥ clone æ— è®ºå†…éƒ¨ç±»å‹ T æ˜¯å¦å®ç°äº† Clone è¿™ä¸ª traitï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å®ç° Clone è¿™ä¸ª traitã€‚è¿™ä¹Ÿæ˜¯ #[derive(clone)] å’Œæ‰‹åŠ¨å®ç° impl Clone çš„ä¸€ä¸ªç»†å°å·®åˆ«ã€‚ impl\u003cT\u003e Clone for Sender\u003cT\u003e { ... } ä¸ºäº†é˜²æ­¢è°ƒç”¨ clone äº§ç”Ÿçš„äºŒä¹‰æ€§ (å› ä¸ºç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è§£å¼•ç”¨)ï¼Œå»ºè®®ä½¿ç”¨ explict æ–¹å¼æ¥è°ƒç”¨ Arc::clone()ï¼Œè¿™æ ·ç¼–è¯‘å™¨å°±ä¼šçŸ¥é“è°ƒç”¨çš„æ˜¯ Arc çš„ clone æ–¹æ³•ï¼Œè€Œä¸æ˜¯ Arc å†…éƒ¨ object çš„ clone æ–¹æ³•ã€‚ let inner = Arc\u003cInner\u003cT\u003e\u003e; inner.clone(); // Inner\u003cT\u003e's clone method? or Arc::clone method? Arc::clone(\u0026inner); // explict Arc::clone ! ","date":"2024-02-29","objectID":"/posts/channels/:2:3","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"dbg Macro std::dbg å¼•ç”¨ Prints and returns the value of a given expression for quick and dirty debugging. let a = 2; let b = dbg!(a * 2) + 1; // ^-- prints: [src/main.rs:2] a * 2 = 4 assert_eq!(b, 5); The macro works by using the Debug implementation of the type of the given expression to print the value to stderr along with the source location of the macro invocation as well as the source code of the expression. è°ƒè¯•çš„å¤§æ€å™¨ï¼Œä½œç”¨ç±»ä¼¼äº kernel ä¸­çš„ debugk å® ğŸ¤£ å¸¸ç”¨äºæ£€æµ‹ç¨‹åºè¿è¡Œæ—¶æ˜¯å¦æ‰§è¡Œäº†æŸäº›è¯­å¥ï¼Œä»¥åŠè¿™äº›è¯­å¥çš„å€¼å¦‚ä½•ã€‚ ","date":"2024-02-29","objectID":"/posts/channels/:2:4","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Performance optimization Every operation takes the lock and that's fine if you have a channel that is not very high performance, but if you wanted like super high performance, like you have a lot of sends that compete with each other, then you might not want the sends to contend with one another. Image that you have 10 threads are trying to send at the same time, you could perhaps write an implementation that allows them to do that. The only thing that really needs to be synchronized is the senders with the receivers, as opposed to the senders with one another, whereas we're actually locking all of them. ä½¿ç”¨ VecDeque ä½œä¸ºç¼“å†²åŒºï¼Œä¼šå¯¼è‡´ send æ—¶çš„æ•ˆèƒ½é—®é¢˜ã€‚å› ä¸º send æ˜¯ä½¿ç”¨ push_back æ–¹æ³•æ¥å°† object åŠ å…¥åˆ° VecDeque ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹ VecDeque å¯èƒ½ä¼šå‘ç”Ÿ resize æ“ä½œï¼Œè¿™ä¼šèŠ±è´¹è¾ƒé•¿æ—¶é—´å¹¶ä¸”åœ¨è¿™ä¸ªè¿‡ç¨‹æ—¶ sender ä»ç„¶æŒæœ‰ Mutexï¼Œæ‰€ä»¥å¯¼è‡´å…¶ä»– sender å’Œ recevier å¹¶ä¸èƒ½ä½¿ç”¨ VecDequeï¼Œæ‰€ä»¥åœ¨å®ä½œä¸­å¹¶ä¸ä½¿ç”¨ VecDeque ä»¥é¿å…ç›¸åº”çš„æ•ˆèƒ½æŸå¤±ã€‚ å› ä¸ºåªæœ‰ä¸€ä¸ª receiverï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ç¼“å†²åŒºæ¥æé«˜æ•ˆèƒ½ï¼Œä¸€æ¬¡æ€§æ¥å—å¤§æ‰¹æ•°æ®å¹¶è¿›è¡Œç¼“å­˜ï¼Œè€Œä¸æ˜¯æ¯æ¬¡åªæ¥æ”¶ä¸€ä¸ªæ•°æ®å°±æ”¾å¼ƒ Mutex (Batch recv optimization)ã€‚å½“ç„¶è¿™ä¸ªå¦‚æœä½¿ç”¨ VecDeque ä¾ç„¶ä¼šåœ¨ recv æ—¶å‡ºç°ä¸Šé¢çš„ resize æ•ˆèƒ½é—®é¢˜ã€‚ ","date":"2024-02-29","objectID":"/posts/channels/:2:5","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Synchronous channels Module std::sync::mpsc These channels come in two flavors: An asynchronous, infinitely buffered channel. The channel function will return a (Sender, Receiver) tuple where all sends will be asynchronous (they never block). The channel conceptually has an infinite buffer. A synchronous, bounded channel. The sync_channel function will return a (SyncSender, Receiver) tuple where the storage for pending messages is a pre-allocated buffer of a fixed size. All sends will be synchronous by blocking until there is buffer space available. Note that a bound of 0 is allowed, causing the channel to become a â€œrendezvousâ€ channel where each sender atomically hands off a message to a receiver. ","date":"2024-02-29","objectID":"/posts/channels/:2:6","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Channel flavors Synchronous channels: Channel where send() can block. Limited capacity. Mutex + Condvar + VecDeque Atomic VecDeque (atomic queue) + thread::park + thread::Thread::notify Asynchronous channels: Channel where send() cannot block. Unbounded. Mutex + Condvar + VecDeque Mutex + Condvar + LinkedList Atomic linked list, linked list of T Atomic block linked list, linked list of atomic VecDeque Rendezvous channels: Synchronous with capacity = 0. Used for thread synchronization. Oneshot channels: Any capacity. In practice, only one call to send(). ","date":"2024-02-29","objectID":"/posts/channels/:2:7","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"async/await Module std::future Keyword async Keyword await ","date":"2024-02-29","objectID":"/posts/channels/:2:8","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Homework ä¿¡æ¯ å®ä½œè¯´æ˜: å°è¯•å®ç° Synchronous channels ä½¿ç”¨ Atomic å­˜å‚¨ senders ä»¥æé«˜æ•ˆèƒ½ ä½¿ç”¨ä¸¤ä¸ª ConVar æ¥æŒ‡ç¤º sender å’Œ receiver è¿›è¡Œ block å’Œ wake up receiver è¢« drop æ—¶éœ€è¦é€šçŸ¥æ‰€æœ‰ senders ä»¥é‡Šæ”¾èµ„æº ä½¿ç”¨ linked list æ¥å–ä»£ VecDeque ä»¥é¿å… resize çš„æ•ˆèƒ½æŸå¤± å°è¯•é˜…è¯» std ä¸­ mpsc çš„å®ç° Module std::sync::mpsc å¯¹æ¯”é˜…è¯»å…¶ä»–åº“å…³äº channel çš„å®ç°: crossbeam, flume å‚è€ƒèµ„æ–™: Module std::sync::atomic Module std::sync::mpsc Crate crossbeam Crate flume ","date":"2024-02-29","objectID":"/posts/channels/:3:0","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Documentations è¿™é‡Œåˆ—ä¸¾è§†é¢‘ä¸­ä¸€äº›æ¦‚å¿µç›¸å…³çš„ documentation å­¦ä¹ çš„ä¸€æ‰‹èµ„æ–™æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œè¯·åŠ¡å¿…è‡ªä¸»å­¦ä¼šé˜…è¯»è§„æ ¼ä¹¦ä¹‹ç±»çš„èµ„æ–™ ","date":"2024-02-29","objectID":"/posts/channels/:4:0","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"Crate std å¯ä»¥ä½¿ç”¨è¿™é‡Œæä¾›çš„æœç´ æ è¿›è¡Œæœç´¢ (BTW ä¸è¦æµªè´¹æ—¶é—´åœ¨ Google æœå¯»ä¸Šï¼) Module std::sync::mpsc Function std::sync::mpsc::channel Struct std::sync::mpsc::Sender Struct std::sync::mpsc::Receiver Module std::sync Struct std::sync::Arc Struct std::sync::Mutex Struct std::sync::Condvar method std::sync::Condvar::wait method std::sync::Condvar::notify_one Module std::sync::atomic Trait std::marker::Send Struct std::collections::VecDeque Function std::mem::take Function std::mem::swap Macro std::dbg ","date":"2024-02-29","objectID":"/posts/channels/:4:1","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["Rust"],"content":"References Go è¯­è¨€ä¹Ÿæœ‰ channel: è§£è¯´ Go channel åº•å±‚åŸç† [bilibili] å¯èƒ½ä¸æ˜¯ä½ çœ‹è¿‡æœ€æ— èŠçš„ Rust å…¥é—¨å–œå‰§ 102 (3) å¤šçº¿ç¨‹å¹¶å‘ [bilibili] ","date":"2024-02-29","objectID":"/posts/channels/:5:0","tags":["Rust","Channel"],"title":"Crust of Rust: Channels","uri":"/posts/channels/"},{"categories":["C","Linux Kernel Internals"],"content":" Linux æ ¸å¿ƒä½œä¸ºä¸–ç•Œä¸Šæœ€æˆåŠŸçš„å¼€æ”¾åŸå§‹ç è®¡åˆ’ï¼Œä¹Ÿæ˜¯ C è¯­è¨€åœ¨å·¥ç¨‹é¢†åŸŸçš„ç‘°å®ï¼Œé‡Œå¤´å……æ–¥åˆ™å„ç§â€œè‰ºæœ¯â€ï¼Œå¾€å¾€ä¼šå“åˆ°åˆæ¬¡æ¥è§¦çš„äººä»¬ï¼Œä½†æ€»æ˜¯èƒ½å¤Ÿä½¿ç”¨ C è¯­è¨€æ ‡å‡†å’Œå¼€å‘å·¥å…·æä¾›çš„æ‰©å±• (ä¸»è¦æ˜¯æ¥è‡ª gcc çš„ GNU extensions) æ¥è§£é‡Šã€‚ å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ åŸæ–‡åœ°å€ If I had eight hours to chop down a tree, Iâ€™d spend six hours sharpening my axe. â€”â€” Abraham Lincoln è¯­è¨€è§„æ ¼: C89/C90 -\u003e C99 -\u003e C11 -\u003e C17/C18 -\u003e C2x ","date":"2024-02-28","objectID":"/posts/c-standards/:0:0","tags":["Sysprog","C","Standard"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å¼€å‘å·¥å…·å’Œè§„æ ¼æ ‡å‡†","uri":"/posts/c-standards/"},{"categories":["C","Linux Kernel Internals"],"content":"C vs C++ C is quirky, flawed, and an enormous success. Although accidents of history surely helped, it evidently satisfied a need for a system implementation language efficient enough to displace assembly language, yet sufficiently abstract and fluent to describe algorithms and interactions in a wide variety of environments. â€”â€” Dennis M. Ritchie David Brailsford: Why C is so Influential - Computerphile Linus Torvalds: c++ in linux kernel And I really do dislike C++. Itâ€™s a really bad language, in my opinion. It tries to solve all the wrong problems, and does not tackle the right ones. The things C++ â€œsolvesâ€ are trivial things, almost purely syntactic extensions to C rather than fixing some true deep problem. Bjarne Stroustrup: Learning Standard C++ as a New Language [PDF] C++ æ ‡å‡†æ›´æ–°é£å¿«: C++11, C++14, C++17, â€¦ ä» C99, C++98 å¼€å§‹ï¼ŒC è¯­è¨€å’Œ C++ åˆ†é“æ‰¬é•³ in C, everything is a representation (unsigned char [sizeof(TYPE)]). â€”â€” Rich Rogers ç¬¬ä¸€å€‹ C èªè¨€ç·¨è­¯å™¨æ˜¯æ€æ¨£ç·¨å¯«çš„ï¼Ÿ ä»‹ç»äº†è‡ªä¸¾ (sel-hosting/compiling) ä»¥åŠ C0, C1, C2, C3, â€¦ ç­‰çš„æ¼”åŒ–è¿‡ç¨‹ ","date":"2024-02-28","objectID":"/posts/c-standards/:1:0","tags":["Sysprog","C","Standard"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å¼€å‘å·¥å…·å’Œè§„æ ¼æ ‡å‡†","uri":"/posts/c-standards/"},{"categories":["C","Linux Kernel Internals"],"content":"C è¯­è¨€è§„æ ¼ä¹¦ ","date":"2024-02-28","objectID":"/posts/c-standards/:2:0","tags":["Sysprog","C","Standard"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å¼€å‘å·¥å…·å’Œè§„æ ¼æ ‡å‡†","uri":"/posts/c-standards/"},{"categories":["C","Linux Kernel Internals"],"content":"main é˜…è¯» C è¯­è¨€è§„æ ¼ä¹¦å¯ä»¥è®©ä½ æ´å¯Ÿæœ¬è´¨ï¼Œä¸åœ¨æ²¡æ„ä¹‰çš„äº‹æƒ…ä¸Šæµªè´¹æ—¶é—´ï¼Œä¾‹å¦‚åœ¨æŸä¹å¤§è‚†è®¨è®ºçš„ void main() å’Œ int main() é—®é¢˜ ğŸ¤£ C99/C11 5.1.2.2.1 Program startup The function called at program startup is named main. The implementation declares no prototype for this function. It shall be defined with a return type of int and with no parameters: int main(void) { /* ... */ } or with two parameters (referred to here as argc and argv, though any names may be used, as they are local to the function in which they are declared): int main(int argc, char *argv[]) { /* ... */ } or equivalent; or in some other implementation-defined manner. Thus, int can be replaced by a typedef name defined as int, or the type of argv can be written as char ** argv, and so on. ","date":"2024-02-28","objectID":"/posts/c-standards/:2:1","tags":["Sysprog","C","Standard"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å¼€å‘å·¥å…·å’Œè§„æ ¼æ ‡å‡†","uri":"/posts/c-standards/"},{"categories":["C","Linux Kernel Internals"],"content":"incomplete type C99 6.2.5 Types incomplete types (types that describe objects but lack information needed to determine their sizes). ","date":"2024-02-28","objectID":"/posts/c-standards/:2:2","tags":["Sysprog","C","Standard"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å¼€å‘å·¥å…·å’Œè§„æ ¼æ ‡å‡†","uri":"/posts/c-standards/"},{"categories":["C","Linux Kernel Internals"],"content":"è§„æ ¼ä¸ä»…è¦çœ‹æœ€æ–°çš„ï¼Œè¿‡å¾€çš„ä¹Ÿè¦ç†Ÿæ‚‰ å› ä¸ºå¾ˆå¤š (åµŒå…¥å¼) è®¾å¤‡ä¸Šè¿è¡Œçš„ Linux å¯èƒ½æ˜¯å¾ˆæ—§çš„ç‰ˆæœ¬ï¼Œé‚£æ—¶ Linux ä½¿ç”¨çš„æ˜¯æ›´æ—§çš„ C è¯­è¨€è§„æ ¼ã€‚ä¾‹å¦‚ç©ºä¸­å·´å£« 330 å®¢æœºçš„å¨±ä¹ç³»ç»Ÿé‡Œæ‰§è¡Œçš„æ˜¯åå‡ å¹´å‰çš„ Red Hat Linuxï¼Œæ€»æœ‰äººè¦ä¸ºè¿™äº›â€œå¤è‘£â€è´Ÿè´£ ğŸ¤£ ","date":"2024-02-28","objectID":"/posts/c-standards/:2:3","tags":["Sysprog","C","Standard"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å¼€å‘å·¥å…·å’Œè§„æ ¼æ ‡å‡†","uri":"/posts/c-standards/"},{"categories":["C","Linux Kernel Internals"],"content":"GDB ä½¿ç”¨ GDB è¿™ç±»è°ƒè¯•å·¥å…·å¯ä»¥å¤§å¹…åº¦æå‡æˆ‘ä»¬ç¼–å†™ä»£ç ã€é™¤é”™çš„èƒ½åŠ› ğŸ¶ video: Linux basic anti-debug video: C Programming, Disassembly, Debugging, Linux, GDB rr (Record and Replay Framework) video: Quick demo video: Record and replay debugging with â€œrrâ€ ","date":"2024-02-28","objectID":"/posts/c-standards/:3:0","tags":["Sysprog","C","Standard"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å¼€å‘å·¥å…·å’Œè§„æ ¼æ ‡å‡†","uri":"/posts/c-standards/"},{"categories":["C","Linux Kernel Internals"],"content":"C23 ä¸Šä¸€ä¸ª C è¯­è¨€æ ‡å‡†æ˜¯ C17ï¼Œæ­£å¼åç§°ä¸º ISO/IEC 9899:2018ï¼Œæ˜¯ 2017 å¹´å‡†å¤‡ï¼Œ2018å¹´æ­£å¼å‘å¸ƒçš„æ ‡å‡†è§„èŒƒã€‚C23 åˆ™æ˜¯ç›®å‰æ­£åœ¨å¼€å‘çš„è§„æ ¼ï¼Œå…¶é¢„è®¡æ–°å¢ç‰¹æ€§å¦‚ä¸‹: typeof: ç”± GNU extension è½¬æ­£ï¼Œç”¨äºå®ä½œ container_of å® call_once: ä¿è¯åœ¨ concurrent ç¯å¢ƒä¸­ï¼ŒæŸæ®µç¨‹å¼ç åªä¼šæ‰§è¡Œ 1 æ¬¡ char8_t: Unicode friendly u8\"ğŸ’£\"[0] unreachable(): ç”± GNU extension è½¬æ­£ï¼Œæç¤ºå…è®¸ç¼–è¯‘å™¨å¯¹æŸæ®µç¨‹å¼ç è¿›è¡Œæ›´æ¿€è¿›çš„æœ€ä½³åŒ– = {}: å–ä»£ memset å‡½æ•°è°ƒç”¨ ISO/IEC 60559:2020: æœ€æ–°çš„ IEEE 754 æµ®ç‚¹æ•°è¿ç®—æ ‡å‡† _Static_assert: æ‰©å…… C11 å…è®¸å•ä¸€å‚æ•° å¸æ”¶ C++11 é£æ ¼çš„ attribute è¯­æ³•ï¼Œä¾‹å¦‚ nodiscard, maybe_unused, deprecated, fallthrough æ–°çš„å‡½æ•°: memccpy(), strdup(), strndup() â€”â€”â€” ç±»ä¼¼äº POSIXã€SVIDä¸­ C å‡½æ•°åº“çš„æ‰©å…… å¼ºåˆ¶è§„èŒƒä½¿ç”¨äºŒè¡¥æ•°è¡¨ç¤ºæ•´æ•° ä¸æ”¯æ´ K\u0026R é£æ ¼çš„å‡½æ•°å®šä¹‰ äºŒè¿›åˆ¶è¡¨ç¤ºæ³•: 0b10101010 ä»¥åŠå¯¹åº” printf() çš„ %b (åœ¨æ­¤ä¹‹å‰ C è¯­è¨€æ˜¯ä¸æ”¯æ´äºŒè¿›åˆ¶è¡¨ç¤ºæ³•çš„ ğŸ¤£) Type generic functions for performing checked integer arithmetic (Integer overflow) _BitInt(N) and UnsignedBitInt(N) types for bit-precise integers #elifdef and #elifndef æ”¯æŒåœ¨æ•°å€¼ä¸­é—´åŠ å…¥åˆ†éš”ç¬¦ï¼Œæ˜“äºé˜…è¯»ï¼Œä¾‹å¦‚ 0xFFFF'FFFF ä¿¡æ¯ Ever Closer - C23 Draws Nearer C23 is Finished: Here is What is on the Menu ","date":"2024-02-28","objectID":"/posts/c-standards/:4:0","tags":["Sysprog","C","Standard"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å¼€å‘å·¥å…·å’Œè§„æ ¼æ ‡å‡†","uri":"/posts/c-standards/"},{"categories":["C","Linux Kernel Internals"],"content":" ä¸å°‘ C/C++ å¼€å‘è€…å¬è¿‡ â€œå†…å­˜å¯¹é½â€ (memory alignment)ï¼Œä½†ä¸æ˜“æŒæ¡æ¦‚å¿µåŠè§„åˆ™ï¼Œé‘è®ºå…¶åœ¨æ‰§è¡Œæ—¶æœŸçš„å†²å‡»ã€‚å†…å­˜ç®¡ç†åƒæ˜¯ malloc/free å‡½æ•°çš„ä½¿ç”¨ï¼Œæ˜¯æ¯ä¸ª C è¯­è¨€ç¨‹åºè®¾è®¡å¼€å‘è€…éƒ½ä¼šæ¥è§¦åˆ°ï¼Œä½†å´éš¾ä¿å……åˆ†æ’é™¤é”™è¯¯çš„éš¾é¢˜ã€‚æœ¬è®²åº§å°è¯•ä»ç¡¬ä½“çš„è¡Œä¸ºå¼€å§‹æ¢è®¨ï¼Œå¸Œæœ›æ¶ˆé™¤è§‚ä¼—å¯¹äº alignment, padding, memory allocator çš„è¯¯è§£ï¼Œå¹¶ä¸”æ¢è®¨é«˜æ•ˆèƒ½ memory pool çš„è®¾è®¡ï¼Œå¦‚ä½•æ”¹å–„æ•´ä½“ç¨‹åºçš„æ•ˆèƒ½å’Œå¯é åº¦ã€‚ä¹Ÿä¼šæ¢è®¨ C11 æ ‡å‡†çš„ aligned_allocã€‚ åŸæ–‡åœ°å€ ","date":"2024-02-27","objectID":"/posts/c-memory/:0:0","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"èƒŒæ™¯çŸ¥è¯† ","date":"2024-02-27","objectID":"/posts/c-memory/:1:0","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡ C99/C11 6.2.5 Types (28) A pointer to void shall have the same representation and alignment requirements as a pointer to a character type. C99/C11 6.3.2.3 Pointers (1) A pointer to void may be converted to or from a pointer to any object type. A pointer to any object type may be converted to a pointer to void and back again; the result shall compare equal to the original pointer. ä½¿ç”¨ void * å¿…é¡»é€šè¿‡ explict (æ˜¾å¼) æˆ–å¼ºåˆ¶è½¬å‹ï¼Œæ‰èƒ½å­˜å–æœ€ç»ˆçš„ objectï¼Œå› ä¸º void æ— æ³•åˆ¤æ–­ object çš„å¤§å°ä¿¡æ¯ã€‚ ","date":"2024-02-27","objectID":"/posts/c-memory/:1:1","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å‡½æ•°å‘¼å«ç¯‡ glibc æä¾›äº† malloc_stats() å’Œ malloc_info() è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œå¯ä»¥æŸ¥è¯¢ process çš„ heap ç©ºé—´ä½¿ç”¨æƒ…å†µä¿¡æ¯ã€‚ ","date":"2024-02-27","objectID":"/posts/c-memory/:1:2","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"Memory é‡‘å­—å¡” è¿™ä¸ªé‡‘å­—å¡”çš„å±‚çº§å›¾æç¤ºæˆ‘ä»¬ï¼Œå–„ç”¨ Cache locality å¯ä»¥æœ‰æ•ˆæé«˜ç¨‹å¼æ•ˆèƒ½ã€‚ æŠ€å·§ What a C programmer should know about memory (ç®€è®°) ","date":"2024-02-27","objectID":"/posts/c-memory/:2:0","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"Understanding virtual memory - the plot thickens The virtual memory allocator (VMA) may give you a memory it doesnâ€™t have, all in a vain hope that youâ€™re not going to use it. Just like banks today è™šæ‹Ÿå†…å­˜çš„ç®¡ç†ç±»ä¼¼äºé“¶è¡Œï¼Œè¿”å›çš„åˆ†é…ç©ºé—´æœªå¿…å¯ä»¥ç«‹å³ä½¿ç”¨ã€‚memory allocator å’Œé“¶è¡Œç±»ä¼¼ï¼Œå¯ç”¨ç©ºé—´å°±ç±»ä¼¼äºé“¶è¡Œçš„ç°é‡‘å‚¨å¤‡é‡‘ï¼Œé“¶è¡Œå¯ä»¥å¼€å¾ˆå¤šæ”¯ç¥¨ï¼Œä½†æ˜¯è¿™äº›æ”¯ç¥¨å¯ä»¥å…‘ç°çš„å‰ææ˜¯è¿™äº›æ”¯ç¥¨ä¸ä¼šåœ¨åŒä¸€æ—¶é—´æ¥å…‘ç°ï¼Œè™šæ‹Ÿå†…å­˜ç®¡ç†ä¹Ÿç±»ä¼¼ï¼Œåˆ†é…ç©ºé—´ä¹ŸæœŸæœ›ç”¨æˆ·ä¸ä¼šç«‹å³å…¨éƒ¨ä½¿ç”¨ã€‚ ","date":"2024-02-27","objectID":"/posts/c-memory/:2:1","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"Understanding stack allocation This is how variable-length arrays (VLA), and also alloca() work, with one difference - VLA validity is limited by the scope, allocaâ€™d memory persists until the current function returns (or unwinds if youâ€™re feeling sophisticated). VLA å’Œ alloca åˆ†é…çš„éƒ½æ˜¯æ ˆ (stack) ç©ºé—´ï¼Œåªéœ€å°†æ ˆæŒ‡é’ˆ (sp) æŒ‰éœ€æ±‚åŠ å‡ä¸€ä¸‹å³å¯å®ç°ç©ºé—´åˆ†é…ã€‚å› ä¸º stack ç©ºé—´æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥ Linux æ ¸å¿ƒä¸­ç¦æ­¢ä½¿ç”¨ VLAï¼Œé˜²æ­¢ Stack Overflow ğŸ¤£ ","date":"2024-02-27","objectID":"/posts/c-memory/:2:2","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"Slab allocator The principle of slab allocation was described by Bonwick for a kernel object cache, but it applies for the user-space as well. Oh-kay, weâ€™re not interested in pinning slabs to CPUs, but back to the gist â€” you ask the allocator for a slab of memory, letâ€™s say a whole page, and you cut it into many fixed-size pieces. Presuming each piece can hold at least a pointer or an integer, you can link them into a list, where the list head points to the first free element. åœ¨ä½¿ç”¨ alloc çš„å†…å­˜ç©ºé—´æ—¶ï¼Œè¿™äº›ç©ºé—´å¾ˆæœ‰å¯èƒ½æ˜¯ä¸è¿ç»­çš„ã€‚æ‰€ä»¥æ­¤æ—¶å¯¹äºç³»ç»Ÿå°±ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä¸€ä¸ªæ˜¯å†…å­˜ç©ºé—´ç¢ç‰‡ fragmentï¼Œå› ä¸ºåˆ†é…çš„ç©ºé—´æœªå¿…ä¼šå…¨éƒ¨ä½¿ç”¨åˆ°ï¼Œå¦ä¸€ä¸ªæ˜¯å› ä¸ºä¸è¿ç»­ï¼Œæ‰€ä»¥æ— æ³•åˆ©ç”¨ Cache locality æ¥æå‡æ•ˆèƒ½ã€‚ ","date":"2024-02-27","objectID":"/posts/c-memory/:2:3","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"Demand paging explained Linux ç³»ç»Ÿä¼šæä¾›ä¸€äº›å†…å­˜ç®¡ç†çš„ API å’Œæœºåˆ¶: mlock() - lock/unlock memory ç¦æ­¢æŸä¸ªåŒºåŸŸçš„å†…å­˜è¢« swapped out åˆ°ç£ç›˜ (åªæ˜¯å‘ OS å»ºè®®ï¼ŒOS å¯èƒ½ä¸ä¼šç†ä¼š) madvise() - give advice about use of memory (åŒæ ·åªæ˜¯å‘ OS å»ºè®®ï¼ŒOS å¯èƒ½ä¸ä¼šç†ä¼š) lazy loading - åˆ©ç”¨ç¼ºé¡µå¼‚å¸¸ (page-fault) æ¥å®ç° copy on write ä¿¡æ¯ ç¾ä»£è™•ç†å™¨è¨­è¨ˆ: Cache åŸç†å’Œå¯¦éš›å½±éŸ¿ Cache åŸç†å’Œå¯¦éš›å½±éŸ¿: é€²è¡Œ CPU caches ä¸­æ–‡é‡é»æç¤ºä¸¦ä¸”é‡ç¾å°æ‡‰çš„å¯¦é©— é‡å°å¤šåŸ·è¡Œç·’ç’°å¢ƒè¨­è¨ˆçš„ Memory allocator rpmalloc æ¢è¨ ","date":"2024-02-27","objectID":"/posts/c-memory/:2:4","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"å † Heap Stack Overflow: Why are two different concepts both called â€œheapâ€? Several authors began about 1975 to call the pool of available memory a â€œheap.â€ ","date":"2024-02-27","objectID":"/posts/c-memory/:3:0","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"Data alignment ä¸€ä¸ª data object å…·æœ‰ä¸¤ä¸ªç‰¹æ€§: value storage location (address) ","date":"2024-02-27","objectID":"/posts/c-memory/:4:0","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"alignment vs unalignment å‡è®¾ç¡¬ä½“è¦æ±‚ 4 Bytes alignmentï¼ŒCPU å­˜å–æ•°æ®æ—¶çš„æ“ä½œå¦‚ä¸‹: alignment unalignment Source é™¤æ­¤ä¹‹å¤–ï¼Œunalignment ä¹Ÿå¯èƒ½ä¼šæ— æ³•å……åˆ†åˆ©ç”¨ cache æ•ˆèƒ½ï¼Œå³å­˜å–çš„æ•°æ®ä¸€éƒ¨åˆ† cache hitï¼Œå¦ä¸€éƒ¨åˆ† cache missã€‚å½“ç„¶å¯¹äºè¿™ç§æƒ…å†µï¼Œcache ä¹Ÿæ˜¯é‡‡ç”¨ç±»ä¼¼ä¸Šé¢çš„ merge æœºåˆ¶æ¥è¿›è¡Œå­˜å–ï¼Œåªæ˜¯æ•ˆèƒ½ä½ä¸‹ã€‚ GCC: 6.60.8 Structure-Packing Pragmas The n value below always is required to be a small power of two and specifies the new alignment in bytes. #pragma pack(push[,n]) pushes the current alignment setting on an internal stack and then optionally sets the new alignment. #pragma pack(pop) restores the alignment setting to the one saved at the top of the internal stack (and removes that stack entry). Note that #pragma pack([n]) does not influence this internal stack; thus it is possible to have #pragma pack(push) followed by multiple #pragma pack(n) instances and finalized by a single #pragma pack(pop). alignment ä¸ unalignment çš„æ•ˆèƒ½åˆ†å¸ƒ: ","date":"2024-02-27","objectID":"/posts/c-memory/:4:1","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"malloc malloc åˆ†é…çš„ç©ºé—´æ˜¯ alignment çš„: man malloc The malloc() and calloc() functions return a pointer to the allocated memory, which is suitably aligned for any built-in type. The GNU C Library - Malloc Example The block that malloc gives you is guaranteed to be aligned so that it can hold any type of data. On GNU systems, the address is always a multiple of eight on 32-bit systems, and a multiple of 16 on 64-bit systems. ä½¿ç”¨ GDB è¿›è¡Œæµ‹è¯•ï¼Œç¡®å®šåœ¨ Linux x86_64 ä¸Š malloc åˆ†é…çš„å†…å­˜ä»¥ 16 Bytes å¯¹é½ï¼Œå³åœ°å€ä»¥ 16 è¿›åˆ¶æ˜¾ç¤ºæ—¶æœ€åä¸€ä¸ªæ•°ä¸º 0ã€‚ ","date":"2024-02-27","objectID":"/posts/c-memory/:4:2","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"unalignment get \u0026 set å¦‚ä¸Šé¢æ‰€è¿°ï¼Œåœ¨ 32-bit æ¶æ„ä¸Šè¿›è¡Œ 8 bytes å¯¹é½çš„å­˜å–æ•ˆèƒ½æ¯”è¾ƒé«˜ (è¿œæ¯”å•çº¯è®¿é—®ä¸€ä¸ª byte é«˜)ï¼Œæ‰€ä»¥åŸæ–‡åˆ©ç”¨è¿™ä¸€ç‰¹æ€§å®ä½œäº† unaligned_get8 è¿™ä¸€å‡½æ•°ã€‚ csrc \u0026 0xfffffffc å‘ä¸‹å–æ•´åˆ°æœ€è¿‘çš„ 8 bytes alignment çš„åœ°å€ v \u003e\u003e (((uint32_t) csrc \u0026 0x3) * 8) å°†è·å–çš„ alignment çš„ 32-bit è¿›è¡Œä½ç§»ä»¥è·å–æˆ‘ä»¬æƒ³è¦çš„é‚£ä¸ªå­—èŠ‚ è€Œåœ¨ ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡ ä¸­å®ä½œçš„ 16-bit integer åœ¨ unalignment æƒ…å†µä¸‹çš„å­˜å–ï¼Œå¹¶æ²¡æœ‰è€ƒè™‘åˆ°ä¸Šé¢åˆ©ç”¨ alignment æ¥æå‡æ•ˆèƒ½ã€‚ å‚è€ƒåŸæ–‡ 32-bit integer å­˜å–ï¼Œå®ä½œ 64-bit integer çš„ get \u0026 set: ","date":"2024-02-27","objectID":"/posts/c-memory/:4:3","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":"oncurrent-II æºç : concurrent-ll è®ºæ–‡: A Pragmatic Implementation of Non-Blocking Linked Lists ","date":"2024-02-27","objectID":"/posts/c-memory/:5:0","tags":["Sysprog","C","Memory"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: å†…å­˜ç®¡ç†ã€å¯¹é½åŠç¡¬ä½“ç‰¹æ€§","uri":"/posts/c-memory/"},{"categories":["C","Linux Kernel Internals"],"content":" Linux æ ¸å¿ƒåŸå§‹ç¨‹å¼ç å­˜åœ¨å¤§é‡ bit(-wise) operations (ç®€ç§° bitops)ï¼Œé¢‡å¤šä¹çœ‹åƒæ˜¯é­”æ³•çš„ C ç¨‹å¼ç å°±æ˜¯ bitops çš„ç»„åˆã€‚ åŸæ–‡åœ°å€ ","date":"2024-02-23","objectID":"/posts/c-bitwise/:0:0","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"å¤ä¹ æ•°å€¼ç³»ç»Ÿ YouTube: åè¿›åˆ¶ï¼ŒåäºŒè¿›åˆ¶ï¼Œå…­åè¿›åˆ¶ä»ä½•è€Œæ¥ï¼Ÿé˜¿æ‹‰ä¼¯äººæˆå°±äº†æ–‡è‰ºå¤å…´ï¼Ÿ[æ•°å­¦å¤§å¸ˆ] ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿ è§£è¯»è®¡ç®—æœºç¼–ç  ","date":"2024-02-23","objectID":"/posts/c-bitwise/:1:0","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"ä½å…ƒç»„åˆ ä¸€äº›ä½å…ƒç»„åˆè¡¨ç¤ºç‰¹å®šçš„æ„ä¹‰ï¼Œè€Œä¸æ˜¯è¡¨ç¤ºæ•°å€¼ï¼Œè¿™äº›ç»„åˆè¢«ç§°ä¸º trap representation C11 6.2.6.2 Integer types For unsigned integer types other than unsigned char, the bits of the object representation shall be divided into two groups: value bits and padding bits (there need not be any of the latter). If there are N value bits, each bit shall represent a different power of 2 between 1 and 2Nâˆ’1, so that objects of that type shall be capable of representing values from 0 to 2Nâˆ’1 using a pure binary representation; this shall be known as the value representation. The values of any padding bits are unspecified. uintN_t å’Œ intN_t ä¿è¯æ²¡æœ‰å¡«å……ä½å…ƒ (padding bits)ï¼Œä¸” intN_t æ˜¯äºŒè¡¥æ•°ç¼–ç ï¼Œæ‰€ä»¥å¯¹è¿™ä¸¤ç§ç±»å‹è¿›è¡Œä½æ“ä½œæ˜¯å®‰å…¨çš„ã€‚ C99 7.18.1.1 Exact-width integer types The typedef name intN_t designates a signed integer type with width N, no padding bits, and a twoâ€™s complement representation. ä¿¡æ¯ æœ‰ç¬¦å·æ•´æ•°ä¸Šä¹Ÿæœ‰å¯èƒ½äº§ç”Ÿé™·é˜±è¡¨ç¤ºæ³• (trap representation) è¡¥å……èµ„è®¯: CS:APP Web Aside DATA:TMIN: Writing TMin in C ","date":"2024-02-23","objectID":"/posts/c-bitwise/:1:1","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"ä½ç§»è¿ç®— ä½ç§»è¿ç®—çš„æœªå®šä¹‰æƒ…å†µ: C99 6.5.7 Bitwise shift operators å·¦ç§»è¶…è¿‡å˜é‡é•¿åº¦ï¼Œåˆ™è¿ç®—ç»“æœæœªå®šä¹‰ If the value of the right operand is negative or is greater than or equal to the width of the promoted left operand, the behavior is undefined. å¯¹ä¸€ä¸ªè´Ÿæ•°è¿›è¡Œå³ç§»ï¼ŒC è¯­è¨€è§„æ ¼æœªå®šä¹‰ï¼Œä½œä¸º implementation-definedï¼ŒGCC å®ä½œä¸ºç®—æœ¯ä½ç§» (arithmetic shift) If E1 has a signed type and a negative value, the resulting value is implementation-defined. ","date":"2024-02-23","objectID":"/posts/c-bitwise/:1:2","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Signed \u0026 Unsigned å½“ Unsigned å’Œ Signed æ··åˆåœ¨åŒä¸€è¡¨è¾¾å¼æ—¶ï¼ŒSigned ä¼šè¢«è½¬æ¢æˆ Unsignedï¼Œè¿ç®—ç»“æœå¯èƒ½ä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸ (è¿™é‡Œå¤§èµ Rustï¼Œè¿™ç§æƒ…å†µä¼šç¼–è¯‘å¤±è´¥ğŸ¤£)ã€‚æ¡ˆä¾‹è¯·å‚è€ƒåŸæ–‡ï¼Œè¿™é‡Œä¸¾ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„ä¾‹å­: int n = 10; for (int i = n - 1 ; i - sizeof(char) \u003e= 0; i--) printf(\"i: 0x%x\\n\",i); è¿™æ®µç¨‹å¼ç ä¼šå¯¼è‡´æ— é™å¾ªç¯ï¼Œå› ä¸ºæ¡ä»¶åˆ¤æ–­è¯­å¥ i - sizeof(char) \u003e= 0 æ’ä¸ºçœŸ (å˜é‡ i è¢«è½¬æ¢æˆ Unsigned äº†)ã€‚ 6.5.3.4 The sizeof operator The value of the result is implementation-defined, and its type (an unsigned integer type) is size_t, defined in \u003cstddef.h\u003e (and other headers). 7.17 Common definitions \u003cstddef.h\u003e size_t which is the unsigned integer type of the result of the sizeof operator ","date":"2024-02-23","objectID":"/posts/c-bitwise/:1:3","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Sign Extension å°† w bit signed integer æ‰©å±•ä¸º w+k bit signed integerï¼Œåªéœ€å°† sign bit è¡¥å……è‡³æ‰©å±•çš„ bitsã€‚ æ•°å€¼ç­‰ä»·æ€§æ¨å¯¼: positive: æ˜¾ç„¶æ˜¯æ­£ç¡®çš„ï¼Œsign bit ä¸º 0ï¼Œæ‰©å±•åæ•°å€¼ä»ç­‰äºåŸæ•°å€¼ negitive: å°† w bit æƒ…å½¢æ—¶çš„é™¤å¼€ sign bit çš„æ•°å€¼è®¾ä¸º Uï¼Œåˆ™åŸæ•°å€¼ä¸º $2^{-(w-1)} + U$ï¼Œåˆ™æ‰©å±•ä¸º w+k bit åæ•°å€¼ä¸º $2^{-(w+k-1)} + 2^{w+k-2} + â€¦ + 2^{-(w-1)} + U$ï¼Œå› ä¸º $2^{-(w+k-1)} + 2^{w+k-2} + â€¦ + 2^{w-1} = 2^{-(w-1)}$ï¼Œæ‰€ä»¥æ•°å€¼ä¾ç„¶ç­‰ä»·ã€‚ $2^{-(w+k-1)} + 2^{w+k-2} + â€¦ + 2^{w-1}$ å¯ä»¥è€ƒè™‘ä»å·¦å¾€å³çš„è¿ç®—ï¼Œæ¯æ¬¡éƒ½æ˜¯å°†åŸå…ˆçš„æ•°å€¼å‡åŠï¼Œæ‰€ä»¥æœ€åçš„æ•°å€¼ä¸º $2^{-(w+k-1)}$ æ‰€ä»¥å¦‚æœ n æ˜¯ signed 32-bitï¼Œåˆ™ n \u003e\u003e 31 ç­‰ä»·äº n == 0 ? 0 : -1ã€‚åœ¨è¿™ä¸ªçš„åŸºç¡€ä¸Šï¼Œè¯·é‡æ–°é˜…è¯» è§£è¯»è®¡ç®—æœºç¼–ç  ä¸­çš„ abs å’Œ min/max çš„å¸¸æ•°æ—¶é—´å®ä½œã€‚ ","date":"2024-02-23","objectID":"/posts/c-bitwise/:1:4","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Bitwise Operator Bitwise Operators Quiz Answers Practice with bit operations Bitwise Practice Each lowercase letter is 32 + uppercase equivalent. This means simply flipping the bit at position 5 (counting from least significant bit at position 0) inverts the case of a letter. The gdb print command (shortened p) defaults to decimal format. Use p/format to instead select other formats such as x for hex, t for binary, and c for char. // unsigned integer `mine`, `yours` remove yours from mine mine = mine \u0026 ~yours test if mine has both of two lowest bits on (mine \u0026 0x3) == 0x3 n least significant bits on, all others off (1 \u003c\u003c n) - 1 k most significant bits on, all others off (~0 \u003c\u003c (32 - k)) or ~(~0U \u003e\u003e k) // unsigned integer `x`, `y` (right-shift: arithmetic shift) x \u0026= (x - 1) clears lowest \"on\" bit in x (x ^ y) \u003c 0 true if x and y have opposite signs ç¨‹åºè¯­è¨€åªæä¾›æœ€å°ç²’åº¦ä¸º Byte çš„æ“ä½œï¼Œä½†æ˜¯ä¸ç›´æ¥æä¾› Bit ç²’åº¦çš„æ“ä½œï¼Œè¿™ä¸å­—èŠ‚é¡ºåºç›¸å…³ã€‚å‡è®¾æä¾›ä»¥ Bit ä¸ºç²’åº¦çš„æ“ä½œï¼Œè¿™å°±éœ€è¦åœ¨ç¼–ç¨‹æ—¶è€ƒè™‘ å¤§ç«¯/å°ç«¯æ¨¡å¼ï¼Œæå…¶ç¹çã€‚ ","date":"2024-02-23","objectID":"/posts/c-bitwise/:2:0","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"bitwise \u0026 logical ä½è¿ç®—æ»¡è¶³äº¤æ¢å¾‹ï¼Œä½†é€»è¾‘è¿ç®—å¹¶ä¸æ»¡è¶³äº¤æ¢å¾‹ï¼Œå› ä¸ºçŸ­è·¯æœºåˆ¶ã€‚è€ƒè™‘ Linked list ä¸­çš„æƒ…å½¢: // list_head *head if (!head || list_empty(head)) if (list_empty(head) || !head) ç¬¬äºŒæ¡è¯­å¥åœ¨æ‰§è¡Œæ—¶ä¼šæŠ¥é”™ï¼Œå› ä¸º list_empty è¦æ±‚ä¼ å…¥çš„å‚æ•°ä¸ä¸º NULLã€‚ é€»è¾‘è¿ç®—ç¬¦ ! ç›¸å½“æœ‰æ•ˆï¼ŒC99 å¹¶æ²¡æœ‰å®Œå…¨æ”¯æŒ bool ç±»å‹ï¼Œå¯¹äºæ•´æ•°ï¼Œå®ƒæ˜¯å°†éé›¶æ•´æ•°è§†ä¸º trueï¼Œé›¶è§†ä¸º falseã€‚æ‰€ä»¥å¦‚æœä½ éœ€è¦ä¿è¯æŸä¸€è¡¨è¾¾å¼çš„ç»“æœä¸ä»…æ˜¯ true of falseï¼Œè¿˜è¦æ±‚å¯¹åº” 0 or 1 æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ !!(expr) æ¥å®ç°ã€‚ C99 6.5.3.3 Unary arithmetic operators The result of the logical negation operator ! is 0 if the value of its operand compares unequal to 0, 1 if the value of its operand compares equal to 0. The result has type int. The expression !E is equivalent to (0==E). æ‰€ä»¥ !!(expr) çš„ç»“æœä¸º int å¹¶ä¸”æ•°å€¼åªæœ‰ 0 æˆ– 1ã€‚ ","date":"2024-02-23","objectID":"/posts/c-bitwise/:2:1","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Right Shifts å¯¹äº Unsigned æˆ– positive sign integer åšå³ç§»è¿ç®—æ—¶ x \u003e\u003e nï¼Œå…¶æœ€ç»ˆç»“æœå€¼ä¸º $\\lfloor x / 2^n \\rfloor$ã€‚ å› ä¸ºè¿™ç§æƒ…å†µçš„å³ç§»æ“ä½œç›¸å½“äºå¯¹æ¯ä¸ª bit è¡¨ç¤ºçš„ power åŠ ä¸Š $-n$ï¼Œå†è€ƒè™‘æœ‰äº› bit è¡¨ç¤ºçš„ power åŠ ä¸Š $-n$ åä¼šå°äº 0ï¼Œæ­¤æ—¶ç›´æ¥å°†è¿™äº› bit æ‰€è¡¨ç¤ºçš„å€¼å»é™¤å³å¯ (å› ä¸ºåœ¨ integer ä¸­ bit çš„ power æœ€å°ä¸º 0ï¼Œå¦‚æœ power å°äº 0 è¡¨ç¤ºçš„æ˜¯å°æ•°å€¼)ï¼Œè¿™ä¸ªæ“ä½œå¯¹åº”äºå‘ä¸‹å–æ•´ã€‚ 00010111 \u003e\u003e 2 (23 \u003e\u003e 4) -\u003e 000101.11 (5.75) -\u003e 000101 (5) ","date":"2024-02-23","objectID":"/posts/c-bitwise/:2:2","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"bitwise å®ä½œ Vi/Vim ä¸ºä»€ä¹ˆä½¿ç”¨ hjkl ä½œä¸ºç§»åŠ¨å­—ç¬¦? ç•¶æˆ‘å€‘å›é¡§ 1967 å¹´ ASCII çš„ç·¨ç¢¼è¦ç¯„ï¼Œå¯ç™¼ç¾å‰ 32 å€‹å­—å…ƒéƒ½æ˜¯æ§åˆ¶ç¢¼ï¼Œè®“äººå€‘å¾—ä»¥é€éé€™äº›ç‰¹åˆ¥å­—å…ƒä¾†æ§åˆ¶ç•«é¢å’Œç›¸é—œ I/Oï¼Œæ—©æœŸéµç›¤çš„ â€œcontrolâ€ æŒ‰éµå°±æ­é…é€™äº›ç‰¹åˆ¥å­—å…ƒä½¿ç”¨ã€‚â€œcontrolâ€ çµ„åˆæŒ‰éµæœƒå°‡åŸæœ¬å­—å…ƒçš„ç¬¬ 1 å€‹ bit é€²è¡Œ XORï¼Œæ–¼æ˜¯ H å­—å…ƒå°æ‡‰ ASCII ç·¨ç¢¼ç‚º 100_1000 (éå»åƒ…ç”¨ 7 bit ç·¨ç¢¼)ï¼Œçµ„åˆ â€œcontrolâ€ å¾Œ (å³ Ctrl+H) æœƒå¾—åˆ° 000_1000ï¼Œä¹Ÿå°±æ˜¯ backspace çš„ç·¨ç¢¼ï¼Œé€™ä¹Ÿæ˜¯ç‚ºä½•åœ¨æŸäº›ç¨‹å¼ä¸­æŒ‰ä¸‹ backspace æŒ‰éµæœƒå¾—åˆ° ^H è¼¸å‡ºçš„åŸå› ã€‚ç›¸ä¼¼åœ°ï¼Œç•¶æŒ‰ä¸‹ Ctrl+J æ™‚æœƒå¾—åˆ° 000_1010ï¼Œå³ linefeed æ³¨æ„ where n is the bit number, and 0 is the least significant bit Source ","date":"2024-02-23","objectID":"/posts/c-bitwise/:3:0","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Set a bit unsigned char a |= (1 \u003c\u003c n); ","date":"2024-02-23","objectID":"/posts/c-bitwise/:3:1","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Clear a bit unsigned char a \u0026= ~(1 \u003c\u003c n); ","date":"2024-02-23","objectID":"/posts/c-bitwise/:3:2","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Toggle a bit unsigned char a ^= (1 \u003c\u003c n); ","date":"2024-02-23","objectID":"/posts/c-bitwise/:3:3","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Test a bit bool a = (val \u0026 (1 \u003c\u003c n)) \u003e 0; ","date":"2024-02-23","objectID":"/posts/c-bitwise/:3:4","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"The right/left most byte // assuming 16 bit, 2-byte short integer unsigned short right = val \u0026 0xff; /* right most (least significant) byte */ unsigned short left = (val \u003e\u003e 8) \u0026 0xff; /* left most (most significant) byte */ // assuming 32 bit, 4-byte int integer unsigned int right = val \u0026 0xff; /* right most (least significant) byte */ unsigned int left = (val \u003e\u003e 24) \u0026 0xff; /* left most (most significant) byte */ ","date":"2024-02-23","objectID":"/posts/c-bitwise/:3:5","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Sign bit // assuming 16 bit, 2-byte short integer, two's complement bool sign = val \u0026 0x8000; // assuming 32 bit, 4-byte int integer, two's complement bool sign = val \u0026 0x80000000; ","date":"2024-02-23","objectID":"/posts/c-bitwise/:3:6","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Uses of Bitwise Operations or Why to Study Bits Compression Set operations Encryption æœ€å¸¸è§çš„å°±æ˜¯ä½å›¾ (bitmap)ï¼Œå¸¸ç”¨äºæ–‡ä»¶ç³»ç»Ÿ (file system)ï¼Œå¯ä»¥èŠ‚çœç©ºé—´ (æ¯ä¸ªå…ƒç´ åªç”¨ä¸€ä¸ª bit æ¥è¡¨ç¤º)ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œé›†åˆæ“ä½œ (é€šè¿‡ bitwise operator)ã€‚ x ^ y = (~x \u0026 y) | (x \u0026 ~y) ","date":"2024-02-23","objectID":"/posts/c-bitwise/:3:7","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"å½±åƒå¤„ç† Stack Overflow: what (r+1 + (r Â» 8)) Â» 8 does? åœ¨å›¾å½¢å¼•æ“ä¸­å°†é™¤æ³•è¿ç®— x / 255 ç”¨ä½è¿ç®— (x+1 + (x \u003e\u003e 8)) \u003e\u003e 8 æ¥å®ä½œï¼Œå¯ä»¥å¤§å¹…åº¦æå‡è®¡ç®—æ•ˆèƒ½ã€‚ ","date":"2024-02-23","objectID":"/posts/c-bitwise/:4:0","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"æ¡ˆä¾‹åˆ†æ å®ä½œç¨‹å¼ç : RGBAtoBW ç»™å®šæ¯ä¸ª pixel ä¸º 32-bit çš„ RGBA çš„ bitmapï¼Œæå‡æ•ˆèƒ½çš„æ–¹æ¡ˆ: å»ºç«‹è¡¨æ ¼åŠ é€Ÿæµ®ç‚¹è¿ç®— å‡å°‘ä½è¿ç®—: å¯ä»¥ä½¿ç”¨ pointer çš„ offset å–ä»£åŸæœ¬å¤æ‚çš„ bitwise operation bwPixel = table[rgbPixel \u0026 0x00ffffff] + rgbPixel \u0026 0xff000000; åªéœ€å¯¹ RGB éƒ¨åˆ†å»ºç«‹æµ®ç‚¹æ•°è¡¨ï¼Œå› ä¸º rgbPixel \u0026 0xff00000 è·å–çš„æ˜¯ Aï¼Œæ— éœ€å‚ä¸æµ®ç‚¹è¿ç®—ã€‚è¿™æ ·å»ºç«‹çš„è¡¨æœ€å¤§ä¸‹æ ‡åº”ä¸º 0x00ffffffï¼Œæ‰€ä»¥è¿™ä¸ªè¡¨å ç”¨ $2^{24} Bytes = 16MB$ï¼Œæ˜¾ç„¶è¿™ä¸ªè¡¨å¤ªå¤§äº† not cache friendly bw = (uint32_t) mul_299[r] + (uint32_t) mul_587[g] + (uint32_t) mul_144[b]; bwPixel = (a \u003c\u003c 24) + (bw \u003c\u003c 16) + (bw \u003c\u003c 8) + bw; åˆ†åˆ«å¯¹ R, G, B å»ºç«‹å¯¹åº”çš„æµ®ç‚¹æ•°è¡¨ï¼Œåˆ™è¿™ä¸‰ä¸ªè¡¨æ€»å…±å ç”¨ $3 \\times 2^8 Bytes \u003c 32KB$ cache friendly ","date":"2024-02-23","objectID":"/posts/c-bitwise/:4:1","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"æ¡ˆä¾‹æ¢è®¨ ä¿¡æ¯ ä½å…ƒæ—‹è½¬å®ä½œå’Œ Linux æ ¸å¿ƒæ¡ˆä¾‹ reverse bit åŸç†å’Œæ¡ˆä¾‹åˆ†æ ","date":"2024-02-23","objectID":"/posts/c-bitwise/:5:0","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"ç±»ç¥ç»ç½‘ç»œçš„ ReLU æå…¶å¸¸æ•°æ—¶é—´å¤æ‚åº¦å®ä½œ åŸæ–‡åœ°å€ ReLU å®šä¹‰å¦‚ä¸‹: $$ ReLU(x) = \\begin{cases} x \u0026 \\text{if } x \\geq 0 \\newline 0 \u0026 \\text{if } x \\lt 0 \\end{cases} $$ æ˜¾ç„¶å¦‚æœ $x$ æ˜¯ 32-bit çš„äºŒè¡¥æ•°ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šé¢æåˆ°çš„ x \u003e\u003e 31 çš„æŠ€å·§æ¥å®ä½œ constant-time function: int32_t ReLU(int32_t x) { return ~(x \u003e\u003e 31) \u0026 x; } ä½†æ˜¯åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæµ®ç‚¹æ•°ä½¿ç”¨æ›´åŠ å¸¸è§ï¼Œå¯¹äºæµ®ç‚¹æ•°è¿›è¡Œä½ç§»è¿ç®—æ˜¯ä¸å…è®¸çš„ C99 6.5.7 Bitwise shift operators Each of the operands shall have integer type. æ‰€ä»¥è¿™é‡Œä»¥ 32-bit float æµ®ç‚¹æ•°ç±»å‹ä¸ºä¾‹ï¼Œåˆ©ç”¨ 32-bit äºŒè¡¥æ•°å’Œ 32-bit float çš„ MSB éƒ½æ˜¯ sign bitï¼Œä»¥åŠ C è¯­è¨€ç±»å‹ union çš„ç‰¹æ€§ C99 6.5.2.3 (82) If the member used to access the contents of a union object is not the same as the member last used to store a value in the object, the appropriate part of the object representation of the value is reinterpreted as an object representation in the new type as described in 6.2.6 (a process sometimes called â€œtype punningâ€). This might be a trap representation. å³ union æ‰€æœ‰æˆå‘˜æ˜¯å…±ç”¨ä¸€å—å†…å­˜çš„ï¼Œæ‰€ä»¥è®¿é—®æˆå‘˜æ—¶ä¼šå°†è¿™å—å†…å­˜å­˜å‚¨çš„ object æŒ‰ç…§æˆå‘˜çš„ç±»å‹è¿›è¡Œè§£é‡Šã€‚åˆ©ç”¨ int32_t å’Œ float çš„ MSB éƒ½æ˜¯ sign bit çš„ç‰¹æ€§ï¼Œå¯ä»¥å·§å¦™ç»•å¼€å¯¹æµ®ç‚¹æ•°è¿›è¡Œä½ç§»è¿ç®—çš„é™åˆ¶ï¼Œå¹¶ä¸”å› ä¸º union æˆå‘˜å†…å­˜çš„å…±ç”¨æ€§è´¨ï¼Œä¿è¯ç»“æœçš„æ•°å€¼ç¬¦åˆé¢„æœŸã€‚ float ReLU(float x) { union { float f; int32_t i; } u = {.f = x}; u.i \u0026= ~(u.i \u003e\u003e 31); return u.f; } åŒç†å¯ä»¥å®Œæˆ 64-bit æµ®ç‚¹æ•°çš„ ReLU å¸¸æ•°æ—¶é—´å®ä½œã€‚ double ReLU(float x) { union { double f; int64_t i; } u = {.f = x}; u.i \u0026= ~(u.i \u003e\u003e 63); return u.f; } ","date":"2024-02-23","objectID":"/posts/c-bitwise/:6:0","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"C è¯­è¨€çš„ bit-field #include \u003cstdbool.h\u003e #include \u003cstdio.h\u003e bool is_one(int i) { return i == 1; } int main() { struct { signed int a : 1; } obj = { .a = 1 }; puts(is_one(obj.a) ? \"one\" : \"not one\"); return 0; } C99 6.7.2.1 Structure and union specifiers A bit-field shall have a type that is a qualified or unqualified version of _Bool, signed int, unsigned int, or some other implementation-defined type. A bit-field is interpreted as a signed or unsigned integer type consisting of the specified number of bits. å°† a è¿™ä¸ª 1-bit çš„ä½åŸŸ (bit-field) å£°æ˜æˆ signed intï¼Œå³å°† a è§†ä¸ºä¸€ä¸ª 1-bit çš„äºŒè¡¥æ•°ï¼Œæ‰€ä»¥ a çš„æ•°å€¼åªæœ‰ 0ï¼Œ-1ã€‚æ¥ä¸‹æ¥å°† 1 èµ‹å€¼ç»™ a ä¼šä½¿å¾— a çš„æ•°å€¼ä¸º -1ï¼Œç„¶åå°† a ä½œä¸ºå‚æ•°ä¼ å…¥ is_one æ—¶ä¼šè¿›è¡Œç¬¦å·æ‰©å±• (sign extension) ä¸º 32-bit çš„äºŒè¡¥æ•° (å‡è®¾ç¼–è¯‘å™¨ä¼šå°† int è§†ä¸º signed int)ï¼Œæ‰€ä»¥æ•°å€¼ä»ç„¶ä¸º -1ã€‚å› æ­¤æœ€ç»ˆä¼šè¾“å‡º â€œnot oneâ€. ","date":"2024-02-23","objectID":"/posts/c-bitwise/:7:0","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["C","Linux Kernel Internals"],"content":"Linux æ ¸å¿ƒ: BUILD_BUG_ON_ZERO() /* * Force a compilation error if condition is true, but also produce a * result (of value 0 and type size_t), so the expression can be used * e.g. in a structure initializer (or where-ever else comma expressions * aren't permitted). */ #define BUILD_BUG_ON_ZERO(e) (sizeof(struct { int:(-!!(e)); })) è¿™ä¸ªå®è¿ç”¨äº†ä¸Šé¢æ‰€è¯´çš„ !! æŠ€å·§å°† -!!(e) çš„æ•°å€¼é™å®šåœ¨ 0 å’Œ -1ã€‚ è¿™ä¸ªå®çš„åŠŸèƒ½æ˜¯: å½“ e ä¸º true æ—¶ï¼Œ-!!(e) ä¸º -1ï¼Œå³ bit-field çš„ size ä¸ºè´Ÿæ•° å½“ e ä¸º false æ—¶ï¼Œ-!!(e) ä¸º 0ï¼Œå³ bit-field çš„ size ä¸º 0 C99 6.7.2.1 Structure and union specifiers The expression that specifies the width of a bit-field shall be an integer constant expression with a nonnegative value that does not exceed the width of an object of the type that would be specified were the colon and expression omitted. If the value is zero, the declaration shall have no declarator. A bit-field declaration with no declarator, but only a colon and a width, indicates an unnamed bit-field. As a special case, a bit-field structure member with a width of 0 indicates that no further bit-field is to be packed into the unit in which the previous bitfield, if any, was placed. (108) An unnamed bit-field structure member is useful for padding to conform to externally imposed layouts. æ ¹æ®ä¸Šé¢ C99 æ ‡å‡†çš„è¯´æ˜ï¼Œå½“ bit-feild çš„ size ä¸ºè´Ÿæ•°æ—¶ä¼šç¼–è¯‘å¤±è´¥ (åªå…è®¸ integer constant expression with a nonnegative value)ï¼Œå½“ bit-field ä¸º 0 æ—¶ï¼Œä¼šè¿›è¡Œ alignment (ä»¥ä¹‹å‰çš„ bit-field æˆå‘˜æ‰€åœ¨çš„ unit ä¸ºå•ä½)ã€‚ struct foo { int a : 3; int b : 2; int : 0; /* Force alignment to next boundary */ int c : 4; int d : 3; }; int main() { int i = 0xFFFF; struct foo *f = (struct foo *) \u0026i; printf(\"a=%d\\nb=%d\\nc=%d\\nd=%d\\n\", f-\u003ea, f-\u003eb, f-\u003ec, f-\u003ed); return 0; } è¿™é‡Œä½¿ç”¨äº† size ä¸º 0 çš„ bit-fieldï¼Œå…¶å†…å­˜å¸ƒå±€å¦‚ä¸‹: i = 1111 1111 1111 1111 X stand for unknown value assume little endian padding \u0026 start from here â†“ 1111 1111 1111 1111XXXX XXXX XXXX XXXX b baaa ddd cccc |â† int 32 bits â†’||â† int 32 bits â†’| zero size bit-field ä½¿å¾—è¿™é‡Œåœ¨ a, b å’Œ c, d ä¹‹é—´è¿›è¡Œ sizeof(int) çš„ alignmentï¼Œæ‰€ä»¥ c, d ä½äº i è¿™ä¸ª object èŒƒå›´ä¹‹å¤–ï¼Œå› æ­¤ c, d æ¯æ¬¡æ‰§è¡Œæ—¶çš„æ•°å€¼æ˜¯ä¸ç¡®å®šçš„ï¼Œå½“ç„¶è¿™ä¹Ÿä¾èµ–äºç¼–è¯‘å™¨ï¼Œå¯ä»¥ä½¿ç”¨ gcc å’Œ clang è¿›è¡Œæµ‹è¯• ğŸ¤£ C11 3.14 1 memory location (NOTE 2) A bit-field and an adjacent non-bit-field member are in separate memory locations. The same applies to two bit-fields, if one is declared inside a nested structure declaration and the other is not, or if the two are separated by a zero-length bit-field declaration, or if they are separated by a non-bit-field member declaration. It is not safe to concurrently update two non-atomic bit-fields in the same structure if all members declared between them are also (non-zero-length) bit-fields, no matter what the sizes of those intervening bit-fields happen to be. æ‰€ä»¥ BUILD_BUG_ON_ZERO å®ç›¸å½“äºç¼–è¯‘æ—¶æœŸçš„ assertï¼Œå› ä¸º assert æ˜¯åœ¨æ‰§è¡Œæ—¶æœŸæ‰ä¼šè§¦å‘çš„ï¼Œå¯¹äº Linux æ ¸å¿ƒæ¥è¯´ä»£ä»·å¤ªå¤§äº† (æƒ³è±¡ä¸€ä¸‹æ ¸å¿ƒè¿è¡Œç€çªç„¶è§¦å‘ä¸€ä¸ª assert å¯¼è‡´å½“æ‰ ğŸ¤£)ï¼Œæ‰€ä»¥é‡‡ç”¨äº† BUILD_BUG_ON_ZERO å®åœ¨ç¼–è¯‘æ—¶æœŸå°±è¿›è¡Œæ£€æŸ¥ (è«åæœ‰ä¸€ç§ Rust çš„é£æ ¼ ğŸ¤£) å¯¹äº BUILD_BUG_ON_ZERO è¿™ä¸ªå®ï¼ŒC11 æä¾›äº† _Static_assert è¯­æ³•è¾¾åˆ°ç›¸åŒæ•ˆæœï¼Œä½†æ˜¯ Linux kernel è‡ªå·±ç»´æŠ¤äº†ä¸€å¥—ç¼–è¯‘å·¥å…·é“¾ (è¿™ä¸ªå·¥å…·é“¾ gcc ç‰ˆæœ¬å¯èƒ½è¿˜æ²¡æ¥çº³ C11 ğŸ¤£)ï¼Œæ‰€ä»¥è¿˜æ˜¯ä½¿ç”¨è‡ªå·±ç¼–å†™çš„ BUILD_BUG_ON_ZERO å®ã€‚ ","date":"2024-02-23","objectID":"/posts/c-bitwise/:7:1","tags":["Sysprog","C","Bitwise"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: bitwise æ“ä½œ","uri":"/posts/c-bitwise/"},{"categories":["Rust"],"content":" In this fourth Crust of Rust video, we cover smart pointers and interior mutability, by re-implementing the Cell, RefCell, and Rc types from the standard library. As part of that, we cover when those types are useful, how they work, and what the equivalent thread-safe versions of these types are. In the process, we go over some of the finer details of Rust's ownership model, and the UnsafeCell type. We also dive briefly into the Drop Check rabbit hole (https://doc.rust-lang.org/nightly/nomicon/dropck.html) before coming back up for air. æ•´ç†è‡ª John Gjengset çš„å½±ç‰‡ ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:0:0","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"å½±ç‰‡æ³¨è§£ ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:1:0","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"Interior Mutability Module std::cell Rust memory safety is based on this rule: Given an object T, it is only possible to have one of the following: Having several immutable references (\u0026T) to the object (also known as aliasing). Having one mutable reference (\u0026mut T) to the object (also known as mutability). Values of the Cell\u003cT\u003e, RefCell\u003cT\u003e, and OnceCell\u003cT\u003e types may be mutated through shared references (i.e. the common \u0026T type), whereas most Rust types can only be mutated through unique (\u0026mut T) references. We say these cell types provide â€˜interior mutabilityâ€™ (mutable via \u0026T), in contrast with typical Rust types that exhibit â€˜inherited mutabilityâ€™ (mutable only via \u0026mut T). We can use (several) immutable references of a cell to mutate the thing inside of the cell. There is (virtually) no way for you to get a reference to the thing inside of a cell. Because if no one else has a pointer to it (the thing inside of a cell), the changing it is fine. Struct std::cell::UnsafeCell If you have a reference \u0026T, then normally in Rust the compiler performs optimizations based on the knowledge that \u0026T points to immutable data. Mutating that data, for example through an alias or by transmuting an \u0026T into an \u0026mut T, is considered undefined behavior. UnsafeCell\u003cT\u003e opts-out of the immutability guarantee for \u0026T: a shared reference \u0026UnsafeCell\u003cT\u003e may point to data that is being mutated. This is called â€œinterior mutabilityâ€. The UnsafeCell API itself is technically very simple: .get() gives you a raw pointer *mut T to its contents. It is up to you as the abstraction designer to use that raw pointer correctly. ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:1:1","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"Cell Module std::cell Cell\u003cT\u003e Cell\u003cT\u003e implements interior mutability by moving values in and out of the cell. That is, an \u0026mut T to the inner value can never be obtained, and the value itself cannot be directly obtained without replacing it with something else. Both of these rules ensure that there is never more than one reference pointing to the inner value. This type provides the following methods: Cell åœ¨ Rust ä¸­å¯¹ä¸€ä¸ªå˜é‡ (T)ï¼Œåœ¨å·²å­˜åœ¨å…¶ immutable references (\u0026T) æ—¶ä½¿ç”¨ mutable reference (\u0026mut T) æ˜¯ç¦æ­¢çš„ï¼Œå› ä¸ºè¿™æ ·ä¼šå› ä¸ºç¼–è¯‘å™¨ä¼˜åŒ–è€Œå¯¼è‡´ç¨‹åºçš„è¡Œä¸ºä¸ä¸€å®šç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚è€ƒè™‘ä»¥ä¸‹çš„ä»£ç : let x = 3; let r1 = \u0026x, r2 = \u0026x; let r3 = \u0026mut x; println!(\"{}\", r1); r3 = 5; println!(\"{}\", r2); å‡è®¾ä»¥ä¸Šçš„ä»£ç å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œé‚£ä¹ˆç¨‹åºæ‰§è¡Œåˆ°ç¬¬ 6 è¡Œæ‰“å°å‡ºæ¥çš„å¯èƒ½æ˜¯ 3 è€Œä¸æ˜¯æˆ‘ä»¬é¢„æœŸçš„ 5ï¼Œè¿™æ˜¯å› ä¸ºç¼–è¯‘å™¨ä¼šå¯¹ immtuable references è¿›è¡Œæ¿€è¿›çš„ä¼˜åŒ–ï¼Œä¾‹å¦‚è¿›è¡Œé¢„å–ï¼Œæ‰€ä»¥åœ¨ç¬¬ 6 è¡Œæ—¶å¯¹äº r2 ä½¿ç”¨çš„è¿˜æ˜¯å…ˆå‰é¢„å–çš„å€¼ 3 è€Œä¸æ˜¯å†…å­˜ä¸­æœ€æ–°çš„å€¼ 5ã€‚è¿™ä¹Ÿæ˜¯ Rust åˆ¶å®šå¯¹ immutable reference å’Œ mutable reference çš„è§„åˆ™çš„åŸå› ä¹‹ä¸€ã€‚ ä¸ºäº†è¾¾åˆ°æˆ‘ä»¬çš„é¢„æœŸè¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨ UnsafeCell æ¥å®ç°: let x = 3; let uc = UnsafeCell::new(x); let r1 = \u0026uc, r2 = \u0026ucï¼Œ r3 = \u0026uc; unsafe { println!(\"{}\", *uc.get()); } unsafe { *uc.get() = 5; } unsafe { println!(\"{}\", *uc.get()); } ä¸Šé¢çš„ä»£ç å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œå¹¶ä¸”åœ¨ç¬¬ 6 è¡Œæ—¶æ‰“å°å‡ºæ¥çš„æ˜¯é¢„æœŸçš„ 5ã€‚è¿™æ˜¯å› ä¸ºç¼–è¯‘å™¨ä¼šå¯¹ UnsafeCell è¿›è¡Œç‰¹åˆ¤ï¼Œè€Œé¿å…è¿›è¡Œä¸€äº›æ¿€è¿›çš„ä¼˜åŒ– (ä¾‹å¦‚é¢„å–)ï¼Œä»è€Œä½¿ç¨‹åºè¡Œä¸ºç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚å¹¶ä¸” UnsafeCell çš„ get() æ–¹æ³•åªéœ€è¦æ¥å— \u0026self å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥å¯¹ UnsafeCell è¿›è¡Œå¤šä¸ª immutable referencesï¼Œè¿™å¹¶ä¸è¿å Rust çš„å†…å­˜å®‰å…¨å‡†åˆ™ã€‚åŒæ—¶æ¯ä¸ªå¯¹äº UnsafeCel çš„ immutable references éƒ½å¯ä»¥é€šè¿‡æ‰€å¼•ç”¨çš„ UnsafeCell æ¥å®ç°å†…éƒ¨å¯å˜æ€§ (interior mutability)ã€‚ ä¸Šè¿°ä»£ç ç‰‡æ®µå­˜åœ¨å¤§é‡çš„ unsafe ç‰‡æ®µ (å› ä¸º UnsafeCell)ï¼Œå°†è¿™äº› unsafe æ“ä½œå°è£…ä¸€ä¸‹å°±å®ç°äº† Cellã€‚ä½†æ˜¯å› ä¸º Cell çš„æ–¹æ³• get() å’Œ set() éƒ½éœ€è¦è½¬ç§»æ‰€æœ‰æƒï¼Œæ‰€ä»¥ Cell åªèƒ½ç”¨äºå®ç°äº† Copy trait çš„ç±»å‹çš„å†…éƒ¨å¯å˜æ€§ã€‚ä½†æ˜¯å¯¹äº concurrent æƒ…å½¢ï¼ŒUnsafeCell å°±æ˜¯ä¸€ä¸ªä¸´ç•ŒåŒºï¼Œæ— æ³•ä¿è¯å†…éƒ¨ä¿®æ”¹æ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥ Cell ä¸æ˜¯ thread safe çš„ã€‚ Cell is typically used for more simple types where copying or moving values isnâ€™t too resource intensive (e.g. numbers) æ³¨æ„ Cell æä¾›äº†è¿™æ ·ä¸€ä¸ªâ€œå†…éƒ¨å¯å˜æ€§â€æœºåˆ¶: åœ¨æ‹¥æœ‰å¯¹ä¸€ä¸ª object å¤šä¸ªå¼•ç”¨æ—¶ï¼Œå¯ä»¥é€šè¿‡ä»»æ„ä¸€ä¸ªå¼•ç”¨å¯¹ object è¿›è¡Œå†…éƒ¨å¯å˜ï¼Œå¹¶ä¿è¯åœ¨æ­¤ä¹‹åå…¶ä»–å¼•ç”¨å¯¹äºè¯¥ object çš„ä¿¡æ¯æ˜¯æœ€æ–°çš„ã€‚ ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:1:2","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"RefCell Module std::cell RefCell\u003cT\u003e RefCell\u003cT\u003e uses Rust\\â€™s lifetimes to implement â€œdynamic borrowingâ€, a process whereby one can claim temporary, exclusive, mutable access to the inner value. Borrows for RefCell\u003cT\u003e\\s are tracked at runtime, unlike Rustâ€™s native reference types which are entirely tracked statically, at compile time. Runtime Borrow Check RefCell RefCell ä¹Ÿæä¾›äº†ä¹‹å‰æ‰€æçš„â€œå†…éƒ¨å¯å˜æ€§â€æœºåˆ¶ï¼Œä½†æ˜¯æ˜¯é€šè¿‡æä¾› å¼•ç”¨ è€Œä¸æ˜¯è½¬ç§»æ‰€æœ‰æƒæ¥å®ç°ã€‚æ‰€ä»¥å®ƒå¸¸ç”¨äº Tree, Graph è¿™ç±»æ•°æ®ç»“æ„ï¼Œå› ä¸ºè¿™äº›æ•°æ®ç»“æ„çš„èŠ‚ç‚¹ â€œå¾ˆå¤§â€ï¼Œä¸å¤§å¯èƒ½å®ç° Copy çš„ Trait (å› ä¸ºå¼€é”€å¤ªå¤§äº†)ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨ RefCell æ¥å®ç°èŠ‚ç‚¹çš„ç›¸äº’å¼•ç”¨å…³ç³»ã€‚ ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:1:3","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"Rc method std::boxed::Box::into_raw After calling this function, the caller is responsible for the memory previously managed by the Box. In particular, the caller should properly destroy T and release the memory, taking into account the memory layout used by Box. The easiest way to do this is to convert the raw pointer back into a Box with the Box::from_raw function, allowing the Box destructor to perform the cleanup. Rc ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:1:4","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"Raw pointers vs references * mut and * const are not references, they are raw pointers. In Rust, there are a bunch of semantics you have to follow when you using references. Like if you use \u0026 symbol, an \u0026 alone means a shared reference, and you have to guarantee that there are no exclusive references to that thing. And similarly, if you have a \u0026mut, a exclusive reference, you know that there are not shared references. The * version of these, like * mut and * const, do not have these guarantees. If you have a * mut, there may be other * muts to the same thing. There might be * const to the same thing. You have no guarantee, but you also cann't do much with a *. If you have a raw pointer, the only thing you can really do to it is use an unsafe block to dereference it and turn it into reference. But that is unsafe, you need to document wht it is safe. You're not able to go from a const pointer to an exclusive reference. But you can go from a mutable pointer to an exclusive reference. To guarantee that you have to follow onwership semantics in Rust. ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:1:5","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"PhantomData \u0026 Drop check The Rustonomicon: Drop Check Medium: Rust Notes: PhantomData struct Foo\u003c'a, T: Default\u003e { v: \u0026'a mut T, } impl\u003cT\u003e Drop for Foo\u003c'_, T: Default\u003e { fn drop(\u0026mut self) { let _ = std::mem::replace(self.v, T::default()); } } fn main() { let mut t = String::from(\"hello\"); let foo = Foo { v: \u0026mut t }; drop(t); drop(foo); } æœ€åçš„ 2 è¡Œ drop è¯­å¥ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ï¼Œå› ä¸ºç¼–è¯‘å™¨çŸ¥é“ foo å¼•ç”¨äº† tï¼Œæ‰€ä»¥ä¼šè¿›è¡Œ drop checkï¼Œä¿è¯ t çš„ lifetime è‡³å°‘å’Œ foo ä¸€æ ·é•¿ï¼Œå› ä¸º drop æ—¶ä¼šæŒ‰ç…§ä»å†…åˆ°å¤–çš„é¡ºåºå¯¹ç»“æ„ä½“çš„æˆå‘˜åŠå…¶æœ¬èº«è¿›è¡Œ dropã€‚ä½†æ˜¯å¯¹äºæˆ‘ä»¬å®ç°çš„ Rc ä½¿ç”¨çš„æ˜¯ raw pointerï¼Œå¦‚æœä¸åŠ  PhantomDataï¼Œé‚£ä¹ˆåœ¨å¯¹ Rc è¿›è¡Œ drop æ—¶å¹¶ä¸ä¼šæ£€æŸ¥ raw pointer æ‰€æŒ‡å‘çš„ RcInner çš„ lifetime æ˜¯å¦æ»¡è¶³è¦æ±‚ï¼Œå³åœ¨ drop Rc ä¹‹å‰ drop RcInner å¹¶ä¸ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ã€‚ç®€å•æ¥è¯´ï¼ŒPhantomData å°±æ˜¯è®©ç¼–è¯‘å™¨ä»¥ä¸º Rc æ‹¥æœ‰ RcInner çš„æ‰€æœ‰æƒæˆ–å¼•ç”¨ï¼Œç”±æ­¤è¿›è¡ŒæœŸæœ›çš„ drop check è¡Œä¸ºã€‚ ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:1:6","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"Thread Safety Cell Because even though you're not giving out references to things, having two threads modify the same value at the same time is just not okay. There actually is o thread-safe version of Cell. (Think it as pointer in C ğŸ¤£) RefCell You could totally implement a thread-safe version of RefCell, one that uses an atomic counter instead of Cell for these numbers. So it turns out that the CPU has built-in instructions that can, in a thread-safe way, increment and decrement counters. Rc The thread-safe version of Rc is Arc, or Atomic Reference Count. ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:1:7","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"Copy-on-Write (COW) Struct std::borrow::Cow The type Cow is a smart pointer providing clone-on-write functionality: it can enclose and provide immutable access to borrowed data, and clone the data lazily when mutation or ownership is required. The type is designed to work with general borrowed data via the Borrow trait. ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:1:8","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"Homework ä¿¡æ¯ å®ä½œè¯´æ˜: å°è¯•ä½¿ç”¨ RefCell æ¥å®ç° Linux kernel é£æ ¼çš„ linked list æ•°æ®ç»“æ„ä¸º circular doubly linked list å®ç° insert_head, remove_head æ–¹æ³• å®ç° insert_tail, remove_tail æ–¹æ³• å®ç° list_size, list_empty, list_is_singular æ–¹æ³• å®ç°è¿­ä»£å™¨ (Iterator)ï¼Œæ”¯æŒåŒå‘è¿­ä»£ (DoubleEndedIterator) å‚è€ƒèµ„æ–™: sysprog21/linux-list linux/list.h ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:2:0","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"Documentations è¿™é‡Œåˆ—ä¸¾è§†é¢‘ä¸­ä¸€äº›æ¦‚å¿µç›¸å…³çš„ documentation å­¦ä¹ çš„ä¸€æ‰‹èµ„æ–™æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œè¯·åŠ¡å¿…è‡ªä¸»å­¦ä¼šé˜…è¯»è§„æ ¼ä¹¦ä¹‹ç±»çš„èµ„æ–™ ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:3:0","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"Crate std å¯ä»¥ä½¿ç”¨è¿™é‡Œæä¾›çš„æœç´ æ è¿›è¡Œæœç´¢ (BTW ä¸è¦æµªè´¹æ—¶é—´åœ¨ Google æœå¯»ä¸Šï¼) Module std::cell Struct std::cell::UnsafeCell Struct std::cell::Cell Struct std::cell::RefCell Module std::rc Module std::sync Struct std::sync::Mutex Struct std::sync::RwLock Struct std::sync::Arc Struct std::boxed::Box method std::boxed::Box::into_raw method std::boxed::Box::from_raw Struct std::ptr::NonNull method std::ptr::NonNull::new_unchecked method std::ptr::NonNull::as_ref method std::ptr::NonNull::as_ptr Struct std::marker::PhantomData Struct std::borrow::Cow Trait std::ops::Drop Trait std::ops::Deref Trait std::ops::DerefMut Trait std::marker::Sized Function std::thread::spawn Function std::mem::replace Function std::mem::drop ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:3:1","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["Rust"],"content":"References å¯èƒ½ä¸æ˜¯ä½ çœ‹è¿‡æœ€æ— èŠçš„ Rust å…¥é—¨å–œå‰§102 (2) æ™ºèƒ½æŒ‡é’ˆ [bilibili] ","date":"2024-02-20","objectID":"/posts/smart-pointers-and-interior-mutability/:4:0","tags":["Rust","Smart pointer","Interior Mutability"],"title":"Crust of Rust: Smart Pointers and Interior Mutability","uri":"/posts/smart-pointers-and-interior-mutability/"},{"categories":["C","Linux Kernel Internals"],"content":" å°½ç®¡æ•°å€¼ç³»ç»Ÿå¹¶é C è¯­è¨€æ‰€æŒæœ‰ï¼Œä½†åœ¨ Linux æ ¸å¿ƒå¤§é‡å­˜åœ¨ u8/u16/u32/u64 è¿™æ ·é€šè¿‡ typedef æ‰€å®šä¹‰çš„ç±»å‹ï¼Œä¼´éšç€å„ç§ alignment å­˜å–ï¼Œå¦‚æœå¯¹æ•°å€¼ç³»ç»Ÿçš„è®¤çŸ¥ä¸å¤Ÿå……åˆ†ï¼Œå¯èƒ½ç«‹å³å°±è¢«é˜»æ‹¦åœ¨æ¢ç´¢ Linux æ ¸å¿ƒä¹‹å¤–â€”â€”æ¯•ç«Ÿä½ å®Œå…¨æä¸æ¸…æ¥šï¼Œä¸ºä½• Linux æ ¸å¿ƒå­˜å–ç‰¹å®šèµ„æ–™éœ€è¦ç»•ä¸€å¤§åœˆã€‚ åŸæ–‡åœ°å€ ","date":"2024-02-20","objectID":"/posts/c-numerics/:0:0","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"Balanced ternary balanced ternary ä¸‰è¿›åˆ¶ä¸­ -, 0, + åœ¨æ•°å­¦ä¸Šå…·å¤‡å¯¹ç§°æ€§è´¨ã€‚å®ƒç›¸å¯¹äºäºŒè¿›åˆ¶ç¼–ç çš„ä¼˜åŠ¿åœ¨äºï¼Œå…¶æœ¬èº«å°±å¯ä»¥è¡¨ç¤ºæ­£è´Ÿæ•° (é€šè¿‡ +-, 0, +)ï¼Œè€ŒäºŒè¿›åˆ¶éœ€è¦è€ƒè™‘ unsigned å’Œ signed çš„æƒ…å†µï¼Œä»è€Œå†³å®šæœ€é«˜ä½æ‰€è¡¨ç¤ºçš„æ•°å€¼ã€‚ ç›¸å…³çš„è¿ç®—è§„åˆ™: + add - = 0 0 add + = + 0 add - = - ä»¥ä¸Šè¿ç®—è§„åˆ™éƒ½æ¯”è¾ƒç›´è§‚ï¼Œè¿™ä¹Ÿå†³å®šäº† balanced ternary åœ¨ç¼–ç ä¸Šçš„å¯¹ç§°æ€§ (å‡æ³•ç­‰ä»·äºåŠ ä¸Šé€†å…ƒï¼Œé€†å…ƒéå¸¸å®¹æ˜“è·å¾—)ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œä¸Šé¢çš„è¿ç®—è§„åˆ™å¹¶æ²¡æœ‰æ¶‰åŠåˆ°ç›¸åŒä½è¿ç®—çš„è§„åˆ™ï¼Œä¾‹å¦‚ $+\\ (add)\\ +$ï¼Œè¿™ç§è¿ç®—ä¹Ÿæ˜¯ balanced ternary ç›¸å¯¹äºäºŒè¿›åˆ¶ç¼–ç çš„åŠ£åŠ¿ï¼Œå¯ä»¥è‡ªè¡Œæ¨å¯¼ä¸€ä¸‹è¿™ç§è¿ç®—çš„è§„åˆ™ã€‚ The Balanced Ternary Machines of Soviet Russia ","date":"2024-02-20","objectID":"/posts/c-numerics/:1:0","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"æ•°å€¼ç¼–ç ä¸é˜¿è´å°”ç¾¤ é˜¿è´å°”ç¾¤ä¹Ÿç”¨äºæŒ‡ç¤ºä¸ºä»€ä¹ˆä½¿ç”¨äºŒè¡¥æ•°ç¼–ç æ¥è¡¨ç¤ºæ•´æ•°: å­˜åœ¨å”¯ä¸€çš„å•ä½å…ƒ (äºŒè¡¥æ•°ä¸­å•ä½å…ƒ 0 çš„ç¼–ç æ˜¯å”¯ä¸€çš„) æ¯ä¸ªå…ƒç´ éƒ½æœ‰é€†å…ƒ (åœ¨äºŒè¡¥æ•°ä¸­å‡ ä¹æ¯ä¸ªæ•°éƒ½æœ‰é€†å…ƒ) æµ®ç‚¹æ•° IEEE 754: An example of a layout for 32-bit floating point is ConversiÃ³n de un nÃºmero binario a formato IEEE 754 å•ç²¾åº¦æµ®ç‚¹æ•°ç›¸å¯¹äºæ•´æ•° åœ¨æŸäº›æƒ…æ³ä¸‹ä¸æ»¡è¶³çµåˆå¾‹å’Œäº¤æ¢å¾‹ï¼Œæ‰€ä»¥ä¸æ„æˆ é˜¿è´å°”ç¾¤ï¼Œåœ¨ç¼–å†™ç¨‹åºæ—¶éœ€è¦æ³¨æ„è¿™ä¸€ç‚¹ã€‚å³ä½¿ç¼–å†™ç¨‹åºæ—¶è°¨æ…å¤„ç†äº†å•ç²¾åº¦æµ®ç‚¹æ•°è¿ç®—ï¼Œä½†æ˜¯ç¼–è¯‘å™¨ä¼˜åŒ–å¯èƒ½ä¼šå°†æˆ‘ä»¬çš„å¤„ç†ç ´åˆ’æ‰ã€‚æ‰€ä»¥æ¶‰åŠåˆ°å•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œéƒ½éœ€è¦æ³¨æ„å…¶è¿ç®—ã€‚ ä¿¡æ¯ ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æµ®ç‚¹æ•°è¿ç®— ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: ç¼–è¯‘å™¨å’Œæœ€ä½³åŒ–åŸç†ç¯‡ ","date":"2024-02-20","objectID":"/posts/c-numerics/:2:0","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"Integer Overflow ","date":"2024-02-20","objectID":"/posts/c-numerics/:3:0","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"2002 å¹´ FreeBSD [53] #define KSIZE 1024 char kbuf[KSIZE]; int copy_from_kernel(void *user_dest, int maxlen) { int len = KSIZE \u003c maxlen ? KSIZE : maxlen; memcpy(user_dest, kbuf, len); return len; } å‡è®¾å°†â€œè´Ÿâ€çš„æ•°å€¼å¸¦å…¥ maxlenï¼Œé‚£ä¹ˆåœ¨ä¸Šè¿°çš„ç¨‹å¼ç ç¬¬ 4 è¡Œæ—¶ len ä¼šè¢«èµ‹å€¼ä¸º maxlenï¼Œåœ¨ç¬¬ 5 è¡Œä¸­ï¼Œæ ¹æ® memcpy çš„åŸå‹å£°æ˜ void *memcpy(void *dest, const void *src, size_t n); ä¼šå°† len (=maxlen) è§£é‡Šä¸º size_t ç±»å‹ï¼Œå…³äº size_t ç±»å‹ C99 [7.17 Common definitions \u003cstddef.h\u003e] size_t which is the unsigned integer type of the result of the sizeof operator; æ‰€ä»¥åœ¨ 5 è¡Œä¸­ memcpy ä¼šå°† len è¿™ä¸ªâ€œè´Ÿâ€œçš„æ•°å€¼æŒ‰ç…§æ— ç¬¦å·æ•°çš„ç¼–ç è¿›è¡Œè§£é‡Šï¼Œè¿™ä¼šå¯¼è‡´å°† len è§£é‡Šä¸ºä¸€ä¸ªè¶…çº§å¤§çš„æ— ç¬¦å·æ•°ï¼Œå¯èƒ½è¿œæ¯” KSIZE è¿™ä¸ªé™åˆ¶å¤§ã€‚copy_from_kernel è¿™ä¸ªå‡½æ•°æ˜¯è¿è¡Œåœ¨ kernel ä¸­çš„ï¼Œè¿™æ ·å¯èƒ½ä¼šé€ æˆæ½œåœ¨çš„ kernel ä¿¡æ¯æ•°æ®æ³„éœ²é—®é¢˜ã€‚ ","date":"2024-02-20","objectID":"/posts/c-numerics/:3:1","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"2002 å¹´ External data representation (XDR) [62] void *copy_elements(void *ele_src[], int ele_cnt, int ele_size) { void *result = malloc(ele_cnt * ele_size); if (result==NULL) return NULL; void *next = result; for (int i = 0; i \u003c ele_cnt; i++) { memcpy(next, ele_src[i], ele_size); next += ele_size; } return result; } å‡è®¾å°† ele_cnt = $2^{20}+1$, ele_size=$2^{12}$ ä»£å…¥ï¼Œæ˜¾ç„¶åœ¨ç¬¬ 2 è¡Œçš„ ele_cnt * ele_size ä¼šè¶…å‡º 32 ä½æ•´æ•°è¡¨ç¤ºçš„æœ€å¤§å€¼ï¼Œå¯¼è‡´ overflowã€‚åˆå› ä¸º malloc çš„åŸå‹å£°æ˜ void *malloc(size_t size); malloc ä¼šå°† ele_cnt * ele_size æº¢å‡ºåä¿ç•™çš„å€¼è§£é‡Šä¸º size_tï¼Œè¿™ä¼šå¯¼è‡´ malloc åˆ†é…çš„å†…å­˜ç©ºé—´è¿œå°äº ele_cnt * ele_size Bytes (è¿™æ˜¯ malloc æˆåŠŸçš„æƒ…å†µï¼Œmalloc ä¹Ÿæœ‰å¯èƒ½ä¼šå¤±è´¥ï¼Œè¿”å› NULL)ã€‚ å› ä¸º malloc æˆåŠŸåˆ†é…ç©ºé—´ï¼Œæ‰€ä»¥ä¼šé€šè¿‡ç¬¬ 3 è¡Œçš„æµ‹è¯•ã€‚åœ¨ç¬¬ 5~8 è¡Œçš„ for å¾ªç¯ï¼Œæ ¹æ® ele_cnt å’Œ ele_size çš„å€¼è¿›è¡Œ memcpyï¼Œä½†æ˜¯å› ä¸ºåˆ†é…çš„ç©ºé—´è¿œè¿œå°äº ele_cnt * ele_sizeï¼Œæ‰€ä»¥è¿™æ ·ä¼šè¦†å†™è¢«åˆ†é…ç©ºé—´å¤–çš„å†…å­˜åŒºåŸŸï¼Œå¯èƒ½ä¼šé€ æˆ kernel çš„ä¿¡æ¯æ•°æ®è¢«è¦†ç›–ã€‚ ","date":"2024-02-20","objectID":"/posts/c-numerics/:3:2","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"Bitwise 3Blue1Brown: How to count to 1000 on two hands [YouTube] æœ¬è´¨ä¸Šæ˜¯ä½¿ç”¨æ— ç¬¦å·æ•°çš„äºŒè¿›åˆ¶ç¼–ç æ¥è¿›è¡Œè®¡æ•°ï¼Œå°†æ‰‹æŒ‡/è„šè¶¾è§†ä¸ºæ•°å€¼çš„ bit ä¿¡æ¯ è§£è¯»è®¡ç®—æœºç¼–ç  ","date":"2024-02-20","objectID":"/posts/c-numerics/:4:0","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"Power of two é€šè¿‡ä»¥ä¸‹ç¨‹å¼ç å¯ä»¥åˆ¤æ–­ x æ˜¯å¦ä¸º 2 çš„æ¬¡æ–¹ x \u0026 (x - 1) == 0 é€šè¿‡å€¼ä¸º 1 çš„æœ€ä½ä½æ¥è¿›è¡Œå½’çº³æ³•è¯æ˜ï¼Œä¾‹å¦‚ï¼Œå¯¹ 0b00000001, 0b00000010, 0b00000100, â€¦ æ¥è¿›è¡Œå½’çº³è¯æ˜ (è¿˜éœ€è¦è¯æ˜ x ä¸­åªèƒ½æœ‰ä¸€ä¸ª bit ä¸ºå€¼ 1ï¼Œä¸è¿‡è¿™ä¸ªæ¯”è¾ƒç®€å•)ã€‚å¦ä¸€ç§æ€è·¯ï¼Œé€šè¿‡ LSBO ä»¥åŠ $X$ å’Œ $-X$ çš„ç‰¹æ€§æ¥è¯æ˜ã€‚ LSBO: Least Significant bit of value One $-X = ~(X - 1)$ $-X$ çš„ç¼–ç ç­‰ä»·äº $X$ çš„ç¼–ç ä¸­æ¯” LSBO æ›´é«˜çš„ bits è¿›è¡Œåè½¬ï¼ŒLSBO åŠæ›´ä½çš„ bits ä¿æŒä¸å˜ ","date":"2024-02-20","objectID":"/posts/c-numerics/:4:1","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"ASCII table é€šè¿‡ ASCII table ä¸­å¯¹ ASCII ç¼–ç çš„åˆ†å¸ƒè§„å¾‹ï¼Œå¯ä»¥å®ç°å¤§å°å†™è½¬æ¢çš„ constant-time function ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤ man ascii æ¥è¾“å‡ºç²¾ç¾çš„ ASCII table // å­—ç¬¦è½¬å°å†™ (x | ' ') // å­—ç¬¦è½¬å¤§å†™ (x \u0026 ' ') // å¤§å°å†™äº’è½¬ (x ^ ' ') Each lowercase letter is 32 + uppercase equivalent. This means simply flipping the bit at position 5 (counting from least significant bit at position 0) inverts the case of a letter. ","date":"2024-02-20","objectID":"/posts/c-numerics/:4:2","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"XOR swap é€šè¿‡ xor è¿ç®—ç¬¦å¯ä»¥å®ç°æ— éœ€ä¸´æ—¶å˜é‡çš„ï¼Œäº¤æ¢ä¸¤ä¸ªæ•°å€¼çš„ç¨‹å¼ç  void xorSwap(int *x, int *y) { *x ^= *y; *y ^= *x; *x ^= *y; } ç¬¬ 3 è¡Œçš„ *y ^= *x çš„ç»“æœç­‰ä»·äº *y ^ *x ^ *yï¼Œæ•´æ•°æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹ï¼Œæ‰€ä»¥ç»“æœä¸º *x ç¬¬ 4 è¡Œçš„ *x ^= *y çš„ç»“æœç­‰ä»·äº *x ^ *y ^ *xï¼Œæ•´æ•°æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹ï¼Œæ‰€ä»¥ç»“æœä¸º *y è¿™ä¸ªå®ä½œæ–¹æ³•å¸¸ç”¨äºæ²¡æœ‰é¢å¤–ç©ºé—´çš„æƒ…å½¢ï¼Œä¾‹å¦‚ Bootloader ","date":"2024-02-20","objectID":"/posts/c-numerics/:4:3","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"é¿å… overflow æ•´æ•°è¿ç®— (x + y) / 2 å¯èƒ½ä¼šå¯¼è‡´ overflow (å¦‚æœ x, y æ•°å€¼éƒ½æ¥è¿‘ UINT32_MAX)ï¼Œå¯ä»¥æ”¹å†™ä¸ºä»¥ä¸‹ä¸ä¼šå¯¼è‡´ overflow çš„ç¨‹å¼ç  (x \u0026 y) + (x ^ y) \u003e\u003e 1 ä½¿ç”¨åŠ æ³•å™¨æ¥æ€è€ƒ: å¯¹äº x + yï¼Œx \u0026 y è¡¨ç¤ºè¿›ä½ï¼Œx ^ y è¡¨ç¤ºä½å…ƒå’Œï¼Œæ‰€ä»¥ x + y ç­‰ä»·äº (x \u0026 y) \u003c\u003c 1 + (x ^ y) è¿™ä¸ªè¿ç®—ä¸ä¼šå¯¼è‡´ overflow (å› ä¸ºä½¿ç”¨äº† bitwise è¿ç®—)ã€‚å› æ­¤ (x + y) / 2 ç­‰ä»·äº ((x \u0026 y) \u003c\u003c 1 + (x ^ y)) \u003e\u003e 1 = ((x \u0026 y) \u003c\u003c 1) \u003e\u003e 1 + (x ^ y) \u003e\u003e 1 = (x \u0026 y) + (x ^ y) \u003e\u003e 1 æ•´æ•°æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹ ","date":"2024-02-20","objectID":"/posts/c-numerics/:4:4","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"macro DIRECT #if LONG_MAX == 2147483647L #define DETECT(X) \\ (((X) - 0x01010101) \u0026 ~(X) \u0026 0x80808080) #else #if LONG_MAX == 9223372036854775807L #define DETECT(X) \\ (((X) - 0x0101010101010101) \u0026 ~(X) \u0026 0x8080808080808080) #else #error long int is not a 32bit or 64bit type. #endif #endif DIRECT å®çš„ä½œç”¨æ˜¯ä¾¦æµ‹ 32bit/64bit ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ª Byte ä¸º NULLã€‚æˆ‘ä»¬ä»¥æœ€ç®€å•çš„æƒ…å†µ 1 ä¸ª Byte æ—¶æ¥æ€è€ƒè¿™ä¸ªå®ä½œçš„æœ¬è´¨ï¼š ((X) - 0x01) \u0026 ~(X) \u0026 0x80 = ~(~((X) - 0x01) | X) \u0026 0x80 ~((X) - 0x01) æ˜¯ X çš„å–è´Ÿå€¼ç¼–ç ï¼Œå³ -Xï¼Œæ ¹æ®äºŒè¡¥æ•°ç¼–ç ä¸­ -X å’Œ X çš„ç‰¹æ€§ï¼Œå¯å¾— (~((X) - 0x01) | X) ä¸º: X äºŒè¡¥æ•°ç¼–ç ä¸­å€¼ä¸º 1 çš„æœ€ä½ä½ (åç»­ç§°ä¹‹ä¸º LSBO) åŠæ›´ä½ä½ä¿æŒä¸å˜ï¼ŒLSBO æ›´é«˜ä½å‡ä¸º 1ã€‚åˆ™ ~(~((X) - 0x01) | X) ä¸º: X äºŒè¡¥æ•°ç¼–ç ä¸­å€¼ä¸º 1 çš„æœ€ä½ä½ (åç»­ç§°ä¹‹ä¸º LSBO) çš„æ›´ä½ä½ç¿»è½¬ï¼ŒLSBO åŠæ›´é«˜ä½å‡ä¸º 0ã€‚ LSBO: Least Significant Bit with value of One X = 0x0080 (X) - 0x01 = 0xff80 ~((X) - 0x01) = 0x007f ~(~((X) - 0x01) | X) \u0026 0x80 = 0 å¯ä»¥è‡ªè¡Œå½’çº³æ¨å¯¼å‡º: å¯¹äºä»»æ„ä¸ä¸º 0 çš„æ•°å€¼ï¼Œä¸Šè¿°æµç¨‹æ¨å¯¼çš„æœ€ç»ˆå€¼éƒ½ä¸º 0ï¼Œä½†å¯¹äºå€¼ä¸º 0 çš„æ•°å€¼ï¼Œæœ€ç»ˆå€¼ä¸º 0x80ã€‚ç”±æ­¤å¯ä»¥æ¨å¯¼å‡ºæœ€å¼€å§‹çš„å®ä½œ DIRECT å®ã€‚ è¿™ä¸ª DIRECT å®ç›¸å½“å®ç”¨ï¼Œå¸¸ç”¨äºåŠ é€Ÿå­—ç¬¦ä¸²æ“ä½œï¼Œå°†åŸå…ˆçš„ä»¥ 1-byte ä¸ºå•å…ƒçš„æ“ä½œåŠ é€Ÿä¸ºä»¥ 32bit/64bit ä¸ºå•ä½çš„æ“ä½œã€‚å¯ä»¥é˜…è¯»ç›¸å…³å®ä½œå¹¶å¯»æ‰¾å…¶ä¸­çš„é€»è¾‘: newlib çš„ strlen newlib çš„ strcpy ","date":"2024-02-20","objectID":"/posts/c-numerics/:4:5","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"Count Leading Zero è®¡ç®— $\\log_2N$ å¯ä»¥é€šè¿‡è®¡ç®—æ•°å€¼å¯¹åº”çš„ç¼–ç ï¼Œé«˜ä½æœ‰å¤šå°‘è¿ç»­çš„ 0â€™bitsï¼Œå†ç”¨ 31 å‡å»å³å¯ã€‚å¯ä»¥é€šè¿‡ 0x0001, 0x0010, 0x0002, â€¦ ç­‰ç¼–ç æ¥è¿›è¡Œå½’çº³æ¨å¯¼å‡ºè¯¥ç»“è®ºã€‚ iteration version int clz(uint32_t x) { int n = 32, c = 16; do { uint32_t y = x \u003e\u003e c; if (y) { n -= c; x = y; } c \u003e\u003e= 1; } while (c); return (n - x); } binary search technique int clz(uint32_t x) { if (x == 0) return 32; int n = 0; if (x \u003c= 0x0000FFFF) { n += 16; x \u003c\u003c= 16; } if (x \u003c= 0x00FFFFFF) { n += 8; x \u003c\u003c= 8; } if (x \u003c= 0x0FFFFFFF) { n += 4; x \u003c\u003c= 4; } if (x \u003c= 0x3FFFFFFF) { n += 2; x \u003c\u003c= 2; } if (x \u003c= 0x7FFFFFFF) { n += 1; x \u003c\u003c= 1; } return n; } byte-shift version int clz(uint32_t x) { if (x == 0) return 32; int n = 1; if ((x \u003e\u003e 16) == 0) { n += 16; x \u003c\u003c= 16; } if ((x \u003e\u003e 24) == 0) { n += 8; x \u003c\u003c= 8; } if ((x \u003e\u003e 28) == 0) { n += 4; x \u003c\u003c= 4; } if ((x \u003e\u003e 30) == 0) { n += 2; x \u003c\u003c= 2; } n = n - (x \u003e\u003e 31); return n; } åœ¨è¿™äº›å®ä½œä¸­ï¼Œå¾ªç¯æ˜¯æ¯”è¾ƒç›´è§‚çš„ï¼Œä½†æ˜¯æ¯”è¾ƒä½æ•ˆï¼›å¯ä»¥åˆ©ç”¨ç¼–ç çš„ç‰¹æ€§ï¼Œä½¿ç”¨äºŒåˆ†æ³•æˆ–ä½è¿ç®—æ¥åŠ é€Ÿå®ä½œã€‚ ","date":"2024-02-20","objectID":"/posts/c-numerics/:5:0","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"é¿å…å¾ªç¯ int func(unsigned int x) { int val = 0; int i = 0; for (i = 0; i \u003c 32; i++) { val = (val \u003c\u003c 1) | (x \u0026 0x1); x \u003e\u003e= 1; } return val; } è¿™æ®µç¨‹å¼ç çš„ä½œç”¨æ˜¯ï¼Œå¯¹ä¸€ä¸ª 32bit çš„æ•°å€¼è¿›è¡Œé€ä½å…ƒåè½¬ã€‚è¿™ä¸ªé€ä½å…ƒåè½¬åŠŸèƒ½éå¸¸å®ç”¨ï¼Œå¸¸å®ä½œäºåŠ å¯†ç®—æ³•ï¼Œä¾‹å¦‚ DESã€AESã€‚ ä½†æ˜¯ä¸ä¸Šé¢çš„ Count Leading Zero ç±»ä¼¼ï¼Œä¸Šé¢ç¨‹å¼ç ä½¿ç”¨äº†å¾ªç¯ï¼Œéå¸¸ä½æ•ˆï¼Œå¯ä»¥é€šè¿‡ä½è¿ç®—æ¥åŠ é€Ÿã€‚ int func(unsigned int x) { int val = 0; val = num; val = ((val \u0026 0xffff0000) \u003e\u003e 16) | ((val \u0026 0x0000ffff) \u003c\u003c 16); val = ((val \u0026 0xff00ff00) \u003e\u003e 8) | ((val \u0026 0x00ff00ff) \u003c\u003c 8); val = ((val \u0026 0xf0f0f0f0) \u003e\u003e 4) | ((val \u0026 0x0f0f0f0f) \u003c\u003c 4); val = ((val \u0026 0xcccccccc) \u003e\u003e 2) | ((val \u0026 0x33333333) \u003c\u003c 2); val = ((val \u0026 0xaaaaaaaa) \u003e\u003e 1) | ((val \u0026 0x55555555) \u003c\u003c 1); return val; } Reverse integer bitwise without using loop [Stack Overflow] æŠ€å·§ Bits Twiddling Hacks è§£æ: (ä¸€), (äºŒ), (ä¸‰) ","date":"2024-02-20","objectID":"/posts/c-numerics/:6:0","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["C","Linux Kernel Internals"],"content":"åŠ è§£å¯†çš„åº”ç”¨ å‡è¨­æœ‰ä¸€å¼µé»‘ç™½çš„ç›¸ç‰‡æ˜¯ç”±å¾ˆå¤šå€‹0 ~255 çš„ pixel çµ„æˆ (0 æ˜¯é»‘è‰²ï¼Œ255 æ˜¯ç™½è‰²)ï¼Œé€™æ™‚å€™å¯ä»¥ç”¨ä»»æ„çš„ KEY (000000002 - 111111112) è·ŸåŸæœ¬çš„æ¯å€‹ pixel åšé‹ç®—ï¼Œå¦‚æœä½¿ç”¨ AND (æ¯å€‹ bit æœ‰ 75% æ©Ÿç‡æœƒè®Šæˆ 0)ï¼Œæ‰€ä»¥åœ–æœƒè®Šæš—ã€‚å¦‚æœä½¿ç”¨ OR (æ¯å€‹ bit æœ‰ 75% æ©Ÿç‡æœƒè®Š 1)ï¼Œåœ–å°±æœƒè®Šäº®ã€‚é€™å…©ç¨®å¹¾ä¹éƒ½é‚„æ˜¯çœ‹çš„å‡ºåŸæœ¬çš„åœ–ç‰‡ï¼Œä½†è‹¥æ˜¯ç”¨ XOR çš„è©±ï¼Œæ¯å€‹ bit è®Šæˆ 0 æˆ– 1 çš„æ©Ÿç‡éƒ½æ˜¯ 50%ï¼Œæ‰€ä»¥åœ–ç‰‡å°±æœƒè®Šæˆçœ‹ä¸å‡ºæ±è¥¿çš„é›œè¨Šã€‚ ä¸Šåœ–å·¦ 1 æ˜¯åŸåœ–ï¼Œå·¦ 2 æ˜¯ç”¨ AND åšé‹ç®—ä¹‹å¾Œï¼Œå³ 2 æ˜¯ç”¨ OR åšé‹ç®—ä¹‹å¾Œï¼Œå³ 1 æ˜¯ç”¨ XORï¼Œå¯è¦‹ä½¿ç”¨ XOR çš„åŠ å¯†æ•ˆæœæœ€å¥½ã€‚ è¿™å°±æ˜¯åœ¨å¯†ç å­¦é¢†åŸŸåçˆ± XOR çš„åŸå› ä¹‹ä¸€ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒXOR åœ¨æ¦‚ç‡ç»Ÿè®¡ä¸Šçš„ä¼˜å¼‚ç‰¹æ€§ä¹Ÿæ˜¯å¦ä¸€ä¸ªåŸå› ï¼Œå…·ä½“è¯æ˜æ¨å¯¼è¯·æŸ¥çœ‹åŸæ–‡çš„è¯´æ˜ã€‚ ","date":"2024-02-20","objectID":"/posts/c-numerics/:7:0","tags":["Sysprog","C","Numerics"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æ•°å€¼ç³»ç»Ÿç¯‡","uri":"/posts/c-numerics/"},{"categories":["Linux Kernel Internals"],"content":"ç¨‹åºåˆ†æå·¥å…· Cppcheck æ˜¯ é™æ€ ç¨‹åºåˆ†æå·¥å…·ï¼Œå³æ— éœ€è¿è¡Œç¨‹åºå°±å¯ä»¥åˆ†æå‡ºç¨‹åºæ½œåœ¨çš„é—®é¢˜ï¼Œå½“ç„¶ä¼šæœ‰ä¸€å®šçš„è¯¯å·®ï¼Œç±»ä¼¼çš„å·¥å…·æœ‰ cargo-check Valgrind æ˜¯ åŠ¨æ€ ç¨‹åºåˆ†æå·¥å…·ï¼Œå³éœ€è¦å°†ç¨‹åºè¿è¡Œèµ·æ¥å†è¿›è¡Œåˆ†æï¼Œé€šå¸¸ç”¨äºæ£€æµ‹å†…å­˜æ³„æ¼ (memory leak) ","date":"2024-02-19","objectID":"/posts/linux2023-lab0/:1:0","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: C Programming Lab","uri":"/posts/linux2023-lab0/"},{"categories":["Linux Kernel Internals"],"content":"Queue ","date":"2024-02-19","objectID":"/posts/linux2023-lab0/:2:0","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: C Programming Lab","uri":"/posts/linux2023-lab0/"},{"categories":["Linux Kernel Internals"],"content":"leetcode ç›¸å…³çš„ LeetCode é¢˜ç›®çš„å®ä½œæƒ…å†µ: LeetCode 2095. Delete the Middle Node of a Linked List LeetCode 82. Remove Duplicates from Sorted List II LeetCode 24. Swap Nodes in Pairs LeetCode 25. Reverse Nodes in k-Group LeetCode 2487. Remove Nodes From Linked List / å‚è€ƒé¢˜è§£ LeetCode 23. Merge k Sorted Lists ","date":"2024-02-19","objectID":"/posts/linux2023-lab0/:2:1","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: C Programming Lab","uri":"/posts/linux2023-lab0/"},{"categories":["Linux Kernel Internals"],"content":"q_new \u0026 q_free q_new ä½¿ç”¨ malloc åˆ†é…ç©ºé—´ï¼Œå¹¶ä½¿ç”¨ INIT_LIST_HEAD è¿›è¡Œåˆå§‹åŒ–ã€‚ q_free éå† queue è¿›è¡Œé€ä¸ªèŠ‚ç‚¹é‡Šæ”¾ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ _safe åç¼€çš„ for_each å®ï¼Œé‡Šæ”¾æ—¶éœ€è¦å…ˆé‡Šæ”¾æˆå‘˜ valueï¼Œå†é‡Šæ”¾èŠ‚ç‚¹ (å›æƒ³ä¸€ä¸‹ C++ çš„ææ„å‡½æ•°)ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ q_release_element å‡½æ•°ã€‚ q_free åœ¨éå†æ—¶éœ€è¦é‡Šæ”¾å½“å‰èŠ‚ç‚¹æ‰€åœ¨å…ƒç´ çš„ç©ºé—´ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ list_for_each_entry_safeï¼Œè€Œ q_size æ— éœ€åœ¨éå†æ—¶ä¿®æ”¹å½“å‰èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä½¿ç”¨ list_for_each å°±è¶³å¤Ÿäº†ã€‚ ","date":"2024-02-19","objectID":"/posts/linux2023-lab0/:2:2","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: C Programming Lab","uri":"/posts/linux2023-lab0/"},{"categories":["Linux Kernel Internals"],"content":"q_insert \u0026 q_remove insert æ—¶éœ€è¦ç‰¹åˆ¤ head æ˜¯å¦ä¸º NULL ä»¥åŠ malloc åˆ†é…æ˜¯å¦æˆåŠŸï¼Œæ¥ä¸‹æ¥éœ€è¦ä½¿ç”¨ strdup å¯¹æ‰€ç»™å‚æ•°è¿›è¡Œå¤åˆ¶ (strdup å†…éƒ¨æ˜¯é€šè¿‡ malloc æ¥å®ç°çš„ï¼Œæ‰€ä»¥ä¹‹å‰ q_free æ—¶ä¹Ÿéœ€è¦æ˜¯å¦ value)ï¼Œæœ€åæ ¹æ®æ’å…¥çš„ä½ç½®è°ƒç”¨ list_add æˆ– list_add_tail è¿›è¡Œæ’å…¥ã€‚ remove æ—¶éœ€è¦ç‰¹åˆ¤ head æ˜¯å¦ä¸º NULL ä»¥åŠ queue æ˜¯å¦ä¸ºç©ºï¼Œæ¥ä¸‹æ¥æ ¹æ®éœ€è¦ remove çš„èŠ‚ç‚¹è°ƒç”¨ list_first_entry æˆ– list_last_entry è·å–èŠ‚ç‚¹å¯¹åº”çš„å…ƒç´ ï¼Œé€šè¿‡ list_del_init æ¥æ¸…é™¤å‡º queueï¼Œæœ€åå¦‚æœ value å­—æ®µä¸ä¸º NULLï¼Œåˆ™é€šè¿‡ memcpy å°† value å­—æ®µå¯¹åº”çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ°æŒ‡å®šä½ç½®ã€‚ ","date":"2024-02-19","objectID":"/posts/linux2023-lab0/:2:3","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: C Programming Lab","uri":"/posts/linux2023-lab0/"},{"categories":["Linux Kernel Internals"],"content":"Valgrind 2007 å¹´çš„è®ºæ–‡: Valgrind: A Framework for Heavyweight Dynamic Binary Instrumentation ç¹ä½“ä¸­æ–‡ç‰ˆæœ¬çš„ è®ºæ–‡å¯¼è¯» memory lost: definitely lost indirectly lost possibly lost still readchable è¿è¡Œ valgrind å’Œ gdb ç±»ä¼¼ï¼Œéƒ½éœ€è¦ä½¿ç”¨ -g å‚æ•°æ¥ç¼–è¯‘ C/C++ æºç¨‹åºä»¥ç”Ÿæˆè°ƒè¯•ä¿¡æ¯ï¼Œç„¶åè¿˜å¯ä»¥é€šè¿‡ -q å‚æ•°æŒ‡ç¤º valgrind è¿›å…¥ quite æ¨¡å¼ï¼Œå‡å°‘å¯åŠ¨æ—¶ä¿¡æ¯çš„è¾“å‡ºã€‚ $ valgrind -q --leak-check=full ./case1 --leak-check=full: å¯ç”¨å…¨é¢çš„å†…å­˜æ³„æ¼æ£€æŸ¥ï¼Œvalgrind å°†ä¼šæŠ¥å‘Šæ‰€æœ‰çš„å†…å­˜æ³„æ¼æƒ…å†µï¼ŒåŒ…æ‹¬è¯¦ç»†çš„å †æ ˆè·Ÿè¸ªä¿¡æ¯ --show-possibly-lost=no: ä¸è¾“å‡º possibly lost ç›¸å…³æŠ¥å‘Š --track-fds=yes: ä¾¦æµ‹ file descriptor å¼€äº†æ²¡å…³çš„æƒ…å†µ valgrind è¾“å‡ºçš„æŠ¥å‘Š invalid write/read è¿™ç±»çš„å•ä½æ˜¯ Byteï¼Œå³ size of X (bytes) ç¨‹åºè¿è¡Œæ—¶å†…å­˜å¸ƒå±€: ä¿¡æ¯ Valgrind User Manual Massif: a heap profiler ","date":"2024-02-19","objectID":"/posts/linux2023-lab0/:3:0","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: C Programming Lab","uri":"/posts/linux2023-lab0/"},{"categories":["Linux Kernel Internals"],"content":"è‡ªåŠ¨æµ‹è¯• ","date":"2024-02-19","objectID":"/posts/linux2023-lab0/:4:0","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: C Programming Lab","uri":"/posts/linux2023-lab0/"},{"categories":["Linux Kernel Internals"],"content":"è¿½è¸ªå†…å­˜çš„åˆ†é…å’Œé‡Šæ”¾ Wikipedia: Hooking Wikipedia: Test harness GCC: Arrays of Length Zero The alignment of a zero-length array is the same as the alignment of its elements. ç›¸å…³æºä»£ç é˜…è¯» (harness.h, harness.c): test_malloc() test_free() test_calloc() find_footer() find_header() ","date":"2024-02-19","objectID":"/posts/linux2023-lab0/:4:1","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: C Programming Lab","uri":"/posts/linux2023-lab0/"},{"categories":["Linux Kernel Internals"],"content":"qtest å‘½ä»¤è§£é‡Šå™¨ æ–°å¢æŒ‡ä»¤ helloï¼Œç”¨äºæ‰“å° Hello, world\" çš„ä¿¡æ¯ã€‚è°ƒç”¨æµç¨‹: main â†’ run_console â†’ cmd_select â†’ interpret_cmd â†’ parse_args â†’ interpret_cmda â†’ do_hello ç›¸å…³æºä»£ç é˜…è¯» (console.h, console.c): init_cmd() ADD_COMMADN add_cmd() ","date":"2024-02-19","objectID":"/posts/linux2023-lab0/:4:2","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: C Programming Lab","uri":"/posts/linux2023-lab0/"},{"categories":["Linux Kernel Internals"],"content":"Signal signal(2) â€” Linux manual page signal() sets the disposition of the signal signum to handler, which is either SIG_IGN, SIG_DFL, or the address of a programmer-defined funcâ€ tion (a â€œsignal handlerâ€). setjmp(3) â€” Linux manual page The functions described on this page are used for performing â€œnonlocal gotosâ€: transferring execution from one function to a predetermined location in another function. The setjmp() function dynamically establishes the target to which control will later be transferred, and longjmp() performs the transfer of execution. Why use sigsetjmp()/siglongjmp() instead of setjmp()/longjmp()? The Linux Programming Interface The sa_mask field allows us to specify a set of signals that arenâ€™t permitted to interrupt execution of this handler. In addition, the signal that caused the handler to be invoked is automatically added to the process signal mask. This means that a signal handler wonâ€™t recursively interrupt itself if a second instance of the same signal arrives while the handler is executing. However, there is a problem with using the standard longjmp() function to exit from a signal handler. We noted earlier that, upon entry to the signal handler, the kernel automatically adds the invoking signal, as well as any signals specified in the act.sa_mask field, to the process signal mask, and then removes these signals from the mask when the handler does a normal return. What happens to the signal mask if we exit the signal handler using longjmp()? The answer depends on the genealogy of the particular UNIX implementation. jmp_ready æŠ€å·§ (ç”¨äºä¿è¯åœ¨ siglongjmp() ä¹‹å‰å¿…ç„¶æ‰§è¡Œè¿‡ä¸€æ¬¡ sigsetjmp()): Because a signal can be generated at any time, it may actually occur before the target of the goto has been set up by sigsetjmp() (or setjmp()). To prevent this possibility (which would cause the handler to perform a nonlocal goto using an uninitialized env buffer), we employ a guard variable, canJump, to indicate whether the env buffer has been initialized. If canJump is false, then instead of doing a nonlocal goto, the handler simply returns. ç›¸å…³æºä»£ç é˜…è¯»: qtest.c q_init() sigsegv_handler() sigalrm_handler() harness.c trigger_exception() exception_setup() ","date":"2024-02-19","objectID":"/posts/linux2023-lab0/:4:3","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: C Programming Lab","uri":"/posts/linux2023-lab0/"},{"categories":["Rust","Network"],"content":" In this stream, we started implementing the ubiquitous TCP protocol that underlies much of the traffic on the internet! In particular, we followed RFC 793 â€” https://tools.ietf.org/html/rfc793 â€” which describes the original protocol, with the goal of being able to set up and tear down a connection with a â€œrealâ€ TCP stack at the other end (netcat in particular). Weâ€™re writing it using a user-space networking interface (see https://www.kernel.org/doc/Documentation/networking/tuntap.txt and the Rust bindings at https://docs.rs/tun-tap/). æ•´ç†è‡ª John Gjengset çš„å½±ç‰‡: Part 1 ","date":"2024-02-17","objectID":"/posts/rust-tcp/:0:0","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"å½±ç‰‡æ³¨è§£ Part 1 ","date":"2024-02-17","objectID":"/posts/rust-tcp/:1:0","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"Raw socket vs TUN/TAP device Raw sockets [Wikipedia] TUN/TAP [Wikipedia] Raw socket vs TUN device [Stack Overflow] Universal TUN/TAP device driver [Linux kernel documentation] Raw socket: Internet â€“\u003e NIC â€“\u003e kernel â€“\u003e user space Internet \u003câ€“ NIC \u003câ€“ kernel \u003câ€“ user space Host interact with other hosts in Internet. TUN/TAP device: kernel â€“\u003e | TUN/TAP | â€“\u003e user space kernel \u003câ€“ | TUN/TAP | \u003câ€“ user space Kernel interact with programs in user space in the same host. å’Œå…¶ä»–ç‰©ç†ç½‘å¡ä¸€æ ·ï¼Œç”¨æˆ·è¿›ç¨‹åˆ›å»ºçš„ TUN/TAP è®¾å¤‡ä»ç„¶æ˜¯è¢« kernel æ‰€æ‹¥æœ‰çš„ (kernel å¯ä»¥ä½¿ç”¨è®¾å¤‡è¿›è¡Œå‘é€/æ¥æ”¶)ï¼Œåªä¸è¿‡ç”¨æˆ·è¿›ç¨‹ä¹Ÿå¯ä»¥åƒæ“ä½œ ç®¡é“ (pipe) é‚£æ ·ï¼Œæ“ä½œæ‰€åˆ›å»ºçš„ TUN/TAP è®¾å¤‡ (å¯ä»¥ä½¿ç”¨è¯¥è®¾å¤‡è¿›è¡Œå‘é€/æ¥æ”¶)ï¼Œä»è€Œä¸ kernel çš„ç‰©ç†ç½‘å¡è¿›è¡Œé€šä¿¡ã€‚ Universal TUN/TAP device driver [Linux kernel documentation] 3.2 Frame format: If flag IFF_NO_PI is not set each frame format is: Flags [2 bytes] Proto [2 bytes] Raw protocol(IP, IPv6, etc) frame. é€šè¿‡ TUN/TAP è®¾å¤‡æ¥æ”¶çš„å°åŒ…ï¼Œä¼šæ‹¥æœ‰ Flags å’Œ Proto è¿™ä¸¤ä¸ªå­—æ®µ (å…± 4 ä¸ªå­—èŠ‚ï¼Œè¿™ä¹Ÿæ˜¯ iface çš„ without_packet_info å’Œ recv æ–¹æ³•æ‰€æè¿°çš„ prepended packet info)ï¼Œç„¶åæ‰æ˜¯åŸå§‹åè®®çš„ frameã€‚å…¶ä¸­çš„ Proto å­—æ®µæ˜¯ EtherType [Wikipedia]ï¼Œå¯ä»¥æ ¹æ®é‡Œé¢çš„ values æ¥åˆ¤æ–­æ¥å—å°åŒ…çš„åè®®ç±»å‹ (0x0800 è¡¨ç¤º IPv4ï¼Œ0x86DD è¡¨ç¤º IPv6)ã€‚ ","date":"2024-02-17","objectID":"/posts/rust-tcp/:1:1","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"setcap setcap [Linux manual page] cap_from_text [Linux manual page] å› ä¸º TUN/TAP æ˜¯ç”± kernel æä¾›çš„ï¼Œæ‰€ä»¥éœ€è¦èµ‹äºˆæˆ‘ä»¬é¡¹ç›®çš„å¯æ‰§è¡Œæ–‡ä»¶æƒé™ï¼Œä½¿å®ƒèƒ½è®¿é—®æˆ‘ä»¬åˆ›å»ºçš„ TUN/TAP è®¾å¤‡ (ä¸ºäº†ç®€å•èµ·è§ï¼Œä¸‹é¢åªåˆ—å‡º release ç‰ˆæœ¬çš„æ–¹æ³•ï¼Œdebug ç‰ˆæœ¬çš„æ–¹æ³•ç±»ä¼¼)ã€‚ # ç¼–è¯‘ $ cargo build --release # è®¾ç½®æ–‡ä»¶æƒé™ $ sudo setcap cap_net_admin=eip target/release/trust # è¿è¡Œ $ cargo run --release åœ¨å¦ä¸€ç»ˆç«¯è¾“å…¥å‘½ä»¤ ip addr å°±å¯ä»¥çœ‹åˆ°æ­¤æ—¶ä¼šå¤šå‡ºä¸€ä¸ªåä¸º tun0 çš„è®¾å¤‡ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬åˆ›å»ºçš„ TUN è®¾å¤‡ã€‚ ip-address [Linux manual page] ip-link [Linux manual page] åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­è¾“å…¥: # åˆ—å‡ºå½“å‰æ‰€æœ‰çš„ç½‘ç»œè®¾å¤‡ $ ip addr # é…ç½®è®¾å¤‡ tun0 çš„ IP åœ°å€ $ sudo ip addr add 192.168.0.1/24 dev tun0 # å¯åŠ¨è®¾å¤‡ tun0 $ sudo ip link set up dev tun0 æ¯æ¬¡ç¼–è¯‘åéƒ½éœ€è¦æ‰§è¡Œä¸€éè¿™ä¸ªæµç¨‹ (å› ä¸ºé‡æ–°ç¼–è¯‘ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶éœ€è¦é‡æ–°è®¾ç½®æƒé™)ï¼Œæˆ‘ä»¬å°†è¿™äº›æµç¨‹çš„é€»è¾‘å†™æˆä¸€ä¸ªè„šæœ¬ run.shã€‚è¿™ä¸ªè„šæœ¬ä¸ºäº†è¾“å‡ºçš„ç¾è§‚æ€§å¢åŠ äº†é¢å¤–é€»è¾‘ï¼Œä¾‹å¦‚å°† trust æ”¾åœ¨åå°æ‰§è¡Œï¼Œå°†è„šæœ¬è®¾ç½®ä¸ºç­‰å¾… trust æ‰§è¡Œå®Œæˆåæ‰ç»“æŸæ‰§è¡Œã€‚ ","date":"2024-02-17","objectID":"/posts/rust-tcp/:1:2","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"Endianness Endianness [Wikipedia] Why is network-byte-order defined to be big-endian? [Stack Overflow] Rust æä¾›äº† Trait std::simd::ToBytes ç”¨äºå¤§å°ç«¯å­—èŠ‚åºä¹‹é—´çš„ç›¸äº’è½¬æ¢ï¼Œæ–¹æ³• from_be_bytes æ˜¯å°†å¤§ç«¯å­—èŠ‚åºçš„ä¸€ç³»åˆ—å­—èŠ‚è½¬æ¢æˆå¯¹åº”è¡¨ç¤ºçš„æ•°å€¼ã€‚ ","date":"2024-02-17","objectID":"/posts/rust-tcp/:1:3","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"IP å› ä¸º TUN åªæ˜¯åœ¨ Network layer çš„è™šæ‹Ÿè®¾å¤‡ (TAP åˆ™æ˜¯ Data link layer å±‚)ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨è§£æ IP å°åŒ…ã€‚ RFC 791 3.1. Internet Header Format List of IP protocol numbers [Wikipedia] å¯ä»¥æŒ‰ç…§ä¸Šé¢çš„æ ¼å¼æ¥è§£æå°åŒ…å¤´ï¼Œä¹Ÿå¯ä»¥å¼•å…¥ Crate etherparse æ¥è§£æ IP å°åŒ…å¤´ã€‚ ping å‘½ä»¤ä½¿ç”¨çš„æ˜¯ Network layer ä¸Šçš„ ICMP åè®®ï¼Œå¯ä»¥ç”¨äºæµ‹è¯• TUN æ˜¯å¦æˆåŠŸé…ç½®å¹¶èƒ½æ¥æ”¶å°åŒ…ã€‚ $ ping -I tun0 192.168.0.2 ping (networking utility) [Wikipedia] ping [Linux man page] nc å‘½ä»¤ç”¨äºå‘é€ TCP å°åŒ… $ nc 192.168.0.2 80 nc [Linux man page] æ³¨æ„ ping, nc è¿™äº›å‘½ä»¤ä½¿ç”¨çš„éƒ½æ˜¯ kernel çš„åè®®æ ˆæ¥å®ç°ï¼Œæ‰€ä»¥åœ¨åˆ›å»ºè™šæ‹Ÿè®¾å¤‡ tun0 ä¹‹åï¼Œä½¿ç”¨ä»¥ä¸Š ping, nc å‘½ä»¤è¡¨ç¤º kernel å‘é€ç›¸åº”çš„ ICMP, TCP å°åŒ…ç»™åˆ›å»º tun0 çš„è¿›ç¨‹ (process)ã€‚ å¯ä»¥ä½¿ç”¨ tshark (Terminal Wireshark) å·¥å…·æ¥æŠ“åŒ…ï¼Œé…åˆ ping,nc å‘½ä»¤å¯ä»¥åˆ†æ tun0 çš„å°åŒ…ä¼ é€ã€‚ $ sudo apt install tshark $ sudo tshark -i tun0 Wireshark [Wikipedia] tshark [Manual Page] ","date":"2024-02-17","objectID":"/posts/rust-tcp/:1:4","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"TCP [RFC 793] 3.2 Terminology The state diagram in figure 6 illustrates only state changes, together with the causing events and resulting actions, but addresses neither error conditions nor actions which are not connected with state changes. è¿™é‡Œé¢æåˆ°çš„ Figure 6. TCP Connection State Diagram åœ¨å…¶ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ° TCP çš„çŠ¶æ€è½¬æ¢ï¼Œéå¸¸æœ‰åˆ©äºç›´è§‚ç†è§£ TCP å»ºç«‹è¿æ¥æ—¶çš„ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ã€‚ è­¦å‘Š NOTE BENE: this diagram is only a summary and must not be taken as the total specification. Time to live [Wikipedia] In the IPv4 header, TTL is the 9th octet of 20. In the IPv6 header, it is the 8th octet of 40. The maximum TTL value is 255, the maximum value of a single octet. A recommended initial value is 64. SND.WL1 and SND.WL2 Note that SND.WND is an offset from SND.UNA, that SND.WL1 records the sequence number of the last segment used to update SND.WND, and that SND.WL2 records the acknowledgment number of the last segment used to update SND.WND. The check here prevents using old segments to update the window. ","date":"2024-02-17","objectID":"/posts/rust-tcp/:1:5","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"Documentations è¿™é‡Œåˆ—ä¸¾è§†é¢‘ä¸­ä¸€äº›æ¦‚å¿µç›¸å…³çš„ documentation å­¦ä¹ çš„ä¸€æ‰‹èµ„æ–™æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œè¯·åŠ¡å¿…è‡ªä¸»å­¦ä¼šé˜…è¯»è§„æ ¼ä¹¦ä¹‹ç±»çš„èµ„æ–™ ","date":"2024-02-17","objectID":"/posts/rust-tcp/:2:0","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"Crate std Module std::io Type Alias std::io::Result Module std::collections::hash_map method std::collections::hash_map::HashMap::entry method std::collections::hash_map::Entry::or_default Trait std::default::Default Module std::net Macro std::eprintln method std::result::Result::expect method u16::from_be_bytes ","date":"2024-02-17","objectID":"/posts/rust-tcp/:2:1","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"Crate tun_tap Enum tun_tap::Mode ","date":"2024-02-17","objectID":"/posts/rust-tcp/:2:2","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"Crate etherparse Struct etherparse::Ipv4HeaderSlice Struct etherparse::Ipv4Header Struct etherparse::TcpHeaderSlice Struct etherparse::TcpHeader ","date":"2024-02-17","objectID":"/posts/rust-tcp/:2:3","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Rust","Network"],"content":"References https://datatracker.ietf.org/doc/html/rfc793 https://datatracker.ietf.org/doc/html/rfc1122 https://datatracker.ietf.org/doc/html/rfc7414#section-2 https://datatracker.ietf.org/doc/html/rfc2398 https://datatracker.ietf.org/doc/html/rfc2525 https://datatracker.ietf.org/doc/html/rfc791 https://www.saminiir.com/lets-code-tcp-ip-stack-3-tcp-handshake/ https://www.saminiir.com/lets-code-tcp-ip-stack-4-tcp-data-flow-socket-api/ https://www.saminiir.com/lets-code-tcp-ip-stack-5-tcp-retransmission/ æ³¨æ„ RFC 793 æè¿°äº†åŸå§‹çš„ TCP åè®®çš„å†…å®¹ (é‡ç‚¹é˜…è¯» 3.FUNCTIONAL SPECIFICATION ) RFC 1122 åˆ™æ˜¯å¯¹åŸå§‹çš„ TCP åŠŸèƒ½çš„ä¸€äº›æ‰©å±•è¿›è¡Œè¯´æ˜ RFC 7414 çš„ Section 2 åˆ™å¯¹ TCP çš„æ ¸å¿ƒåŠŸèƒ½è¿›è¡Œäº†ç®€è¦æè¿° RFC 2398 æè¿°äº†å¯¹å®ç°çš„ TCP çš„ä¸€äº›æµ‹è¯•æ–¹æ³•å’Œå·¥å…· RFC 2525 è¯´æ˜äº†åœ¨å®ç° TCP è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°çš„é”™è¯¯ï¼Œå¹¶æŒ‡å‡ºå¯èƒ½å¯¼è‡´é”™è¯¯çš„æ½œåœ¨é—®é¢˜ RFC 791 æè¿°äº† IP åè®® çš„å†…å®¹ æœ€å 3 ç¯‡åšå®¢ä»‹ç»äº† TCP åè®®ç›¸å…³æœ¯è¯­å’Œæ¦‚å¿µï¼Œå¯ä»¥æ­é… RFC 793 é˜…è¯» ","date":"2024-02-17","objectID":"/posts/rust-tcp/:3:0","tags":["Rust","TCP","Network"],"title":"Impl Rust: TCP/IP","uri":"/posts/rust-tcp/"},{"categories":["Linux Kernel Internals"],"content":"Source ","date":"2024-02-16","objectID":"/posts/linux-quiz1/:0:0","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: ç¬¬ 1 å‘¨æµ‹éªŒé¢˜ linked list","uri":"/posts/linux-quiz1/"},{"categories":["Linux Kernel Internals"],"content":"2018q1 ç¬¬ 4 é€±æ¸¬é©—é¡Œ ","date":"2024-02-16","objectID":"/posts/linux-quiz1/:1:0","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: ç¬¬ 1 å‘¨æµ‹éªŒé¢˜ linked list","uri":"/posts/linux-quiz1/"},{"categories":["Linux Kernel Internals"],"content":"æµ‹éªŒ 1 FuncA çš„ä½œç”¨æ˜¯ (e) å»ºç«‹æ–°ç¯€é»ï¼Œå…§å®¹æ˜¯ valueï¼Œä¸¦å®‰æ’åœ¨çµå°¾ FuncB çš„ä½œç”¨æ˜¯ (d) å»ºç«‹æ–°ç¯€é»ï¼Œå…§å®¹æ˜¯ valueï¼Œä¸¦å®‰æ’åœ¨é–‹é ­ FuncC çš„ä½œç”¨æ˜¯ (e) æ‰¾åˆ°ç¯€é»å…§å®¹ç‚º value2 çš„ç¯€é»ï¼Œä¸¦åœ¨ä¹‹å¾Œæ’å…¥æ–°ç¯€é»ï¼Œå…§å®¹ç‚º value1 åœ¨ main å‡½æ•°è°ƒç”¨ display å‡½æ•°ä¹‹å‰ï¼Œé“¾è¡¨åˆ†å¸ƒä¸º: 48 -\u003e 51 -\u003e 63 -\u003e 72 -\u003e 86 åœ¨ç¨‹å¼è¼¸å‡ºä¸­ï¼Œè¨Šæ¯ Traversal in forward direction å¾Œä¾åºå°å‡ºå“ªå¹¾å€‹æ•¸å­—å‘¢ï¼Ÿ (d) 48 (c) 51 (a) 63 (e) 72 (b) 86 åœ¨ç¨‹å¼è¼¸å‡ºä¸­ï¼Œè¨Šæ¯ Traversal in reverse direction å¾Œä¾åºå°å‡ºå“ªå¹¾å€‹æ•¸å­—å‘¢ï¼Ÿ (b) 86 (e) 72 (a) 63 (c) 51 (d) 48 æŠ€å·§ å»¶ä¼¸é¡Œç›®ï¼š åœ¨ä¸Šè¿° doubly-linked list å¯¦ä½œæ°£æ³¡æ’åºå’Œåˆä½µæ’åºï¼Œä¸¦æå‡ºéœ€è¦é¡å¤–å¯¦ä½œå“ªäº›å‡½ç¤ºæ‰è¶³ä»¥é”æˆç›®æ¨™ å¼•å…¥çµ±è¨ˆæ¨¡å‹ï¼Œéš¨æ©Ÿæ–°å¢å’Œåˆªé™¤ç¯€é»ï¼Œç„¶å¾Œè©•ä¼°ä¸Šè¿°åˆä½µæ’åºç¨‹å¼çš„æ™‚é–“è¤‡é›œåº¦å’Œæ•ˆèƒ½åˆ†ä½ˆ (éœ€è¦è£½åœ–å’Œæ•¸å­¸åˆ†æ) ","date":"2024-02-16","objectID":"/posts/linux-quiz1/:1:1","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: ç¬¬ 1 å‘¨æµ‹éªŒé¢˜ linked list","uri":"/posts/linux-quiz1/"},{"categories":["Linux Kernel Internals"],"content":"æµ‹éªŒ 2 FuncX çš„ä½œç”¨æ˜¯ (æ¶µè“‹ç¨‹å¼åŸ·è¡Œè¡Œç‚ºçš„æ­£ç¢ºæè¿°æœ€å¤šè€…) (f) åˆ¤æ–·æ˜¯å¦ç‚º circular linked listï¼Œè‹¥ç‚º circular å‰‡å›å‚³ 0ï¼Œå…¶ä»–éé›¶å€¼ï¼Œéç¨‹ä¸­è¨ˆç®—èµ°è¨ªçš„ç¯€é»ç¸½æ•¸ K1 Â» å¾Œé¢æ¥çš„è¼¸å‡ºç‚ºä½• (b) Yes K2 Â» å¾Œé¢æ¥çš„è¼¸å‡ºç‚ºä½• (a) No K3 Â» å¾Œé¢æ¥çš„è¼¸å‡ºç‚ºä½• (a) No K4 Â» å¾Œé¢æ¥çš„è¼¸å‡ºç‚ºä½• (a) No K5 Â» å¾Œé¢æ¥çš„è¼¸å‡ºç‚ºä½• (f) 0 count Â» å¾Œé¢æ¥çš„è¼¸å‡ºç‚ºä½• (f) 0 ","date":"2024-02-16","objectID":"/posts/linux-quiz1/:1:2","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: ç¬¬ 1 å‘¨æµ‹éªŒé¢˜ linked list","uri":"/posts/linux-quiz1/"},{"categories":["Linux Kernel Internals"],"content":"2020q1 ç¬¬ 1 é€±æ¸¬é©—é¡Œ ","date":"2024-02-16","objectID":"/posts/linux-quiz1/:2:0","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: ç¬¬ 1 å‘¨æµ‹éªŒé¢˜ linked list","uri":"/posts/linux-quiz1/"},{"categories":["Linux Kernel Internals"],"content":"æµ‹éªŒ 1 æœ¬é¢˜ä½¿ç”¨çš„æ˜¯å•å‘ linked list typedef struct __list { int data; struct __list *next; } list; ä¸€å¼€å§‹çš„ if è¯­å¥ç”¨äºåˆ¤æ–­ start æ˜¯å¦ä¸º NULL æˆ–æ˜¯å¦åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯åˆ™ç›´æ¥è¿”å›æ— éœ€æ’åº æ¥ä¸‹æ¥ä½¿ç”¨ mergesort æ¥å¯¹ linked list è¿›è¡Œä»å°åˆ°å¤§æ’åºï¼Œå¹¶ä¸”æ¯æ¬¡å·¦ä¾§é“¾è¡¨åªåˆ’åˆ†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå‰©ä½™èŠ‚ç‚¹å…¨éƒ¨åˆ’ä¸ºå³ä¾§é“¾è¡¨ list *left = start; list *right = left-\u003enext; left-\u003enext = NULL; // LL0; å†æ¥å°±æ˜¯å½’å¹¶æ“ä½œï¼Œå°† left å’Œ right è¿›è¡Œå½’å¹¶ï¼Œå¦‚æœ merge ä¸º NULLï¼Œåˆ™å°†å¯¹åº”çš„èŠ‚ç‚¹èµ‹å€¼ç»™å®ƒå’Œ startï¼Œå¦åˆ™éœ€è¦è¿­ä»£ left æˆ– right ä»¥åŠ merge ä»¥å®Œæˆå½’å¹¶æ“ä½œ for (list *merge = NULL; left || right; ) { if (!right || (left \u0026\u0026 left-\u003edata \u003c right-\u003edata)) { if (!merge) { start = merge = left; // LL1; } else { merge-\u003enext = left; // LL2; merge = merge-\u003enext; } left = left-\u003enext; // LL3; } else { if (!merge) { start = merge = right; // LL4; } else { merge-\u003enext = right; // LL5; merge = merge-\u003enext; } right = right-\u003enext; // LL6; } } æŠ€å·§ å»¶ä¼¸å•é¡Œ: è§£é‡‹ä¸Šè¿°ç¨‹å¼é‹ä½œåŸç†; æŒ‡å‡ºç¨‹å¼æ”¹é€²ç©ºé–“ï¼Œç‰¹åˆ¥æ˜¯è€ƒæ…®åˆ° Optimizing merge sort; å°‡ä¸Šè¿° singly-linked list æ“´å……ç‚º circular doubly-linked list ä¸¦é‡æ–°å¯¦ä½œå°æ‡‰çš„ sort; ä¾å¾ª Linux æ ¸å¿ƒ include/linux/list.h ç¨‹å¼ç¢¼çš„æ–¹å¼ï¼Œæ”¹å¯«ä¸Šè¿°æ’åºç¨‹å¼; å˜—è©¦å°‡åŸæœ¬éè¿´çš„ç¨‹å¼æ”¹å¯«ç‚º iterative ç‰ˆæœ¬; ","date":"2024-02-16","objectID":"/posts/linux-quiz1/:2:1","tags":["Sysprog","Linux","C"],"title":"Linux æ ¸å¿ƒè®¾è®¡: ç¬¬ 1 å‘¨æµ‹éªŒé¢˜ linked list","uri":"/posts/linux-quiz1/"},{"categories":["Linux","Linux Kernel Internals"],"content":" é¢å°åŸå§‹ç¨‹å¼ç¢¼è¶…è¶Š 3 åƒè¬è¡Œè¦æ¨¡çš„ Linux æ ¸å¿ƒ (2023 å¹´)ï¼Œæœ€ä»¤äººæ„Ÿåˆ°æŒ«æŠ˜çš„ï¼Œçµ•éç¼ºä¹ç¨‹å¼è¨»è§£ï¼Œè€Œæ˜¯å°±ç®—è¦‹åˆ°æ»¿æ»¿çš„è¨»è§£ï¼Œè‡ªå·±å»æœ‰å¦‚æ–‡ç›²ï¼Œå…¨ç„¶ç„¡å¾ç†è§£èµ·ã€‚ç‚ºä»€éº¼å‘¢ï¼Ÿå¾€å¾€æ˜¯å› ç‚ºå°ä½œæ¥­ç³»çµ±çš„èªçŸ¥å¤ªä¾·é™ã€‚ åŸæ–‡åœ°å€ ","date":"2024-02-15","objectID":"/posts/linux-concepts/:0:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"Linux æ ¸å¿ƒå‘å±• è™šæ‹ŸåŒ– (Virtualization) æŠ€æœ¯åˆ†ä¸º CPU å±‚çº§çš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œä¾‹å¦‚ KVM å’Œ RVMï¼Œä¹Ÿæœ‰æ“ä½œç³»ç»Ÿå±‚çº§çš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œä¾‹å¦‚ Dockerã€‚ Plan 9 from Bell Labs [Wikipedia] LXC [Wikipedia] ä¿¡æ¯ å¾ Revolution OS çœ‹ä½œæ¥­ç³»çµ±ç”Ÿæ…‹è®ŠåŒ– Linux æ ¸å¿ƒè¨­è¨ˆ: é€é eBPF è§€å¯Ÿä½œæ¥­ç³»çµ±è¡Œç‚º ","date":"2024-02-15","objectID":"/posts/linux-concepts/:1:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"çœ‹æ¼«ç”»å­¦ Linux åŸæ–‡åœ°å€ inside the linux kernel æ•´ç†ä¸Šå›¾ï¼Œå¯ä»¥å¾—åˆ° è‡ªåº•å‘ä¸Š çš„ Linux ç³»ç»Ÿç»“æ„: åœ°ä¸‹å±‚: æ–‡ä»¶ç³»ç»Ÿ (File System) ä¸­å¤®å¤§å…å±‚: è¿›ç¨‹è¡¨ (process table) å†…å­˜ç®¡ç† (memory management) ä¿¡æ¯å®‰å…¨ (security) çœ‹é—¨ç‹— (watchdog) httpd cron ç®¡é“ (pipe) FTP SSH Wine GNOME æœ€ä¸Šå±‚ tty / terminal wiki: Pipeline (Unix) [Wikipedia] Process identifier [Wikipedia] watchdog [Linux man page] init [Wikipedia] systemd [Wikipedia] fork [Linux man page] clone [Linux man page] Project Genie [Wikipedia] posix_spawn [Linux man page] Native POSIX Thread Library [Wikipedia] æå®¢æ¼«ç”»: ä¸è¦ä½¿ç”¨ SIGKILL çš„åŸå›  wait [Linux man page] signal [Linux man page] TUX web server [Wikipedia] -[x] cron æŠ€å·§ Multics é‡‡ç”¨äº†å½“æ—¶èƒŒæ™¯ä¸‹çš„å‡ ä¹æ‰€æœ‰çš„å…ˆè¿›æŠ€æœ¯ï¼Œå¯ä»¥å‚è€ƒè¯¥ç³»ç»Ÿè·å–ç³»ç»Ÿé¢†åŸŸçš„çµæ„Ÿã€‚ è™šæ‹Ÿå†…å­˜ç®¡ç†ä¸ç°ä»£é“¶è¡Œçš„è¿è¡Œé€»è¾‘ç±»ä¼¼ï¼Œé€šè¿‡ malloc åˆ†é…çš„æœ‰æ•ˆè™šæ‹Ÿåœ°å€å¹¶ä¸èƒ½ä¿è¯çœŸæ­£å¯ç”¨ï¼Œç±»ä¼¼äºæ”¯ç¥¨å¾—å»é“¶è¡Œå…‘ç°æ—¶æ‰çŸ¥é“é“¶è¡ŒçœŸæ­£çš„ç°é‡‘å‚¨å¤‡ã€‚ä½†æ˜¯æ ¹æ®ç»Ÿè®¡å­¦å…¬å¼ï¼Œè™šæ‹Ÿåœ°å€å’Œé“¶è¡Œç°é‡‘å¯ä»¥ä¿è¯åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œéƒ½å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œå½“ç„¶çªå‘çš„å¤§è§„æ¨¡è™šæ‹Ÿå†…å­˜ä½¿ç”¨ã€ç°é‡‘å…‘ç°æ—¶å°±æ— æ³•ä¿è¯äº†ã€‚è¿™éƒ¨åˆ†çš„åŸç†æ¨å¯¼éœ€è¦å­¦ä¹ æ¦‚ç‡è®ºã€ç»Ÿè®¡å­¦ç­‰æ•°ç†è¯¾ç¨‹ã€‚ ä¿¡æ¯ Linux æ ¸å¿ƒè®¾è®¡: Linux æ ¸å¿ƒè¨­è¨ˆ: æª”æ¡ˆç³»çµ±æ¦‚å¿µåŠå¯¦ä½œæ‰‹æ³• Linux æ ¸å¿ƒè¨­è¨ˆ: ä¸åƒ…æ˜¯å€‹åŸ·è¡Œå–®å…ƒçš„ Process Linux æ ¸å¿ƒè¨­è¨ˆ: ä¸åªæŒ‘é¸ä»»å‹™çš„æ’ç¨‹å™¨ UNIX ä½œæ¥­ç³»çµ± fork/exec ç³»çµ±å‘¼å«çš„å‰ä¸–ä»Šç”Ÿ Linux æ ¸å¿ƒè¨­è¨ˆ: è¨˜æ†¶é«”ç®¡ç† Linux æ ¸å¿ƒè¨­è¨ˆ: ç™¼å±•å‹•æ…‹å›é¡§ Linux æ ¸å¿ƒè¨­è¨ˆ: é‡å°äº‹ä»¶é©…å‹•çš„ I/O æ¨¡å‹æ¼”åŒ– Linux æ ¸å¿ƒè¨­è¨ˆ: Scalability è­°é¡Œ Effective System Call Aggregation (ESCA) ä½ æ‰€ä¸çŸ¥é“çš„ C èªè¨€: Stream I/O, EOF å’Œä¾‹å¤–è™•ç† Unix-like å·¥å…·ä½¿ç”¨æŠ€å·§: Mastering UNIX pipes, Part 1 Mastering UNIX pipes, Part 2 ","date":"2024-02-15","objectID":"/posts/linux-concepts/:2:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"é«˜é˜¶è§‚ç‚¹ æŠ•å½±ç‰‡: Linux Kernel: Introduction âœ… å¯¹æŠ•å½±ç‰‡çš„ é‡ç‚¹æè¿° ä¸€äº›æ¦‚å¿µç†è§£: 1963 Timesharing: A Solution to Computer Bottlenecks [YouTube] Supervisory program [Wikipedia] ","date":"2024-02-15","objectID":"/posts/linux-concepts/:3:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"Monolithic kernel vs Microkernel æ·ºè«‡ Microkernel è¨­è¨ˆå’ŒçœŸå¯¦ä¸–ç•Œä¸­çš„æ‡‰ç”¨ Hybrid kernel [wikipedia] â€œAs to the whole â€˜hybrid kernelâ€™ thing - itâ€™s just marketing. Itâ€™s â€˜oh, those microkernels had good PR, how can we try to get good PR for our working kernel? Oh, I know, letâ€™s use a cool name and try to imply that it has all the PR advantages that that other system hasâ€™.â€ â€”â€” Linus Torvalds ","date":"2024-02-15","objectID":"/posts/linux-concepts/:3:1","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"è™šæ‹ŸåŒ– MicroVM å’Œ Unikernel éƒ½æ˜¯ä½¿ç”¨ CPU å±‚çº§çš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œåœ¨ Host OS ä¸Šé¢æ„å»ºçš„ GuestOS: MicroVM ä¼šå‡å°‘ç¡¬ä»¶é©±åŠ¨æ–¹é¢çš„åˆå§‹åŒ–ï¼Œä»è€ŒåŠ å¿«å¯åŠ¨å’ŒæœåŠ¡é€Ÿåº¦ (åœ¨äº‘æœåŠ¡å™¨æ–¹é¢å¾ˆå¸¸è§ï¼ŒæœåŠ¡å™¨ç«¯å¹¶ä¸éœ€è¦è¿›è¡Œç¡¬ä»¶é©±åŠ¨)ã€‚ Unikernel åˆ™æ›´æ¿€è¿›ï¼Œå°† programs å’Œ kernel ä¸€èµ·è¿›è¡ŒåŠ¨æ€ç¼–è¯‘ï¼Œå¹¶ä¸”é™åˆ¶åªèƒ½è¿è¡Œä¸€ä¸ª process (ä¾‹å¦‚åªè¿è¡Œä¸€ä¸ªæ•°æ®åº“è¿›ç¨‹ï¼Œè¿™æ ·äº‘æœåŠ¡å™¨å¾ˆå¸¸è§)ï¼Œè¿™æ ·å°±å‡å°‘äº†ä¸€äº›ç³»ç»Ÿè°ƒç”¨çš„å‘¼å«ï¼Œä¾‹å¦‚ fork (å› ä¸ºåªèƒ½è¿è¡Œä¸€ä¸ª process)ï¼Œæå‡äº†å®‰å…¨æ€§ (å› ä¸º fork ç³»ç»Ÿè°ƒç”¨å¯èƒ½ä¼šé€ æˆä¸€äº›æ¼æ´)ã€‚Unikernel åˆå« Library OSï¼Œå¯ä»¥ç†è§£ä¸ºåˆ†æ—¶å¤šäººå¤šå·¥æ“ä½œç³»ç»Ÿçš„å¦ä¸€ä¸ªå¯¹ç«‹é¢ï¼Œæ‹¥æœ‰æé«˜çš„è¿è¡Œé€Ÿåº¦ (å› ä¸ºåªæœ‰ä¸€ä¸ª process)ã€‚ Container Sandbox ä½¿ç”¨çš„æ˜¯ OS å±‚çº§çš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œå³å®ƒæ˜¯å°†ä¸€ç»„è¿›ç¨‹éš”ç¦»èµ·æ¥æ„å»ºä¸ºå®¹å™¨ï¼Œè¿™æ ·å¯èƒ½ä¼šå¯¼è‡´è¿™ä¸€ç»„è¿›ç¨‹å°±è€—å°½äº†ç³»ç»Ÿçš„èµ„æºï¼Œå…¶ä»–è¿›ç¨‹æ— æ³•ä½¿ç”¨ç³»ç»Ÿçš„èµ„æºã€‚åŒæ—¶å› ä¸ºæ˜¯è¿›ç¨‹çº§çš„éš”ç¦»ï¼Œæ‰€ä»¥å®‰å…¨æ€§ä¸åŠ CPU å±‚çº§çš„ MicroVM å’Œ Unikernelã€‚ ä¿¡æ¯ ç›¸å…³æ¼”è®²ã€å½•å½±: YouTube: Inside the Mac OS X Kernel YouTube: What Are MicroVMs? And Why Should I Care? YouTube: From the Ground Up: How We Built the Nanos Unikernel ç›¸å…³è®ºæ–‡é˜…è¯»: ","date":"2024-02-15","objectID":"/posts/linux-concepts/:3:2","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"Scalability Wikipedia: scalability A system whose performance improves after adding hardware, proportionally to the capacity added, is said to be a scalable system. lock-free sequence lock RCU algorithm complexity ","date":"2024-02-15","objectID":"/posts/linux-concepts/:3:3","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"eBPF é€è¿‡ eBPF å¯å°† Monolithic kernel çš„ Linux å–å¾— microkernel çš„ç‰¹æ€§ The Beginners Guide to eBPF Programming, Liza RIce (live programming + source code) A thorough introduction to eBPF (four articles in lwn.net), Matt FLeming, December 2017 ","date":"2024-02-15","objectID":"/posts/linux-concepts/:3:4","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"ç»†èŠ‚åˆ‡å…¥ç‚¹ CPU å’Œ OS çš„åŸºæœ¬æ¦‚å¿µç§‘æ™®ç½‘ç«™: Putting the â€œYouâ€ in CPU ç›¸å½“äºç§‘æ™®ç‰ˆ CSAPP æŠ€å·§ UNSW COMP9242: Advanced Operating Systems (2023/T3) è¿™é—¨è¯¾å¯ä»¥ä½œä¸ºè¾…åŠ©ææ–™ï¼Œè®²å¾—æ·±å…¥æµ…å‡ºï¼Œå¯ä»¥ä½œä¸ºè¿›é˜¶ææ–™é˜…è¯»ã€‚ Georgia Tech Advanced Operating Systems: Part 1 Part 2 Part 3 Part 4 ","date":"2024-02-15","objectID":"/posts/linux-concepts/:4:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"man $ man man The table below shows the section numbers of the manual followed by the types of pages they contain. 1 Executable programs or shell commands 2 System calls (functions provided by the kernel) 3 Library calls (functions within program libraries) 4 Special files (usually found in /dev) 5 File formats and conventions, e.g. /etc/passwd 6 Games 7 Miscellaneous (including macro packages and conventions), e.g. man(7), groff(7), man-pages(7) 8 System administration commands (usually only for root) 9 Kernel routines [Non standard] ","date":"2024-02-15","objectID":"/posts/linux-concepts/:5:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"ç³»ç»Ÿè½¯ä»¶å¼€å‘æ€ç»´ ","date":"2024-02-15","objectID":"/posts/linux-concepts/:6:0","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"Maslowâ€™s pyramid of code review Maslowâ€™s pyramid of code review ","date":"2024-02-15","objectID":"/posts/linux-concepts/:6:1","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Linux","Linux Kernel Internals"],"content":"Benchmark / Profiling Benchmark / Profiling ","date":"2024-02-15","objectID":"/posts/linux-concepts/:6:2","tags":["Sysprog","Linux"],"title":"Linux æ ¸å¿ƒè®¾è®¡: æ“ä½œç³»ç»Ÿæœ¯è¯­åŠæ¦‚å¿µ","uri":"/posts/linux-concepts/"},{"categories":["Rust"],"content":" In this third Crust of Rust video, we cover iterators and trait bounds, by re-implementing the â€œflattenâ€ Iterator method from the standard library. As part of that, we cover some of the weirder trait bounds that are required, including whatâ€™s needed to extend the implementation to support backwards iteration. æ•´ç†è‡ª John Gjengset çš„å½±ç‰‡ ","date":"2024-02-05","objectID":"/posts/iterators/:0:0","tags":["Rust","Iterator"],"title":"Crust of Rust: Iterators","uri":"/posts/iterators/"},{"categories":["Rust"],"content":"å½±ç‰‡æ³¨è§£ ","date":"2024-02-05","objectID":"/posts/iterators/:1:0","tags":["Rust","Iterator"],"title":"Crust of Rust: Iterators","uri":"/posts/iterators/"},{"categories":["Rust"],"content":"Generic traits vs associated types trait Iterator { type Item; fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e; } trait Iterator\u003cItem\u003e { fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e; } ä¸ºä»€ä¹ˆä½¿ç”¨ä¸Šé¢çš„ associated type è€Œä¸æ˜¯ä¸‹é¢çš„ generic æ¥å®ç° Iteratorï¼Ÿå› ä¸ºä½¿ç”¨ generic æ¥å®ç°çš„è¯ï¼Œå¯ä»¥å¯¹ä¸€ä¸ªç±»å‹å®ç°å¤šä¸ª Iterator trait ä¾‹å¦‚ Iterator\u003ci32\u003e, Iterator\u003cf64ï¼Œè€Œä»è¯­è¨€è¡¨è¾¾ä¸Šè®²ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€ä¸ªç±»å‹åªèƒ½å®ç°ä¸€ä¸ª Iterator traitï¼Œæ‰€ä»¥ä½¿ç”¨ associated type æ¥å®ç° Iterator traitï¼Œé˜²æ­¢äºŒä¹‰æ€§ã€‚ for v in vs.iter() { // borrow vs, \u0026 to v } for v in \u0026vs { // equivalent to vs.iter() } è¿™ä¸¤æ¡ for è¯­å¥è™½ç„¶æ•ˆæœä¸€æ ·ï¼Œä½†æ˜¯åè€…æ˜¯ä½¿ç”¨ \u003c\u0026vs\u003e into_iter è®² \u0026vs è½¬ä¸º iteratorï¼Œè€Œä¸æ˜¯è°ƒç”¨ iter() æ–¹æ³•ã€‚ ","date":"2024-02-05","objectID":"/posts/iterators/:1:1","tags":["Rust","Iterator"],"title":"Crust of Rust: Iterators","uri":"/posts/iterators/"},{"categories":["Rust"],"content":"Iterator::flatten method std::iter::Iterator::flatten Creates an iterator that flattens nested structure. This is useful when you have an iterator of iterators or an iterator of things that can be turned into iterators and you want to remove one level of indirection. flatten() çš„æœ¬è´¨æ˜¯å°†ä¸€ç§ Iterator ç±»å‹è½¬æ¢æˆå¦ä¸€ç§ Iterator ç±»å‹ï¼Œæ‰€ä»¥è°ƒç”¨è€…å’Œè¿”å›å€¼ Flatten éƒ½æ»¡è¶³ trait Iteratorï¼Œå› ä¸ºéƒ½æ˜¯è¿­ä»£å™¨ï¼Œåªæ˜¯å°†åŸå…ˆçš„ n-level å‹æ‰ä¸º 1-level çš„ Iterator äº†ã€‚å½•å½±è§†é¢‘é‡Œåªè€ƒè™‘ 2-level çš„æƒ…å†µã€‚ ","date":"2024-02-05","objectID":"/posts/iterators/:1:2","tags":["Rust","Iterator"],"title":"Crust of Rust: Iterators","uri":"/posts/iterators/"},{"categories":["Rust"],"content":"DoubleEndedIterator Trait std::iter::DoubleEndedIterator It is important to note that both back and forth work on the same range, and do not cross: iteration is over when they meet in the middle. ä¹Ÿå°±æ˜¯è¯´ï¼Œback å’Œ front çš„è¿­ä»£å™¨ç±»ä¼¼äºåŒæŒ‡é’ˆï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªè¿­ä»£å™¨å¹¶ä¸ä¼šè¶Šè¿‡å¯¹æ–¹ã€‚ ","date":"2024-02-05","objectID":"/posts/iterators/:1:3","tags":["Rust","Iterator"],"title":"Crust of Rust: Iterators","uri":"/posts/iterators/"},{"categories":["Rust"],"content":"Homework ä¿¡æ¯ å®ä½œè¯´æ˜: å°è¯•å®ç° Iterator çš„ flat_map æ–¹æ³• (Github: My Implementation) å‚è€ƒèµ„æ–™: method std::iter::Iterator::flat_map struct std::iter::FlatMap ","date":"2024-02-05","objectID":"/posts/iterators/:2:0","tags":["Rust","Iterator"],"title":"Crust of Rust: Iterators","uri":"/posts/iterators/"},{"categories":["Rust"],"content":"Documentations è¿™é‡Œåˆ—ä¸¾è§†é¢‘ä¸­ä¸€äº›æ¦‚å¿µç›¸å…³çš„ documentation å­¦ä¹ çš„ä¸€æ‰‹èµ„æ–™æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œè¯·åŠ¡å¿…è‡ªä¸»å­¦ä¼šé˜…è¯»è§„æ ¼ä¹¦ä¹‹ç±»çš„èµ„æ–™ ","date":"2024-02-05","objectID":"/posts/iterators/:3:0","tags":["Rust","Iterator"],"title":"Crust of Rust: Iterators","uri":"/posts/iterators/"},{"categories":["Rust"],"content":"Crate std å¯ä»¥ä½¿ç”¨è¿™é‡Œæä¾›çš„æœç´ æ è¿›è¡Œæœç´¢ (BTW ä¸è¦æµªè´¹æ—¶é—´åœ¨ Google æœå¯»ä¸Šï¼) Trait std::iter::Iterator method std::iter::Iterator::flatten method std::iter::Iterator::rev method std::iter::Iterator::flat_map Trait std::iter::IntoIterator Struct std::iter::Flatten function std::iter::empty Struct std::iter::Empty function std::iter::once Struct std::iter::Once Trait std::iter::DoubleEndedIterator Enum std::option::Option method std::option::Option::and_then method std::option::Option::as_mut Trait std::marker::Sized ","date":"2024-02-05","objectID":"/posts/iterators/:3:1","tags":["Rust","Iterator"],"title":"Crust of Rust: Iterators","uri":"/posts/iterators/"},{"categories":["Rust"],"content":"References What is the difference between iter and into_iter? [Stack Overflow] How to run a specific unit test in Rust? [Stack Overflow] How do I implement a trait with a generic method? [Stack Overflow] å¯èƒ½ä¸æ˜¯ä½ çœ‹è¿‡æœ€æ— èŠçš„ Rust å…¥é—¨å–œå‰§ 102 (1) é—­åŒ…ä¸è¿­ä»£å™¨ [bilibili] ","date":"2024-02-05","objectID":"/posts/iterators/:4:0","tags":["Rust","Iterator"],"title":"Crust of Rust: Iterators","uri":"/posts/iterators/"},{"categories":["C","Linux Kernel Internals"],"content":" æ— è®ºæ˜¯æ“ä½œç³»ç»Ÿæ ¸å¿ƒã€C è¯­è¨€å‡½æ•°åº“å†…éƒ¨ã€ç¨‹åºå¼€å‘æ¡†æ¶ï¼Œåˆ°åº”ç”¨ç¨‹åºï¼Œéƒ½ä¸éš¾è§åˆ° linked list çš„èº«å½±ï¼ŒåŒ…å«å¤šç§é’ˆå¯¹æ€§èƒ½å’Œå®‰å…¨è®®é¢˜æ‰€åšçš„ linked list å˜å½¢ï¼Œåˆè¿˜è¦è€ƒè™‘åº”ç”¨ç¨‹åºçš„æ³›ç”¨æ€§ (generic programming)ï¼Œæ˜¯å¾ˆå¥½çš„è¿›é˜¶é¢˜æã€‚ åŸæ–‡åœ°å€ ","date":"2024-02-03","objectID":"/posts/c-linked-list/:0:0","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"Linux æ ¸å¿ƒçš„è‰ºæœ¯ YouTube: The mind behind Linux | Linus Torvalds | TED äº‹å®ä¸Š special case å’Œ indirect pointer è¿™ä¸¤ç§å†™æ³•åœ¨ clang çš„æœ€ä½³ä¼˜åŒ–ä¸‹æ•ˆèƒ½å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ä½¿ç”¨ indirect pointer æ¥å†™ç¨‹åºï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å­¦ä¹  indirect pointer è¿™ç§æ€ç»´æ–¹å¼ï¼Œå³ good tasteã€‚ æŠŠæ¡ç¨‹åºçš„æœ¬è´¨ï¼Œå³æœ¬è´¨ä¸Šæ˜¯ä¿®æ”¹æŒ‡é’ˆçš„å€¼ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æŒ‡é’ˆçš„æŒ‡é’ˆæ¥å®ç°ï¼Œæ— éœ€è¿›è¡Œç‰¹åˆ¤ã€‚ åœ¨ Unix-like çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œç±»å‹åå¸¦æœ‰åç¼€ _t è¡¨ç¤ºè¿™ä¸ªç±»å‹æ˜¯ç”± typedef å®šä¹‰çš„ï¼Œè€Œä¸æ˜¯è¯­è¨€åŸç”Ÿçš„ç±»å‹åï¼Œe.g. typedef struct list_entry { int value; struct list_entry *next; } list_entry_t; ","date":"2024-02-03","objectID":"/posts/c-linked-list/:1:0","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"linked list append \u0026 remove Source ä¿¡æ¯ The mind behind Linux Linus on Understanding Pointers ","date":"2024-02-03","objectID":"/posts/c-linked-list/:1:1","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"LeetCode Source LeetCode 21. Merge Two Sorted Lists LeetCode 23. Merge k Sorted Lists Leetcode 2095. Delete the Middle Node of a Linked List LeetCode 86. Partition List æ³¨æ„ åŸæ–‡å¯¹äº LeetCode 23. Merge k Sorted Lists ç»™å‡ºäº† 3 ç§è§£æ³•ï¼Œå…¶æ—¶é—´å¤æ‚åº¦åˆ†åˆ«ä¸ºï¼š $O(m \\cdot n)$ $O(m \\cdot n)$ $O(m \\cdot logn)$ $n$ ä¸º listsSizeï¼Œ$m$ ä¸º merge linked list è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ linked list çš„æœ€å¤§é•¿åº¦ã€‚ å¦‚æœä½ å¯¹ç¬¬ 3 ç§è§£æ³•çš„æ—¶é—´å¤æ‚åº¦æ„Ÿåˆ°ç–‘æƒ‘ï¼Œè¯·å‚è€ƒ Josh Hug åœ¨ CS61B çš„ Merge Sort å¤æ‚åº¦è®²è§£ã€‚ ","date":"2024-02-03","objectID":"/posts/c-linked-list/:1:2","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"Circular linked list å•å‘ linked list ç›¸å¯¹äºåŒå‘ linked list çš„ä¼˜åŠ¿åœ¨äºï¼Œä¸€ä¸ª cache line å¯ä»¥å®¹çº³æ›´å¤šçš„ list nodeï¼Œè€Œä¸”å¾ˆå®¹æ˜“è¿›è¡Œåå‘æŸ¥è¯¢ï¼Œè¿™å¼¥è¡¥äº†åå‘æŸ¥è¯¢æ—¶çš„æ•ˆèƒ½å·®è·ã€‚ä¾‹å¦‚åœ¨ 64 ä½å¤„ç†å™¨ä¸Šï¼Œåœ°å€ä¸º 64 Bit å³ 8 Byteï¼Œå¦‚æœ list node çš„æ•°æ®åŸŸå­˜æ”¾ä¸€ä¸ª 2 Byte çš„æ•´æ•°ï¼Œé‚£ä¹ˆä¸€ä¸ªå•å‘çš„ list node å¤§å°ä¸º 10 Byteï¼ŒåŒå‘çš„åˆ™ä¸º 18 Byteï¼Œåˆå› ä¸ºä¸€èˆ¬çš„ cache line çš„å¤§å°ä¸º 64 Byteï¼Œåˆ™å¯¹äºå•å‘çš„ node æ¥è¯´ï¼Œcache line å¯ä»¥å­˜æ”¾ $64 / 10 = 6$ ä¸ª list nodeï¼Œä½†æ˜¯ä»…èƒ½å­˜æ”¾ $64 / 18 = 3$ ä¸ª list nodeï¼Œcache æ•ˆç‡æ˜æ˜¾é™ä½ã€‚ è¿™éƒ¨åˆ†å†…å®¹å¯ä»¥å‚è€ƒ jserv çš„è®²åº§ \u003cç¾ä»£è™•ç†å™¨è¨­è¨ˆ: Cache åŸç†å’Œå¯¦éš›å½±éŸ¿\u003e ","date":"2024-02-03","objectID":"/posts/c-linked-list/:2:0","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"Floydâ€™s Cycle detection è¿™ä¸ªâ€œé¾Ÿå…”èµ›è·‘â€ç®—æ³•ä¿è¯å…”å­åœ¨è·‘ä¸¤æ¬¡å¾ªç¯åœˆåï¼Œä¸€å®šä¼šå’Œåˆšå®Œæˆä¸€æ¬¡å¾ªç¯åœˆçš„ä¹Œé¾Ÿç›¸é‡ã€‚å› ä¸ºå·²çŸ¥ä¹Œé¾Ÿæ¯æ¬¡ç§»åŠ¨ä¸€æ­¥ï¼Œå…”å­æ¯æ¬¡ç§»åŠ¨ä¸¤æ­¥ï¼Œå¯ä»¥å‡è®¾åœ¨ç›¸é‡ç‚¹å¤„ä¹Œé¾Ÿç§»åŠ¨çš„ $X$ æ­¥ï¼Œåˆ™å…”å­ç§»åŠ¨äº† $2X$ æ­¥ï¼Œ$2X$ å¿…ä¸ºå¶æ•°ï¼Œæ‰€ä»¥å…”å­å¿…èƒ½åœ¨ç§»åŠ¨äº† $2X$ æ­¥åä¸ä¹Œé¾Ÿç›¸é‡ï¼Œä¸ä¼šå‡ºç°å…”å­å› ä¸ºæ¯æ¬¡ç§»åŠ¨ä¸¤æ­¥è€Œåˆšå¥½è¶Šè¿‡ä¹Œé¾Ÿä¸€æ­¥çš„æƒ…å†µã€‚ $\\lambda$ is the length of the loop to be found, $\\mu$ is the index of the first element of the cycle. Source LeetCode 141. Linked List Cycle LeetCode 142. Linked List Cycle II LeetCode 146. LRU Cache é‡‘åˆ€çš„ç®—æ³•å°å†Œå­ Linked List ä¸“é¢˜ LeetCode 206. Reverse Linked List ä¿¡æ¯ æ¢ç´¢ Floyd Cycle Detection Algorithm ","date":"2024-02-03","objectID":"/posts/c-linked-list/:2:1","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"Merge Sort å®ç°äº† recursion, non-recursion çš„ merge sort Source æŠ€å·§ Merge Sort ä¸å®ƒçš„å˜åŒ– ä¸è®ºæ˜¯è¿™é‡Œçš„ non-recursion ç‰ˆæœ¬çš„ merge sortï¼Œè¿˜æ˜¯åé¢çš„ non-recursion ç‰ˆæœ¬çš„ quick sortï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯é€šè¿‡æ¨¡æ‹Ÿæ ˆ (stack) æ“ä½œæ¥å®ç°çš„ï¼Œå…³äºè¿™ä¸ªæ¨¡æ‹Ÿ stack æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒè’‹ç‚å²©è€å¸ˆçš„å½•å½± åº”ç”¨è§†è§’çš„æ“ä½œç³»ç»Ÿ (ç¨‹åºçš„çŠ¶æ€æœºæ¨¡å‹ï¼›ç¼–è¯‘ä¼˜åŒ–)ã€‚ ","date":"2024-02-03","objectID":"/posts/c-linked-list/:3:0","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"Linux æ ¸å¿ƒçš„ linked list Linux æ ¸å¿ƒä½¿ç”¨çš„ linked list æ˜¯é€šè¿‡ Intrusive linked lists æ­é… contain_of å®ï¼Œæ¥å®ç°è‡ªå®šä¹‰çš„ linked list nodeã€‚ sysprog21/linux-list è¿™ä¸ªä»“åº“å°† Linux kernel ä¸­ linked list éƒ¨åˆ†æŠ½ç¦»å‡ºæ¥ï¼Œå¹¶æ”¹å†™ä¸º user mode çš„å®ä½œã€‚æœ¬äººå¯¹è¯¥ä»“åº“è¿›è¡Œäº†ä¸€äº›æ”¹å†™ï¼Œå¯¹ insert sort å’Œ quick sort å¢åŠ äº† makefile æ”¯æŒã€‚ ä¸Šé¢çš„ä»“åº“ä¸ Linux kernel çš„å®ä½œå·®å¼‚ä¸»è¦åœ¨äº WRITE_ONCE å®ã€‚WRITE_ONCE çš„åŸç†ç®€å•æ¥è¯´æ˜¯ï¼Œé€šè¿‡ union äº§ç”Ÿä¸¤ä¸ªå¼•ç”¨åŒä¸€åœ°å€çš„å¼•ç”¨ (å³ __val å’Œ __c)ï¼Œç„¶åå› ä¸ºå¯¹åŒä¸€åœ°å€æœ‰å¤šä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨è¿›è¡Œæœ€ä½³åŒ–æ—¶ä¸ä¼šè¿‡äºæ¿€è¿›çš„é‡æ’åºï¼Œä»è€Œè¾¾åˆ°é¡ºåºæ‰§è¡Œæ•ˆæœã€‚ Source ","date":"2024-02-03","objectID":"/posts/c-linked-list/:4:0","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"Intrusive linked lists Intrusive linked lists è¿™ç¯‡æ–‡ç« å¯¹äº Intrusive linked list è¯´æ˜çš„éå¸¸å¥½ï¼Œè§£é‡Šäº†å…¶åœ¨ memory allocations å’Œ cache thrashing çš„ä¼˜åŠ¿ï¼Œè¿˜æ­é… Linux kernel è®²è§£äº†åœºæ™¯åº”ç”¨ã€‚ ","date":"2024-02-03","objectID":"/posts/c-linked-list/:4:1","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"container_of Linux æ ¸å¿ƒåŸå§‹ç¨‹å¼ç¢¼å·¨é›†: container_of ","date":"2024-02-03","objectID":"/posts/c-linked-list/:4:2","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"Optimized QuickSort Optimized QuickSort: C Implementation (Non-Recursive) è¿™ç¯‡æ–‡ç« ä»‹ç»äº† non-recursion çš„ quick sort åœ¨ array ä¸Šçš„å®ä½œï¼Œå‚è€ƒè¯¥æ–‡ç« å®Œæˆ linked list ä¸Šçš„ non-recursion ç‰ˆæœ¬çš„ quick sort å®ä½œã€‚ éé€’å½’çš„å¿«é€Ÿæ’åºä¸­ if (L != R \u0026\u0026 \u0026begin[i]-\u003elist != head) { å…¶ä¸­çš„ \u0026begin[i]-\u003elist != head æ¡ä»¶åˆ¤æ–­ç”¨äºç©ºé“¾è¡¨æƒ…å†µï¼Œæ•°ç»„ç‰ˆæœ¬ä¸­ä½¿ç”¨çš„æ˜¯ä¸‹æ ‡æ¯”è¾ƒ L \u003c R æ¥åˆ¤æ–­ï¼Œä½†æ˜¯é“¾è¡¨ä¸­ä½¿ç”¨ L != R ä¸è¶³ä»¥å®Œå…¨è¡¨ç¤º L \u003c R è¿™ä¸ªæ¡ä»¶ï¼Œè¿˜éœ€è¦ \u0026begin[i]-\u003elist != head æ¥åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©ºã€‚ ","date":"2024-02-03","objectID":"/posts/c-linked-list/:4:3","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"Linux æ ¸å¿ƒçš„ list_sort å®ä½œ linux/list_sort.c å…ˆå°†åŒå‘å¾ªç¯é“¾è¡¨è½¬æ¢æˆå•å‘é“¾è¡¨ï¼Œç„¶ååˆ©ç”¨é“¾è¡¨èŠ‚ç‚¹çš„ prev æ¥æŒ‚è½½ pending list (å› ä¸ºå•å‘é“¾è¡¨ä¸­ prev æ²¡æœ‰ä½œç”¨ï¼Œä½†æ˜¯é“¾è¡¨èŠ‚ç‚¹ä»ç„¶å­˜åœ¨ prev å­—æ®µï¼Œæ‰€ä»¥è¿›è¡Œå……åˆ†åˆ©ç”¨)ã€‚ å‡è®¾ count å¯¹åº”çš„ bits ç¬¬ k ä¸ª bit å€¼ä¸º 0 ä¸” $\u003e k$ çš„ bits éƒ½ä¸º 0ï¼Œ$\u003c k$ çš„ bits éƒ½ä¸º 1ï¼Œåˆ™ $\u003c k $ çš„è¿™äº› 1 å¯ä»¥è¡¨ç¤º pending list ä¸­åˆ†åˆ«æœ‰ $2^{k-1}, 2^{k-2}, â€¦, 2^0$ å¤§å°çš„ list å„ä¸€ä¸ªã€‚ å¦‚æœç¬¬ k ä¸ª bit å€¼ä¸º 0 ä¸” $\u003e k$ çš„ bits ä¸­å­˜åœ¨å€¼ä¸º 1 çš„ bitï¼Œ$\u003c k$ çš„ bits å‡ä¸º 1ï¼Œåˆ™åªæœ‰ $\u003c k$ çš„ bits å¯ä»¥è¡¨ç¤º pending list ä¸­åˆ†åˆ«æœ‰ $2^{k-1}, 2^{k-2}, â€¦, 2^0$ å¤§å°çš„ list å„ä¸€ä¸ªï¼Œ\u003e k çš„ 1 è¡¨ç¤ºéœ€è¦è¿›è¡Œ merge ä»¥è·å¾—å¯¹åº”å¤§å°çš„ listã€‚ è¿™æ ·ä¹Ÿåˆšå¥½èƒ½ä½¿å¾— merge æ—¶æ˜¯ $2: 1$ çš„é•¿åº¦æ¯”ä¾‹ï¼Œå› ä¸º 2 çš„æŒ‡æ•°ä¹‹é—´çš„æ¯”ä¾‹æ˜¯ $2: 1$ã€‚ æŠ€å·§ è¿™éƒ¨åˆ†å†…å®¹åœ¨ Lab0: Linux æ ¸å¿ƒçš„é“¾è¡¨æ’åº ä¸­æœ‰æ›´è¯¦ç»†çš„è§£é‡Šå’Œè®¨è®ºã€‚ ä¿¡æ¯ List, HList, and Hash Table hash table What is the strict aliasing rule? [Stack Overflow] Unions and type-punning [Stack Overflow] Nine ways to break your systems code using volatile [Stack Overflow] WRITE_ONCE in linux kernel lists [Stack Overflow] lib/list_sort: Optimize number of calls to comparison function ","date":"2024-02-03","objectID":"/posts/c-linked-list/:4:4","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["C","Linux Kernel Internals"],"content":"Fisherâ€“Yates shuffle Wikipedia Fisherâ€“Yates shuffle The Fisherâ€“Yates shuffle is an algorithm for shuffling a finite sequence. åŸæ–‡æ‰€è¯´çš„äº‹ä»¶å¤æ‚åº¦ï¼Œæ˜¯è€ƒè™‘å…³äºæ„é€ ç»“æœé“¾è¡¨æ—¶çš„å¤æ‚åº¦ï¼Œå¹¶ä¸è€ƒè™‘å¯»æ‰¾æŒ‡å®šèŠ‚ç‚¹çš„å¤æ‚åº¦ï¼Œæ‰€ä»¥å¯¹äºåŸå§‹æ–¹æ³•å¤æ‚åº¦ä¸º $1 + 2 + â€¦ + n = O(n^2)$ï¼Œå¯¹äº modern method å¤æ‚åº¦ä¸º $1 + 1 + â€¦ + 1 = O(n)$ åŸæ–‡å®ä½œè™½ç„¶ä½¿ç”¨äº† pointer to pointerï¼Œä½†æ˜¯ä½¿ç”¨ä¸Šå¹¶æ²¡æœ‰ä½“ç° linus æ‰€è¯´çš„ good tasteï¼Œé‡æ–°å®ä½œå¦‚ä¸‹: void shuffle(node_t **head) { srand(time(NULL)); // First, we have to know how long is the linked list int len = 0; node_t **indirect = head; while (*indirect) { len++; indirect = \u0026(*indirect)-\u003enext; } // Append shuffling result to another linked list node_t *new = NULL; node_t **new_tail = \u0026new; while (len) { int random = rand() % len; indirect = head; while (random--) indirect = \u0026(*indirect)-\u003enext; node_t *tmp = *indirect; *indirect = (*indirect)-\u003enext; tmp-\u003enext = NULL; *new_tail = tmp; new_tail = \u0026(*new_tail)-\u003enext; len--; } *head = new; } ä¸»è¦æ˜¯ä¿®æ”¹äº†æ–°é“¾è¡¨ new é‚£ä¸€éƒ¨åˆ†ï¼Œåªéœ€è¦ä¸€ä¸ª pointer to pinter new_tail å°±å¯ä»¥é¿å…æ¡ä»¶åˆ¤æ–­ã€‚ ","date":"2024-02-03","objectID":"/posts/c-linked-list/:5:0","tags":["Sysprog","C","Linked List"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: linked list å’Œéè¿ç»­å†…å­˜","uri":"/posts/c-linked-list/"},{"categories":["Rust"],"content":" In this second Crust of Rust video, we cover declarative macros, macro_rules!, by re-implementing the vec! macro from the standard library. As part of that, we cover not only how to write these, but some of the gotchas and tricks youâ€™ll run into, and some common use-cases. æ•´ç†è‡ª John Gjengset çš„å½±ç‰‡ ","date":"2024-01-31","objectID":"/posts/declarative-macros/:0:0","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"å½±ç‰‡æ³¨è§£ ","date":"2024-01-31","objectID":"/posts/declarative-macros/:1:0","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"regex macro å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ 3 ç§åˆ†éš”ç¬¦æ¥ä¼ å…¥å‚æ•° (æ³¨æ„èŠ±æ‹¬å· {} çš„éœ€è¦ä¸ macro åä¹‹é—´è¿›è¡Œç©ºæ ¼ï¼Œæœ«å°¾ä¸éœ€è¦åˆ†å·ï¼Œè¿™æ˜¯å› ä¸º {} ä¼šè¢«ç¼–è¯‘å™¨è§†ä¸ºä¸€ä¸ª statementï¼Œæ— éœ€ä½¿ç”¨ ; æ¥è¿›è¡Œåˆ†éš”): macro_rules! avec { () =\u003e {}; ... } avec!(); avec![]; avec! {} macro å®šä¹‰å†…çš„ () å’Œ {} ä¹Ÿéƒ½å¯ä»¥ä½¿ç”¨ (), [], {} ä¹‹é—´çš„ä»»æ„ä¸€ç§ï¼Œå¹¶ä¸å½±å“è°ƒç ” macro çš„åˆ†éš”ç¬¦çš„ä½¿ç”¨ï¼ˆéƒ½æ˜¯ 3 ä»»é€‰ 1 å³å¯ï¼‰ï¼Œä¸è¿‡æ¨èåœ¨ macro å®šä¹‰å†…ä½¿ç”¨ () å’Œ {} æ­é…ã€‚ å¦‚æœéœ€è¦åœ¨ macro ä¼ å…¥çš„ synatx ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ (regex)ï¼Œåˆ™éœ€è¦åœ¨å¤–é¢ä½¿ç”¨ $() è¿›è¡ŒåŒ…è£…: ($($elem:expr),* $(,)?) =\u003e {{ let mut v = Vec::new(); $(v.push($elem);)* v }}; åŒæ ·çš„ï¼Œå¯ä»¥åœ¨ macro ä½“å†…ä½¿ç”¨ regex å¯¹å‚æ•°è¿›è¡Œè§£åŒ…è£…ï¼Œè¯­æ³•æ˜¯ç›¸åŒçš„ï¼š $(...)[delimiter](+|*|?) å…¶ä¸­åˆ†éš”ç¬¦ (delimiter) æ˜¯å¯é€‰çš„ã€‚å®ƒä¼šæ ¹æ®å†…éƒ¨æ‰€åŒ…å«çš„å‚æ•° $(...) (æœ¬ä¾‹ä¸­æ˜¯ $(elem)) æ¥è¿›è¡Œè‡ªåŠ¨è§£åŒ…è£…ï¼Œç”Ÿæˆå¯¹åº”æ¬¡æ•°çš„ statementï¼Œå¦‚æœæœ‰åˆ†éš”ç¬¦ (delimiter) ä¹Ÿä¼šç”Ÿæˆå¯¹åº”çš„ç¬¦å·ã€‚ ","date":"2024-01-31","objectID":"/posts/declarative-macros/:1:1","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"cargo expand cargo-expand å¯ä»¥å°†å®å±•å¼€ï¼Œå¯¹äºå®çš„é™¤é”™éå¸¸æ–¹ä¾¿ï¼Œå¯ä»¥ä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…: $ cargo install cargo-expand ç„¶åå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯¹ macro è¿›è¡Œå±•å¼€: $ cargo expand ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥å°† unit tests ä¸ cargo expand ç»“åˆèµ·æ¥ï¼Œå³å±•å¼€çš„æ˜¯ unit tests ä¹‹åçš„å®Œæ•´ä»£ç : $ cargo expand --lib tests ","date":"2024-01-31","objectID":"/posts/declarative-macros/:1:2","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"scope ç”±äº Rust ä¸­ macro å’Œ normal code çš„ä½œç”¨åŸŸä¸ä¸€è‡´ï¼Œæ‰€ä»¥åƒ C è¯­è¨€é‚£ç§åœ¨ macro ä¸­å®šä¹‰å˜é‡æˆ–åœ¨ macro ä¸­ç›´æ¥ä¿®æ”¹å·²æœ‰å˜é‡æ˜¯ä¸å¯è¡Œçš„ï¼Œæ“ä½œè¿™ç§ lvalue çš„æƒ…å†µéœ€è¦ä½¿ç”¨ macro å‚æ•°è¿›è¡Œä¼ å…¥ï¼Œå¦åˆ™æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚ // cannot compile macro_rules! avec { () =\u003e { let x = 1; } } // cannot compile macro_rules! avec { () =\u003e { x = 42; } } // can compile macro_rules! avec { ($x: ident) =\u003e { $x += 1; } } ","date":"2024-01-31","objectID":"/posts/declarative-macros/:1:3","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"statements åœ¨ Rust macro ä¸­ï¼Œå¦‚æœéœ€è¦å°†ä¼ å…¥çš„ syntax è½¬æ¢æˆå¤šä¸ª statementsï¼Œéœ€è¦ä½¿ç”¨ {} è¿›è¡ŒåŒ…è£…: () =\u003e {{ ... }} å…¶ä¸­ç¬¬ä¸€å¯¹ {} æ˜¯ macro è¯­æ³•æ‰€è¦æ±‚çš„çš„ï¼Œç¬¬äºŒå¯¹ {} åˆ™æ˜¯ç”¨äºåŒ…è£… statements çš„ {}ï¼Œä½¿ç”¨ cargo expand è¿›è¡ŒæŸ¥çœ‹ä¼šæ›´ç›´è§‚ã€‚ ","date":"2024-01-31","objectID":"/posts/declarative-macros/:1:4","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"delimiter æ³¨æ„ macro ä¸­ä¼ å…¥çš„ syntaxï¼Œå…¶ä½¿ç”¨çš„ç±»ä¼¼äº =\u003e çš„åˆ†éš”ç¬¦æ˜¯æœ‰é™çš„ï¼Œä¾‹å¦‚ä¸èƒ½ä½¿ç”¨ -\u003e ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå…·ä½“å¯ä»¥æŸ¥é˜…æ‰‹å†Œã€‚ ($arg1:ty =\u003e $arg2:ident) =\u003e { type $arg2 = $arg1; }; æŠ€å·§ å½“ declarative macros å˜å¾—å¤æ‚æ—¶ï¼Œå®ƒçš„å¯è¯»æ€§ä¼šå˜å¾—å¾ˆå·®ï¼Œè¿™æ—¶å€™éœ€è¦ä½¿ç”¨ procedural macrosã€‚ä½†æ˜¯ procedural macros éœ€è¦å¤šèŠ±è´¹ä¸€äº›ç¼–è¯‘å‘¨æœŸ (compilition cycle)ï¼Œå› ä¸ºéœ€è¦å…ˆå¯¹ procedural macros è¿›è¡Œç¼–è¯‘ï¼Œå†ç¼–è¯‘ lib/bin å¯¹åº”çš„æºæ–‡ä»¶ã€‚ ","date":"2024-01-31","objectID":"/posts/declarative-macros/:1:5","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"calculating ç¼–å†™ macro æ—¶ä¼ å…¥çš„å‚æ•°å¦‚æœæ˜¯ expressionï¼Œéœ€è¦å…ˆå¯¹å…¶è¿›è¡Œè®¡ç®—ï¼Œç„¶åä½¿ç”¨ clone æ–¹æ³•æ¥å¯¹è¯¥è®¡ç®—ç»“æœè¿›è¡Œæ‹·è´ï¼Œè¿™æ ·èƒ½æœ€å¤§é™åº¦çš„é¿å…æ‰“ç ´ Rust æ‰€æœ‰æƒåˆ¶åº¦çš„é™åˆ¶ã€‚ ($elem:expr; $count:expr) =\u003e {{ let mut v = Vec::new(); let x = $elem; for _ in 0..$count { v.push(x.clone()); } v }}; è¿™æ ·ä¼ å…¥ y.take().unwrap() ä½œä¸ºå®çš„ elem å‚æ•°å°±ä¸ä¼šäº§ç”Ÿ panicã€‚ æŠ€å·§ å¯¹äºä¼šå¯¼è‡´ compile fail çš„ unit testï¼Œæ— æ³•ä½¿ç”¨é€šå¸¸çš„ unit test æ¥æµ‹è¯•ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæŠ€å·§ï¼šå¯ä»¥ä½¿ç”¨ Doc-tests çš„æ–¹å¼æ¥æ„å»ºï¼ˆéœ€è¦æ ‡è®° compile_failï¼Œå¦‚æœä¸æ ‡è®°åˆ™é»˜è®¤è¯¥æµ‹è¯•éœ€è¦ compile successï¼‰ /// ```compile_fail /// let v: Vec\u003cu32\u003e = vecmac::avec![42; \"foo\"]; /// ``` #[allow(dead_code)] struct CompileFailTest; ","date":"2024-01-31","objectID":"/posts/declarative-macros/:1:6","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"trait Rust ä¸­çš„ macro æ— æ³•é™åˆ¶ä¼ å…¥å‚æ•°çš„ Traitï¼Œä¾‹å¦‚ä¸èƒ½é™åˆ¶å‚æ•°å¿…é¡»å®ç° Clone è¿™ä¸ª Traitã€‚ ::std::iter å¸¦æœ‰å‰ç½®åŒå†’å· :: çš„è¯­æ³•ï¼Œæ˜¯åœ¨æ²¡æœ‰æ˜¾å¼å¼•å…¥ use std::iter æ¨¡å—çš„æƒ…å†µä¸‹è®¿é—®è¯¥æ¨¡å—çš„æ–¹å¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ::std::iter è¡¨ç¤ºå…¨å±€å‘½åç©ºé—´ (global namespace) ä¸­çš„ std::iter æ¨¡å—ï¼Œå³æ ‡å‡†åº“ä¸­çš„ iter æ¨¡å—ã€‚ç”±äº macro éœ€è¦è¿›è¡Œ export å»ºè®®ç¼–å†™ macro æ—¶å°½é‡ä½¿ç”¨ :: è¿™ç±»è¯­æ³•ã€‚ æŠ€å·§ è®¡ç®— vector çš„å…ƒç´ ä¸ªæ•°æ—¶ä½¿ç”¨ () å¼•ç”¨ [()] è¿›è¡Œè®¡æ•°æ˜¯ä¸€ä¸ªå¸¸è§æŠ€å·§ï¼Œå› ä¸º () æ˜¯ zero size çš„ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå ç”¨æ ˆç©ºé—´ã€‚å…¶ä»–çš„å…ƒç´ è®¡æ•°æ–¹æ³•å¯ä»¥å‚è€ƒ The Little Book of Rust Macros çš„ 2.5.2 Counting ä¸€èŠ‚ã€‚ ","date":"2024-01-31","objectID":"/posts/declarative-macros/:1:7","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"Homework ä¿¡æ¯ å®ä½œè¯´æ˜: å°è¯•ä½¿ç”¨ declarative macro æ¥å®ç° HashMap çš„åˆå§‹åŒ–è¯­æ³• (Github: My Implementation) å°è¯•é˜…è¯» vec macro åœ¨ std åº“çš„å®ç° Macro std::vec å‚è€ƒèµ„æ–™: Struct std::collections::HashMap ","date":"2024-01-31","objectID":"/posts/declarative-macros/:2:0","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"Documentations è¿™é‡Œåˆ—ä¸¾è§†é¢‘ä¸­ä¸€äº›æ¦‚å¿µç›¸å…³çš„ documentation å­¦ä¹ çš„ä¸€æ‰‹èµ„æ–™æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œè¯·åŠ¡å¿…è‡ªä¸»å­¦ä¼šé˜…è¯»è§„æ ¼ä¹¦ä¹‹ç±»çš„èµ„æ–™ ","date":"2024-01-31","objectID":"/posts/declarative-macros/:3:0","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"Crate std å¯ä»¥ä½¿ç”¨è¿™é‡Œæä¾›çš„æœç´ æ è¿›è¡Œæœç´¢ (BTW ä¸è¦æµªè´¹æ—¶é—´åœ¨ Google æœå¯»ä¸Šï¼) Macro std::vec Struct std::vec::Vec Method std::vec::Vec::with_capacity method std::vec::Vec::extend method std::vec::Vec::resize Module std::iter Function std::iter::repeat method std::iter::Iterator::take method std::option::Option::take ","date":"2024-01-31","objectID":"/posts/declarative-macros/:3:1","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":"References åŸç‰ˆçš„ The Little Book of Rust Macros åœ¨ Rust æ›´æ–°æ–°ç‰ˆæœ¬åæ²¡æœ‰æŒç»­æ›´æ–°ï¼Œå¦ä¸€ä½å¤§ç‰›å¯¹è¿™æœ¬å°å†Œå­è¿›è¡Œäº†ç›¸åº”çš„æ›´æ–°: The Little Book of Rust Macros Rustè¯­è¨€ä¸­æ–‡ç¤¾åŒºä¹Ÿç¿»è¯‘äº†è¯¥å°å†Œå­: Rust å®å°å†Œ ","date":"2024-01-31","objectID":"/posts/declarative-macros/:4:0","tags":["Rust","Macro","Declarative Macros"],"title":"Crust of Rust: Declarative Macros","uri":"/posts/declarative-macros/"},{"categories":["Rust"],"content":" Weâ€™re going to investigate a case where you need multiple explicit lifetime annotations. We explore why they are needed, and why we need more than one in this particular case. We also talk about some of the differences between the string types and introduce generics over a self-defined trait in the process. æ•´ç†è‡ª John Gjengset çš„å½±ç‰‡ ","date":"2024-01-25","objectID":"/posts/lifetime-annotations/:0:0","tags":["Rust","Lifetime"],"title":"Crust of Rust: Lifetime Annotations","uri":"/posts/lifetime-annotations/"},{"categories":["Rust"],"content":"C è¯­è¨€ä¸­çš„ lifetime Rust ä¸­çš„ lifetime ä¸€å‘æ˜¯ä¸€ä¸ªéš¾ç‚¹ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€éš¾ç‚¹çš„æœ¬è´¨ï¼Œå»ºè®®é˜…è¯» C è¯­è¨€è§„æ ¼ä¹¦å…³äº lifetime çš„éƒ¨åˆ†ï¼Œç›¸ä¿¡ä½ ä¼šå¯¹ Rust çš„ lifetime æœ‰ä¸åŒçš„çœ‹æ³•ã€‚ C11 [6.2.4] Storage durations of objects An object has a storage duration that determines its lifetime. There are four storage durations: static, thread, automatic, and allocated. ","date":"2024-01-25","objectID":"/posts/lifetime-annotations/:1:0","tags":["Rust","Lifetime"],"title":"Crust of Rust: Lifetime Annotations","uri":"/posts/lifetime-annotations/"},{"categories":["Rust"],"content":"å½±ç‰‡æ³¨è§£ ","date":"2024-01-25","objectID":"/posts/lifetime-annotations/:2:0","tags":["Rust","Lifetime"],"title":"Crust of Rust: Lifetime Annotations","uri":"/posts/lifetime-annotations/"},{"categories":["Rust"],"content":"cargo check cargo check å¯ä»¥ç»™å‡ºæ›´ç®€æ´çš„æç¤ºï¼Œä¾‹å¦‚ç›¸å¯¹äºç¼–è¯‘å™¨ç»™å‡ºçš„é”™è¯¯ä¿¡æ¯ï¼Œå®ƒä¼šæ•´åˆç›¸åŒçš„é”™è¯¯ä¿¡æ¯ï¼Œä»è€Œæä¾›ç®€æ´åˆ‡è¦çš„æç¤ºä¿¡æ¯ã€‚è€Œä¸”å®ƒæ˜¯ä¸€ä¸ªé™æ€åˆ†æå·¥å…·ï¼Œä¸éœ€è¦è¿›è¡Œç¼–è¯‘å³å¯ç»™å‡ºæç¤ºï¼Œæ‰€ä»¥é€Ÿåº¦ä¼šæ¯”ç¼–è¯‘å¿«å¾ˆå¤šï¼Œåœ¨å¤§å‹é¡¹ç›®ä¸Šå°¤ä¸ºæ˜æ˜¾ã€‚ ","date":"2024-01-25","objectID":"/posts/lifetime-annotations/:2:1","tags":["Rust","Lifetime"],"title":"Crust of Rust: Lifetime Annotations","uri":"/posts/lifetime-annotations/"},{"categories":["Rust"],"content":"ref å½±ç‰‡å¤§æ¦‚ 49 åˆ†æ—¶æåˆ°äº† if let Some(ref mut remainder) = self.remainder {...} ref çš„ä½œç”¨é…åˆ if let è¯­å¥ä½“çš„é€»è¾‘å¯ä»¥ä½“ä¼šåˆ° pointer of pointer çš„ç¾å¦™ä¹‹å¤„ã€‚ å› ä¸ºåœ¨ pattern match ä¸­å½¢å¦‚ \u0026mut è¿™ç±»ä¹Ÿæ˜¯ç”¨äº pattern match çš„ï¼Œä¸èƒ½ç”¨äºè·å– referenceï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨ ref mut è¿™ç±»è¯­æ³•æ¥è·å– reference çš„åŸå› ã€‚ ","date":"2024-01-25","objectID":"/posts/lifetime-annotations/:2:2","tags":["Rust","Lifetime"],"title":"Crust of Rust: Lifetime Annotations","uri":"/posts/lifetime-annotations/"},{"categories":["Rust"],"content":"operator ? å½±ç‰‡å¤§æ¦‚ 56 åˆ†æ—¶æåˆ°äº† let remainder = self.remainder.as_mut()?; ä¸ºä»€ä¹ˆä½¿ç”¨ä¹‹å‰æ‰€æçš„ let remainder = \u0026mut self.remainder?; è¿™æ˜¯å› ä¸ºä½¿ç”¨ ? è¿ç®—ç¬¦è¿”å›çš„æ˜¯å†…éƒ¨å€¼çš„ copyï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µ remainder é‡Œæ˜¯ self.remainder? è¿”å›çš„å€¼ (æ˜¯åŸæœ‰ self.remainder å†…éƒ¨å€¼çš„ copy) çš„ reference ","date":"2024-01-25","objectID":"/posts/lifetime-annotations/:2:3","tags":["Rust","Lifetime"],"title":"Crust of Rust: Lifetime Annotations","uri":"/posts/lifetime-annotations/"},{"categories":["Rust"],"content":"\u0026str vs String å½±ç‰‡å¤§æ¦‚ 1:03 æ—¶æåˆ°äº† str ä¸ String çš„åŒºåˆ«ï¼Œä¸ªäººè§‰å¾—è®²çš„å¾ˆå¥½ï¼š str -\u003e [char] \u0026str -\u003e \u0026[char] // fat pointer (address and size) String -\u003e Vec\u003cchar\u003e String -\u003e \u0026str (cheap -- AsRef) \u0026str -\u003e String (expensive -- memcpy) å¯¹äº String ä½¿ç”¨ \u0026* å¯ä»¥ä¿è¯å°†å…¶è½¬æ¢æˆ \u0026strï¼Œå› ä¸º * ä¼šå…ˆå°† String è½¬æ¢æˆ strã€‚å½“ç„¶å¯¹äºå‡½æ•°å‚æ•°çš„ \u0026strï¼Œåªéœ€ä¼ å…¥ \u0026String å³å¯è‡ªåŠ¨è½¬æ¢ç±»å‹ã€‚ ","date":"2024-01-25","objectID":"/posts/lifetime-annotations/:2:4","tags":["Rust","Lifetime"],"title":"Crust of Rust: Lifetime Annotations","uri":"/posts/lifetime-annotations/"},{"categories":["Rust"],"content":"lifetime å¯ä»¥å°†ç»“æ„ä½“çš„ lifetime çš„ç¬¬ä¸€ä¸ª (ä¸€èˆ¬ä¸º 'a) è§†ä¸ºå®ä¾‹çš„ lifetimeï¼Œå…¶å®ƒçš„å¯ä»¥è¡¨ç¤ºä¸å®ä¾‹ lifetime æ— å…³çš„ lifetimeã€‚ç”±äº compiler ä¸å¤Ÿæ™ºèƒ½ï¼Œæ‰€ä»¥å®ƒä¼šå°†å®ä¾‹åŒ–æ—¶ä¼ å…¥å‚æ•°çš„ lifetime ä¸­ç›¸å…³è”çš„æœ€å° lifetime è§†ä¸ºå®ä¾‹çš„ lifetime çº¦æŸ (å³å®ä¾‹çš„ lifetime åŒ…å«äºè¯¥ lifetime å†…)ã€‚ å½“åœ¨å®ç°ç»“æ„ä½“çš„æ–¹æ³•æˆ– Trait æ—¶ï¼Œå¦‚æœåœ¨å®ç°æ–¹æ³•æ—¶æ— éœ€ä½¿ç”¨ lifetime çš„åç§°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åŒ¿å lifetime '_ï¼Œæˆ–è€…åœ¨ç¼–è¯‘å™¨å¯ä»¥æ¨æ¨å¯¼å‡º lifetime æ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨åŒ¿å lifetime '_ã€‚ only lifetime struct Apple\u003c'a\u003e { owner: \u0026'a Human, } impl Apple\u003c'_\u003e { ... } lifetime and generic struct Apple\u003c'a, T\u003e { owner: \u0026'a T, } impl\u003cT\u003e Apple\u003c'_, T\u003e { ... } compiler can know lifetime pun fn func(\u0026self) -\u003e Apple\u003c'_, T\u003e { ... } ","date":"2024-01-25","objectID":"/posts/lifetime-annotations/:2:5","tags":["Rust","Lifetime"],"title":"Crust of Rust: Lifetime Annotations","uri":"/posts/lifetime-annotations/"},{"categories":["Rust"],"content":"Documentations è¿™é‡Œåˆ—ä¸¾è§†é¢‘ä¸­ä¸€äº›æ¦‚å¿µç›¸å…³çš„ documentation å­¦ä¹ çš„ä¸€æ‰‹èµ„æ–™æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œè¯·åŠ¡å¿…è‡ªä¸»å­¦ä¼šé˜…è¯»è§„æ ¼ä¹¦ä¹‹ç±»çš„èµ„æ–™ ","date":"2024-01-25","objectID":"/posts/lifetime-annotations/:3:0","tags":["Rust","Lifetime"],"title":"Crust of Rust: Lifetime Annotations","uri":"/posts/lifetime-annotations/"},{"categories":["Rust"],"content":"Crate std å¯ä»¥ä½¿ç”¨è¿™é‡Œæä¾›çš„æœç´ æ è¿›è¡Œæœç´¢ (BTW ä¸è¦æµªè´¹æ—¶é—´åœ¨ Google æœå¯»ä¸Šï¼) Keywords Keyword SelfTy Keyword ref Trait std::iter::Iterator method std::iter::Iterator::eq method std::iter::Iterator::collect method std::iter::Iterator::position method std::iter::Iterator::find Enum std::option::Option method std::option::Option::take method std::option::Option::as_mut method std::option::Option::expect Primitive Type str method str::find method str::char_indices Trait std::ops::Try Macro std::try method char::len_utf8 ","date":"2024-01-25","objectID":"/posts/lifetime-annotations/:3:1","tags":["Rust","Lifetime"],"title":"Crust of Rust: Lifetime Annotations","uri":"/posts/lifetime-annotations/"},{"categories":["Operating Systems"],"content":"è®°å½•ä¸€ä¸‹æŠ˜è…¾ Deepin 20.9 çš„ç‰©ç†æœºçš„è¿‡ç¨‹ä¸ç›¸å…³çš„é…ç½®ã€‚ ","date":"2024-01-24","objectID":"/posts/deepin20.9/:0:0","tags":["Linux","Deepin"],"title":"æ·±åº¦æ“ä½œç³»ç»Ÿ Deepin 20.9 å®‰è£…é…ç½®","uri":"/posts/deepin20.9/"},{"categories":["Operating Systems"],"content":"å®‰è£…ä¸é…ç½® æ–°æ‰‹æ•™å­¦å½±ç‰‡ï¼š æ·±åº¦æ“ä½œç³»ç»Ÿdeepinä¸‹è½½å®‰è£… (é™„åŒç³»ç»Ÿå®‰è£…åŠåˆ†åŒºæŒ‡å¼•) [bilibili] å®‰è£…å®Œdeepinä¹‹åè¯¥åšçš„äº‹æƒ… [bilibili] ","date":"2024-01-24","objectID":"/posts/deepin20.9/:1:0","tags":["Linux","Deepin"],"title":"æ·±åº¦æ“ä½œç³»ç»Ÿ Deepin 20.9 å®‰è£…é…ç½®","uri":"/posts/deepin20.9/"},{"categories":["Operating Systems"],"content":"ç½‘ç»œä»£ç† æ–°æ‰‹æ•™å­¦æ–‡æ¡£: Ubuntu 22.04LTS ç›¸å…³é…ç½® åœ¨å¢ƒå†…å¯ä»¥ä½¿ç”¨ gitclone é•œåƒç«™æ¥åŠ å¿« clone çš„é€Ÿåº¦ã€‚ ","date":"2024-01-24","objectID":"/posts/deepin20.9/:2:0","tags":["Linux","Deepin"],"title":"æ·±åº¦æ“ä½œç³»ç»Ÿ Deepin 20.9 å®‰è£…é…ç½®","uri":"/posts/deepin20.9/"},{"categories":["Operating Systems"],"content":"ç¼–è¾‘å™¨: VS Code æ–°æ‰‹æ•™å­¦æ–‡æ¡£: ç¼–è¾‘å™¨: Visual Studio Code [HackMD] æœ¬äººçš„ä¸€äº›æ³¨è§£: GNU/Linux å¼€å‘å·¥å…· è¿™é‡Œåˆ—ä¸¾ä¸€ä¸‹æœ¬äººé…ç½®çš„æ’ä»¶ï¼š Even Better TOML CodeLLDB ç”¨äºè°ƒè¯• Rust Git History Native Debug ç”¨äºè°ƒè¯• C/C++ rust-analyzer Tokyo Night æŒºå¥½çœ‹çš„ä¸€ä¸ªä¸»é¢˜ Vim VSCode Great Icons æ–‡ä»¶å›¾æ ‡ä¸»é¢˜ é—®é¢˜ rust5-analyzer æ’ä»¶å¯èƒ½ä¼šå› ä¸ºæ–°ç‰ˆæœ¬è¦æ±‚ glibc 2.29 è€Œå¯¼è‡´å¯åŠ¨å¤±è´¥ï¼Œè¯·å‚è€ƒè¿™ä¸ª issue æ¥è§£å†³ã€‚ ","date":"2024-01-24","objectID":"/posts/deepin20.9/:3:0","tags":["Linux","Deepin"],"title":"æ·±åº¦æ“ä½œç³»ç»Ÿ Deepin 20.9 å®‰è£…é…ç½®","uri":"/posts/deepin20.9/"},{"categories":["Operating Systems"],"content":"ç»ˆç«¯å’Œ Vim æ–°æ‰‹æ•™å­¦æ–‡æ¡£: çµ‚ç«¯æ©Ÿå’Œ Vim è¨­å®š [HackMD] æœ¬äººçš„ä¸€äº›æ³¨è§£: GNU/Linux å¼€å‘å·¥å…· æœ¬äººçš„ç»ˆç«¯æç¤ºç¬¦é…ç½®: \\u@\\h\\W æœ¬äººä½¿ç”¨ Minimalist Vim Plugin Manager æ¥ç®¡ç† Vim æ’ä»¶ï¼Œé…ç½®å¦‚ä¸‹: \" Specify a directory for plugins (for Neovim: ~/.local/share/nvim/plugged) call plug#begin('~/.vim/plugged') Plug 'Shougo/neocomplcache' Plug 'scrooloose/nerdtree' map \u003cF5\u003e :NERDTreeToggle\u003cCR\u003e call plug#end() let g:neocomplcache_enable_at_startup = 1 let g:neocomplcache_enable_smart_case = 1 inoremap \u003cexpr\u003e\u003cTAB\u003e pumvisible()?\"\\\u003cC-n\u003e\" : \"\\\u003cTAB\u003e\" syntax on set number set cursorline colorscheme default set bg=dark set tabstop=4 set expandtab set shiftwidth=4 set ai set hlsearch set smartindent map \u003cF4\u003e : set nu!\u003cBAR\u003eset nonu?\u003cCR\u003e \" autocomplete dropdown list colorscheme hi Pmenu ctermfg=0 ctermbg=7 hi PmenuSel ctermfg=7 ctermbg=4 ","date":"2024-01-24","objectID":"/posts/deepin20.9/:4:0","tags":["Linux","Deepin"],"title":"æ·±åº¦æ“ä½œç³»ç»Ÿ Deepin 20.9 å®‰è£…é…ç½®","uri":"/posts/deepin20.9/"},{"categories":["Operating Systems"],"content":"ç³»ç»Ÿè¯­è¨€: Rust å®‰è£…æ•™ç¨‹: Installation [The book] å®‰è£… Rust [Rust course] Channels [The rustup book] # install rust $ curl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh # install nightly toolchain $ rustup toolchain install nightly # change to nightly toolchain $ rustup default nightly # list installed toolchain $ rustup toolchain list # update installed toolchain $ rustup update ä¸ªäººåå‘äºä½¿ç”¨ nightly toolchain ","date":"2024-01-24","objectID":"/posts/deepin20.9/:5:0","tags":["Linux","Deepin"],"title":"æ·±åº¦æ“ä½œç³»ç»Ÿ Deepin 20.9 å®‰è£…é…ç½®","uri":"/posts/deepin20.9/"},{"categories":["Operating Systems"],"content":"tldr The tldr-pages project is a collection of community-maintained help pages for command-line tools, that aims to be a simpler, more approachable complement to traditional man pages. å®‰è£… tldr: $ sudo apt install tldr ","date":"2024-01-24","objectID":"/posts/deepin20.9/:6:0","tags":["Linux","Deepin"],"title":"æ·±åº¦æ“ä½œç³»ç»Ÿ Deepin 20.9 å®‰è£…é…ç½®","uri":"/posts/deepin20.9/"},{"categories":["Operating Systems"],"content":"æ•ˆæœå±•ç¤º Deepin Terminial Vim Deepin DDE Desktop ","date":"2024-01-24","objectID":"/posts/deepin20.9/:7:0","tags":["Linux","Deepin"],"title":"æ·±åº¦æ“ä½œç³»ç»Ÿ Deepin 20.9 å®‰è£…é…ç½®","uri":"/posts/deepin20.9/"},{"categories":["Operating Systems"],"content":"FAQ é—®é¢˜ é‡å¯åå¯èƒ½ä¼šå‡ºç°ï¼Œè¾“å…¥å¯†ç æ— æ³•è¿›å…¥å›¾å½¢ç•Œé¢é‡æ–°è¿”å›ç™»å½•ç•Œé¢ï¼Œè¿™ä¸€å¾ªç¯çŠ¶å†µã€‚è¿™ä¸ªæ˜¯ deepin çš„é»˜è®¤ shell æ˜¯ dash é€ æˆçš„ï¼Œåªéœ€å°†é»˜è®¤çš„ shell æ”¹ä¸º bash å³å¯è§£å†³é—®é¢˜ï¼š $ ls -l /bin/sh lrwxrwxrwx 1 root root 9 xxæœˆ xx xx:xx /bin/sh -\u003e /bin/dash $ sudo rm /bin/sh $ sudo ln -s /bin/bash /bin/sh å¦‚æœä½ å·²ç»å¤„äºæ— é™ç™»å½•ç•Œé¢å¾ªç¯è¿™ä¸€çŠ¶å†µï¼Œå¯ä»¥é€šè¿‡ Ctrl + Alt + \u003cF2\u003e è¿›å…¥ tty2 ç•Œé¢è¿›è¡Œä¿®æ”¹ï¼š # å…ˆæŸ¥çœ‹é—®é¢˜æ—¥å¿—ï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯ shell å¯¼è‡´çš„é—®é¢˜ $ cat .xsession-errors # å¦‚æœæ˜¯ï¼Œåˆ™é‡å¤ä¸Šé¢çš„æ“ä½œå³å¯ ","date":"2024-01-24","objectID":"/posts/deepin20.9/:8:0","tags":["Linux","Deepin"],"title":"æ·±åº¦æ“ä½œç³»ç»Ÿ Deepin 20.9 å®‰è£…é…ç½®","uri":"/posts/deepin20.9/"},{"categories":["Operating Systems"],"content":"åœ¨ deepin 20.9 ä¸Šæ ¹æ® DragonOS æ„å»ºæ–‡æ¡£ çš„ bootstrap.sh çš„æ–¹å¼æ¥æ„å»º DragonOS æ—¶ï¼Œå¦‚æœæ²¡æœ‰äº‹å…ˆå®‰è£… Qemu ä¼šå‡ºç° KVM ç›¸å…³çš„ä¾èµ–é—®é¢˜ã€‚æœ¬æ–‡è®°å½•è§£å†³è¿™ä¸€é—®é¢˜çš„è¿‡ç¨‹ã€‚ å¦‚æœäº‹å…ˆæ²¡æœ‰å®‰è£… Qemuï¼Œåœ¨ä½¿ç”¨ bootstrap.sh æ—¶ä¼šå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š $ bash bootstrap.sh ... ä¸‹åˆ—è½¯ä»¶åŒ…æœ‰æœªæ»¡è¶³çš„ä¾èµ–å…³ç³»ï¼š qemu-kvm : ä¾èµ–: qemu-system-x86 E: æ— æ³•ä¿®æ­£é”™è¯¯ï¼Œå› ä¸ºæ‚¨è¦æ±‚æŸäº›è½¯ä»¶åŒ…ä¿æŒç°çŠ¶ï¼Œå°±æ˜¯å®ƒä»¬ç ´åäº†è½¯ä»¶åŒ…é—´çš„ä¾èµ–å…³ç³»ã€‚ æŸ¥è¯¢ deepin è®ºå›ä¸Šçš„ç›¸å…³å†…å®¹ï¼šqemu-kvmæ— æ³•å®‰è£…ï¼Œå¯ä»¥å¾—çŸ¥æ˜¯å› ä¸º qemu-kvm åœ¨ debian å‘è¡Œç‰ˆä¸Šåªæ˜¯ä¸€ä¸ªè™šåŒ…ï¼Œæ‰€ä»¥å¯¹äº x86 æ¶æ„çš„æœºå™¨å¯ä»¥ç›´æ¥å®‰è£… qemu-systerm-x86 Debian qemu-kvm https://packages.debian.org/search?keywords=qemu-kvm å®‰è£… qemu-systerm-x86: $ sudo apt install qemu-systerm-x86 $ $ qemu-system-x86_64 --version QEMU emulator version 5.2.0 (Debian 1:5.2+dfsg-11+deb11u1) Copyright (c) 2003-2020 Fabrice Bellard and the QEMU Project developers å®‰è£…çš„ qemu ç‰ˆæœ¬çœ‹èµ·æ¥æœ‰ç‚¹ä½ï¼Œä½†æ˜¯å…ˆä½¿ç”¨ bootstrap.sh å¿«é€Ÿå®‰è£…å…¶å®ƒä¾èµ–é¡¹ï¼Œç„¶åå°è¯•ç¼–è¯‘è¿è¡Œä¸€ä¸‹ DragonOS: $ bash bootstrap.sh ... |-----------Congratulations!---------------| | | | ä½ æˆåŠŸå®‰è£…äº†DragonOSæ‰€éœ€çš„ä¾èµ–é¡¹! | | | | è¯·å…³é—­å½“å‰ç»ˆç«¯, å¹¶é‡æ–°æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ | | ç„¶åé€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿è¡Œ: | | | | make run | | | |------------------------------------------| æ–°å¼€ä¸€ä¸ªç»ˆç«¯æˆ–åˆ·æ–°ä¸€ä¸‹ ~/.bashrc: $ cd DragonOS $ make run è¿è¡Œ DragonOS Ok å¯ä»¥æˆåŠŸè¿è¡Œ æ³¨æ„ å¦‚æœéœ€è¦ä½¿ç”¨ RISC-V çš„ Qemu æ¨¡æ‹Ÿå™¨ï¼Œå®‰è£… qemu-system-misc å³å¯ï¼š $ sudo apt install qemu-system-misc ","date":"2024-01-22","objectID":"/posts/deepin-dragonos/:0:0","tags":["Deepin","Linux","DragonOS"],"title":"Deepin 20.9 æ„å»º DragonOS","uri":"/posts/deepin-dragonos/"},{"categories":["Mathematics"],"content":"éšæœºå˜é‡ (Random Variable) æ˜¯æ¦‚ç‡ (Probability) å’Œç»Ÿè®¡ (Statistics) çš„â€œçµé­‚â€ï¼Œä»æ•°å­¦ä¸Šè®²ï¼ŒRandom Variable æ˜¯è¿æ¥ Probability å’Œ Statistics çš„æ¡¥æ¢ï¼›ä»å®é™…ä¸Šè®²ï¼ŒRandom Variable è¡¨ç¤ºæˆ‘ä»¬æ‰€å…³å¿ƒã€æœŸæœ›çš„ä¸œè¥¿ã€‚ä¾‹å¦‚ä¸€æ‰¹äº§å“çš„ç¡¬åº¦ï¼Œæ¯ä¸ªäº§å“çš„ç¡¬åº¦æ˜¾ç„¶æ˜¯ä¸åŒçš„ã€æ˜¯éšæœºçš„ï¼Œå°½ç®¡ç¡¬åº¦æ˜¯éšæœºçš„ï¼Œä½†äº§å“çš„ç¡¬åº¦éµå¾ªä¸€å®šçš„æ¦‚ç‡è§„å¾‹ï¼Œè¿™ç§éšæœºã€ä½†å´éµå¾ªä¸€å®šæ¦‚ç‡è§„å¾‹çš„ä¸œè¥¿ï¼Œå°±æ˜¯ Random Valueã€‚ å›½ç«‹é˜³æ˜äº¤é€šå¤§å­¦ é™ˆé‚»å®‰è€å¸ˆï¼Œå¼€è®¾äº†ä¸¤å­¦æœŸçš„ç»Ÿè®¡è¯¾ç¨‹ï¼Œåˆ†åˆ«æ˜¯ä¸Šå­¦æœŸçš„ ç»Ÿè®¡å­¦ å’Œä¸‹å­¦æœŸçš„ é«˜ç­‰ç»Ÿè®¡å­¦ã€‚ è¯¾ç¨‹åç§° è‹±æ–‡åç§° è¯¾ç¨‹åœ°å€ è¯¾ç¨‹è§†é¢‘ ç»Ÿè®¡å­¦ Statistics è¯¾ç¨‹èµ„è®¯ YouTube é«˜ç­‰ç»Ÿè®¡å­¦ Advanced Statistics è¯¾ç¨‹èµ„è®¯ YouTube è¿™ä¸¤ä¸ªå­¦æœŸè¯¾ç¨‹çš„ä½œä¸šã€ä¹ é¢˜ä»¥åŠè§£ç­”éƒ½å¯ä»¥åœ¨ è¿™é‡Œ æ‰¾åˆ°ã€‚ å­¦ä¹ ä¸€é—¨è¯¾ï¼Œè¦å­¦ä¹ å…¶â€œç²¾ç¥â€ï¼Œè€Œä¸æ˜¯å­¦ä¹ å…¶æ–¹æ³•ã€‚ ","date":"2024-01-20","objectID":"/posts/nycu-statistics/:0:0","tags":["Mathematics","Statistics","Probility","Random Variable"],"title":"å›½ç«‹é˜³æ˜äº¤é€šå¤§å­¦ ç»Ÿè®¡å­¦ é‡ç‚¹æç¤º","uri":"/posts/nycu-statistics/"},{"categories":["Mathematics"],"content":"Concepts å¼•ç”¨ Sample space $S$: Set of possible outcomes of a random experiment. Every subset of $S$ is an event. Random experiment æ˜¯ä¸€ç§ç‰¹æ®Šçš„å®éªŒã€‚ç‰©ç†å®éªŒã€åŒ–å­¦å®éªŒåœ¨ç›¸åŒçš„æ¡ä»¶ä¸‹æ‰€äº§ç”Ÿçš„ç»“æœæ˜¯ç›¸åŒçš„ï¼Œä½† Random experiment ä¸åŒï¼Œåœ¨ç›¸åŒçš„æ¡ä»¶ä¸‹ï¼Œæ¯æ¬¡å®éªŒçš„ç»“æœæ˜¯éšæœºçš„ã€‚ä½† Random experiment ç»“æœçš„æƒ…å†µæ˜¯æœ‰é™çš„ï¼Œæ‰€æœ‰å®éªŒç»“æœçš„é›†åˆå°±ç§°ä¸º Sample spaceã€‚ å¼•ç”¨ Probability set function $P$ on subset of $S$ satisfies: $P(A) \\geq 0$ $P(S) = 1$ $P(\\bigcup\\limits_{k=1}^{\\infty} A_k) = \\sum\\limits_{k=1}^{\\infty} A_k\\ \\ \\ if A_i \\bigcap A_j = \\emptyset\\ for\\ all\\ i \\neq j$ A random variable $X$ is a real-valued function define on $S$. $$ X:\\ S \\rightarrow R\\ \\ \\ or \\ \\ \\ S \\xrightarrow{X} R $$ set function æ˜¯å¯¹ set è¿›è¡Œæ˜ å°„çš„ functionï¼Œæ‰€ä»¥ $P$ æ˜¯ subset of $S$ åˆ°å®æ•°çš„æ˜ å°„å…³ç³»ï¼Œé€šè¿‡ $P$ å¯ä»¥è®¡ç®— event å¯¹åº”çš„æ¦‚ç‡å€¼ã€‚ Probability set function $P$ æœ‰ 3 ä¸ªç¬¦åˆç›´è§‰çš„åŸºæœ¬å‡†åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™ 3 ä¸ªå‡†åˆ™å¯ä»¥æ¨å¯¼å‡ºå…¶å®ƒç¬¦åˆç›´è§‰çš„æ€§è´¨: $$ \\forall A \\subset S \\implies \\begin{cases} P(\\emptyset) \u0026= 0 \\\\ P(A^{C}) \u0026= 1 - p \\end{cases} $$ $$ \\begin{split} \u0026 \\mathrm{Since}\\ \\emptyset \\cap S = \\emptyset \\\\ \u0026 \\mathrm{Then}\\ P(S) = P(\\emptyset \\cap S) = P(\\emptyset) + P(S) \\\\ \u0026 \\mathrm{and}\\ P(S) = 1 \\\\ \u0026 \\mathrm{Thus}\\ P(\\emptyset) = P(S) - P(S) = 0 \\\\ \u0026 Q.D.E. \\\\ \u0026 \\\\ \u0026 \\mathrm{Since}\\ A^{C} \\cap A = \\emptyset \\\\ \u0026 \\mathrm{Then}\\ P(S) = P(A^{C} \\cup A) = P(A^{C}) + P(A) \\\\ \u0026 \\mathrm{and}\\ P(S) = 1 \\\\ \u0026 \\mathrm{Thus}\\ P(A^{C}) = P(S) - P(A) = 1 - p \\\\ \u0026 Q.D.E. \\end{split} $$ Random variable $X$ æ˜¯å°† sample space $S$ æ˜ å°„åˆ°å®æ•°åŸŸ $R$ çš„æ˜ å°„å…³ç³»ï¼Œå³ $S$ æ˜¯å®šä¹‰åŸŸ (domain)ï¼Œ$R$ æ˜¯å€¼åŸŸ (co-domain)ã€‚ç”±äº $S$ å’Œ $R$ åœ¨è®¡æ•°ä¸Šå¹¶ä¸ç›¸åŒï¼Œæ‰€ä»¥ $r.v.\\ X$ åªæ˜¯å•å°„ï¼Œå¹¶ä¸æ˜¯æ»¡å°„ã€‚ ä¸ºä»€ä¹ˆéœ€è¦è¿™æ ·çš„æ˜ å°„å…³ç³»ï¼Ÿå› ä¸ºå¯¹äºå®æ•°ï¼Œå¯ä»¥ä½¿ç”¨å¾®ç§¯åˆ†è¿™ç±»æ•°å­¦å·¥å…·å¯¹æ¦‚ç‡çš„æ€§è´¨è¿›è¡Œç ”ç©¶ï¼Œè€Œå¾®ç§¯åˆ†è¿™ç±»æ•°å­¦å·¥å…·å¯¹äº sample space æ˜¾ç„¶æ˜¯æ— æ³•ä½¿ç”¨çš„ã€‚ ä½†æ˜¯æ³¨æ„ï¼Œæ ¹æ® Probability set function çš„å®šä¹‰ï¼Œå¯¹äºæ˜ å°„åå®æ•°åŸŸä¸Šçš„é›†åˆï¼Œæˆ‘ä»¬æ˜¯æ— æ³•ç›´æ¥æ±‚å¾—å¯¹åº”çš„æ¦‚ç‡å€¼ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªç±»ä¼¼åå‡½æ•°çš„æ˜ å°„å…³ç³» $X^{-1}:\\ R \\rightarrow S$ æ¥å°† $R$ æ˜ å°„å› $S$ï¼Œä»è€Œè®¡ç®—å¯¹åº”çš„æ¦‚ç‡å€¼ã€‚ ä¸ºä»€ä¹ˆæ˜¯ç±»ä¼¼åå‡½æ•°çš„æ˜ å°„ï¼ŸåŸå› å¦‚ä¸Šé¢æ‰€è¯´çš„ï¼Œ$S$ å’Œ $R$ åœ¨è®¡æ•°ä¸Šå¹¶ä¸ç›¸ç­‰ï¼Œæ‰€ä»¥ $R$ åˆ° $S$ çš„æ˜ å°„æœ‰å¯èƒ½ä¸æ»¡è¶³å•å°„ã€‚ å¼•ç”¨ Our interest of Probability: Given $B \\subset R$, what $P(x \\in B) =\\ ?$ $$ (X \\in B) = X^{-1}(B) = \\{s \\in S: X(s) \\in B\\} \\subset S \\\\ \\implies P(x \\in B) = P(\\{s \\in S: X(s) \\in B\\}) $$ Distribution function (df) of a r.v. $X$ is $$ F(x) = P(X \\leq x),\\ x \\in R $$ å¦‚æœæˆ‘ä»¬éœ€è¦å¯¹å®æ•°åŸŸä¸Šçš„é›†åˆ $B$ æ±‚å…¶æ¦‚ç‡å€¼ï¼Œåˆ™å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„ï¼Œéœ€è¦ä½¿ç”¨ $X^{-1}$ å°† $R$ æ˜ å°„å› $S$ã€‚ç”±äºå¯èƒ½æ˜¯éå•å°„çš„æ˜ å°„å…³ç³»ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨é›†åˆ $\\{s \\in S: X(s) \\in B\\}$ æ¥è¡¨ç¤ºæ˜ å°„ç»“æœï¼Œæ‰€ä»¥ $(x \\in B)$ ä¹Ÿå¯ä»¥è¡¨ç¤º eventã€‚ è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¯¹å®æ•°åŸŸä¸Šçš„é›†åˆæ±‚å…¶æ¦‚ç‡å€¼äº†ï¼Œä¹Ÿå³æ­¤æ—¶æˆ‘ä»¬æ‹¥æœ‰ä¸€ä¸ª $subset\\ of\\ R$ åˆ° $R$ çš„æ˜ å°„å…³ç³»ã€‚ ä½†æ˜¯è¿™æ ·ä»ç„¶æ— æ³•åœ¨äºŒç»´åæ ‡è½´ä¸Šè¿›è¡Œç›´è§‚è¡¨ç¤ºï¼Œä¹Ÿæ— æ³•å¯¹è¯¥å…³ç³»ä½¿ç”¨å¾®ç§¯åˆ†ç­‰å·¥å…·è¿›è¡Œç ”ç©¶ï¼Œæˆ‘ä»¬éœ€è¦ $R \\rightarrow R$ çš„æ˜ å°„å…³ç³»ã€‚ Distribution function (df) å°±æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ $R \\rightarrow R$ çš„æ˜ å°„å…³ç³»ï¼Œå¯¹äº $R$ ä¸Šçš„æ¯ä¸€ä¸ª $x$ æ˜ å°„åˆ° $P(X \\leq x)$ã€‚ æ³¨æ„ $X \\leq x$ åªæ˜¯ä¸€ä¸ªæ•°å­¦è¡¨ç¤ºï¼Œå¹¶ä¸å…·å¤‡æ•°å­¦æ„ä¹‰ï¼Œå› ä¸º $X$ ä½œä¸ºä¸€ä¸ª real-valued function å’Œå®æ•° $x$ è¿›è¡Œå…³ç³»è¿ç®—æ˜¾ç„¶æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ $X \\leq x$ è¡¨ç¤ºåœ¨ r.v. $X$ çš„æ˜ å°„å…³ç³»ä¸‹ï¼Œé›†åˆ $y \\in (-\\infty, x]$ å³ $\\{s \\in S: X(s) \\in (-\\infty, x]\\}$ï¼Œæ‰€ä»¥ $$ P(X \\leq x) = P(\\{s \\in S: X(s) \\in (-\\infty, x]\\}) $$ æœ‰äº† df æˆ‘ä»¬å°±å¯ä»¥å°†æ¦‚ç‡çš„æ€§è´¨é€šè¿‡äºŒç»´åæ ‡è½´è¿›è¡Œç›´è§‚æ˜¾ç¤ºï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å¾®ç§¯åˆ†è¿™ç±»å·¥å…·è¿›è¡Œè¿›ä¸€æ­¥ç ”ç©¶ã€‚ æ¥ä¸‹æ¥ä»¥ä¸€äº›å¸¸è§çš„æ¦‚ç‡åˆ†å¸ƒæ¥å¯¹ä¹‹å‰æ‰€æçš„æ¦‚å¿µè¿›è¡Œå®ä½œï¼š å¼•ç”¨ Some Distributions: Bernoulli distribution and Binomial distribution. A experiment with two possible outcomes is called a Bernoulli experiment. We denote the sample space by $$S = \\{S, F\\},\\ S = Success,\\ F = Failure$$ Probability set function: $$P(\\{S\\}) = p,\\ P(\\{F\\}) = 1-p,\\ 0 \\le p \\le 1$$ We define r.v. $X$ on $S = \\{S, F\\}$ by $$ X(S) = 1, X(F) = 0 \\\\ \\implies \\{S, F\\} \\xrightarrow{X} \\{0, 1\\} $$ The Probability are $$ P(X = 1) = P(X^{-1}\\{1\\}) = P(\\{S\\}) = p $$ æˆ‘ä»¬å¯ä»¥ä»è¿™ä¸ª Bernoulli distribution çš„ä¾‹å­ä¸­æç‚¼ç»Ÿè®¡çš„ä¸€èˆ¬æ€è·¯: ä» Random experiment ä¸­æ„å»º Sample space $S$ é€šè¿‡ Probability set function è®¡ç®— event å¯¹åº”çš„æ¦‚ç‡å€¼ å®šä¹‰ Random variable $X$ å®ç° $S$ åˆ° $R$ çš„æ˜ å°„å…³ç³» å¯¹ Distribution function (df) è¿›ä¸€æ­¥åˆ†æ ","date":"2024-01-20","objectID":"/posts/nycu-statistics/:1:0","tags":["Mathematics","Statistics","Probility","Random Variable"],"title":"å›½ç«‹é˜³æ˜äº¤é€šå¤§å­¦ ç»Ÿè®¡å­¦ é‡ç‚¹æç¤º","uri":"/posts/nycu-statistics/"},{"categories":["Mathematics"],"content":"References List of LaTeX mathematical symbols ","date":"2024-01-20","objectID":"/posts/nycu-statistics/:2:0","tags":["Mathematics","Statistics","Probility","Random Variable"],"title":"å›½ç«‹é˜³æ˜äº¤é€šå¤§å­¦ ç»Ÿè®¡å­¦ é‡ç‚¹æç¤º","uri":"/posts/nycu-statistics/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"å¤§å‹å¼€æºé¡¹ç›®çš„è§„æ¨¡ååˆ†åºå¤§ï¼Œä¾‹å¦‚ä½¿ç”¨ Rust ç¼–å†™çš„ Servo æµè§ˆå™¨ï¼Œè¿™ä¸ªé¡¹ç›®æœ‰è¿‘åä¸‡è¡Œä»£ç ã€‚åœ¨å¼€å‘è§„æ¨¡å¦‚æ­¤åºå¤§çš„é¡¹ç›®æ—¶ï¼Œäº†è§£å¦‚ä½•é€šè¿‡æ­£ç¡®çš„æ–¹å¼è¿›è¡Œè°ƒè¯•éå¸¸é‡è¦ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿåœ°æ‰¾åˆ°ç“¶é¢ˆã€‚ åŸæ–‡åœ°å€ | æ•™å­¦å½•å½± ","date":"2024-01-16","objectID":"/posts/debug-gdb/:0:0","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"GDB è°ƒè¯• è§‚çœ‹æ•™å­¦è§†é¢‘ æ‹¯æ•‘è³‡å·¥ç³»å­¸ç”Ÿçš„åŸºæœ¬ç´ é¤Šâ€”ä½¿ç”¨ GDB é™¤éŒ¯åŸºæœ¬æ•™å­¸ å’Œæ­é…åšæ–‡ ==[How to debug Rust/C/C++ via GDB][debug-gdb]==ï¼Œå­¦ä¹  GDB çš„åŸºæœ¬æ“ä½œå’Œç†Ÿæ‚‰ä½¿ç”¨ GDB è°ƒè¯• Rust/C/C++ ç¨‹åºã€‚ æŒæ¡ run/r, break/b, print/p, continue/c, step/s info/i, delete/d, backtrace/bt, frame/f, up/down, exit/q ç­‰å‘½ä»¤çš„ç”¨æ³•ã€‚ä»¥åŠ GBD çš„ä¸€äº›ç‰¹æ€§ï¼Œä¾‹å¦‚ GDB ä¼šå°†ç©ºç™½è¡Œçš„æ–­ç‚¹è‡ªåŠ¨ä¸‹ç§»åˆ°ä¸‹ä¸€ä»£ç è¡Œï¼›ä½¿ç”¨ break å‘½ä»¤æ—¶å¯ä»¥è¾“å…¥æºæ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå¯ä»¥åªè¾“å…¥æºæ–‡ä»¶åç§°ã€‚ ç›¸å…³çš„æµ‹è¯•æ–‡ä»¶ï¼š test.c hello_cargo/ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:1:0","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"GDB åŸºæœ¬ä»‹ç» å¼•ç”¨ â€œGDB, the GNU Project debugger, allows you to see what is going on â€˜insideâ€™ another program while it executes â€” or what another program was doing at the moment it crashed.â€ â€” from gnu.org å®‰è£… GDB: $ sudo apt install gdb å¯åŠ¨ GDB æ—¶å¯ä»¥åŠ å…¥ -q å‚æ•° (quite)ï¼Œè¡¨ç¤ºå‡å°‘æˆ–ä¸è¾“å‡ºä¸€äº›æç¤ºæˆ–ä¿¡æ¯ã€‚ LLDB ä¸ GDB çš„å‘½ä»¤ç±»ä¼¼ï¼Œæœ¬æ–‡ä¹Ÿå¯ç”¨äº LLDB çš„å…¥é—¨å­¦ä¹ ã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:2:0","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"GDB è°ƒè¯• C/C++ è¦ä½¿ç”¨ GDB æ¥è°ƒè¯• C/C++ï¼Œéœ€è¦åœ¨ç¼–è¯‘æ—¶åŠ ä¸Š -g å‚æ•°ï¼ˆå¿…éœ€ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ -Og å‚æ•°æ¥å¯¹ debug è¿›è¡Œä¼˜åŒ–ï¼ˆä½†ä½¿ç”¨ -Og å compiler å¯èƒ½ä¼šæŠŠä¸€äº›ä¸œè¥¿ç§»é™¤æ‰ï¼Œæ‰€ä»¥ debug æ—¶å¯èƒ½ä¸ä¼šç¬¦åˆé¢„æœŸï¼‰ï¼Œä¾‹å¦‚ï¼š $ gcc test.c -Og -g -o test $ gdb -q ./test Source ","date":"2024-01-16","objectID":"/posts/debug-gdb/:3:0","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"GDB è°ƒè¯• Rust åœ¨ä½¿ç”¨ build å‘½ä»¤æ„å»º debug ç›®æ ‡æ–‡ä»¶ï¼ˆå³ä½äº target/debug ç›®å½•ä¸‹çš„ç›®æ ‡æ–‡ä»¶ï¼Œä¸ package åŒåï¼‰åï¼Œå°±å¯ä»¥é€šè¿‡ gdb æ¥è¿›è¡Œè°ƒè¯•ï¼š $ cargo build $ gdb -q ./target/debug/\u003cpackage name\u003e ä½†æ˜¯å¦‚æœæ˜¯ä½¿ç”¨ cargo build --release æ„å»ºçš„ release ç›®æ ‡æ–‡ä»¶ï¼ˆå³ä½äº target/release ç›®å½•ä¸‹çš„ç›®æ ‡æ–‡ä»¶ï¼‰ï¼Œåˆ™æ— æ³•ä½¿ç”¨ GDB è¿›è¡Œè°ƒè¯•ï¼Œå› ä¸º release ç›®æ ‡æœªåŒ…å«ä»»ä½•è°ƒè¯•ä¿¡æ¯ï¼Œç±»ä¼¼äºæœªä½¿ç”¨ -g å‚æ•°ç¼–è¯‘ C/C++ æºä»£ç ã€‚ Source ","date":"2024-01-16","objectID":"/posts/debug-gdb/:4:0","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"GDB åŸºæœ¬å‘½ä»¤ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:0","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"run run (r) å‘½ä»¤ç”¨äºä»ç¨‹åºçš„æ‰§è¡Œèµ·å§‹ç‚¹å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹æˆ–è€…ç¨‹åºç»“æŸã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:1","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"continue continue (c) å‘½ä»¤ç”¨äºä»å½“å‰åœæ­¢çš„æ–­ç‚¹ä½ç½®å¤„ç»§ç»­æ‰§è¡Œç¨‹åºï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹æˆ–è€…ç¨‹åºç»“æŸã€‚ æ³¨æ„ run å’Œ continue çš„åŒºåˆ«åœ¨äº run æ˜¯å°†ç¨‹åºä»å¤´å¼€å§‹æ‰§è¡Œã€‚ä¾‹å¦‚å¦‚æœæœªè®¾ç½®ä»»ä½•æ–­ç‚¹ï¼Œä½¿ç”¨ run å¯ä»¥åå¤æ‰§è¡Œç¨‹åºï¼Œè€Œå¦‚æœä½¿ç”¨ continue åˆ™ä¼šæç¤º The program is not being runã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:2","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"step step (s) å‘½ä»¤ç”¨äº é€è¡Œ æ‰§è¡Œç¨‹åºï¼Œåœ¨é‡åˆ°å‡½æ•°è°ƒç”¨æ—¶è¿›å…¥å¯¹åº”å‡½æ•°ï¼Œå¹¶åœ¨å‡½æ•°å†…éƒ¨çš„ç¬¬ä¸€è¡Œæš‚åœã€‚step å‘½ä»¤ä»¥ å•æ­¥æ–¹å¼ æ‰§è¡Œç¨‹åºçš„æ¯ä¸€è¡Œä»£ç ï¼Œå¹¶è·Ÿè¸ªå‡½æ•°è°ƒç”¨çš„è¿›å…¥å’Œé€€å‡ºã€‚ (gdb) step 6 bar += 3; (gdb) step 7 printf(\"bar = %d\\n\", bar); æ³¨æ„ step å‘½ä»¤ä¸ continue å‘½ä»¤ç›¸åŒï¼Œåªèƒ½åœ¨ç¨‹åºå¤„äºè¿è¡Œæ€ï¼ˆå³åœç•™åœ¨æ–­ç‚¹å¤„ï¼‰æ—¶æ‰èƒ½ä½¿ç”¨ã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:3","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"next next (n) å‘½ä»¤ç”¨äºæ‰§è¡Œå½“å‰è¡Œå¹¶ç§»åŠ¨åˆ° ä¸‹ä¸€è¡Œï¼Œå®ƒç”¨äºé€è¡Œæ‰§è¡Œç¨‹åºï¼Œä½†ä¸ä¼šè¿›å…¥å‡½æ•°è°ƒç”¨ã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:4","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"break break (b) å‘½ä»¤ç”¨äºåœ¨å¯æ‰§è¡Œé—®å·å¯¹åº”çš„æºç¨‹åºä¸­åŠ å…¥æ–­ç‚¹ï¼Œå¯ä»¥åœ¨ç¨‹åºå¤„äº æœªè¿è¡Œæ€/è¿è¡Œæ€ æ—¶åŠ å…¥æ–­ç‚¹ï¼ˆè¿è¡Œæ€æ˜¯æŒ‡ç¨‹åºåœç•™åœ¨æ–­ç‚¹å¤„ä½†æœªæ‰§è¡Œå®Œæ¯•çš„å§¿æ€ï¼‰ã€‚ å¯ä»¥é€šè¿‡æŒ‡å®š æºæ–‡ä»¶å¯¹åº”çš„ è¡Œæ•°/å‡½æ•°å æ¥åŠ å…¥æ–­ç‚¹ï¼ˆæºæ–‡ä»¶åå¯ä»¥çœç•¥ï¼‰ï¼š (gdb) break test.c:7 (gdb) break test.c:foo å¦‚æœå¯æ‰§è¡Œæ–‡ä»¶ç”±å¤šä¸ªæºæ–‡ä»¶ç¼–è¯‘é“¾æ¥å¾—åˆ°ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®š æºæ–‡ä»¶åå­— çš„æ–¹å¼æ¥åŠ å…¥æ–­ç‚¹ï¼Œæ— éœ€æºæ–‡ä»¶è·¯å¾„ï¼Œä½†å¦‚æœä¸åŒè·¯å¾„æœ‰é‡åæºæ–‡ä»¶ï¼Œåˆ™éœ€è¦æŒ‡å®šè·¯å¾„æ¥åŒºåˆ†ï¼š (gdb) break test1.c:7 (gdb) break test2.c:main ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:5","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"print print (p) å‘½ä»¤ç”¨äºåœ¨è°ƒè¯•è¿‡ç¨‹ä¸­æ‰“å° å˜é‡çš„å€¼æˆ– è¡¨è¾¾å¼ çš„ç»“æœï¼Œå¸®åŠ©å¼€å‘è€…æ£€æŸ¥ç¨‹åºçŠ¶æ€å¹¶æŸ¥çœ‹ç‰¹å®šå˜é‡çš„å½“å‰å€¼ã€‚ # Assume x: 3, y: 4 (gdb) print x $1 = 3 (gdb) print x + y $2 = 7 ä½¿ç”¨ p å‘½ä»¤æ‰“å°å˜é‡å€¼æ—¶ï¼Œä¼šåœ¨å·¦ä¾§æ˜¾ç¤ºä¸€ä¸ª $\u003cnumber\u003eï¼Œè¿™ä¸ªå¯ä»¥ç†è§£æˆä¸´æ—¶å˜é‡ï¼Œåç»­ä¹Ÿå¯ä»¥é€šè¿‡è¿™ä¸ªæ ‡å¿—æ¥å¤ç”¨è¿™äº›å€¼ã€‚ä¾‹å¦‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼š (gdb) print $1 $3 = 3 (gdb) print $1 + $3 $4 = 4 Use p/format to instead select other formats such as x for hex, t for binary, and c for char. ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:6","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"backtrace backtrace (bt) å‘½ä»¤ç”¨äºæ‰“å°å½“å‰è°ƒç”¨æ ˆçš„ä¿¡æ¯ï¼Œä¹Ÿç§°ä¸ºå †æ ˆå›æº¯ (backtrace)ã€‚å®ƒæ˜¾ç¤ºäº†ç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ç»è¿‡çš„å‡½æ•°è°ƒç”¨åºåˆ—ï¼Œä»¥åŠæ¯ä¸ªå‡½æ•°è°ƒç”¨çš„ä½ç½®å’Œå‚æ•°ï¼Œå³å¯ä»¥è·å–ä»¥ä¸‹ä¿¡æ¯ï¼š å‡½æ•°è°ƒç”¨åºåˆ—ï¼šæ˜¾ç¤ºç¨‹åºå½“å‰çš„å‡½æ•°è°ƒç”¨åºåˆ—ï¼Œä»¥åŠæ¯ä¸ªå‡½æ•°çš„åç§°å’Œæ‰€åœ¨çš„æºä»£ç æ–‡ä»¶ã€‚ æ ˆå¸§ä¿¡æ¯ï¼šå¯¹äºæ¯ä¸ªå‡½æ•°è°ƒç”¨ï¼Œæ˜¾ç¤ºè¯¥å‡½æ•°çš„æ ˆå¸§ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ ˆå¸§çš„åœ°å€å’Œæ ˆå¸§çš„å¤§å°ã€‚ (gdb) backtrace (gdb) backtrace #0 foo () at test.c:7 #1 0x00005555555551d2 in main () at test.c:14 æŠ€å·§ backtrace å‘½ä»¤å¯¹äºè·Ÿè¸ªç¨‹åºçš„æ‰§è¡Œè·¯å¾„ã€æ£€æŸ¥å‡½æ•°è°ƒç”¨çš„é¡ºåºä»¥åŠå®šä½é”™è¯¯éå¸¸æœ‰ç”¨ã€‚åœ¨å®é™…ä¸­ï¼Œä¸€èˆ¬ä¼šæ­é…å…¶ä»–GDBå‘½ä»¤ï¼ˆå¦‚ upã€down å’Œ frameï¼‰ç»“åˆä½¿ç”¨ï¼Œä»¥æŸ¥çœ‹ç‰¹å®šæ ˆå¸§çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯æˆ–åˆ‡æ¢åˆ°ä¸åŒçš„æ ˆå¸§ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ#0 å’Œ #1 è¡¨ç¤ºæ ˆå¸§çš„ç¼–å·ï¼Œå¯ä»¥é€šè¿‡ frame é…åˆè¿™äº›ç¼–å·æ¥åˆ‡æ¢æ ˆå¸§ã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:7","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"where where å’Œ backtrace å‘½ä»¤éƒ½ç”¨äºæ˜¾ç¤ºç¨‹åºçš„è°ƒç”¨æ ˆä¿¡æ¯ã€‚backtrace æä¾›æ›´è¯¦ç»†çš„è°ƒç”¨æ ˆä¿¡æ¯ï¼ŒåŒ…æ‹¬å‡½æ•°åç§°ã€æ–‡ä»¶åã€è¡Œå·ã€å‚æ•°å’Œå±€éƒ¨å˜é‡çš„å€¼ã€‚è€Œ where å‘½ä»¤å¯ä»¥ç†è§£ä¸º backtrace çš„ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬ï¼Œå®ƒæä¾›çš„æ˜¯è¾ƒä¸ºç´§å‡‘çš„è°ƒç”¨æ ˆä¿¡æ¯ï¼Œé€šå¸¸åªåŒ…å«å‡½æ•°åç§°ã€æ–‡ä»¶åå’Œè¡Œå·ã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:8","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"frame frame (f) å‘½ä»¤ç”¨äºé€‰æ‹©ç‰¹å®šçš„æ ˆå¸§ (stack frame)ï¼Œä»è€Œåˆ‡æ¢åˆ°ä¸åŒçš„å‡½æ•°è°ƒç”¨ä¸Šä¸‹æ–‡ï¼Œæ¯ä¸ªæ ˆå¸§å¯¹åº”äºç¨‹åºä¸­çš„ä¸€ä¸ªå‡½æ•°è°ƒç”¨ã€‚ æ¥ç€ä¸Šä¸€ä¸ªä¾‹å­ï¼Œåˆ‡æ¢åˆ° main å‡½æ•°æ‰€åœ¨çš„æ ˆå¸§ï¼š (gdb) frame 1 #1 0x00005555555551d2 in main () at test.c:14 14 int result = foo(); ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:9","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"up/down up å’Œ down å‘½ä»¤ç”¨äºåœ¨è°ƒè¯•è¿‡ç¨‹ä¸­åœ¨ä¸åŒçš„æ ˆå¸§ä¹‹é—´è¿›è¡Œåˆ‡æ¢ï¼š up ç”¨äºåœ¨è°ƒç”¨æ ˆä¸­å‘ä¸Šç§»åŠ¨åˆ°è¾ƒé«˜çš„æ ˆå¸§ï¼Œå³è¿›å…¥è°ƒç”¨å½“å‰å‡½æ•°çš„å‡½æ•°ã€‚æ¯æ¬¡æ‰§è¡Œ up å‘½ä»¤ï¼ŒGDB å°†åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªï¼ˆæ›´é«˜å±‚æ¬¡ï¼‰çš„æ ˆå¸§ã€‚è¿™å¯ä»¥ç”¨äºæŸ¥çœ‹è°ƒç”¨å½“å‰å‡½æ•°çš„ä¸Šå±‚å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ down ç”¨äºåœ¨è°ƒç”¨æ ˆä¸­å‘ä¸‹ç§»åŠ¨åˆ°è¾ƒä½çš„æ ˆå¸§ï¼Œå³è¿”å›åˆ°å½“å‰å‡½æ•°è°ƒç”¨çš„å‡½æ•°ã€‚æ¯æ¬¡æ‰§è¡Œ down å‘½ä»¤ï¼ŒGDB å°†åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼ˆè¾ƒä½å±‚æ¬¡ï¼‰çš„æ ˆå¸§ã€‚è¿™å¯ä»¥ç”¨äºè¿”å›åˆ°è°ƒç”¨å½“å‰å‡½æ•°çš„å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ è¿™ä¸¤ä¸ªå‘½ä»¤éœ€è¦å¼€å‘è€…å¯¹åº”å‡½æ•°è°ƒç”¨å †æ ˆçš„å¸ƒå±€æœ‰ä¸€å®šç¨‹åº¦çš„äº†è§£ã€‚ æ¥ç€ä¸Šä¸€ä¸ªä¾‹å­ï¼š (gdb) up #1 0x00005555555551d2 in main () at test.c:14 14 int result = foo(); (gdb) down #0 foo () at test.c:7 7 printf(\"bar = %d\\n\", bar); ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:10","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"info info (i) å‘½ä»¤ç”¨äºè·å–ç¨‹åºçŠ¶æ€å’Œè°ƒè¯•ç¯å¢ƒçš„ç›¸å…³ä¿¡æ¯ï¼Œè¯¥å‘½ä»¤åé¢å¯ä»¥è·Ÿéšä¸åŒçš„å­å‘½ä»¤ï¼Œç”¨äºè·å–ç‰¹å®šç±»å‹çš„ä¿¡æ¯ã€‚ ä¸€äº›å¸¸ç”¨çš„ info å­å‘½ä»¤ï¼š info breakpoints æ˜¾ç¤ºå·²è®¾ç½®çš„æ‰€æœ‰æ–­ç‚¹ (breakpoint) ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–­ç‚¹ç¼–å·ã€æ–­ç‚¹ç±»å‹ã€æ–­ç‚¹ä½ç½®ç­‰ã€‚ info watchpoints æ˜¾ç¤ºå·²è®¾ç½®çš„æ‰€æœ‰ç›‘è§†ç‚¹ (watchpoint) ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç›‘è§†ç‚¹ç¼–å·ã€ç›‘è§†ç‚¹ç±»å‹ã€ç›‘è§†çš„è¡¨è¾¾å¼ç­‰ã€‚ info locals æ˜¾ç¤ºå½“å‰å‡½æ•°çš„å±€éƒ¨å˜é‡çš„å€¼å’Œåç§°ã€‚ info args æ˜¾ç¤ºå½“å‰å‡½æ•°çš„å‚æ•°çš„å€¼å’Œåç§°ã€‚ info registers æ˜¾ç¤ºå½“å‰ CPU å¯„å­˜å™¨çš„å€¼ã€‚ info threads æ˜¾ç¤ºå½“å‰æ­£åœ¨è°ƒè¯•çš„æ‰€æœ‰çº¿ç¨‹ (thread) ä¿¡æ¯ï¼ŒåŒ…æ‹¬çº¿ç¨‹ç¼–å·ã€çº¿ç¨‹çŠ¶æ€ç­‰ã€‚ info frame æ˜¾ç¤ºå½“å‰æ ˆå¸§ (stack frame) çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å‡½æ•°åç§°ã€å‚æ•°ã€å±€éƒ¨å˜é‡ç­‰ã€‚ info program æ˜¾ç¤ºè¢«è°ƒè¯•ç¨‹åºçš„ç›¸å…³ä¿¡æ¯ï¼Œä¾‹å¦‚ç¨‹åºå…¥å£åœ°å€ã€ç¨‹åºçš„åŠ è½½åœ°å€ç­‰ã€‚ (gdb) info breakpoints # or simply: i b Num Type Disp Enb Address What 1 breakpoint keep y 0x000055555555518f in foo at test.c:7 2 breakpoint keep y 0x0000555555555175 in foo at test.c:4 ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:11","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"delete delete (d) å‘½ä»¤ç”¨äºåˆ é™¤æ–­ç‚¹ (breakpoint) æˆ–è§‚å¯Ÿç‚¹ (watchpoint)ã€‚æ–­ç‚¹æ˜¯åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´æš‚åœæ‰§è¡Œçš„ç‰¹å®šä½ç½®ï¼Œè€Œè§‚å¯Ÿç‚¹æ˜¯åœ¨ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶æš‚åœæ‰§è¡Œçš„ä½ç½®ã€‚ å¯ä»¥é€šè¿‡æŒ‡å®š æ–­ç‚¹ / è§‚å¯Ÿç‚¹ çš„ç¼–å·æˆ–ä½¿ç”¨ delete å‘½ä»¤ç›¸å…³çš„å‚æ•°ï¼Œæ¥åˆ é™¤å·²è®¾ç½®çš„æ–­ç‚¹ / è§‚å¯Ÿç‚¹ã€‚æ–­ç‚¹ / è§‚å¯Ÿç‚¹ç¼–å·å¯ä»¥åœ¨ä½¿ç”¨ info breakpoints / info watchpoints å‘½ä»¤æ—¶è·å¾—ã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:12","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"quit quit (q) å‘½ä»¤ç”¨äºé€€å‡º GDBï¼Œè¿”å›ç»ˆç«¯é¡µé¢ã€‚ (gdb) quit $ # Now, in the terminial ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:13","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"list list å‘½ä»¤ç”¨äºæ˜¾ç¤ºå½“å‰ä½ç½®çš„ä»£ç ç‰‡æ®µï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¼šæ˜¾ç¤ºå½“å‰ä½ç½®çš„å‰å10è¡Œä»£ç ã€‚ list å‘½ä»¤ä¹Ÿå¯ä»¥æ˜¾ç¤ºæŒ‡å®šèŒƒå›´çš„ä»£ç ï¼Œä½¿ç”¨ list \u003cstart\u003e,\u003cend\u003e å‘½ä»¤å°†æ˜¾ç¤ºä» start è¡Œåˆ° end è¡Œçš„æºä»£ç ã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:14","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"whatis whatis å‘½ä»¤ç”¨äºè·å–ç»™å®šæ ‡è¯†ç¬¦ï¼ˆå¦‚å˜é‡ã€å‡½æ•°æˆ–ç±»å‹ï¼‰çš„ç±»å‹ä¿¡æ¯ã€‚ // in source code int calendar[12][31]; // in gdb (gdb) whatis calendar type = int [12][31] ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:15","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"x x å‘½ä»¤ç”¨äºæŸ¥çœ‹å†…å­˜ä¸­çš„æ•°æ®ï¼Œä½¿ç”¨ x å‘½ä»¤æ­é…ä¸åŒçš„æ ¼å¼æ¥æ˜¾ç¤ºå†…å­˜ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ­é… / åè·Ÿæ•°å­—æ¥æŒ‡å®šè¦æ˜¾ç¤ºçš„å†…å­˜å•å…ƒæ•°é‡ã€‚ä¾‹å¦‚ï¼Œx/4 \u003caddress\u003e è¡¨ç¤ºæ˜¾ç¤ºåœ°å€ address å¼€å§‹çš„è¿ç»­ 4 ä¸ªå†…å­˜å•å…ƒçš„å†…å®¹ã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:16","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"å…¶ä»– å¦‚æœè¢«è°ƒè¯•ç¨‹åºæ­£å¤„äºè¿è¡Œæ€ï¼ˆå³å·²ç»é€šè¿‡ run å‘½ä»¤æ¥è¿è¡Œç¨‹åºï¼‰ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ Ctrl+C æ¥ä¸­æ–­ GDBï¼Œç¨‹åºå°†è¢«ç«‹å³ä¸­æ–­ï¼Œå¹¶åœ¨ä¸­æ–­æ—¶æ‰€è¿è¡Œåˆ°çš„åœ°æ–¹æš‚åœã€‚è¿™ç§æ–¹å¼è¢«ç§°ä¸º æ‰‹åŠ¨æ–­ç‚¹ï¼Œæ‰‹åŠ¨æ–­ç‚¹å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªä¸´æ—¶æ–­ç‚¹ï¼Œåªä¼šåœ¨è¯¥å¤„æš‚åœä¸€æ¬¡ã€‚ GDB ä¼šå°†ç©ºç™½è¡Œçš„æ–­ç‚¹è‡ªåŠ¨ä¸‹ç§»åˆ°ä¸‹ä¸€éç©ºçš„ä»£ç è¡Œã€‚ set print pretty å‘½ä»¤å¯ä»¥ä»¥æ›´æ˜“è¯»å’Œæ ¼å¼åŒ–çš„æ–¹å¼æ˜¾ç¤ºç»“æ„åŒ–æ•°æ®ï¼Œä»¥æ›´å‹å¥½çš„æ–¹å¼è¾“å‡ºç»“æ„ä½“ã€ç±»ã€æ•°ç»„ç­‰å¤æ‚ç±»å‹çš„æ•°æ®ï¼Œæ›´æ˜“äºé˜…è¯»å’Œç†è§£ã€‚ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:5:17","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"References video: Linux basic anti-debug video: C Programming, Disassembly, Debugging, Linux, GDB rr (Record and Replay Framework) video: Quick demo video: Record and replay debugging with â€œrrâ€ ","date":"2024-01-16","objectID":"/posts/debug-gdb/:6:0","tags":["Debug","GDB","Rust","C/C++","Sysprog"],"title":"ç¨‹åºè°ƒè¯•å·¥å…· GDB","uri":"/posts/debug-gdb/"},{"categories":["C","Linux Kernel Internals"],"content":" ã€ŒæŒ‡é’ˆã€ æ‰®æ¼” ã€Œè®°å¿†ä½“ã€ å’Œ ã€Œç‰©ä»¶ã€ ä¹‹é—´çš„æ¡¥æ¢ åŸæ–‡åœ°å€ ","date":"2024-01-14","objectID":"/posts/c-pointer/:0:0","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"å‰è¨€æ‚è°ˆ Letâ€™s learn programming by inventing it [CppCon 2018] âœ… åœ¨ K\u0026R ä¸€ä¹¦ä¸­ï¼Œç›´åˆ° 93 é¡µæ‰å¼€å§‹è°ˆè®º pointerï¼Œè€Œå…¨ä¹¦æ€»è®¡ 185 é¡µï¼Œæ‰€ä»¥å¤§æ¦‚æ˜¯åœ¨å…¨ä¹¦ $50.27\\%$ çš„ä½ç½®æ‰å¼€å§‹è®² pointerã€‚æ‰€ä»¥å³ä½¿ä¸å­¦ pointerï¼Œä½ è¿˜æ˜¯èƒ½å¤ŸæŒæ¡ $~50\\%$ çš„ C è¯­è¨€çš„å†…å®¹ï¼Œä½†æ˜¯ C è¯­è¨€çš„æ ¸å¿ƒæ­£æ˜¯ pointerï¼Œæ‰€ä»¥ Good Luck ğŸ¤£ godbolt å¯ä»¥ç›´æ¥åœ¨ç½‘é¡µä¸Šçœ‹åˆ°ï¼Œæºä»£ç ç”±å„ç±» compiler ç”Ÿæˆçš„ Assembly Code How to read this prototype? [Stack Overflow] âœ… Note è¿™ä¸ªé—®é¢˜æ˜¯å…³äº signal ç³»ç»Ÿè°ƒç”¨çš„å‡½æ•°åŸå‹è§£è¯»ï¼Œé‡Œé¢çš„å›ç­”é¡µç»™å‡ºäº†å¾ˆå¤šå¯¹äºæŒ‡é’ˆï¼Œç‰¹åˆ«æ˜¯ å‡½æ•°æŒ‡é’ˆ çš„è¯´æ˜ï¼Œä¸‹é¢èŠ‚é€‰ä¸€äº›ç‰¹åˆ«æœ‰æ„æ€çš„å›ç­”ï¼š The whole thing declares a function called signal: signal takes an int and a function pointer this function pointer takes an int and returns void signal returns a function pointer this function pointer takes an intand returns avoid` Thatâ€™s where the last int comes in. You can use the spiral rule to make sense of such declarations, or the program cdecl(1). è¿™é‡Œé¢æåˆ°äº† the spiral rule è¿™æ˜¯ä¸€ä¸ªç”¨äºè§£æ C è¯­è¨€ä¸­å£°æ˜ (declaration) çš„æ–¹æ³•ï¼›å¦å¤–è¿˜æåˆ°äº† cdecl è¿™ä¸€ç¨‹åºï¼Œå®ƒä¹Ÿæœ‰ç±»ä¼¼çš„ä½œç”¨ï¼Œå¯ä»¥ä½¿ç”¨è‹±æ–‡è¿›è¡Œå£°æ˜æˆ–è€…è§£é‡Šã€‚ Find the leftmost identifier and work your way out, remembering that [] and () bind before *; IOW, *a[] is an array of pointers, (*a)[] is a pointer to an array, *f() is a function returning a pointer, and (*f)() is a pointer to a function. Thus, void ( *signal(int sig, void (*handler)(int)) ) (int); breaks down as signal -- signal signal( ) -- is a function signal( sig ) -- with a parameter named sig signal(int sig, ) -- of type int signal(int sig, handler ) -- and a parameter named handler signal(int sig, *handler ) -- which is a pointer signal(int sig, (*handler)( )) ) -- to a function signal(int sig, (*handler)(int)) ) -- taking an int parameter signal(int sig, void (*handler)(int)) ) -- and returning void *signal(int sig, void (*handler)(int)) ) -- returning a pointer ( *signal(int sig, void (*handler)(int)) )( ) -- to a function ( *signal(int sig, void (*handler)(int)) )(int) -- taking an int parameter void ( *signal(int sig, void (*handler)(int)) )(int); -- and returning void è¿™ä¸€å›ç­”å¼ºè°ƒäº† * å’Œ []ã€() ä¼˜å…ˆçº§çš„å…³ç³»ï¼Œè¿™åœ¨åˆ¤æ–­æ•°ç»„æŒ‡é’ˆã€å‡½æ•°æŒ‡é’ˆæ—¶æ˜¯ä¸ªéå¸¸å¥½ç”¨çš„æŠ€å·§ã€‚ Rob Pike äº 2009/10/30 çš„ Golang Talk [PDF] David Brailsford æ•™æˆè§£è¯´å½±ç‰‡ Essentials: Pointer Power! - Computerphile [YouTube] ","date":"2024-01-14","objectID":"/posts/c-pointer/:1:0","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"é˜…è¯» C è¯­è¨€è§„æ ¼ä¹¦ ä¸€æ‰‹èµ„æ–™çš„é‡è¦æ€§æ¯‹åº¸ç½®ç–‘ï¼Œå¯¹äº C è¯­è¨€ä¸­çš„æ ¸å¿ƒæ¦‚å¿µ æŒ‡é’ˆï¼Œå€ŸåŠ©å®˜æ–¹è§„æ ¼ä¹¦æ¸…æ™°æ¦‚å¿µæ˜¯éå¸¸é‡è¦çš„ã€‚ C99 [6.2.5] Types An array type of unknown size is an incomplete type. It is completed, for an identifier of that type, by specifying the size in a later declaration (with internal or external linkage). A structure or union type of unknown content is an incomplete type. It is completed, for all declarations of that type, by declaring the same structure or union tag with its defining content later in the same scope. incomplete type å’Œ linkage é…åˆå¯ä»¥è¿›è¡Œ forward declarationï¼Œå¦‚æœæ­é… pointer åˆ™å¯ä»¥è¿›ä¸€æ­¥ï¼Œåœ¨æ— éœ€çŸ¥é“ object å†…éƒ¨ç»†èŠ‚å³å¯è¿›è¡Œç¨‹åºå¼€å‘ã€‚ Array, function, and pointer types are collectively called derived declarator types. A declarator type derivation from a type T is the construction of a derived declarator type from T by the application of an array-type, a function-type, or a pointer-type derivation to T. æ³¨æ„ derived declarator types è¡¨ç¤ºè¡ç”Ÿçš„å£°æ˜ç±»å‹ï¼Œå› ä¸º array, function, pointer æœ¬è´¨éƒ½æ˜¯åœ°å€ï¼Œè€Œå®ƒä»¬çš„ç±»å‹éƒ½æ˜¯ç”±å…¶å®ƒç±»å‹è¡ç”Ÿè€Œæ¥çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨è¿™äº›æ‰€è°“çš„ derived declarator types æ¥æå‰å£°æ˜ objectï¼Œè¡¨ç¤ºåœ¨æŸä¸ªåœ°å€ä¼šå­˜å‚¨ä¸€ä¸ª objectï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¿™äº›ç±»å‹è¢«è§„æ ¼ä¹¦å®šä¹‰ä¸º derived declarator typesã€‚ lvalue: Locator value å±é™© C è¯­è¨€é‡Œåªæœ‰ call by value ","date":"2024-01-14","objectID":"/posts/c-pointer/:2:0","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"void \u0026 void * C89 ä¹‹å‰ï¼Œå‡½æ•°å¦‚æœæ²¡æœ‰æ ‡æ³¨è¿”å›ç±»å‹ï¼Œåˆ™é»˜è®¤è¿”å›ç±»å‹ intï¼Œè¿”å›å€¼ 0ã€‚ä½†ç”±äºè¿™æ ·æ—¢å¯ä»¥è¡¨ç¤ºè¿”å›å€¼ä¸é‡è¦ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºè¿”å›å€¼ä¸º 0ï¼Œè¿™ä¼šé€ æˆæ­§ä¹‰ï¼Œæ‰€ä»¥å¼•è¿›äº† voidã€‚ void * åªèƒ½è¡¨ç¤ºåœ°å€ï¼Œè€Œä¸èƒ½å¯¹æ‰€æŒ‡å‘çš„åœ°å€åŒºåŸŸçš„å†…å®¹è¿›è¡Œæ“ä½œã€‚å› ä¸ºé€šè¿‡ void * æ— æ³•çŸ¥é“æ‰€æŒ‡å‘åŒºåŸŸçš„ sizeï¼Œæ‰€ä»¥æ— æ³•å¯¹åŒºåŸŸçš„å†…å®¹è¿›è¡Œæ“ä½œï¼Œå¿…é¡»å¯¹ void * è¿›è¡Œ æ˜¾ç¤ºè½¬æ¢ æ‰èƒ½æ“ä½œæŒ‡å‘çš„å†…å®¹ã€‚ï¼ˆé™¤æ­¤ä¹‹å¤–ï¼Œé’ˆå¯¹äº gccï¼Œå¯¹äºæŒ‡é’ˆæœ¬èº«çš„æ“ä½œï¼Œvoid * ä¸ char * æ˜¯ç­‰ä»·çš„ï¼Œå³å¯¹äº +/- 1 è¿™ç±»çš„æ“ä½œï¼ŒäºŒè€…çš„åç§»é‡æ˜¯ä¸€è‡´çš„ (è¿™æ˜¯ GNU extensions å¹¶ä¸æ˜¯ C è¯­è¨€æ ‡å‡†)ï¼›å¯¹äºå…¶å®ƒçš„ç¼–è¯‘å™¨ï¼Œå»ºè®®å°† void * è½¬æ¢æˆ char * å†è¿›è¡ŒæŒ‡é’ˆçš„åŠ å‡è¿ç®—ï¼‰ ","date":"2024-01-14","objectID":"/posts/c-pointer/:3:0","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"Alignment è¿™éƒ¨åˆ†åŸæ–‡æè¿°ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œ2-byte aligned å›¾ç¤ºå¦‚ä¸‹ï¼š Alignment å¦‚æœæ˜¯ 2-byte aligned ä¸”æ˜¯ little-endian çš„å¤„ç†å™¨ï¼Œå¯¹äºå·¦è¾¹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ *(uint16_t *) ptrï¼Œä½†å¯¹äºå³è¾¹å°±æ— æ³•è¿™æ ·ï¼ˆä¸ç¬¦åˆ alignmentï¼‰ï¼š /* may receive wrong value if ptr is not 2-byte aligned */ uint16_t value = *(uint16_t *) ptr; /* portable way of reading a little-endian value */ uint16_t value = *(uint8_t *) ptr | ((*(uint8_t *) (ptr + 1)) \u003c\u003c 8); å› ä¸ºå†…å­˜å¯»å€çš„æœ€å°ç²’åº¦æ˜¯ Byteï¼Œæ‰€ä»¥ä½¿ç”¨ (uint_8 *) ä¸éœ€è¦æ‹…å¿ƒ alignment çš„é—®é¢˜ã€‚åŸæ–‡å¹¶æ²¡æœ‰ç»™å‡º 32-bit aligned çš„ portable wayï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸‹ï¼š /* may receive wrong value if ptr is not 2-byte aligned */ uint32_t value = *(uint32_t *) ptr; /* portable way of reading a little-endian value */ uint32_t value = *(uint8_t *) ptr | ((*(uint8_t *) (ptr + 1)) \u003c\u003c 8) | ((*(uint8_t *) (ptr + 2)) \u003c\u003c 16) | ((*(uint8_t *) (ptr + 3)) \u003c\u003c 24); ä¿¡æ¯ The Lost Art of Structure Packing ","date":"2024-01-14","objectID":"/posts/c-pointer/:3:1","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"è§„æ ¼ä¹¦ä¸­çš„ Pointer C99 [6.3.2.3] Pointers A pointer to a function of one type may be converted to a pointer to a function of another type and back again; the result shall compare equal to the original pointer. Ifaconverted pointer is used to call a function whose type is not compatible with the pointed-to type, the behavior is undefined. C11 [6.3.2.3] Pointers A pointer to a function of one type may be converted to a pointer to a function of another type and back again; the result shall compare equal to the original pointer. If a converted pointer is used to call a function whose type is not compatible with the referenced type, the behavior is undefined. C99 å’Œ C11 éƒ½ä¸ä¿è¯ pointers (whose type is not compatible with the pointed-to / referenced type) ä¹‹é—´çš„è½¬æ¢æ˜¯æ­£ç¡®çš„ã€‚ å¯¼è‡´è¿™ä¸ªçš„åŸå› æ­£æ˜¯ä¹‹å‰æ‰€æçš„ Alignmentï¼Œè½¬æ¢åçš„æŒ‡é’ˆç±»å‹ä¸ä¸€å®šæ»¡è¶³åŸæœ‰ç±»å‹çš„ Alignment è¦æ±‚ï¼Œè¿™ç§æƒ…å†µä¸‹è¿›è¡Œ dereference ä¼šå¯¼è‡´å¼‚å¸¸ã€‚ä¾‹å¦‚å°†ä¸€ä¸ª char * æŒ‡é’ˆè½¬æ¢æˆ int * æŒ‡é’ˆï¼Œç„¶åè¿›è¡Œ deference æœ‰å¯èƒ½ä¼šäº§ç”Ÿå¼‚å¸¸ã€‚ ","date":"2024-01-14","objectID":"/posts/c-pointer/:3:2","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"Pointers vs. Arrays C99 6.3.2.1 Except when it is the operand of the sizeof operator or the unary \u0026 operator, or is a string literal used to initialize an array, an expression that has type â€˜â€˜array of typeâ€™â€™ is converted to an expression with type â€˜â€˜pointer to typeâ€™â€™ that points to the initial element of the array object and is not an lvalue. Array åªæœ‰åœ¨è¡¨ç¤ºå…¶è‡ªèº«ä¸ºæ•°ç»„æ—¶æ‰ä¸ä¼šè¢« converted to Pointerï¼Œä¾‹å¦‚ // case 1: extern declaration of array extern char a[]; // case 2: defintion of array char a[10]; // case 3: size of array sizeof(a); // case 4: address of array \u0026a åœ¨å…¶ä»–æƒ…å†µåˆ™ä¼šå€ converted to Pointerï¼Œè¿™æ—¶ Array å¯ä»¥å’Œ Pointer äº’æ¢è¿›è¡Œè¡¨ç¤ºæˆ–æ“ä½œï¼Œä¾‹å¦‚ // case 1: function parameter void func(char a[]); void func(char *a); // case 2: operation in expression char c = a[2]; char c = *(a + 2); è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¯¹äºä¸€ä¸ª Array aï¼Œ\u0026a å’Œ \u0026a[0] å€¼è™½ç„¶ç›¸åŒï¼Œä½† \u0026a + 1 å’Œ \u0026a[0] + 1 çš„ç»“æœå¤§éƒ¨åˆ†æ—¶å€™æ˜¯å¤§ä¸ç›¸åŒçš„ï¼Œè¿™ä»¶äº‹ä¹ä¸€çœ‹æ˜¯éå¸¸æƒŠäººçš„ï¼Œä½†å…¶å®ä¸ç„¶ï¼Œåœ¨äº†è§£ Array å’Œ Pointer ä¹‹åï¼Œä¹Ÿå°±é‚£ä¹ˆä¸€å›äº‹ ğŸ¤£ Source ","date":"2024-01-14","objectID":"/posts/c-pointer/:4:0","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"GDB å®ä½œ char a[10]; int main() { return 0; }; æˆ‘ä»¬ä»¥ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œé€šè¿‡ GDB æ¥å¯¹ Array å’Œ Pointer è¿›è¡Œæ·±å…¥ç ”ç©¶ï¼š (gdb) print \u0026a $1 = (char (*)[10]) 0x555555558018 \u003ca\u003e (gdb) print \u0026a[0] $2 = 0x555555558018 \u003ca\u003e \"\" ç¬¦åˆé¢„æœŸï¼Œ\u0026a å’Œ \u0026a[0] å¾—åˆ°çš„å€¼æ˜¯ç›¸åŒçš„ï¼Œè™½ç„¶ç±»å‹çœ‹èµ·æ¥ä¸åŒï¼Œä½†æ˜¯ç°åœ¨å…ˆæ”¾åˆ°ä¸€è¾¹ã€‚ (gdb) print \u0026a + 1 $3 = (char (*)[10]) 0x555555558022 (gdb) print \u0026a[0] + 1 $4 = 0x555555558019 \u003ca+1\u003e \"\" (gdb) print a + 1 $5 = 0x555555558019 \u003ca+1\u003e \"\" Oh! æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„ \u0026a + 1 ä¸ \u0026a[0] + 1 ç»“æœå¹¶ä¸ç›¸åŒï¼ˆè€Œ \u0026a[0] + 1 å’Œ a + 1 ç»“æœç›¸åŒæ­£æ˜¯æˆ‘ä»¬æ‰€æåˆ°çš„ Array é€€åŒ–ä¸º Pointerï¼‰ï¼Œè™½ç„¶å¦‚æ­¤ï¼ŒGDB æ‰€ç»™çš„ä¿¡æ¯æç¤ºæˆ‘ä»¬å¯èƒ½æ˜¯äºŒè€… Pointer ç±»å‹ä¸ç›¸åŒå¯¼è‡´çš„ã€‚ (gdb) whatis \u0026a type = char (*)[10] (gdb) whatis \u0026a[0] type = char * Great! æœç„¶æ˜¯ Pointer ç±»å‹ä¸åŒå¯¼è‡´çš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° \u0026a çš„ç±»å‹æ˜¯ char (*)[10] ä¸€ä¸ªæŒ‡å‘ Array çš„æŒ‡é’ˆï¼Œ\u0026a[0] åˆ™æ˜¯ char *ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ª Pointer åœ¨è¿›è¡Œ +/- è¿ç®—æ—¶çš„åç§»é‡æ˜¯ä¸åŒçš„ï¼Œ\u0026a[0] çš„åç§»é‡ä¸º sizeof(a[0]) å³ä¸€ä¸ª char çš„å®½åº¦ ($0x18 + 1 = 0x19$)ï¼Œè€Œ \u0026a çš„åç§»é‡ä¸º sizeof(a) å³ 10 ä¸ª char çš„å®½åº¦ ($0x18 + 10 = 0x22$)ã€‚ è­¦å‘Š åœ¨ GDB ä¸­ä½¿ç”¨ memcpy åç›´æ¥æ‰“å°å¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š (gdb) p memcpy(calendar, b, sizeof(b[0])) 'memcpy' has unknown return type; cast the call to its declared return type åªéœ€åŠ å…¥ void * è¿›è¡Œç±»å‹è½¬æ¢å³å¯è§£å†³è¯¥é—®é¢˜ï¼š (gdb) p (void *) memcpy(calendar, b, sizeof(b[0])) ... æŠ€å·§ é‡åˆ°é™Œç”Ÿçš„å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ man æ¥å¿«é€ŸæŸ¥é˜…æ‰‹å†Œï¼Œä¾‹å¦‚ man strcpy, man strcatï¼Œæ‰‹å†Œå¯ä»¥è®©æˆ‘ä»¬å¿«é€ŸæŸ¥è¯¢å‡½æ•°çš„ä¸€äº›ä¿¡æ¯ï¼Œä»è€Œè¿›å…¥å®ä½œã€‚ ","date":"2024-01-14","objectID":"/posts/c-pointer/:4:1","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"Runtime Environment æ ¹æ® Zero size arrays in C ï¼ŒåŸæ–‡ä¸­çš„ char (*argv)[0] åœ¨å‡½æ•°å‚æ•°ä¼ é€’æ—¶ä¼šè¢«è½¬æ¢æˆ char **argvã€‚è€Œä¸ºä»€ä¹ˆåœ¨æŸ¥çœ‹åœ°å€ ((char **) argv)[0] å¼€å§‹çš„è¿ç»­ 4 ä¸ª char * å†…å®¹æ—¶ï¼Œä¼šæ‰“å°å‡º envp ä¸­çš„å†…å®¹ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹çš„è¿›å…¥ main å‡½æ•°æ—¶çš„æ ˆå¸ƒå±€ï¼š argv å’Œ envp æ‰€æŒ‡çš„å­—ç¬¦ä¸²åŒºåŸŸæ˜¯ç›¸è¿çš„ï¼Œæ‰€ä»¥åœ¨è¶Šè¿‡ argv å­—ç¬¦ä¸²åŒºåŸŸçš„è¾¹ç•Œåï¼Œä¼šç»§ç»­æ‰“å° envp åŒºåŸŸçš„å­—ç¬¦ä¸²ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ‰“å°å‡ºçš„å­—ç¬¦ä¸²ä¹‹é—´åœ°å€å¢é•¿äºå…¶é•¿åº¦ç›¸åŒ¹é…ã€‚æ‰€ä»¥ä»åœ°å€ (char **) argv å¼€å§‹çš„åŒºåŸŸåªæ˜¯ä¸€ä¸ª char * æ•°ç»„ï¼Œä½¿ç”¨ x/4s å¯¹è¿™éƒ¨åˆ†è¿›è¡Œå­—ç¬¦ä¸²æ ¼å¼æ‰“å°æ˜¾ç„¶æ˜¯çœ‹ä¸æ‡‚çš„ã€‚ æ³¨æ„ argv å’Œ envp éƒ½æ˜¯åœ¨ shell è¿›è¡Œ exec ç³»ç»Ÿè°ƒç”¨ä¹‹å‰è¿›è¡Œä¼ é€’ï¼ˆäº‹å®ä¸Šæ˜¯ä»¥ arguments çš„å½¢å¼ä¼ é€’ç»™ execï¼‰ man 2 execve int execve(const char *pathname, char *const argv[], char *const envp[]); execve å®é™…ä¸Šåœ¨å†…éƒ¨è°ƒç”¨äº† forkï¼Œæ‰€ä»¥ argv å’Œ envp çš„ä¼ é€’æ˜¯åœ¨ fork ä¹‹å‰ã€‚ï¼ˆè®¾æƒ³å¦‚æœæ˜¯åœ¨ fork ä¹‹åä¼ é€’ï¼Œå¯èƒ½ä¼šå‡ºç° fork å child process å…ˆæ‰§è¡Œï¼Œè¿™ç§æƒ…å†µ child process æ˜¾ç„¶æ— æ³•è·å¾—è¿™äº›è¢«ä¼ é€’çš„ä¿¡æ¯ï¼‰ æ³¨æ„åˆ° execve åªä¼ é€’äº† argv è€Œæ²¡æœ‰ä¼ é€’ argcï¼Œè¿™ä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼Œargc æ˜¯ argv çš„è®¡æ•°ï¼Œåªéœ€ argv å³å¯æ¨å¯¼å‡º argcã€‚ ","date":"2024-01-14","objectID":"/posts/c-pointer/:4:2","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"Function Pointer å±é™© ä¸ Array ç±»ä¼¼ï¼ŒFunction åªæœ‰åœ¨è¡¨ç¤ºè‡ªèº«æ—¶ä¸ä¼šè¢« converted to Function Pointer (å³é™¤ sizeof å’Œ \u0026 è¿ç®—ä¹‹å¤–)ï¼Œå…¶å®ƒæƒ…å†µã€è¿ç®—æ—¶éƒ½ä¼šè¢« convert to Function Pointer ç†è§£ C è¯­è¨€ä¸­çš„ Function ä»¥åŠ Function Pointer çš„æ ¸å¿ƒåœ¨äºç†è§£ Function Designator è¿™ä¸ªæ¦‚å¿µï¼Œå‡½æ•°åå­—å¿…ç„¶æ˜¯ Function Designatorï¼Œå…¶å®ƒçš„ designator åˆ™æ˜¯æ ¹æ®ä»¥ä¸‹ä¸¤æ¡è§„åˆ™è¿›è¡Œæ¨å¯¼å¾—æ¥ã€‚ C99 [ 6.3.2.1 ] A function designator is an expression that has function type. Except when it is the operand of the sizeof operator or the unary \u0026 operator, a function designator with type â€˜â€˜function returning typeâ€™â€™ is converted to an expression that has type â€˜â€˜pointer to function returning typeâ€™â€™. C99 [6.5.3.2-4] The unary * operator denotes indirection. If the operand points to a function, the result is a function designator. ","date":"2024-01-14","objectID":"/posts/c-pointer/:5:0","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"æŒ‡é’ˆçš„ä¿®é¥°ç¬¦ æŒ‡é’ˆ p è‡ªèº«ä¸èƒ½å˜æ›´ï¼Œæ—¢ä¸èƒ½æ”¹å˜ p è‡ªèº«æ‰€å­˜å‚¨çš„åœ°å€ã€‚const åœ¨ * ä¹‹åï¼š char * const p; æŒ‡é’ˆ p æ‰€æŒ‡å‘çš„å†…å®¹ä¸èƒ½å˜æ›´ï¼Œå³ä¸èƒ½é€šè¿‡ p æ¥æ›´æ”¹æ‰€æŒ‡å‘çš„å†…å®¹ã€‚const åœ¨ * ä¹‹å‰ï¼š const char * p; char const * p; æŒ‡é’ˆ p è‡ªèº«äºæ‰€æŒ‡å‘çš„å†…å®¹éƒ½ä¸èƒ½å˜æ›´ï¼š const char * const p; char const * const p; ","date":"2024-01-14","objectID":"/posts/c-pointer/:6:0","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"å­—ç¬¦ä¸² å¯¹äºå‡½æ•°å†…éƒ¨çš„ char *p = \"hello\"; char p[] = \"hello\"; è¿™ä¸¤ä¸ªæ˜¯ä¸ä¸€æ ·çš„ï¼Œå› ä¸º string literals æ˜¯å¿…é¡»æ”¾åœ¨ â€œstatic storageâ€ ä¸­ï¼Œè€Œ char p[] åˆ™è¡¨ç¤ºå°†èµ„æ–™åˆ†é…åœ¨ stack å…§ï¼Œæ‰€ä»¥è¿™ä¼šé€ æˆç¼–è¯‘å™¨éšå¼åœ°ç”Ÿæˆé¢å¤–ä»£ç ï¼Œåœ¨æ‰§è¡Œæ—¶ (runtime) å°† string literals ä» static storage æ‹·è´åˆ° stack ä¸­ï¼Œæ‰€ä»¥æ­¤æ—¶ return p ä¼šé€ æˆ UBã€‚è€Œ char *p çš„æƒ…å½¢ä¸åŒï¼Œæ­¤æ—¶ p åªæ˜¯ä¸€ä¸ªæŒ‡å‘ static storage çš„æŒ‡é’ˆï¼Œè¿›è¡Œ return p æ˜¯åˆæ³•çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ— æ³•å¯¹ç¬¬ä¸€ç§æ–¹æ³•çš„å­—ç¬¦ä¸²è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œå› ä¸ºå®ƒæŒ‡å‘çš„å­—ç¬¦ä¸²å­˜æ”¾çš„åŒºåŸŸçš„èµ„æ–™æ˜¯æ— æ³•ä¿®æ”¹çš„ï¼Œå¦åˆ™ä¼šé€ æˆ segmentationfalut ğŸ¤£ åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œnull pointer å¹¶ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åœ¨ glibc ä¸­å­—ç¬¦ç›¸å…³çš„å¤§éƒ¨åˆ†å‡½æ•°ä¹Ÿä¸ä¼šå¯¹ null pointer è¿›è¡Œç‰¹åˆ¤ (ç‰¹åˆ¤ä¼šå¢åŠ åˆ†æ”¯ï¼Œä»è€Œå½±å“ç¨‹åºæ•ˆèƒ½)ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨è¿™äº›å‡½æ•°æ—¶éœ€è¦ç”¨æˆ·è‡ªå·±åˆ¤æ–­æ˜¯å¦ä¸º null pointerï¼Œå¦åˆ™ä¼šé€ æˆ UBã€‚ ","date":"2024-01-14","objectID":"/posts/c-pointer/:7:0","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"Linus çš„â€œæ•™å¯¼â€ Linus è¦ªè‡ªæ•™ä½  C èªè¨€ array argument çš„ä½¿ç”¨ because array arguments in C donâ€™t actually exist. Sadly, compilers accept it for various bad historical reasons, and silently turn it into just a pointer argument. There are arguments for them, but they are from weak minds. The â€œarray as function argumentâ€ syntax is occasionally useful (particularly for the multi-dimensional array case), so I very much understand why it exists, I just think that in the kernel weâ€™d be better off with the rule that itâ€™s against our coding practices. array argument åº”è¯¥åªç”¨äºå¤šç»´æ•°ç»„ (multi-dimensional arrays) çš„æƒ…å½¢ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä½¿ç”¨ä¸‹æ ‡è¡¨ç¤ºæ—¶ offset æ˜¯æ­£ç¡®çš„ï¼Œä½†å¯¹äºä¸€ç»´æ•°ç»„åˆ™ä¸åº”è¯¥ä½¿ç”¨æ•°ç»„è¡¨ç¤ºä½œä¸ºå‡½æ•°å‚æ•°ï¼Œå› ä¸ºè¿™ä¼šå¯¹å‡½æ•°ä½“å†…çš„ sizeof ç”¨æ³•è¯¯è§£ (ä»¥ä¸ºä¼šè·å¾—æ•°ç»„çš„ sizeï¼Œå®é™…ä¸Šè·å¾—çš„åªæ˜¯æŒ‡é’ˆçš„ size)ã€‚ æŠ€å·§ ä¸€ä¸ªå¸¸ç”¨äºè®¡ç®—æ•°ç»„ä¸­å…ƒç´ ä¸ªæ•°çš„å®ï¼š #define ARRAY_SIZE(x) (sizeof(x) / sizeof((x)[0])) è¿™ä¸ªå®éå¸¸æœ‰ç”¨ï¼Œxv6 ä¸­ä½¿ç”¨åˆ°äº†è¿™ä¸ªå®ã€‚ ä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œä½¿ç”¨æ—¶å¿…é¡»ä¿è¯ x æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè€Œä¸æ˜¯å‡½æ•°å‚æ•°ä¸­ç”±æ•°ç»„é€€åŒ–è€Œæ¥çš„æŒ‡é’ˆï¼Œä»¥åŠä¿è¯æ•°ç»„å¿…é¡»è‡³å°‘æ‹¥æœ‰ä¸€ä¸ªå…ƒç´ çš„é•¿åº¦ (è¿™ä¸ªå¾ˆå®¹æ˜“æ»¡è¶³ï¼Œæ¯•ç«Ÿ x[0] ç¼–è¯‘å™¨ä¼šæŠ›å‡ºè­¦å‘Š)ã€‚ ","date":"2024-01-14","objectID":"/posts/c-pointer/:8:0","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["C","Linux Kernel Internals"],"content":"Lvalue \u0026 Rvalue Lvalue: locator value Rvalue: Read-only value C99 6.3.2.1 footnote The name â€œlvalueâ€ comes originally from the assignment expression E1 = E2, in which the left operand E1 is required to be a (modifiable) lvalue. It is perhaps better considered as representing an object â€œlocator valueâ€. What is sometimes called â€œrvalueâ€ is in this International Standard described as the â€œvalue of an expressionâ€. An obvious example of an lvalue is an identifier of an object. As a further example, if E is a unary expression that is a pointer to an object, *E is an lvalue that designates the object to which E points. å³åœ¨ C è¯­è¨€ä¸­ lvalue æ˜¯å¿…é¡»èƒ½åœ¨å†…å­˜ (memory) ä¸­å¯ä»¥å®šä½ (locator) çš„ä¸œè¥¿ï¼Œå› ä¸ºå¯ä»¥å®šä½ (locator) æ‰€ä»¥æ‰å¯ä»¥åœ¨è¡¨è¾¾å¼å·¦è¾¹ä»è€Œä¿®æ”¹å€¼ã€‚æƒ³åƒä¸€ä¸‹ï¼Œåœ¨ C è¯­è¨€ä¸­ä¿®æ”¹ä¸€ä¸ªå¸¸æ•°çš„å€¼æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºå¸¸æ•°æ— æ³•åœ¨å†…å­˜ (memory) å®šä½ (locator) æ‰€ä»¥å¸¸æ•°åœ¨ C è¯­è¨€ä¸­ä¸æ˜¯ lvalueã€‚C è¯­è¨€ä¸­é™¤äº† lvalue ä¹‹å¤–çš„ value éƒ½æ˜¯ rvalue (è¿™ä¸ C++ æœ‰äº›ä¸åŒï¼ŒC++ çš„ lvalue å’Œ rvalue çš„å®šä¹‰è¯·å‚è€ƒ C++ çš„è§„æ ¼ä¹¦)ã€‚ ","date":"2024-01-14","objectID":"/posts/c-pointer/:9:0","tags":["Sysprog","C","Pointer"],"title":"ä½ æ‰€ä¸çŸ¥é“çš„ C è¯­è¨€: æŒ‡é’ˆç¯‡","uri":"/posts/c-pointer/"},{"categories":["Network"],"content":"ä¹‹å‰å­¦æ ¡çš„è®¡ç½‘ç†è®ºè¯¾å­¦å¾—äº‘é‡Œé›¾é‡Œï¼Œå¯¹äºç‰©ç†å±‚å’Œæ•°æ®é“¾è·¯å±‚å¹¶æ²¡æœ‰æ¸…æ™°çš„é€»è¾‘æ¡†æ¶ï¼Œè€Œè¿™å­¦æœŸçš„è®¡ç½‘è¯¾è®¾å†…å®¹ä¸ºæ•°æ®é“¾è·¯å±‚å’Œç½‘ç»œå±‚çš„ç›¸å…³å†…å®¹ï¼Œå†™èµ·æ¥è¿˜æ˜¯äº‘é‡Œé›¾é‡Œã€‚è™½ç„¶æœ€ç»ˆè‰°éš¾åœ°æŠŠè¯¾è®¾æ°´è¿‡å»äº†ï¼Œä½†æ˜¯ä¸ªäººè®¤ä¸ºç½‘ç»œå¯¹äº CSer éå¸¸é‡è¦ï¼Œç‰¹åˆ«æ˜¯åœ¨äº’è”ç½‘è¡Œä¸šï¼Œç½‘ç»œçŸ¥è¯†æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ æ‰€ä»¥å†³å®šå¯’å‡é‡å­¦è®¡ç½‘ï¼Œäºæ˜¯åœ¨ HackMD ä¸Šå†²æµªå¯»æ‰¾ç›¸å…³èµ„æ–™ã€‚ç„¶åå‘ç°äº†è¿™ç¯‡ç¬”è®° 110-1 è¨ˆç®—æ©Ÿç¶²è·¯ (æ¸…å¤§é–‹æ”¾å¼èª²ç¨‹)ï¼Œé‡Œé¢æåˆ°æ¸…å¤§è®¡ç½‘ä¸»è¦ä»‹ç» L2 ~ L4 ä¸€äº›è‘—åçš„åè®®å’Œç®—æ³•ï¼Œè¿™å®Œç¾ç¬¦åˆä¸ªäººçš„éœ€æ±‚ï¼Œè€Œä¸”è¯¥ç¬”è®°è¿˜è¡¥å……äº†ä¸€äº›é¢å¤–çš„å†…å®¹ï¼Œä¾‹å¦‚ IPv6ï¼Œæ‰€ä»¥å½“å³å†³å®šæ­é…è¿™ç¯‡ç¬”è®°æ¥å­¦ä¹ æ¸…å¤§çš„è®¡ç®—æœºç½‘ç»œæ¦‚è®ºã€‚ ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:0:0","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"æ¸…å¤§è®¡ç®—æœºç½‘ç»œæ¦‚è®º æœ¬èª²ç¨‹å°‡ä»‹ç´¹è¨ˆç®—æ©Ÿç¶²è·¯çš„åŸºæœ¬é‹ä½œåŸç†èˆ‡æ¨™æº–çš„ç¶²è·¯ä¸ƒå±¤çµæ§‹,ç”±æ·ºå…¥æ·±,å¯ä»¥è®“æˆ‘å€‘å°æ–¼è¨ˆç®—æ©Ÿç¶²è·¯çš„é‹ä½œæœ‰æœ€åŸºæœ¬çš„èªè­˜,æœ¬èª²ç¨‹é‚„æœƒä»‹ç´¹å…¨çƒå»ºç½®æœ€å¤šçš„æœ‰ç·šç¶²è·¯â”€â”€IEEE 802.3 Ethernet çš„åŸºæœ¬é‹ä½œåŸç†, é‚„æœ‰å…¨çƒå»ºç½®æœ€å¤šçš„ç„¡ç·šå€åŸŸç¶²è·¯â”€â”€IEEE 802.11 Wireless LAN çš„åŸºæœ¬é‹ä½œåŸç†, æƒ³çŸ¥é“ç¶²è·¯äº¤æ›æ©Ÿ(switches) æ˜¯å¦‚ä½•é‹ä½œçš„å— ? æƒ³çŸ¥é“ç¶²éš›ç¶²è·¯æœ€é‡è¦ä¹Ÿæœ€é—œéµçš„é€šè¨Šå”è­° â”€â”€ TCP/IP æ˜¯å¦‚ä½•é‹ä½œçš„å— ? æƒ³çŸ¥é“ç¶²éš›ç¶²è·¯æœ€é‡è¦çš„è·¯ç”±å™¨ (Routers) æ˜¯å¦‚ä½•é‹ä½œçš„å— ? åœ¨æœ¬èª²ç¨‹è£¡æ‚¨éƒ½å¯ä»¥å­¸åˆ°é€™äº›é‡è¦çš„åŸºæœ¬çŸ¥è­˜ã€‚ å¼€è¯¾å­¦æ ¡ è¯¾ç¨‹ä¸»é¡µ è¯¾ç¨‹èµ„æ–™ è¯¾ç¨‹å½±ç‰‡ åœ‹ç«‹æ¸…è¯å¤§å­¸ è¨ˆç®—æ©Ÿç¶²è·¯æ¦‚è«– èª²ç¨‹è¬›ç¾©èˆ‡ç·´ç¿’é¡Œ Youtube ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:1:0","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"L1: Foundation Outline: Applications Network Connectivity Network Architecture Network Performance ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:2:0","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"Applications Foundation - 5 è¿›è¡Œ 1 æ¬¡ URL request éœ€è¦è¿›è¡Œ 17 æ¬¡çš„è®¯æ¯äº¤æ¢ï¼š 6 æ¬¡è®¯æ¯äº¤æ¢ç”¨äºæŸ¥è¯¢ URL å¯¹åº”çš„ IP Address 3 æ¬¡è®¯æ¯äº¤æ¢ç”¨äºå»ºç«‹ TCP è¿æ¥ï¼ˆTCP çš„ 3 æ¬¡æ¡æ‰‹ï¼‰ 4 æ¬¡è®¯æ¯äº¤æ¢ç”¨äº HTTP åè®®çš„è¯·æ±‚å’Œå›å¤ 4 æ¬¡è®¯æ¯äº¤æ¢ç”¨äºå…³é—­ TCP è¿æ¥ï¼ˆTCP çš„ 4 æ¬¡æ¡æ‰‹ï¼‰ ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:2:1","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"Network Connectivity Foundation - 8 äº¤æ¢æœº (Switches) å¯ä»¥åˆ†ä¸ºå¾ˆå¤šå±‚çº§ï¼Œå³å¯ä»¥æœ‰ä¸åŒå±‚çº§çš„äº¤æ¢æœºï¼Œä¾‹å¦‚ L2 å±‚çš„äº¤æ¢æœºï¼ŒL3 å±‚çš„äº¤æ¢æœºä»¥åŠ L4 å±‚çš„äº¤æ¢æœºã€‚å¦‚ä½•åˆ¤æ–­äº¤æ¢æœºæ˜¯å“ªä¸ªå±‚çº§ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦æ ¹æ®äº¤æ¢æœºæ‰€å¤„ç†çš„è®¯æ¯ï¼ŒL2 å±‚äº¤æ¢æœºå¤„ç†çš„æ˜¯ MAC Addressï¼ŒL3 å±‚äº¤æ¢æœºå¤„ç†çš„æ˜¯ IP Addressï¼Œè€Œ L4 å±‚äº¤æ¢æœºå¤„ç†çš„æ˜¯ TCP æˆ–è€… UDP ç›¸å…³çš„è®¯æ¯ã€‚ äº¤æ¢æœº (Switches) ç”¨äºç½‘ç»œ (Network) å†…éƒ¨çš„è¿æ¥ï¼Œè·¯ç”± (Router) ç”¨äºè¿æ¥ä¸åŒçš„ç½‘ç»œ (Network)ï¼Œä»è€Œå½¢æˆ Internetworkã€‚ åœ°å€ (Address)ï¼Œå¯¹äºç½‘å¡æ¥è¯´æ˜¯æŒ‡ MAC Addressï¼Œå¯¹äºä¸»æœºæ¥è¯´æ˜¯æŒ‡ IP Addressã€‚Host-to-Host connectivity æ˜¯æŒ‡ä¸åŒç½‘ç»œ (Network) çš„ä¸»æœºï¼Œå³ä½äº Internetwork çš„ä¸åŒä¸»æœºä¹‹é—´ï¼Œè¿›è¡Œè¿æ¥ã€‚ ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:2:2","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"Network Architecture Foundation - 22 Physical Layer: å¦‚ä½•å°†åŸå§‹èµ„æ–™åœ¨ link ä¸Šä¼ è¾“ï¼Œä¾‹å¦‚ä¸åŒä»‹è´¨ã€ä¿¡æ¯ç¼–ç ã€‚(P25) Data Link Layer: åœ¨ Physical Layer åŸºç¡€ä¸Šï¼Œå¦‚ä½•å°† frame ä¼ ç»™ç›´æ¥ç›¸è¿çš„ä¸»æœºæˆ–è®¾å¤‡ï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡ Media Access Control Protocol è§£å†³ Multiple access äº§ç”Ÿçš„ç¢°æ’é—®é¢˜ã€‚è¿™ä¸€å±‚äº¤æ¢çš„æ•°æ®è¢«ç§°ä¸º frameã€‚(P26) Network Layer: åœ¨ Data Link Layer åŸºç¡€ä¸Šï¼Œå¦‚ä½•å°† packet é€šè¿‡ Internet é€ç»™ç›®çš„åœ°ä¸»æœºã€‚æ ¸å¿ƒæ˜¯é€šè¿‡ Routing Protocols åŠ¨æ€è½¬å‘ packetã€‚è¿™ä¸€å±‚äº¤æ¢çš„æ•°æ®è¢«ç§°ä¸º packetã€‚(P27) Transport Layer: åœ¨ Network Layer åŸºç¡€ä¸Šï¼Œæä¾›ä¸åŒä¸»æœº processes ä¹‹é—´çš„èµ„æ–™ä¼ é€ã€‚ç”±äº Networkd Layer æ˜¯ä¸»æœºé—´è¿›è¡Œèµ„æ–™ä¼ é€ï¼Œæ‰€ä»¥åœ¨ Transport Layer ä¸è®ºæ˜¯å¯é è¿˜æ˜¯ä¸å¯é çš„ä¼ è¾“åè®®ï¼Œéƒ½å¿…é¡»è¦å®ç°æœ€åŸºæœ¬çš„æœºåˆ¶ï¼šä¸»æœºä¸ process ä¹‹é—´æ•°æ®çš„å¤ç”¨å’Œåˆ†è§£ã€‚è¿™ä¸€å±‚äº¤æ¢çš„æ•°æ®è¢«ç§°ä¸º messageã€‚(P28) æ³¨æ„ Switch ä¸€èˆ¬å¤„äº L2 Layerï¼ŒRouter ä¸€èˆ¬å¤„äº L3 Layerã€‚L4 Layer åŠä»¥ä¸Šçš„ layers é€šå¸¸åªå­˜åœ¨äº hostsï¼Œswitches å’Œ routers å†…éƒ¨ä¸€èˆ¬ä¸å…·æœ‰è¿™äº› layersã€‚(P29) Internet Architecture çš„å±‚çº§å¹¶ä¸æ˜¯ä¸¥æ ¼çš„ï¼ŒHost å¯ä»¥ç•¥è¿‡ Application Layer è€Œç›´æ¥ä½¿ç”¨ Transport Layerã€Network Layer ä¸­çš„åè®®ã€‚(P30) Internet Architecture çš„æ ¸å¿ƒæ˜¯ IP åè®®ï¼Œå®ƒä½œä¸ºæ²™æ¼å½¢çŠ¶çš„ä¸­å¿ƒä½ç½®ï¼Œä¸ºå¤„äºå…¶ä¸Šå±‚çš„åè®®ä¸å¤„äºå…¶ä¸‹å±‚åè®®ä¹‹é—´æä¾›äº†ä¸€ä¸ªæ˜ å°„å…³ç³»ã€‚(P31) ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:2:3","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"Network Performance Foundation - 36 Foundation - 37 Bandwidth: Number of bits per second (P34) Delay å¯ä»¥è¿‘ä¼¼ç†è§£ä¸º Propagation timeã€‚æœ‰æ•ˆåˆ©ç”¨ network çš„æ ‡å¿—æ˜¯åœ¨æ¥æ”¶å¯¹æ–¹çš„å›åº”ä¹‹å‰ï¼Œå‘é€æ–¹ä¼ é€çš„èµ„æ–™å……æ»¡äº† pipeï¼Œå³å‘é€äº† Delay $\\times$ Bandwitdh bits çš„èµ„æ–™é‡ã€‚(P39) Foundation - 40 RTT å¯ä»¥è¿‘ä¼¼ç†è§£ä¸º 2 $\\times$ Propagation timeï¼Œå› ä¸ºä¸€ä¸ªæ¥å›éœ€è¦ä» sender åˆ° recieverï¼Œå†ä» reciever åˆ° senderã€‚ ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:2:4","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"Homework Redis ä½œè€… Salvatore Sanfilippo çš„èŠå¤©å®¤é¡¹ç›®: smallchatï¼Œé€šè¿‡è¯¥é¡¹ç›®å¯ä»¥å…¥é—¨å­¦ä¹ ç½‘ç»œç¼–ç¨‹ (Network Programming)ï¼Œè¯·å¤ç°è¯¥é¡¹ç›®ã€‚ Salvatore Sanfilippo åœ¨ YouTube ä¸Šå¯¹ smallchat çš„è®²è§£ï¼š Smallchat intro smallchat client \u0026 raw line input GitHub ä¸Šä¹Ÿæœ‰ä½¿ç”¨ Go å’Œ Rust å®ç°è¯¥é¡¹ç›®çš„ä»“åº“ï¼Œå¦‚æœä½ å¯¹ Go æˆ– Rust çš„ç½‘ç»œç¼–ç¨‹ (Network Programming) æ„Ÿå…´è¶£ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªä»“åº“ã€‚ ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:2:5","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"L2: IEEE 802.3 Ethernet Outline: Introduction Ethernet Topologies Ethernet Frame Format Ethernet MAC Protocol â€“ CSMA/CD 802.3 Ethernet Standards Summary: MAC Protocol â€“ CSMA/CD Connection less, unreliable transmission Topology from Bus to Star (switches) Half-duplex transmission in Bus topology Work best under lightly loaded conditions Too much collision under heavy load Full-duplex transmission in Switch topology (point-to-point) No more collisions !! Excellent performance (wired speed) ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:3:0","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"Introduction Ethernet - 03 Ethernet å‘å±•è¿‡ç¨‹: ä¼ è¾“é€Ÿåº¦ä» 10Mb å‘å±•åˆ° 100Gb (P4) Ethernet çš„ç‰¹ç‚¹: Unreliable, Connectionless, CSMA/CD (P5) ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:3:1","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"Ethernet Topologies Ethernet - 07 Ethernet - 18 10Base5: 10Mbps, segment up to 500m (P8) 10Base2: 10Mbps, segment up to 200m (P8) 10BaseT: 10Mbps, Twisted pair, segment up to 100m (P16) Repeater, Hub éƒ½æ˜¯ physical layer çš„è®¾å¤‡ï¼Œåªè´Ÿè´£ è½¬å‘ä¿¡å·ï¼Œæ— æ³•é˜²æ­¢ collision (P12, P16) Switch åˆ™æ˜¯ data-link layer çš„è®¾å¤‡ï¼Œå†…ç½®èŠ¯ç‰‡è¿›è¡Œ æ•°æ®è½¬å‘ï¼Œå¯ä»¥é˜²æ­¢ collision (P19) Manchester Encoding (P11): Ethernet ä¸‹å±‚çš„ physical layer ä½¿ç”¨çš„ç¼–ç æ–¹å¼æ˜¯ Manchester Encoding: åœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…ï¼Œä¿¡å·ä»ä½åˆ°é«˜è¡¨ç¤º 1ï¼Œä»é«˜åˆ°ä½è¡¨ç¤º 0 æ³¨æ„ Manchester Encoding å‘é€æ–¹åœ¨è¿›è¡Œæ•°æ®ä¼ è¾“ä¹‹å‰éœ€è¦å‘é€ä¸€äº› bits æ¥è¿›è¡Œæ—¶é’ŸåŒæ­¥ (ä¾‹å¦‚ P22 çš„ Preamble éƒ¨åˆ†)ï¼Œæ¥æ”¶æ–¹å®Œæˆæ—¶é’ŸåŒæ­¥åï¼Œå¯ä»¥å¯¹ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸè¿›è¡Œä¸¤æ¬¡é‡‡æ ·ï¼šä¸€æ¬¡å‰åŠæ®µï¼Œä¸€æ¬¡ååŠæ®µï¼Œç„¶åå¯ä»¥é€šè¿‡ä¸¤æ¬¡å–æ ·ç”µä½ä¿¡å·çš„å˜åŒ–æ¥è·å–å¯¹åº”çš„ bit (ä½åˆ°é«˜è¡¨ç¤º 1ï¼Œé«˜åˆ°ä½è¡¨ç¤º 0)ã€‚ æœ‰äº›è¯»è€…å¯èƒ½ä¼šç–‘æƒ‘ï¼Œæ—¢ç„¶éƒ½è¿›è¡Œæ—¶é’ŸåŒæ­¥äº†ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨é«˜ç”µä½ä¿¡å·è¡¨ç¤º 1ï¼Œä½ç”µä½ä¿¡å·è¡¨ç¤º 0 è¿™æ ·ç›´è§‚çš„ç¼–ç æ–¹å¼ï¼Ÿè¿™æ˜¯å› ä¸ºå¦‚æœé‡‡å–è¿™ç§ç¼–ç æ–¹å¼ï¼Œé‚£ä¹ˆåœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…ä¿¡å·ä¸ä¼šæœ‰å˜åŒ–ï¼Œå¦‚æœæ¥æ”¶çš„æ˜¯ä¸€ç³»åˆ—çš„ 1 æˆ– 0ï¼Œä¿¡å·ä¹Ÿä¸ä¼šå˜åŒ–ã€‚è¿™æ ·å¯èƒ½ä¼šå¯¼è‡´æ¼é‡‡æ ·ï¼Œæˆ–è€…ç¼–ç å‡ºé”™å´æ— æ³•åŠæ—¶ä¾¦æµ‹ã€‚è€Œé‡‡ç”¨ Manchester Encoding æ¥æ”¶æ–¹æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸå†…ä¿¡å·éƒ½ä¼šå˜åŒ–ï¼Œå¦‚æœæ¥æ”¶æ–¹åœ¨ä¸€æ¬¡æ—¶é’Ÿå‘¨æœŸå†…çš„ä¸¤æ¬¡é‡‡æ ·ï¼Œä¿¡å·æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå¯ä»¥ç«‹å³ä¾¦æµ‹åˆ°å‡ºé”™äº† (è¦ä¹ˆæ˜¯æ¼é‡‡æ ·äº†ï¼Œè¦ä¹ˆæ˜¯ç¼–ç å‡ºé”™äº†)ã€‚ ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:3:2","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"Ethernet Frame Format Ethernet - 23 é™¤å¼€ Preamble, SFD ä¹‹å¤–ï¼Œä¸€ä¸ª Frame çš„å¤§å°ä¸º $64 \\sim 1518$ bytesã€‚å› ä¸º DA, SA, TYPE, FCS å æ®äº† $6 + 6 + 2 + 4 = 18$ bytesï¼Œæ‰€ä»¥ Data éƒ¨åˆ†çš„å¤§å°ä¸º $48 ~\\sim 1500$ bytes (P43) MAC Address æ˜¯ unique å¹¶ä¸”æ˜¯ä¸ Adaptor ç›¸å…³çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªä¸»æœºå¯èƒ½æ²¡æœ‰ MAC Address (æ²¡æœ‰ Adaptor)ï¼Œå¯èƒ½æœ‰ä¸¤ä¸ª MAC Address (æœ‰ä¸¤ä¸ª Adaptor)ã€‚MAC Address æ˜¯ç”± Adaptor çš„ç”Ÿäº§å•†æ¥å†³å®šçš„ã€‚(P24) unicast address, broadcast address, multicast address (P26) ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:3:3","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"CSMA/CD Ethernet - 46 Ethernet - 41 Ethernet - 45 Ethernet - 49 å…³äº CSMA/CD çš„è¯¦ç»†ä»‹ç»å¯ä»¥æŸ¥çœ‹ P34 ~ P38 å…³äº Ethernet Frame çš„å¤§å°é™åˆ¶è®¾è®¡å¯ä»¥æŸ¥çœ‹ P39 ~ P43 å…³äº CSMA/CD Collision Handling çš„ç­–ç•¥æœºåˆ¶å¯ä»¥æŸ¥çœ‹ P44 ~ P45, P47 ~ P48 æ³¨æ„ Host åœ¨ detect collision ä¹‹åè¿›è¡Œ backoff random delayï¼Œdelay ç»“æŸåæŒ‰ç…§ 1-persistent protocol (P35) ç»§ç»­ç­‰å¾…åˆ° busy channel goes idle åç«‹åˆ»è¿›è¡Œä¼ è¾“ã€‚ ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:3:4","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"Homework ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:3:5","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"L3: IEEE 802.11 Wireless LAN æ— çº¿ç½‘ç»œè¿™ç« å¤ªéš¾äº†ï¼Œæˆ˜æœ¯æ€§æ”¾å¼ƒ ","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:4:0","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["Network"],"content":"L4: IEEE 802.1D Spanning Tree Algorithm","date":"2024-01-14","objectID":"/posts/nthu-computer-network/:5:0","tags":["Network"],"title":"å›½ç«‹æ¸…åå¤§å­¦ è®¡ç®—æœºç½‘ç»œæ¦‚è®º é‡ç‚¹æç¤º","uri":"/posts/nthu-computer-network/"},{"categories":["C"],"content":"C è¯­è¨€è§„æ ¼ä¹¦ Chapter 6 - Language é˜…è¯»è®°å½•ã€‚ ","date":"2024-01-11","objectID":"/posts/c-spec-ch6/:0:0","tags":["C","Sysprog"],"title":"C è§„æ ¼ç¬¬ 6 ç«  Language","uri":"/posts/c-spec-ch6/"},{"categories":["C"],"content":"6.2 Concepts ","date":"2024-01-11","objectID":"/posts/c-spec-ch6/:1:0","tags":["C","Sysprog"],"title":"C è§„æ ¼ç¬¬ 6 ç«  Language","uri":"/posts/c-spec-ch6/"},{"categories":["C"],"content":"6.2.2 Linkages of identifiers linkage: external internal none ä¸€ä¸ªæ‹¥æœ‰ file scope å¹¶ä¸”å…³äº object æˆ– function çš„ identifier å£°æ˜ï¼Œå¦‚æœä½¿ç”¨ static ä¿®é¥°ï¼Œåˆ™è¯¥ identifer æœ‰ internal linkageï¼Œe.g. // file scope static int a; static void f(); int main() {} ä¸€ä¸ª scope å†…ä½¿ç”¨ static ä¿®é¥°çš„ identifier å£°æ˜ï¼Œå¦‚æœåœ¨åŒä¸€ scope å†…å·²å­˜åœ¨è¯¥ identifier å£°æ˜ï¼Œåˆ™è¯¥ identifier çš„ linkage å–å†³äºå…ˆå‰çš„ identifier å£°æ˜ã€‚å¦‚æœè¯¥ identifier ä¸å­˜åœ¨å…ˆå‰å£°æ˜æˆ–è€…å…ˆå‰å£°æ˜ no linkageï¼Œåˆ™è¯¥ identifier æ˜¯ external linkageï¼Œe.g. // Example 1 static int a; // a is internal linkage extern int a; // linkage is the same as prior // Example 2 extern int b; // no prior, a is external linkage extern int b; // linkage is the same as prior å¦‚æœä¸€ä¸ª function identifier å£°æ˜æ²¡æœ‰ storage-class ä¿®é¥°ç¬¦ï¼Œåˆ™å…¶ linkage ç­‰ä»·äºåŠ ä¸Š extern ä¿®é¥°çš„å£°æ˜çš„ linkageï¼Œe.g. int func(int a, int b); // equal to `extern int func(int a. int b);` // and then no prior, it is external linkage å¦‚æœä¸€ä¸ª object identifier å£°æ˜æ²¡æœ‰ storage-class ä¿®é¥°ç¬¦ï¼Œä¸”æ‹¥æœ‰ file scopeï¼Œåˆ™å…¶æ‹¥æœ‰ external linkageï¼Œe.g. // file scope int a; // external linkage int main() {} ","date":"2024-01-11","objectID":"/posts/c-spec-ch6/:1:1","tags":["C","Sysprog"],"title":"C è§„æ ¼ç¬¬ 6 ç«  Language","uri":"/posts/c-spec-ch6/"},{"categories":["C"],"content":"6.5 Expressions ","date":"2024-01-11","objectID":"/posts/c-spec-ch6/:2:0","tags":["C","Sysprog"],"title":"C è§„æ ¼ç¬¬ 6 ç«  Language","uri":"/posts/c-spec-ch6/"},{"categories":["C"],"content":"6.5.3 Unary operators æ³¨æ„ C99 [6.2.5] Types There are three real floating types, designated as float, double, and long double. The real floating and complex types are collectively called the floating types. The integer and real floating types are collectively called real types. Integer and floating types are collectively called arithmetic types. A function type describes a function with specified return type. A function type is characterized by its return type and the number and types of its parameters. A function type is said to be derived from its return type, and if its return type is T, the function type is sometimes called â€˜â€˜function returning Tâ€™â€™. The construction of a function type from a return type is called â€˜â€˜function type derivationâ€™â€™. Arithmetic types and pointer types are collectively called scalar types. C99 [6.3.2.1] Lvalues, arrays, and function designators A function designator is an expression that has function type. Except when it is the operand of the sizeof operator or the unary \u0026 operator, a function designator with type â€˜â€˜function returning typeâ€™â€™ is converted to an expression that has type â€˜â€˜pointer to function returning typeâ€™â€™. 6.5.3.1 Prefix increment and decrement operators Constraints å‰ç¼€è‡ªå¢æˆ–è‡ªå‡è¿ç®—ç¬¦çš„æ“ä½œæ•°ï¼Œå¿…é¡»ä¸ºå®æ•° (real types) ç±»å‹ï¼ˆå³ä¸èƒ½æ˜¯å¤æ•°ï¼‰æˆ–è€…æ˜¯æŒ‡é’ˆç±»å‹ï¼Œå¹¶ä¸”å…¶å€¼æ˜¯å¯å˜çš„ã€‚ Semantics ++E ç­‰ä»·äº (E+=1) --E ç­‰ä»·äº (E-=1) 6.5.3.2 Address and indirection operators Constraints \u0026 è¿ç®—ç¬¦çš„æ“ä½œæ•°å¿…é¡»ä¸º function designatorï¼Œ[] æˆ– * çš„è¿ç®—ç»“æœï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªä¸æ˜¯ bit-field å’Œ register ä¿®é¥°çš„å·¦å€¼ã€‚ * è¿ç®—ç¬¦çš„æ“ä½œæ•°å¿…é¡»ä¸ºæŒ‡é’ˆç±»å‹ã€‚ Semantics \u0026*E ç­‰ä»·äº Eï¼Œå³ \u0026 å’Œ * è¢«ç›´æ¥å¿½ç•¥ï¼Œä½†æ˜¯å®ƒä»¬çš„ constraints ä»ç„¶èµ·ä½œç”¨ã€‚æ‰€ä»¥ (\u0026*(void *)0) å¹¶ä¸ä¼šæŠ¥é”™ã€‚ \u0026a[i] ç­‰ä»·äº a + iï¼Œå³å¿½ç•¥äº† \u0026 ä»¥åŠ * (ç”± [] éšå¼æŒ‡ä»£)ã€‚ å…¶å®ƒæƒ…å†µ \u0026 è¿ç®—çš„ç»“æœä¸ºä¸€ä¸ªæŒ‡å‘ object æˆ– function çš„æŒ‡é’ˆã€‚ å¦‚æœ * è¿ç®—ç¬¦çš„æ“ä½œæ•°æ˜¯ä¸€ä¸ªæŒ‡å‘ function çš„æŒ‡é’ˆï¼Œåˆ™ç»“æœä¸ºå¯¹åº”çš„ function designatorã€‚ å¦‚æœ * è¿ç®—ç¬¦çš„æ“ä½œæ•°æ˜¯ä¸€ä¸ªæŒ‡å‘ object çš„æŒ‡é’ˆï¼Œåˆ™ç»“æœä¸ºæŒ‡ç¤ºè¯¥ obejct çš„å·¦å€¼ã€‚ å¦‚æœ * è¿ç®—ç¬¦çš„æ“ä½œæ•°ä¸ºéæ³•å€¼çš„æŒ‡é’ˆï¼Œåˆ™å¯¹è¯¥æŒ‡é’ˆè¿›è¡Œ * è¿ç®—çš„è¡Œä¸ºä¸‰æœªå®šä¹‰çš„ã€‚ 6.5.3.3 Unary arithmetic operators Constraints å•ç›® + æˆ– - è¿ç®—ç¬¦çš„æ“ä½œæ•°å¿…é¡»ä¸ºç®—æ•°ç±»å‹ (arithmetic type)ï¼Œ~ è¿ç®—ç¬¦çš„æ“ä½œæ•°å¿…é¡»ä¸ºæ•´æ•°ç±»å‹ (integer type)ï¼Œ! è¿ç®—ç¬¦çš„æ“ä½œæ•°å¿…é¡»ä¸ºå¸¸æ•°ç±»å‹ (scalar type)ã€‚ Semantics åœ¨è¿›è¡Œå•ç›® +ã€-ã€~ è¿ç®—ä¹‹å‰ï¼Œä¼šå¯¹æ“ä½œæ•°è¿›è¡Œæ•´æ•°æå‡ (integer promotions)ï¼Œç»“æœçš„ç±»å‹ä¸æ“ä½œæ•°è¿›è¡Œæ•´æ•°æå‡åçš„ç±»å‹ä¸€è‡´ã€‚ !E ç­‰ä»·äº (E==0)ï¼Œç»“æœä¸º int ç±»å‹ã€‚ ","date":"2024-01-11","objectID":"/posts/c-spec-ch6/:2:1","tags":["C","Sysprog"],"title":"C è§„æ ¼ç¬¬ 6 ç«  Language","uri":"/posts/c-spec-ch6/"},{"categories":["C"],"content":"6.5.6 Additive operators ä»‹ç»åŠ å‡æ³•è¿ç®—ï¼Œå…¶ä¸­åŒ…æ‹¬äº†æŒ‡é’ˆçš„è¿ç®—ï¼ŒåŠ¡å¿…é˜…è¯»è¿™éƒ¨åˆ†å…³äºæŒ‡é’ˆè¿ç®—çš„æ ‡å‡†è¯´æ˜ã€‚ ","date":"2024-01-11","objectID":"/posts/c-spec-ch6/:2:2","tags":["C","Sysprog"],"title":"C è§„æ ¼ç¬¬ 6 ç«  Language","uri":"/posts/c-spec-ch6/"},{"categories":["C"],"content":"6.5.7 Bitwise shift operators Constraints ä½è¿ç®—çš„æ“ä½œæ•°éƒ½å¿…é¡»ä¸ºæ•´æ•°ç±»å‹ã€‚ Semantics åœ¨è¿›è¡Œä½è¿ç®—ä¹‹å‰ä¼šå…ˆå¯¹æ“ä½œæ•°è¿›è¡Œæ•´æ•°æå‡ (integer promotion)ï¼Œä½è¿ç®—ç»“æœç±»å‹ä¸æ•´æ•°æå‡åçš„å·¦æ“ä½œæ•°ä¸€è‡´ã€‚å¦‚æœå³è¿ç®—æ•°æ˜¯è´Ÿæ•°ï¼Œæˆ–è€…å¤§äºç­‰äºæ•´æ•°æå‡åçš„å·¦è¿ç®—æ•°çš„ç±»å‹çš„å®½åº¦ï¼Œé‚£ä¹ˆè¿™ä¸ªä½è¿ç®—è¡Œä¸ºæ˜¯æœªå®šä¹‰çš„ã€‚ å‡è®¾è¿ç®—ç»“æœçš„ç±»å‹ä¸º T $E1 \u003c\u003c E2$ å¦‚æœ E1 æ˜¯æ— ç¬¦å·ï¼Œåˆ™ç»“æœä¸º $E1 \\times 2^{E2} \\bmod (\\max[T] + 1)$ã€‚ å¦‚æœ E1 æ˜¯æœ‰ç¬¦å·ï¼ŒE1 ä¸æ˜¯è´Ÿæ•°ï¼Œå¹¶ä¸” T å¯ä»¥è¡¨ç¤º $E1 \\times 2^{E2}$ï¼Œåˆ™ç»“æœä¸º $E1 \\times 2^{E2}$ã€‚ é™¤äº†ä»¥ä¸Šä¸¤ç§è¡Œä¸ºå¤–ï¼Œå…¶ä»–å‡æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚ $E1 \u003e\u003e E2$ å¦‚æœ E1 æ˜¯æ— ç¬¦å·ï¼Œæˆ–è€… E1 æ˜¯æœ‰ç¬¦å·å¹¶ä¸”æ˜¯éè´Ÿæ•°ï¼Œåˆ™ç»“æœä¸º $E1 / 2^{E2}$ã€‚ å¦‚æœ E1 æ˜¯æœ‰ç¬¦å·å¹¶ä¸”æ˜¯è´Ÿæ•°ï¼Œåˆ™ç»“æœç”±å…·ä½“å®ç°å†³å®š (implementation-defined)ã€‚ ","date":"2024-01-11","objectID":"/posts/c-spec-ch6/:2:3","tags":["C","Sysprog"],"title":"C è§„æ ¼ç¬¬ 6 ç«  Language","uri":"/posts/c-spec-ch6/"},{"categories":["C"],"content":"C è¯­è¨€è§„æ ¼ä¹¦ Chapter 7 - Library é˜…è¯»è®°å½•ã€‚ ","date":"2024-01-11","objectID":"/posts/c-spec-ch7/:0:0","tags":["C","Sysprog"],"title":"C è§„æ ¼ç¬¬ 7 ç«  Library","uri":"/posts/c-spec-ch7/"},{"categories":["C"],"content":"7.18 Integer types \u003cstdint.h\u003e æè¿°äº†å¤´æ–‡ä»¶ stdint.h å¿…é¡»å®šä¹‰å’Œå®ç°çš„æ•´æ•°ç±»å‹ï¼Œä»¥åŠç›¸åº”çš„å®ã€‚ ","date":"2024-01-11","objectID":"/posts/c-spec-ch7/:1:0","tags":["C","Sysprog"],"title":"C è§„æ ¼ç¬¬ 7 ç«  Library","uri":"/posts/c-spec-ch7/"},{"categories":["C"],"content":"7.18.1 Integer types 7.18.1.1 Exact-width integer types äºŒè¡¥æ•°ç¼–ç ï¼Œå›ºå®šé•¿åº¦ N çš„æ•´æ•°ç±»å‹ï¼š æœ‰ç¬¦å·æ•°ï¼šintN_t æ— ç¬¦å·æ•°ï¼šuintN_t 7.18.1.2 Minimum-width integer types è‡³å°‘æ‹¥æœ‰é•¿åº¦ N çš„æ•´æ•°ç±»å‹ï¼š æœ‰ç¬¦å·æ•°ï¼šint_leastN_t æ— ç¬¦å·æ•°ï¼šuint_leastN_t 7.18.1.3 Fastest minimum-width integer types è‡³å°‘æ‹¥æœ‰é•¿åº¦ Nï¼Œä¸”æ“ä½œé€Ÿåº¦æœ€å¿«çš„æ•´æ•°ç±»å‹ï¼š æœ‰ç¬¦å·æ•°ï¼šint_fastN_t æ— ç¬¦å·æ•°ï¼šuint_fastN_t 7.18.1.4 Integer types capable of holding object pointers å¯ä»¥å°†æŒ‡å‘ void çš„æœ‰æ•ˆæŒ‡é’ˆè½¬æ¢æˆè¯¥æ•´æ•°ç±»å‹ï¼Œä¹Ÿå¯ä»¥å°†è¯¥æ•´æ•°ç±»å‹è½¬æ¢å›æŒ‡å‘ void çš„æŒ‡é’ˆç±»å‹ï¼Œå¹¶ä¸”è½¬æ¢ç»“æœä¸ä¹‹å‰çš„æŒ‡é’ˆå€¼ä¿æŒä¸€è‡´ï¼š æœ‰ç¬¦å·æ•°ï¼šintptr_t æ— ç¬¦å·æ•°ï¼šuintptr_t 7.18.1.5 Greatest-width integer types å¯ä»¥è¡¨ç¤ºä»»æ„æ•´æ•°ç±»å‹æ‰€è¡¨ç¤ºçš„å€¼çš„æ•´æ•°ç±»å‹ï¼Œå³å…·æœ‰æœ€å¤§é•¿åº¦çš„æ•´æ•°ç±»å‹ï¼š æœ‰ç¬¦å·æ•°ï¼šintmax_t æ— ç¬¦å·æ•°ï¼šuintmax_t ","date":"2024-01-11","objectID":"/posts/c-spec-ch7/:1:1","tags":["C","Sysprog"],"title":"C è§„æ ¼ç¬¬ 7 ç«  Library","uri":"/posts/c-spec-ch7/"},{"categories":["C","Linux Kernel Internals"],"content":"C è¯­è¨€è§„æ ¼ä¹¦é˜…è¯»å­¦ä¹ è®°å½•ã€‚ è§„æ ¼ä¹¦è‰æ¡ˆç‰ˆæœ¬ä¸º n1256ï¼Œå¯¹åº” C99 æ ‡å‡†ï¼Œå¯¹åº”çš„ PDF ä¸‹è½½åœ°å€ã€‚ ä¹Ÿé…åˆ C11 æ ‡å‡†æ¥é˜…è¯»ï¼Œè‰æ¡ˆç‰ˆæœ¬ n1570ï¼Œå¯¹åº”çš„ PDF ä¸‹è½½åœ°å€ã€‚ é˜…è¯»è§„æ ¼ä¹¦éœ€è¦ä¸€å®šçš„ä½“ç³»ç»“æ„ã€ç¼–è¯‘åŸç†çš„ç›¸å…³çŸ¥è¯†ï¼Œä½†ä¸éœ€è¦å¾ˆé«˜çš„ç¨‹åº¦ã€‚è¯·å–„ç”¨æ£€ç´¢å·¥å…·ï¼Œåœ¨é˜…è¯»è§„æ ¼ä¹¦æ—¶é‡åˆ°æœ¯è¯­æ—¶ï¼Œè¯·å…ˆåœ¨è§„æ ¼ä¹¦ä¸­è¿›è¡Œæ£€ç´¢ï¼Œå› ä¸ºæå¤§å¯èƒ½æ˜¯è§„æ ¼ä¹¦è‡ªå·±å®šä¹‰çš„æœ¯è¯­ã€‚ ","date":"2024-01-06","objectID":"/posts/c-specification/:0:0","tags":["C","Sysprog"],"title":"C è¯­è¨€è§„æ ¼ä¹¦ é˜…è¯»è®°å½•","uri":"/posts/c-specification/"},{"categories":["C","Linux Kernel Internals"],"content":"6. Language è¯¦è§ é˜…è¯»è®°å½• 6. Languageã€‚ ","date":"2024-01-06","objectID":"/posts/c-specification/:1:0","tags":["C","Sysprog"],"title":"C è¯­è¨€è§„æ ¼ä¹¦ é˜…è¯»è®°å½•","uri":"/posts/c-specification/"},{"categories":["C","Linux Kernel Internals"],"content":"7. Library è¯¦è§ é˜…è¯»è®°å½• 7. Libraryã€‚ ","date":"2024-01-06","objectID":"/posts/c-specification/:2:0","tags":["C","Sysprog"],"title":"C è¯­è¨€è§„æ ¼ä¹¦ é˜…è¯»è®°å½•","uri":"/posts/c-specification/"},{"categories":["Toolbox"],"content":"Git ä¸­æ–‡æ•™å­¦ æ–°æ‰‹å…¥é—¨æ¨èï¼Œå¯¹äº Git çš„å…¥é—¨æ“ä½œè®²è§£ååˆ†å‹å¥½ã€‚ è§†é¢‘åœ°å€ å­¦ä¹ è®°å½• ","date":"2024-01-04","objectID":"/posts/git/:1:0","tags":["Git","GitHub"],"title":"Git/GitHub èµ„æºä¸é—®é¢˜æ±‡æ€»","uri":"/posts/git/"},{"categories":["Toolbox"],"content":"Git å¸¸è§é—®é¢˜åŠè§£å†³ ","date":"2024-01-04","objectID":"/posts/git/:2:0","tags":["Git","GitHub"],"title":"Git/GitHub èµ„æºä¸é—®é¢˜æ±‡æ€»","uri":"/posts/git/"},{"categories":["Toolbox"],"content":"git pull/push é‡åˆ° Port 22 connect timeout ç½‘ç»œé—®é¢˜å¯¼è‡´ 22 ç«¯å£è¢«ç¦æ­¢ï¼Œæ— æ³•æ­£å¸¸ä½¿ç”¨ sshã€‚åˆ‡æ¢æˆ 443 ç«¯å£å¹¶ä¸”ç¼–å†™é…ç½®æ–‡ä»¶å³å¯ï¼š $ vim ~/.ssh/config # In ~/.ssh/config Host github.com HostName ssh.github.com Port 443 ","date":"2024-01-04","objectID":"/posts/git/:2:1","tags":["Git","GitHub"],"title":"Git/GitHub èµ„æºä¸é—®é¢˜æ±‡æ€»","uri":"/posts/git/"},{"categories":["Toolbox"],"content":"GitHub æ”¯æŒå¤šä¸ªè´¦æˆ·é€šè¿‡ ssh è¿æ¥ Using multiple github accounts with ssh keys ","date":"2024-01-04","objectID":"/posts/git/:2:2","tags":["Git","GitHub"],"title":"Git/GitHub èµ„æºä¸é—®é¢˜æ±‡æ€»","uri":"/posts/git/"},{"categories":["Toolbox"],"content":"References Git åŸºæœ¬åŸç† Learn Git Branching DIY a Git ugit åŠ¨æ‰‹å­¦ä¹ GIT - æœ€å¥½å­¦ä¹ GITçš„æ–¹å¼æ˜¯ä»é›¶å¼€å§‹åšä¸€ä¸ª ","date":"2024-01-04","objectID":"/posts/git/:3:0","tags":["Git","GitHub"],"title":"Git/GitHub èµ„æºä¸é—®é¢˜æ±‡æ€»","uri":"/posts/git/"},{"categories":["Network"],"content":"æ•´ç†ä¸€äº›è®¡ç®—æœºç½‘ç»œç›¸å…³çš„èµ„æº ","date":"2024-01-02","objectID":"/posts/network/:0:0","tags":["Network"],"title":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ æŒ‡å¼•","uri":"/posts/network/"},{"categories":["Network"],"content":"Referenecs 110-1 è¨ˆç®—æ©Ÿç¶²è·¯ (æ¸…å¤§é–‹æ”¾å¼èª²ç¨‹) å°èœå­¦ç½‘ç»œ NUDT é«˜çº§è®¡ç®—æœºç½‘ç»œå®éªŒ: åŸºäºUDPçš„å¯é ä¼ è¾“ å¯é  UDP çš„å®ç° (KCP over UDP) åŸºäºUDPçš„å¯é ä¼ è¾“ [bilibili] å®ç°åŸºäºUDPçš„ç½‘ç»œæ–‡ä»¶ä¼ è¾“å™¨ï¼Œç¨‹åºå‘˜çš„ç»éªŒå¤§ç¤¼åŒ…é¡¹ç›® [bilibili] pingå‘½ä»¤ä½†æ˜¯ç”¨æ¥é€šä¿¡ï¼Œå­¦ä¹ è®¡ç®—æœºç½‘ç»œå¥½é¡¹ç›®ï¼Œä¹Ÿå¯èƒ½æ˜¯æ ¡å›­ç½‘ç¦åˆ© [bilibili] Implementing TCP in Rust [YouTube] Let's code a TCP/IP stack ","date":"2024-01-02","objectID":"/posts/network/:1:0","tags":["Network"],"title":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ æŒ‡å¼•","uri":"/posts/network/"},{"categories":["Linux Kernel Internals"],"content":" äººä»¬å¯¹æ•°å­¦çš„åŠ å‡è¿ç®—å¯è½»æ˜“åœ¨è„‘ä¸­è¾¨è¯†ç¬¦å·å¹¶ç†è§£å…¶ç»“æœï¼Œä½†ç”µè„‘åšä»»ä½•äº‹éƒ½å—é™äºå®ä½“èµ„æ–™å‚¨å­˜åŠæ“ä½œæ–¹å¼ï¼Œæ¢è¨€ä¹‹ï¼Œç”µè„‘ç¡¬ä½“å®é™…åªè®¤å¾— 0 å’Œ 1ï¼Œå´ä¸çŸ¥é“ç¬¦å· + å’Œ - åœ¨æ•°å­¦åŠåº”ç”¨åœºåŸŸçš„æ„ä¹‰ï¼Œæ–¼æ˜¯å·¥ç¨‹äººå‘˜å¼•å…¥ã€Œè¡¥æ•°ã€ä»¥ä¾¿åœ¨äºŒè¿›ä½ç³»ç»Ÿä¸­ï¼Œè¡¨è¾¾äººä»¬è®¤çŸ¥ä¸Šçš„æ­£è´Ÿæ•°ã€‚ä½†æ‚¨æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œä¸ºä½•ã€ŒäºŒè¡¥æ•°ã€(2â€™s complement) è¢«ç”µè„‘å¹¿æ³›é‡‡ç”¨å‘¢ï¼ŸèƒŒå¾Œçš„è®¾è®¡è€ƒé‡åˆæ˜¯ä»€éº½ï¼Ÿæœ¬æ–‡å°è¯•ä»æ•°å­¦è§‚ç‚¹å»è§£è¯»ç¼–ç èƒŒå¾Œçš„åŸç†ï¼Œå¹¶ä½ä»¥èµ„è®¯å®‰å…¨åŠç¨‹å¼ç æœ€ä½³åŒ–çš„è€ƒé‡ï¼Œæ¢è®¨äºŒè¡¥æ•°è¿™æ ·çš„ç¼–ç å¯¹äºç¨‹å¼è®¾è®¡æœ‰ä½•å…³é”®å½±å“ã€‚ åŸæ–‡åœ°å€ï¼šè§£è®€è¨ˆç®—æ©Ÿç·¨ç¢¼ æŠ€å·§ ä¸ºäº†æ›´å¥½çš„ç†è§£æœ¬æ–‡çš„ä¸€äº›æ•°å­¦æ¦‚å¿µï¼Œä¾‹å¦‚ç¾¤ï¼Œä»¥åŠåç»­å…¶ä»–å…³äºæ•°å€¼ç³»ç»Ÿã€æµ®ç‚¹æ•°çš„è®²åº§ï¼ŒJserv å¼ºçƒˆå»ºè®®æˆ‘ä»¬å»ä¿®è¯»æ•°å­¦ç³»çš„ æ•°å­¦å¯¼è®ºã€‚ç¬”è€…åœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹å°å¤§é½éœ‡å®‡è€å¸ˆçš„ 2015 å¹´çš„æ–°ç”Ÿè¥è®²åº§ï¼Œè¿™ä¸ªè®²åº§è¦†ç›–äº†æ•°å­¦å¯¼è®ºçš„å†…å®¹ã€‚ YouTube: è‡ºå¤§ 2015 æ•¸å­¸ç³»æ–°ç”Ÿç‡Ÿ ","date":"2023-12-31","objectID":"/posts/binary-representation/:0:0","tags":["Sysprog","Numerics","Bitwise"],"title":"è§£è¯»è®¡ç®—æœºç¼–ç ","uri":"/posts/binary-representation/"},{"categories":["Linux Kernel Internals"],"content":"ä¸€è¡¥æ•° (Onesâ€™ complement) ","date":"2023-12-31","objectID":"/posts/binary-representation/:1:0","tags":["Sysprog","Numerics","Bitwise"],"title":"è§£è¯»è®¡ç®—æœºç¼–ç ","uri":"/posts/binary-representation/"},{"categories":["Linux Kernel Internals"],"content":"9 çš„è¡¥æ•° ç§‘æ™®çŸ­ç‰‡: Not just counting, but saving lives: Curta ","date":"2023-12-31","objectID":"/posts/binary-representation/:1:1","tags":["Sysprog","Numerics","Bitwise"],"title":"è§£è¯»è®¡ç®—æœºç¼–ç ","uri":"/posts/binary-representation/"},{"categories":["Linux Kernel Internals"],"content":"è¿ç®—åŸç† æ³¨æ„ ä»¥ä¸€è¡¥æ•°ç¼–ç å½¢å¼è¡¨ç¤ºçš„è¿ç®—å­ï¼Œåœ¨å‚ä¸è¿ç®—åï¼Œè¿ç®—ç»“æœç¬¦åˆä¸€è¡¥æ•°çš„ç¼–ç ï¼š $$ [X]_{ä¸€è¡¥æ•°} + [Y]_{ä¸€è¡¥æ•°} = [X+Y]_{ä¸€è¡¥æ•°} $$ æ¥ä¸‹æ¥è¿›è¡Œåˆ†ç±»è®¨è®ºï¼Œä»¥ 32-bit æ­£æ•° $X$, $Y$ ä¸ºä¾‹ï¼š $X + Y = X + Y$ æ˜¾ç„¶è¿ç®—å­å’Œè¿ç®—ç»“æœéƒ½æ»¡è¶³ä¸€è¡¥æ•°ç¼–ç ã€‚ $X - Y = X + (2^{32} - 1 - Y)$ å¦‚æœ $X \u003e Y$ï¼Œåˆ™è¿ç®—ç»“æœåº”ä¸º $X - Y$ ä¸”ä¸ºæ­£æ•°ï¼Œå…¶ä¸€è¡¥æ•°ç¼–ç ä¸º $X - Y$ã€‚è€Œæ­¤æ—¶ $$ 2^{32} - 1 + X - Y $$ æ˜¾ç„¶ä¼šæº¢å‡ºï¼Œä¸ºäº†ä½¿è¿ç®—ç»“æœå¯¹åº”ä¸€è¡¥æ•°ç¼–ç ï¼Œæ‰€ä»¥æ­¤æ—¶å¾ªç¯è¿›ä½å¯¹åº” $+\\ (1 - 2_{32})$ã€‚ å¦‚æœ $X \u003c Y$ï¼Œåˆ™è¿ç®—ç»“æœåº”ä¸º $X - Y$ ä¸”ä¸ºè´Ÿæ•°ï¼Œå…¶ä¸€è¡¥æ•°ç¼–ç ä¸º $$ 2^{32} - 1 - ï¼ˆY - Xï¼‰ = 2_{32} - 1 - X - Y $$ è€Œæ­¤æ—¶ $2^{32} - 1 + X - Y$ å¹¶ä¸ä¼šæº¢å‡ºï¼Œå¹¶ä¸”æ»¡è¶³è¿ç®—ç»“æœçš„ä¸€è¡¥æ•°ç¼–ç ï¼Œæ‰€ä»¥æ— éœ€è¿›è¡Œå¾ªç¯è¿›ä½ã€‚ å¦‚æœ $X = Y$ï¼Œæ˜¾ç„¶ $$ X - Y = X + 2^{32} - 1 - Y = 2^{32} - 1 $$ ä¸º 0 æˆç«‹ã€‚ $-X - Y = (2^{32} - 1 - X) + (2^{32} - 1 - Y)$ï¼Œæ˜¾ç„¶ä¼šå¯¼è‡´æº¢å‡ºã€‚è€Œ $-X - Y$ çš„ä¸€è¡¥æ•°ç¼–ç ä¸º $$ 2^{32} - 1 - (X + Y) = 2^{32} - 1 - X - Y $$ æ‰€ä»¥éœ€è¦åœ¨æº¢å‡ºæ—¶å¾ªç¯è¿›ä½ $+\\ (1 - 2^{32})$ æ¥æ¶ˆé™¤è¿ç®—ç»“æœä¸­çš„ä¸€ä¸ª $2^{32} - 1$ã€‚ ","date":"2023-12-31","objectID":"/posts/binary-representation/:1:2","tags":["Sysprog","Numerics","Bitwise"],"title":"è§£è¯»è®¡ç®—æœºç¼–ç ","uri":"/posts/binary-representation/"},{"categories":["Linux Kernel Internals"],"content":"äºŒè¡¥æ•° (Twoâ€™s complement) ","date":"2023-12-31","objectID":"/posts/binary-representation/:2:0","tags":["Sysprog","Numerics","Bitwise"],"title":"è§£è¯»è®¡ç®—æœºç¼–ç ","uri":"/posts/binary-representation/"},{"categories":["Linux Kernel Internals"],"content":"æ­£è´Ÿæ•°ç¼–ç è¡¨ç¤º å‡è®¾æœ‰ n-bit çš„äºŒè¡¥æ•°ç¼–ç  $A$ï¼Œ$-A$ çš„æ¨å¯¼å¦‚ä¸‹ï¼š æ ¼å¼ä¸€ï¼š $$ \\begin{align*} A + \\neg A \u0026= 2^n - 1 \\\\ A + \\neg A + 1 \u0026\\equiv 0 \\equiv 2^n \\ (\\bmod 2^n) \\\\ -A \u0026= \\neg A + 1 \\\\ \\end{align*} $$ æ ¼å¼äºŒï¼š $$ \\begin{align*} A + \\neg A \u0026= 2^n - 1 \\\\ A + \\neg A - 1 \u0026= 2^n - 2 \\\\ A - 1 \u0026= 2^n - 1 - (\\neg A + 1) \\\\ \\neg (A - 1) \u0026= \\neg A + 1 \\\\ \\neg (A - 1) \u0026= -A \\\\ \\end{align*} $$ ä¹Ÿå¯ä»¥é€šè¿‡ä¸€è¡¥æ•°å’ŒäºŒè¡¥æ•°ï¼Œåœ¨æ—¶é’Ÿè¡¨ä¸Šçš„å¯¹ç§°è½´åå·®ï¼Œæ¥ç†è§£ä¸Šè¿°ä¸¤ç§æ–¹å¼æ˜¯ç­‰ä»·çš„ã€‚ Twosâ€™ complement æ³¨æ„ åœ¨äºŒè¡¥æ•°ç¼–ç ä¸­ï¼Œå°†ä¸€ä¸ªæ•´æ•°è½¬æ¢æˆå…¶é€†å…ƒï¼Œä¹Ÿå¯ä»¥ä¾æ®ä»¥ä¸‹çš„æ–¹æ³•ï¼š ä»¥ LSB åˆ° MSB çš„é¡ºåºï¼Œå¯»æ‰¾ç¬¬ä¸€ä¸ªå€¼ä¸º 1 çš„ bitï¼Œå°†è¿™ä¸ª bit ä»¥åŠæ¯”å…¶æ›´ä½çš„ bits (åŒ…å«è¯¥ bit) éƒ½ä¿æŒä¸å˜ï¼Œå°†æ¯”è¯¥ bit æ›´é«˜çš„ bits (ä¸åŒ…æ‹¬è¯¥ bit) è¿›è¡Œå–åæ“ä½œã€‚ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ (ä»¥ 32-bit ä¸ºä¾‹)ï¼š 0x0080 \u003c-\u003e 0xff80 0x0001 \u003c-\u003e 0xffff 0x0002 \u003c-\u003e 0xfffe ","date":"2023-12-31","objectID":"/posts/binary-representation/:2:1","tags":["Sysprog","Numerics","Bitwise"],"title":"è§£è¯»è®¡ç®—æœºç¼–ç ","uri":"/posts/binary-representation/"},{"categories":["Linux Kernel Internals"],"content":"åŠ  / å‡æ³•å™¨è®¾è®¡ ç§‘æ™®çŸ­ç‰‡: See How Computers Add Numbers In One Lesson âœ… äº†è§£æ™¶ä½“ç®¡çš„åŸç† äº†è§£åŸºæœ¬é€»è¾‘é—¨å…ƒä»¶ï¼Œä¾‹å¦‚ OR, AND é€»è¾‘é—¨çš„è®¾è®¡ äº†è§£åŠ æ³•å™¨çš„åŸç†å’Œå·¥ä½œæµç¨‹ã€‚ ","date":"2023-12-31","objectID":"/posts/binary-representation/:2:2","tags":["Sysprog","Numerics","Bitwise"],"title":"è§£è¯»è®¡ç®—æœºç¼–ç ","uri":"/posts/binary-representation/"},{"categories":["Linux Kernel Internals"],"content":"é˜¿è´å°”ç¾¤åŠå¯¹ç§°æ€§ æŠ€å·§ ç¾¤è®ºçš„æœ€å¤§ç”¨é€”æ˜¯å…³äºã€Œå¯¹ç§°æ€§ã€çš„ç ”ç©¶ï¼›æ‰€æœ‰å…·æœ‰å¯¹ç§°æ€§è´¨ï¼Œç¾¤è®ºéƒ½å¯æ´¾ä¸Šç”¨åœºã€‚åªè¦å‘ç”Ÿå˜æ¢åä»æœ‰ä»€ä¹ˆä¸œè¥¿è¿˜ç»´æŒä¸å˜ï¼Œé‚£ç¬¦åˆå¯¹ç§°çš„æ€§è´¨ã€‚ ä¸€ä¸ªåœ†å·¦å³ç¿»è½¬åè¿˜æ˜¯åœ†ï¼Œå®ƒåœ¨è¿™ç§å˜æ¢ä¸‹æ˜¯å¯¹ç§°çš„ï¼Œè€Œè¿™åˆšå¥½ä¸ç¾¤çš„ å°é—­æ€§ (Closure) å¯¹åº”ã€‚ ä¸€ä¸ªæ—¶é’Ÿçš„æ—¶åˆ»ï¼Œä» 0 æ—¶åˆ»å¼€å§‹ï¼Œä¸¤è¾¹çš„æ—¶åˆ»ç›¸åŠ æ¨¡ 12 çš„ç»“æœå‡ä¸º 0ï¼Œè¿™ä¸ç¾¤çš„ å•ä½å…ƒ (Identity element) å’Œ é€†å…ƒ (Inverse element) å¯¹åº”ã€‚ ä¸Šè¿°ä¸¤ä¸ªä¾‹å­åæ˜ äº†ç¾¤è®ºçš„æ€§è´¨ï¼Œå¯¹äºå¯¹ç§°æ€§ç ”ç©¶çš„é‡è¦æ€§å’ŒåŸç†ä¾æ®ã€‚ ç§‘æ™®å½±ç‰‡: ä»äº”æ¬¡æ–¹ç¨‹åˆ°ä¼½ç½—ç“¦ç†è®º ","date":"2023-12-31","objectID":"/posts/binary-representation/:3:0","tags":["Sysprog","Numerics","Bitwise"],"title":"è§£è¯»è®¡ç®—æœºç¼–ç ","uri":"/posts/binary-representation/"},{"categories":["Linux Kernel Internals"],"content":"æ—è·¯æ”»å‡» è§‚çœ‹ç§‘æ™®è§†é¢‘: æˆ‘å¬å¾—åˆ°ä½ æ‰“äº†ä»€ä¹ˆå­— âœ… é˜…è¯»ç›¸å…³è®ºæ–‡ Keyboard Acoustic Emanations ä½“éªŒä½¿ç”¨ç›¸å…³å·¥å…· kbd-audio å€Ÿç”± Wikipedia äº†è§£æ—è·¯æ”»å‡» (Side-channel attack) å’Œæ—¶åºæ”»å‡» (Timing attack) çš„åŸºæœ¬æ¦‚å¿µ âœ… Black-box testing Row hammer Cold boot attack Rubber-hose cryptanalysis å»¶ä¼¸é˜…è¯» The password guessing bug in Tenex Side Channel Attack By Using Hidden Markov Model One\u0026Done: A Single-Decryption EM-Based Attack on OpenSSLâ€™s Constant-Time Blinded RSA ","date":"2023-12-31","objectID":"/posts/binary-representation/:4:0","tags":["Sysprog","Numerics","Bitwise"],"title":"è§£è¯»è®¡ç®—æœºç¼–ç ","uri":"/posts/binary-representation/"},{"categories":["Linux Kernel Internals"],"content":"Constant-Time Functions æ¯”è¾ƒå¸¸è§çš„å¸¸æ•°æ—¶é—´å®ä½œæ–¹æ³•æ˜¯ï¼Œæ¶ˆé™¤åˆ†æ”¯ã€‚å› ä¸ºä¸åŒåˆ†æ”¯çš„æ‰§è¡Œæ—¶é—´å¯èƒ½ä¼šä¸åŒï¼Œè¿™ä¼šè¢«åˆ©ç”¨è¿›è¡Œæ—¶åºæ”»å‡»ã€‚è¿™ä¸ªæ–¹æ³•éœ€è¦å¯¹ C è¯­è¨€ä¸­çš„ç¼–ç å’Œä½è¿ç®—æœ‰ä¸€å®šçš„äº†è§£ã€‚ C99 STandard - 7.18.1.1 Exact-width integer types é˜…è¯»è®°å½• C99 Standard - 6.5.7.5 Bitwise shift operators é˜…è¯»è®°å½• Source Branchless abs å¦‚æœ n æ˜¯ signed 32-bitï¼Œåˆ™ n \u003e\u003e 31 ç­‰ä»·äº n == 0 ? 0 : -1 æ–¹æ³•ä¸€ï¼ŒåŸç†ä¸º $-A = \\neg (A - 1)$: #include \u003cstdint.h\u003e int32_t abs(int32_t x) { int32_t mask = (x \u003e\u003e 31); return (x + mask) ^ mask; } æ–¹æ³•äºŒï¼ŒåŸç†ä¸º $-A = \\neg A + 1$: #include \u003cstdint.h\u003e int32_t abs(int32_t x) { int32_t mask = (x \u003e\u003e 31); return (x ^ mask) - mask; } Branchless min/max Min: #include \u003cstdint.h\u003e int32_t min(int32_t a, int32_t b) { int32_t diff = (a - b); return b + (diff \u0026 (diff \u003e\u003e 31)); } å¦‚æœ diff \u003e 0 å³ b å°ï¼Œé‚£ä¹ˆ (diff \u003e\u003e 31) == 0ï¼Œåˆ™ b + (diff \u0026 (diff \u003e\u003e 31)) == b å¦‚æœ diff \u003c 0 å³ a å°ï¼Œé‚£ä¹ˆ (diff \u003e\u003e 31) == -1ï¼Œåˆ™ b + (diff \u0026 (diff \u003e\u003e 31)) == b + (a - b) == a Max: #include \u003cstdint.h\u003e int32_t max(int32_t a, int32_t b) { int32_t diff = (b - a); return b - (diff \u0026 (diff \u003e\u003e 31)); } å¦‚æœ diff \u003e 0 å³ b å¤§, é‚£ä¹ˆ (diff \u003e\u003e 31) == 0ï¼Œåˆ™ b - (diff \u0026 (diff \u003e\u003e 31)) == b å¦‚æœ diff \u003c 0 å³ a å¤§ï¼Œé‚£ä¹ˆ (diff \u003e\u003e 31) == -1ï¼Œåˆ™ b - (diff \u0026 (diff \u003e\u003e 31)) == b - (b - a) == a ä¿¡æ¯ åŸºäº C è¯­è¨€æ ‡å‡†ç ”ç©¶ä¸ç³»ç»Ÿç¨‹åºå®‰å…¨è®®é¢˜ ","date":"2023-12-31","objectID":"/posts/binary-representation/:4:1","tags":["Sysprog","Numerics","Bitwise"],"title":"è§£è¯»è®¡ç®—æœºç¼–ç ","uri":"/posts/binary-representation/"},{"categories":["Linux Kernel Internals","Rust"],"content":"Rust in 100 Seconds è§‚çœ‹çŸ­ç‰‡: Rust in 100 Seconds âœ… äº†è§£ Rustï¼Œåˆæ­¥äº†è§£å…¶å®‰å…¨æ€§åŸç† æ‰€æœ‰æƒ (ownership) å€Ÿç”¨ (borrow) è­¦å‘Š 0:55 This is wrong, value mutability doesnâ€™t have anything to do with the value being stored on the stack or the heap (and the example let mut hello = \"hi mom\" will be stored on the stack since itâ€™s type is \u0026'static str), it depends on the type of the value (if itâ€™s Sized or not). ","date":"2023-12-28","objectID":"/posts/why-rust-/:1:0","tags":["Rust","Sysprog"],"title":"Why Rust?","uri":"/posts/why-rust-/"},{"categories":["Linux Kernel Internals","Rust"],"content":"The adoption of Rust in Business (2022) é˜…è¯»æŠ¥å‘Š: The adoption of Rust in Business (2022) âœ… Rust ç›®å‰è“¬å‹ƒå‘å±•ï¼Œé¢„æµ‹æœªæ¥æ˜¯å¾ˆéš¾çš„ï¼Œä½†æ˜¯ Rust å·²ç»æ˜¯è¿›è¡Œæ—¶çš„æœªæ¥äº† ğŸ¤£ ","date":"2023-12-28","objectID":"/posts/why-rust-/:2:0","tags":["Rust","Sysprog"],"title":"Why Rust?","uri":"/posts/why-rust-/"},{"categories":["Linux Kernel Internals","Rust"],"content":"Visualizing memory layout of Rustâ€™s data types YouTube: Visualizing memory layout of Rustâ€™s data types å½±ç‰‡çš„ä¸­æ–‡ç¿»è¯‘ï¼š å¯è§†åŒ– Rust å„æ•°æ®ç»“æ„çš„å†…å­˜å¸ƒå±€ [bilibili] å¯æ­é…é˜…è¯»ç›¸å…³çš„æ–‡æ¡£ï¼š [2022-05-04] å¯è§†åŒ– Rust å„æ•°æ®ç±»å‹çš„å†…å­˜å¸ƒå±€ ","date":"2023-12-28","objectID":"/posts/why-rust-/:3:0","tags":["Rust","Sysprog"],"title":"Why Rust?","uri":"/posts/why-rust-/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"æ•™å­¦å½±ç‰‡ï¼šGit ä¸­æ–‡æ•™å­¦ ","date":"2023-12-27","objectID":"/posts/git-learn/:0:0","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"å®‰è£…ä¸è®¾å®š æ³¨æ„ âœ… è§‚çœ‹å½±ç‰‡ Git æ•™å­¦ç³»åˆ— - å®‰è£…ä¸é…ç½®ï¼Œå®Œæˆå¸¸ç”¨çš„ Git è®¾ç½®ã€‚ è®¾ç½® Git çš„ç¼–è¾‘å™¨ä¸º vimï¼Œä¸»è¦ç”¨äº commit æ—¶çš„ç¼–è¾‘ï¼š $ git config --global core.editor vim è®¾ç½® Git çš„åˆå¹¶è§£å†³å†²çªå·¥å…·ä¸º vimdiffï¼š $ git config --global merge.tool vimdiff å¯ç”¨ Git å‘½ä»¤è¡Œç•Œé¢çš„é¢œè‰²æ˜¾ç¤ºï¼š $ git config --global color.ui true è®¾ç½®å¸¸ç”¨å‘½ä»¤çš„åˆ«åï¼š $ git config --global alias.st status $ git config --global alias.ch checkout $ git config --global alias.rst reset HEAD æ•ˆæœä¸ºï¼šå‘½ä»¤ git st ç­‰ä»·äº git statusï¼Œå…¶ä½™çš„ç±»ä¼¼ã€‚ è®¾ç½® Windows å’Œ Mac/Linux çš„æ¢è¡Œç¬¦åŒæ­¥ï¼š # In Windows $ git config --global core.autocrlf true # In Mac/Linux $ git config --global core.autocrlf input æ•ˆæœä¸ºï¼šåœ¨ Windows æäº¤æ—¶è‡ªåŠ¨å°† CRLF è½¬ä¸º LFï¼Œæ£€å‡ºä»£ç æ—¶å°† LF è½¬æ¢æˆ CRLFã€‚åœ¨ Mac/Linux æäº¤æ—¶å°† CRLFè½¬ä¸º LFï¼Œæ£€å‡ºä»£ç æ—¶ä¸è½¬æ¢ã€‚è¿™æ˜¯å› ä¸º Windows çš„æ¢è¡Œç¬¦ä¸º \\r\\nï¼Œè€Œ Mac/Linux çš„æ¢è¡Œç¬¦ä»…ä¸º \\nã€‚ ","date":"2023-12-27","objectID":"/posts/git-learn/:1:0","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Add å’Œ Commit ","date":"2023-12-27","objectID":"/posts/git-learn/:2:0","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"æŒ‡å®š Commit æ³¨æ„ âœ… è§‚çœ‹å½±ç‰‡ Git æ•™å­¦ç³»åˆ— - æŒ‡å®š Commitï¼ŒæŒæ¡ git logã€git showã€git diff çš„å¸¸ç”¨æ–¹æ³•ã€‚ç†è§£ Hash Value å’Œ commit å¯¹äº Git ç‰ˆæœ¬æ§åˆ¶çš„æ ¸å¿ƒä½œç”¨ã€‚ åªè¦ commit äº†ï¼Œèµ„æ–™åŸºæœ¬ä¸å¯èƒ½ä¸¢å¤±ï¼Œå³ä½¿è¯¯æ“ä½œäº†ä¹Ÿæ˜¯å¯ä»¥è¡¥æ•‘å›æ¥çš„ï¼ˆé™¤éæŠŠ .git/ æ–‡ä»¶å¤¹ä¹Ÿåˆ é™¤äº†ï¼‰ã€‚ ","date":"2023-12-27","objectID":"/posts/git-learn/:3:0","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Hash Value Every commit has a unique hash value. Calculate by SHA1 Hash value can indicate a commit absolutely. ","date":"2023-12-27","objectID":"/posts/git-learn/:3:1","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Indicate Commit git manage references to commit HEAD Branch Tag Remote Also, We can indicate commit by ^, ~ é€šä¿—åœ°å°†ï¼Œä¸è®ºæ˜¯ HEADã€Branchã€Tagã€Remoteï¼Œå…¶æœ¬è´¨éƒ½æ˜¯ä½¿ç”¨ Hash Value è¿›è¡Œç´¢å¼•çš„ commitï¼Œæ‰€ä»¥ ~ å’Œ ^ ä¹Ÿå¯ä»¥ä½œç”¨äºå®ƒä»¬ã€‚ å¯ä»¥é€šè¿‡ git log æ¥æŸ¥çœ‹ commit ä»¥åŠå¯¹åº”çš„ Hash å€¼ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸ªå‘½ä»¤ååˆ†çµæ´»ï¼Œä¸¾ä¸ªä¾‹å­ï¼š git log 4a6ebc -n1 è¿™ä¸ªå‘½ä»¤çš„æ•ˆæœæ˜¯ä» Hash å€¼ä¸º 4a6bc çš„ commit å¼€å§‹æ‰“å° 1 æ¡ commit è®°å½•ï¼ˆæ²¡é”™ï¼Œå¯¹åº”çš„æ˜¯ -n1ï¼‰ï¼Œå› ä¸º Git ååˆ†èªæ˜ï¼Œæ‰€ä»¥ commit å¯¹åº”çš„ Hash å€¼åªéœ€å‰ 6 ä½å³å¯ï¼ˆå› ä¸ºè¿™æ ·å·²ç»å‡ ä¹ä¸ä¼šå‘ç”Ÿ Hash å†²çªï¼‰ã€‚ Examples æ‰“å° master åˆ†æ”¯çš„æœ€æ–°ä¸€ä¸ª commitï¼š git log master -n1 æ‰“å° master åˆ†æ”¯çš„æœ€æ–°ä¸€ä¸ª commitï¼ˆä»…ä½¿ç”¨ä¸€è¡Œæ‰“å° commit ä¿¡æ¯ï¼‰ï¼š git log master -n1 --oneline æ‰“å° HEAD æ‰€æŒ‡å‘çš„ commitï¼š git log HEAD -n1 --oneline æ‰“å° HEAD æ‰€æŒ‡å‘çš„ commit çš„å‰ä¸€ä¸ª commitï¼š git log HEAD^ -n1 --oneline ^ å¯ä»¥æŒç»­ä½¿ç”¨ï¼Œæ¯”å¦‚ HEAD^^ è¡¨ç¤º HEAD æ‰€æŒ‡å‘çš„ commit çš„å‰ä¸¤ä¸ª commitã€‚å½“ ^ æ•°é‡è¿‡å¤šæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ ~ æ­é…æ•°å­—æ¥è¾¾åˆ°ç›¸åŒæ•ˆæœã€‚ä¾‹å¦‚ï¼š git log HEAD^^^^^ -n1 --oneline git log HEAD~5 -n1 --oneline ä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨ ^ å°±å·²ç»è¶³å¤Ÿäº†ï¼Œå‡ ä¹ä¸ä¼šé‡åˆ°ä½¿ç”¨ ~ çš„åœºæ™¯ï¼Œå› ä¸ºè¿™ç§åœºæ™¯ä¸€èˆ¬ä¼šå»æ‰¾å›¾å½¢åŒ–ç•Œé¢å§ã€‚ğŸ¤£ æ‰“å°ä¸æ–‡ä»¶ README.md ç›¸å…³çš„ commitsï¼ˆä»…ä½¿ç”¨ä¸€è¡Œæ˜¾ç¤ºï¼‰ï¼š git log --oneline README.md æ‰“å°ä¸æ–‡ä»¶ README.md ç›¸å…³çš„ commitsï¼ˆæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶å†…å®¹çš„å¢å‡ç»Ÿè®¡ï¼‰ï¼š git log --stat README.md æ‰“å°ä¸æ–‡ä»¶ README.md ç›¸å…³çš„ commitsï¼ˆæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶å†…å®¹çš„å¢å‡ç»†èŠ‚ï¼‰ï¼š git log --patch README.md åœ¨æ‰“å°çš„ commit ä¿¡æ¯ä¸­æŠ“å–ä¸ README ç¬¦åˆçš„ä¿¡æ¯ï¼ˆå¯ä»¥ä¸ --stat æˆ– --patch é…åˆä½¿ç”¨ï¼‰ï¼š git log -S README ","date":"2023-12-27","objectID":"/posts/git-learn/:3:2","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"View History git log \u003cpath\u003e|\u003ccommit\u003e -n: limit number --oneline: view hash and commit summary --stat: view files change --patch: view lines change -S or --grep: find modification ","date":"2023-12-27","objectID":"/posts/git-learn/:3:3","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"View Commit git show \u003ccommit\u003e Equal to log -n1 ","date":"2023-12-27","objectID":"/posts/git-learn/:3:4","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"See Difference æŸ¥çœ‹å½“å‰çš„ä¿®æ”¹ï¼Œå¯ä»¥æŸ¥çœ‹å·²ç»ä¿®æ”¹ä½†æ²¡æœ‰ staged æ–‡ä»¶çš„å˜åŒ–ï¼š git diff æŸ¥çœ‹å½“å‰çš„ä¿®æ”¹ï¼Œå¯ä»¥æŸ¥çœ‹å·²ç»ä¿®æ”¹ä¸” staged æ–‡ä»¶çš„å˜åŒ–ï¼š git diff --staged æŸ¥çœ‹å½“å‰ä¸æŒ‡å®šçš„ commit çš„å·®å¼‚ï¼š git diff \u003ccommit\u003e # e.g. git diff master^ æŸ¥ä¸¤ä¸ªæŒ‡å®šçš„ commit ä¹‹é—´çš„å·®å¼‚ï¼š git diff \u003ccommit\u003e \u003ccommit\u003e # e.g. git diff master^ master^^ ","date":"2023-12-27","objectID":"/posts/git-learn/:3:5","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Path Add and Amend æ³¨æ„ âœ… è§‚çœ‹å½±ç‰‡ Git æ•™å­¦ç³»åˆ— - Patch Add and Amendï¼ŒæŒæ¡ git add -pã€git checkout -pã€git add ---amend çš„ç”¨æ³•ï¼Œä½¿ç”¨ add å’Œ checkout æ—¶å¼ºçƒˆå»ºè®®ä½¿ç”¨ -pï¼ŒæŒæ¡ä¿®æ”¹ commit çš„ä¸¤ç§æ–¹æ³•ã€‚ ","date":"2023-12-27","objectID":"/posts/git-learn/:4:0","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Only Add Related git add -p æ¨èå°½é‡ä½¿ç”¨è¿™ä¸ª git add -p è€Œä¸æ˜¯å•çº¯çš„ git addã€‚ ä½¿ç”¨ git add -p åï¼ŒGit ä¼šå¸®æˆ‘ä»¬æŠŠæ¶‰åŠçš„ä¿®æ”¹åˆ†æˆ sectionï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å¯¹æ¯ä¸€ä¸ª section æ¶‰åŠçš„ä¿®æ”¹è¿›è¡Œ reviewï¼Œé€‰æ‹© y(yes) è¡¨ç¤ºé‡‡çº³è¯¥ sction å¯¹åº”çš„ä¿®æ”¹ï¼Œé€‰æ‹© n(no) è¡¨ç¤ºä¸é‡‡çº³ã€‚ å¦‚æœè§‰å¾— section åˆ‡å‰²çš„ç²’åº¦å¤ªå¤§äº†ï¼Œå¯ä»¥é€‰æ‹© s(split) æ¥è¿›è¡Œæ›´ç»†ç²’åº¦çš„åˆ’åˆ†ã€‚å¦‚æœè¿™æ ·ä»ç„¶è§‰å¾—ç²’åº¦ä¸å¤Ÿï¼Œå¯ä»¥é€‰æ‹© e(edit) å¯¹ section æ¶‰åŠçš„ä¿®æ”¹ï¼Œè¿›è¡Œä»¥è¡Œä¸ºç²’åº¦çš„ reviewï¼Œå…·ä½“æ“ä½œå¯ä»¥æŸ¥é˜…æ­¤æ—¶ç»™å‡ºçš„æç¤ºã€‚ è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„é€‰é¡¹ï¼Œæ¯”å¦‚ jã€Jã€kã€Kï¼Œè¿™äº›æ˜¯ç±»ä¼¼ vimï¼Œç”¨äºåˆ‡æ¢è¿›è¡Œ review çš„ sectionï¼Œä¸å¤ªå¸¸ç”¨ã€‚q(quit) è¡¨ç¤ºé€€å‡ºã€‚ ç”±äºå¯ä»¥é’ˆå¯¹ä¸€ä¸ªæ–‡ä»¶çš„ä¸åŒ section è¿›è¡Œ reviewï¼Œæ‰€ä»¥åœ¨è¿›è¡Œ git add -p ä¹‹åï¼Œä½¿ç”¨ git status å¯ä»¥å‘ç°åŒä¸€ä¸ªæ–‡ä»¶ä¼šåŒæ—¶å¤„äºä¸¤ç§çŠ¶æ€ã€‚ ","date":"2023-12-27","objectID":"/posts/git-learn/:4:1","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Checkout Also git checkout -p è¿™ä¸ªæ“ä½œæ¯”è¾ƒå±é™©ï¼Œå› ä¸ºè¿™ä¸ªæ“ä½œçš„æ•ˆæœä¸ git add -p ç›¸åï¼Œå¦‚æœé€‰æ‹© y çš„è¯ï¼Œæ–‡ä»¶æ¶‰åŠçš„ä¿®æ”¹å°±ä¼šæ¶ˆå¤±ï¼Œå¦‚æœæ¶‰åŠçš„ä¿®æ”¹æ²¡æœ‰ commit çš„è¯ï¼Œé‚£ä¹ˆæ¶‰åŠçš„ä¿®æ”¹æ˜¯æ— æ³•æ•‘å›çš„ã€‚ä½†æ˜¯æ€ä¹ˆè¯´ï¼Œè¿™ä¸ªæ“ä½œè¿˜æ˜¯æ¯”ç›´æ¥ä½¿ç”¨ git checkout ç¨å¾®ä¿é™©ä¸€ç‚¹ï¼Œå› ä¸ºä¼šå…ˆè¿›å…¥ review ç•Œé¢ï¼Œè€Œä¸æ˜¯ç›´æ¥æ’¤é”€ä¿®æ”¹ã€‚æ‰€ä»¥ï¼Œè¯·ä¸€å®šè¦ä½¿ç”¨ git checkout -pï¼ ","date":"2023-12-27","objectID":"/posts/git-learn/:4:2","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Modify Commit æœ‰ä¸¤ç§æ–¹å¼æ¥ä¿®æ”¹æœ€æ–°çš„ commitï¼š # 1. Use git commit --amend git commit --amend # 2. Use reset HEAD^ then re-commit git reset HEAD^ git add -p git commit git commit --amend å¹¶ä¸æ˜¯ç›´æ¥æ›¿æ¢åŸæœ‰çš„ commitï¼Œè€Œæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ commit å¹¶é‡æ–°è®¾ç½®äº† HEAD çš„æŒ‡å‘ã€‚æ‰€ä»¥ï¼Œæ–°æ—§ä¸¤ä¸ª commit çš„ Hash Value å¹¶ä¸ç›¸åŒï¼Œäº‹å®ä¸Šï¼Œå¦‚æœä½ æ‹¥æœ‰æ—§ commit çš„ Hash Valueï¼Œæ˜¯å¯ä»¥é€šè¿‡ git checkout \u003ccommit\u003e åˆ‡æ¢åˆ°é‚£ä¸ª commit çš„ã€‚å…¶åŸç†å¦‚ä¸‹å›¾ï¼š ä½†æ˜¯æ³¨æ„ï¼Œgit reset HEAD^ æ˜¯ä¼šæ’¤é”€åŸå…ˆçš„ commitï¼ˆä»…é™äºæœ¬åœ° Git å­˜å‚¨åº“ï¼‰ã€‚ ","date":"2023-12-27","objectID":"/posts/git-learn/:4:3","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Branch and Merge æ³¨æ„ âœ… è§‚çœ‹å½±ç‰‡ Git æ•™å­¦ç³»åˆ— - Branch and Mergeï¼ŒæŒæ¡åˆ›å»ºã€åˆ é™¤ã€åˆ‡æ¢åˆ†æ”¯çš„ç”¨æ³•ï¼ŒæŒæ¡åˆå¹¶åˆ†æ”¯ã€è§£å†³å†²çªçš„æ–¹æ³•ã€‚ git checkout \u003ccommit\u003e git branch \u003cname\u003e git branch \u003cname\u003e \u003ccommit\u003e git branch [-d|-D] \u003cname\u003e git merge \u003cname\u003e --no-ff ","date":"2023-12-27","objectID":"/posts/git-learn/:5:0","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Move and Create Branch Checkout: move HEAD git checkout \u003ccommit\u003e: Move HEAD to commit git checkout \u003cpath\u003e: WARNING: discard change å¯ä»¥å°†è·¯å¾„ä¸Šçš„æ–‡ä»¶å¤åŸåˆ°ä¹‹å‰ commit çš„çŠ¶æ€ã€‚ Branch: git branch: List branch git branch \u003cname\u003e: Create branch Or just: git checkout -b Examples ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶å¹¶æ¢å¤ï¼š # modify file load.cpp git status git checkout load.cpp git status åˆ é™¤ä¸€ä¸ªæ–‡ä»¶å¹¶æ¢å¤ï¼š rm load.cpp git status git checkout load.cpp git status æ­£å¦‚ä¸Šä¸€èŠ‚æ‰€è¯´çš„ï¼Œgit checkout å°½é‡å¸¦ä¸Š -p å‚æ•°ï¼Œå› ä¸ºå¦‚æœä¸€ä¸å°å¿ƒè¾“å…¥äº† git checkout .ï¼Œé‚£å°±å‰åŠŸå°½å¼ƒäº†ã€‚ æ˜¾ç¤ºåˆ†æ”¯ï¼š # only show name git branch # show more infomation git branch -v åˆ‡æ¢åˆ†æ”¯ï¼š # switch to branch 'main' git checkout main åˆ›å»ºåˆ†æ”¯ï¼š # 1. using `git branch` git branch cload # 2. using `git checkout -b` git checkout -b asmload # 3. create a new branch in \u003ccommit\u003e git branch cload \u003ccommit\u003e åˆ‡æ¢åˆ°ä»»ä¸€ commitï¼š git checkout \u003ccommit\u003e ç›´æ¥ checkout åˆ°ä»»ä¸€ commit ä¼šæœ‰è­¦å‘Šï¼Œè¿™æ˜¯å› ä¸ºï¼Œå½“ä½ ä»¥è¯¥ commit ä¸ºåŸºç‚¹è¿›è¡Œä¸€ç³»åˆ—çš„ commitï¼Œè¿™äº›æ–°çš„ commit ä¼šåœ¨ä½ åˆ‡æ¢åˆ†æ”¯åæ¶ˆå¤±ï¼Œå› ä¸ºæ²¡æœ‰ branch æ¥å¼•ç”¨å®ƒä»¬ã€‚ä¹‹å‰å¯ä»¥è¢«å¼•ç”¨æ˜¯å› ä¸º HEAD å¼•ç”¨ï¼Œåˆ‡æ¢åˆ†æ”¯å HEAD ä¸å†å¼•ç”¨è¿™äº› commitï¼Œæ‰€ä»¥å°±ä¼šæ¶ˆå¤±ã€‚åœ¨è¿™ç§æƒ…å†µï¼ŒGit ä¼šåœ¨å‘å‡ºè­¦å‘Šçš„åŒæ—¶å»ºè®®æˆ‘ä»¬ä½¿ç”¨ git branch æ¥åˆ›å»ºåˆ†æ”¯è¿›è¡Œå¼•ç”¨ã€‚ ","date":"2023-12-27","objectID":"/posts/git-learn/:5:1","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"View Branch åˆ—å‡ºä»“åº“çš„æ‰€æœ‰åˆ†æ”¯ï¼š git branch ä¹Ÿå¯ä»¥é€šè¿‡ log æ¥æŸ¥çœ‹åˆ†æ”¯ï¼š git log --decorate: åœ¨ log çš„é¦–è¡Œæ˜¾ç¤ºæ‰€æœ‰çš„ referencesï¼ˆå¯èƒ½éœ€è¦é€šè¿‡ git config log.decorate auto æ¥å¼€å¯ï¼‰ --graph: ä»¥å›¾å½¢åŒ–çš„æ–¹å¼æ˜¾ç¤º branch çš„å…³ç³»ï¼ˆä¸»è¦æ˜¯ commit çš„å¼•ç”¨ï¼‰ ","date":"2023-12-27","objectID":"/posts/git-learn/:5:2","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Delete Branch åˆ é™¤åˆ†æ”¯ï¼š git branch -d \u003cname\u003e å¯¹äºæœ‰æ²¡æœ‰ merge çš„ commit çš„åˆ†æ”¯ï¼ŒGit ä¼šè­¦å‘Šï¼Œéœ€è¦ä½¿ç”¨ -D æ¥å¼ºåˆ¶åˆ é™¤ï¼š git branch -D \u003cname\u003e for no-merge commit WARNING: Discard Commit Git ä¼šå‘å‡ºè­¦å‘Šçš„åŸå› åŒæ ·æ˜¯ no-merge commit åœ¨åˆ é™¤åˆ†æ”¯åå°±æ— æ³•è¢«å¼•ç”¨ï¼Œæ‰€ä»¥ä¼šå‘å‡ºè­¦å‘Šã€‚ ","date":"2023-12-27","objectID":"/posts/git-learn/:5:3","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Merge åˆå¹¶åˆ†æ”¯ã€‚é»˜è®¤ä½¿ç”¨ fast-forwardï¼Œå³å¦‚æœæ²¡æœ‰å†²çªï¼Œç›´æ¥å°†è¦åˆå¹¶çš„åˆ†æ”¯æå‰åˆ°è¢«åˆå¹¶åˆ†æ”¯çš„ commit å¤„ï¼Œè€Œä¸ä¼šå¦å¤–ç”Ÿæˆä¸€ä¸ª merge commitã€‚ä½†è¿™æ ·ä¼šä½¿å¾—è¢«åˆå¹¶çš„åˆ†æ”¯åœ¨åˆå¹¶åï¼Œæ²¡æœ‰å†å²ç—•è¿¹ã€‚å¯ä»¥é€šè¿‡ --no-ff (no fast forward) æ¥å¼ºåˆ¶ç”Ÿæˆ merge commitã€‚æ¨èä½¿ç”¨ merge æ—¶åŠ ä¸Š --no-ff è¿™ä¸ªå‚æ•°ã€‚ git merge \u003cbranch\u003e é€šå¸¸æ˜¯ main/master è¿™ç±»ä¸»åˆ†æ”¯åˆå¹¶å…¶å®ƒåˆ†æ”¯ï¼š git checkout main/master git merge \u003cbranch\u003e ","date":"2023-12-27","objectID":"/posts/git-learn/:5:4","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Resolve Conflict Manually resolve: Check every codes between \u003c\u003c\u003c\u003c\u003c\u003c\u003c, \u003e\u003e\u003e\u003e\u003e\u003e\u003e Edit code to what it should be Use mergetool like vimdiff: It shows: local, base, remote, file to be edited Edit â€œfile ro be editedâ€ to what is should be Add and Commit # 1. åˆå¹¶åˆ†æ”¯ git merge \u003cbranch\u003e # 2. æ£€æŸ¥çŠ¶æ€ï¼ŒæŸ¥çœ‹ unmerged çš„æ–‡ä»¶ git status # 3. ç¼–è¾‘ unmerged æ–‡ä»¶ï¼Œç¼–è¾‘å†²çªåŒºåŸŸä»£ç å³å¯ vim \u003cfile\u003e # 4. æ·»åŠ è§£å†³å®Œå†²çªçš„æ–‡ä»¶ git add \u003cfile\u003e # 5. è¿›è¡Œ merge commit git commit å†²çªåŒºåŸŸå°±æ˜¯ \u003c\u003c\u003c\u003c\u003c\u003c\u003c å’Œ \u003e\u003e\u003e\u003e\u003e\u003e\u003e å†…çš„åŒºåŸŸï¼Œåœ¨ merge æ“ä½œåï¼ŒGit å·²ç»å¸®æˆ‘ä»¬æŠŠ unmerged æ–‡ä»¶ä¿®æ”¹ä¸ºå¾…è§£å†³å†²çªçš„çŠ¶æ€ï¼Œç›´æ¥ç¼–è¾‘æ–‡ä»¶å³å¯ã€‚åœ¨ç¼–è¾‘å®Œæˆåï¼Œéœ€è¦æ‰‹åŠ¨è¿›è¡Œ add å’Œ commitï¼Œæ­¤æ¬¡ commit çš„ä¿¡æ¯ Git å·²ç»å¸®æˆ‘ä»¬å†™å¥½äº†ï¼Œä¸€èˆ¬ä¸éœ€è¦ä¿®æ”¹ã€‚ å¦‚æœä½¿ç”¨çš„æ˜¯ mergetoolï¼Œä»¥ vimdiff ä¸ºä¾‹ï¼Œåªéœ€å°†ç¬¬ 3 æ­¥çš„ vim \u003cfile\u003e æ”¹ä¸º git mergetool å³å¯ã€‚vimdiff ä¼šæä¾› 4 ä¸ªè§†çª—ï¼šåº•éƒ¨è§†çª—æ˜¯æˆ‘ä»¬çš„ç¼–è¾‘åŒºï¼Œé¡¶éƒ¨å·¦è¾¹æ˜¯å½“å‰åˆå¹¶åˆ†æ”¯çš„çŠ¶æ€ï¼Œé¡¶éƒ¨ä¸­é—´æ˜¯ base (åˆå¹¶åˆ†æ”¯å’Œè¢«åˆå¹¶çš„å…±åŒçˆ¶èŠ‚ç‚¹) çš„çŠ¶æ€ï¼Œé¡¶éƒ¨å³è¾¹æ˜¯ remote çš„çŠ¶æ€ï¼ŒæŒ‰éœ€è¦é€‰æ‹©ã€ç¼–è¾‘ã€‚ vimdiff åœ¨ç¼–è¾‘å®Œåä¼šä¿ç•™ *.orig çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å¾…è§£å†³å†²çªçš„æ–‡ä»¶å‰¯æœ¬ã€‚ ","date":"2023-12-27","objectID":"/posts/git-learn/:5:5","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Merge Conflict Prevent very long development branch. Split source code clearly. ","date":"2023-12-27","objectID":"/posts/git-learn/:5:6","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Toolbox","Linux Kernel Internals"],"content":"Rebase æ³¨æ„ âœ… è§‚çœ‹å½±ç‰‡ Git æ•™å­¦ç³»åˆ— - Branch and Mergeï¼ŒæŒæ¡ TODO çš„æ–¹æ³•ã€‚git rebase æ˜¯ Git çš„ç²¾åï¼Œå¯ä»¥è®©æˆ‘ä»¬å®ç°æ›´ç»†ç²’åº¦çš„æ“ä½œï¼Œå¯ä»¥è¯´å­¦ä¼šäº† rebase æ‰ç®—çœŸæ­£å…¥é—¨äº† Gitã€‚ è¿™ä¸ªè§†é¢‘è®²å¾—æ¯”è¾ƒä¹±ï¼Œæ‰€ä»¥æ¨èé…åˆè§†é¢‘ç»™å‡ºçš„å‚è€ƒæ–‡ç«  Git-rebase å°ç¬”è®° æ¥å­¦ä¹ ã€‚ ","date":"2023-12-27","objectID":"/posts/git-learn/:6:0","tags":["Git","GitHub"],"title":"Git å­¦ä¹ è®°å½•","uri":"/posts/git-learn/"},{"categories":["Operating Systems"],"content":"ç½‘ç»œä»£ç† æ ¹æ®é¡¹ç›® clash-for-linux-backup æ¥é…ç½® Ubuntu çš„ç½‘ç»œä»£ç†ã€‚ $ git clone https://github.com/Elegybackup/clash-for-linux-backup.git clash-for-linux è¿‡ç¨‹å½“ä¸­å¯èƒ½éœ€è¦å®‰è£… curl å’Œ net-toolsï¼Œæ ¹æ®æç¤ºè¿›è¡Œå®‰è£…å³å¯ï¼š sudo apt install curl sudo apt install net-tools å®‰è£…å¹¶å¯åŠ¨å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ localhost:9090/ui æ¥è®¿é—® Dashboardã€‚ å¯åŠ¨ä»£ç†ï¼š $ cd clash-for-linux $ sudo bash start.sh $ source /etc/profile.d/clash.sh $ proxy_on å…³é—­ä»£ç†ï¼š $ cd clash-for-linux $ sudo bash shutdown.sh $ proxy_off ","date":"2023-12-27","objectID":"/posts/ubuntu22.04lts/:1:0","tags":["Linux","Ubuntu"],"title":"Ubuntu 22.04LTS ç›¸å…³é…ç½®","uri":"/posts/ubuntu22.04lts/"},{"categories":["Operating Systems"],"content":"æœç‹—è¾“å…¥æ³• æ ¹æ® æœç‹—è¾“å…¥æ³• Linux å®‰è£…æŒ‡å¯¼ æ¥å®‰è£…æœç‹—è¾“å…¥æ³•ã€‚ å®‰è£…æ—¶æ— éœ€å¸è½½ç³»ç»Ÿ ibus è¾“å…¥æ³•æ¡†æ¶ (ä¸ä¸Šé¢çš„å®‰è£…æŒ‡å¯¼ä¸ä¸€è‡´) é€šè¿‡ Ctrl + space å”¤é†’æœç‹—è¾“å…¥æ³• é€šè¿‡ Ctrl + Shift + Z å‘¼å‡ºç‰¹æ®Šç¬¦å·è¡¨ ","date":"2023-12-27","objectID":"/posts/ubuntu22.04lts/:2:0","tags":["Linux","Ubuntu"],"title":"Ubuntu 22.04LTS ç›¸å…³é…ç½®","uri":"/posts/ubuntu22.04lts/"},{"categories":["Operating Systems"],"content":"å¿«æ·é”® æ–°å»ºç»ˆç«¯ï¼š Ctrl + Alt + T é”å±ï¼š Super + Lï¼šé”å®šå±å¹•å¹¶ç†„å±ã€‚ æ˜¾ç¤ºæ¡Œé¢ï¼š Super + d æˆ–è€… Ctrl + Alt + d æœ€å°åŒ–æ‰€æœ‰è¿è¡Œçš„çª—å£å¹¶æ˜¾ç¤ºæ¡Œé¢ï¼Œå†æ¬¡é”®å…¥åˆ™é‡æ–°æ‰“å¼€ä¹‹å‰çš„çª—å£ã€‚ æ˜¾ç¤ºæ‰€æœ‰çš„åº”ç”¨ç¨‹åºï¼š Super + a å¯ä»¥é€šè¿‡ ESC æ¥é€€å‡ºè¯¥æ˜¾ç¤ºã€‚ æ˜¾ç¤ºå½“å‰è¿è¡Œçš„æ‰€æœ‰åº”ç”¨ç¨‹åºï¼š Super ç§»åŠ¨çª—å£ä½ç½®ï¼š Super + å·¦ç®­å¤´ï¼šå½“å‰çª—å£ç§»åŠ¨åˆ°å±å¹•å·¦åŠè¾¹åŒºåŸŸ Super + å³ç®­å¤´ï¼šå½“å‰çª—å£ç§»åŠ¨åˆ°å±å¹•å³åŠè¾¹åŒºåŸŸ Super + ä¸Šç®­å¤´ï¼šå½“å‰çª—å£æœ€å¤§åŒ– Super + ä¸‹ç®­å¤´ï¼šå½“å‰çª—å£æ¢å¤æ­£å¸¸ éšè—å½“å‰çª—å£åˆ°ä»»åŠ¡æ ï¼š Super + h åˆ‡æ¢å½“å‰çš„åº”ç”¨ç¨‹åºï¼š Super + Tabï¼šä»¥åº”ç”¨ç¨‹åºä¸ºç²’åº¦æ˜¾ç¤ºåˆ‡æ¢é€‰é¡¹ Alt + Tabï¼šä»¥çª—å£ä¸ºç²’åº¦æ˜¾ç¤ºåˆ‡æ¢é€‰é¡¹ åˆ‡æ¢è™šæ‹Ÿæ¡Œé¢/å·¥ä½œåŒºï¼š Ctrl + Alt + å·¦/å³æ–¹å‘é”® è‡ªå®šä¹‰é”®ç›˜å¿«æ·é”®ï¼š Settings -\u003e Keyboard -\u003e Keyboard Shortcus | View and Customize Shortcuts -\u003e Custom Shortcuts ","date":"2023-12-27","objectID":"/posts/ubuntu22.04lts/:3:0","tags":["Linux","Ubuntu"],"title":"Ubuntu 22.04LTS ç›¸å…³é…ç½®","uri":"/posts/ubuntu22.04lts/"},{"categories":["Linux Kernel Internals"],"content":" æ‘˜è¦ GNU/Linux å¼€å‘å·¥å…·ï¼Œå‡ ä¹ä»ç¡¬ä»¶åˆ°è½¯ä»¶ï¼ŒLinux å¹³å°èƒ½å¤Ÿè‡ªä¸‹è€Œä¸Šæä¾›å„ç±»è§¦åŠâ€œçµé­‚â€çš„å­¦ä¹ æ¡ˆä¾‹ï¼Œè®©æ‰€æœ‰è¯¾ç¨‹ä»çº¸ä¸Šè°ˆå…µè½¬å˜æˆæ²™åœºå®æˆ˜ï¼Œä¼šæå¤§åœ°æå‡å·¥ç¨‹å®è·µçš„æ•ˆç‡å’ŒæŠ€èƒ½ã€‚ åŸæ–‡åœ°å€ ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:0:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"å®‰è£… Windows / Ubuntu åŒç³»ç»Ÿ å› ä¸ºæœ‰äº›æ“ä½œå¿…é¡»åœ¨ç‰©ç†ç¡¬ä»¶ä¸Šæ‰èƒ½æ‰§è¡Œã€‚ ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:1:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"Markdown ä¸ LaTeX é€Ÿè§ˆ LaTeX è¯­æ³•ç¤ºä¾‹ä¸€èŠ‚ï¼Œä½œä¸ºå·¥å…·ä¹¦å†Œï¼Œåœ¨éœ€è¦ä½¿ç”¨æ—¶çŸ¥é“å¦‚ä½•æŸ¥è¯¢ã€‚ é€Ÿè§ˆ Markdown è¯­æ³•ç¤ºä¾‹ä¸€èŠ‚ï¼Œä½œä¸ºå·¥å…·ä¹¦å†Œï¼Œåœ¨éœ€è¦ä½¿ç”¨æ—¶çŸ¥é“å¦‚ä½•æŸ¥è¯¢ã€‚ æ³¨æ„ ç¼–å†™ Markdown æ–‡æœ¬ä»¥åŠ LaTeX è¯­æ³•è¡¨ç¤ºçš„æ•°å­¦å¼å¯ä»¥é€šè¿‡ï¼š Hugo + FixIt âœ… VS Code + Markdown Preview Enhanced ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:2:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"Git å’Œ Github é˜…è¯» SSH key äº§ç”Ÿæ–¹æ³•ä¸€èŠ‚ï¼Œé…ç½®å¥½ Git å’Œ Github çš„ SSH keyã€‚åŒæ—¶ä¹Ÿå¯ä½œä¸ºå·¥å…·ä¹¦å†Œï¼Œåœ¨éœ€è¦ä½¿ç”¨æ—¶çŸ¥é“å¦‚ä½•æŸ¥è¯¢ã€‚ æ¨èé€šè¿‡ LearnGitBranching æ¥ç†Ÿæ‚‰ Git å‘½ä»¤ï¼ï¼ï¼ ä»¥ä¸‹èµ„æºä½œä¸ºè‡ªå­¦èµ„æºï¼Œç”¨äºè¡¥å……è‡ªå·±ä¸ç†Ÿæ‚‰çš„æ“ä½œï¼Œæˆ–è€…ä½œä¸ºä»¥ä¸Šèµ„æ–™çš„è¡¥å……å·¥å…·æ‰‹å†Œã€‚ Git ä¸­æ–‡æ•™å­¦ - YouTube (å­¦ä¹ è®°å½•) 30 å¤©ç²¾é€š Git ç‰ˆæœ¬æ§åˆ¶ - GitHub è­¦å‘Š åŸæ–‡æ¡£ä¸­çš„å°†å…¬é’¥å¤åˆ¶åˆ° clipboard ä¸­ä½¿ç”¨äº† clip å‘½ä»¤ï¼Œä½†æ˜¯è¿™ä¸ªå‘½ä»¤åœ¨ Ubuntu ä¸­å¹¶æ²¡æœ‰å¯¹åº”çš„å‘½ä»¤ã€‚å¯ä»¥ä½¿ç”¨ xclip + alias è¾¾åˆ°è¿‘ä¼¼æ•ˆæœã€‚ $ sudo apt install xclip # using alias to implement clip, you can add this to bashrc $ alias clip='xclip -sel c' $ clip \u003c ~/.ssh/id_rsa.pub ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:3:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"ç¼–è¾‘å™¨: Visual Studio Code è®¤çœŸé˜…è¯»ï¼Œè·Ÿéšæ•™å­¦æ–‡æ¡£è¿›è¡Œå®‰è£…ã€è®¾ç½®ã€‚é‡ç‚¹é˜…è¯» è®¾å®šã€é™¤é”™ï¼ˆè°ƒè¯•ï¼‰ è¿™ä¸¤éƒ¨åˆ†ã€‚æ›´æ–° VS Code éƒ¨åˆ†ä½œä¸ºæ‰‹å†Œï¼Œåœ¨éœ€è¦æ—¶è¿›è¡Œå‚è€ƒã€‚ ä»¥ä¸‹èµ„æºä½œä¸ºè‡ªå­¦èµ„æºï¼Œç”¨äºè¡¥å……è‡ªå·±ä¸ç†Ÿæ‚‰çš„æ“ä½œï¼Œæˆ–è€…ä½œä¸ºä»¥ä¸Šèµ„æ–™çš„è¡¥å……å·¥å…·æ‰‹å†Œã€‚ å¼€å¼€å¿ƒå¿ƒå­¦ Vistual Studio Code å®Œæˆ SSH key çš„ç”Ÿæˆã€‚ å®Œæˆ VS Code çš„è®¾ç½®ã€‚ å®‰è£… Git History æ’ä»¶ã€‚ å®‰è£… Native Debug æ’ä»¶ï¼Œå¹¶è¿›è¡Œ Debug (test-stopwatch.c) æ“ä½œã€‚ å®‰è£… VSCode Great Icons æ–‡ä»¶å›¾æ ‡ä¸»é¢˜ï¼Œå¦å¤–æ¨èä¸¤æ¬¾é¢œè‰²ä¸»é¢˜ï¼šOne Dark Pro, Learn with Sumitã€‚ VS Code æ§åˆ¶å°ä½¿ç”¨è¯´æ˜ï¼š å¯ä»¥åœ¨é¢æ¿çš„è¾“å‡ºï¼Œç‚¹å‡» GIT é€‰é¡¹æ˜¾ç¤º VS Code èƒŒåæ‰§è¡Œçš„ git å‘½ä»¤ã€‚ å¯ä»¥ä½¿ç”¨ ctrl + shift + P å‘¼å‡ºå‘½ä»¤åŒºï¼Œç„¶åé€šè¿‡è¾“å…¥ Git branch å’Œ Git checkout ç­‰å¹¶é€‰æ‹©å¯¹åº”é€‰é¡¹ï¼Œæ¥è¾¾åˆ°åˆ›å»ºåˆ†æ”¯ã€åˆ‡æ¢åˆ†æ”¯ç­‰åŠŸèƒ½ã€‚ æŠ€å·§ åœ¨ VS Code è®¾ç½®ä¸­ï¼Œéœ€è¦åœ¨è®¾ç½®ä¸­æ‰“å¼€ Open Default Settings é€‰é¡¹æ‰èƒ½åœ¨å·¦ä¾§é¢æ¿è§‚å¯Ÿåˆ°é¢„è®¾å€¼ã€‚é”®ä½ç»‘å®šåŒç†ã€‚ è¦æƒ³è¿›è¡Œè°ƒè¯•ï¼Œéœ€è¦åœ¨ä½¿ç”¨ gcc ç”Ÿæˆç›®æ ‡æ–‡ä»¶æ—¶ï¼ŒåŠ å…¥ -g å‚æ•°æ¥ç”Ÿäº§è°ƒè¯•ä¿¡æ¯ã€‚ åŸæ–‡æ¡£ä¸­çš„ GDB æ•™å­¦é“¾æ¥-é™¤é”™ç¨‹å¼-gdb å·²å¤±æ•ˆï¼Œè¿™æ˜¯ç›®å‰çš„æœ‰æ•ˆé“¾æ¥ã€‚ä¹Ÿå¯é€šè¿‡è¯¥å½±ç‰‡ æ‹¯æ•‘èµ„å·¥ç³»å­¦ç”Ÿçš„åŸºæœ¬ç´ å…»-ä½¿ç”¨ GDB é™¤é”™åŸºæœ¬æ•™å­¦ æ¥è¡¥å……å­¦ä¹  GDB çš„æ“ä½œã€‚ ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:4:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"ç»ˆç«¯å’Œ Vim è®¤çœŸé˜…è¯»ï¼Œè·Ÿéšæ•™å­¦å½±ç‰‡ å¿«å¿«ä¹ä¹å­¦ Vim å’Œæ•™å­¦æ–‡æ¡£é…ç½®å¥½ ç»ˆç«¯æç¤ºç¬¦ã€Vimã€‚ å®Œæˆå‘½ä»¤è¡Œæç¤ºç¬¦é…ç½® å®Œæˆ Vim çš„è®¾å®š å®‰è£…å¹¶ä½¿ç”¨ Minial Vim Plugin Manager æ¥ç®¡ç† Vim æ’ä»¶ (neocomplcache, nerdtree) å®‰è£…å¹¶ä½¿ç”¨ byobu æ¥ç®¡ç†å¤šä¸ªç»ˆç«¯è§†å›¾ã€‚ æŠ€å·§ åœ¨ .vimrc ä¸­å¢åŠ æ’ä»¶åï¼Œæ‰“å¼€ vimï¼Œæ‰§è¡Œ :PlugInstall æ¥å®‰è£…æ’ä»¶ï¼Œå®Œæˆååœ¨ vim æ‰§è¡Œ :source ~/.vimrcã€‚ï¼ˆå¯ä»¥é€šè¿‡ :PlugStatus æ¥æŸ¥çœ‹æ’ä»¶å®‰è£…çŠ¶æ€ï¼‰ ä½¿ç”¨ F4 é”®æ¥[æ˜¾ç¤º/ä¸æ˜¾ç¤º][è¡Œæ•°/ç›¸å¯¹è¡Œæ•°]ã€‚ ä½¿ç”¨ F5 é”®æ¥å‘¼å…¥/å‘¼å‡ºæ–‡ä»¶æ ‘(nerdtree)ï¼Œåœ¨æ–‡ä»¶æ ‘æ»é€šè¿‡ ENTER é”®æ¥è®¿é—®ç›®å½•/æ–‡ä»¶ã€‚ ä½¿ç”¨ Ctrl-w-h/Ctrl-w-l åˆ‡æ¢åˆ° æ–‡ä»¶æ ‘/ç¼–è¾‘åŒºã€‚ è‡ªåŠ¨è¡¥å…¨æ—¶ä½¿ç”¨ ENTER é”®æ¥é€‰ä¸­ï¼Œä½¿ç”¨æ–¹å‘é”®æˆ– Ctrl-N/Ctrl-U/Ctrl-P æ¥ä¸Šä¸‹é€‰æ‹©ã€‚ åœ¨ Vim ä¸­å¯ä»¥é€šè¿‡ :set pasteï¼Œå¹¶åœ¨ insert æ¨¡å¼ä¸‹ï¼Œå°†ç²˜è´´æ¿çš„å†…å®¹é€šè¿‡ Ctrl-Shift-V è¿›è¡Œç²˜è´´ã€‚ byobu ä½¿ç”¨è¯´æ˜ï¼š åœ¨ç»ˆç«¯è¾“å…¥ byobu F2 æ–°å¢ Terminial åˆ†é¡µã€‚F3, F4 åœ¨ Terminial åˆ†é¡µä¸­åˆ‡æ¢ã€‚Ctrl +F6 åˆ é™¤å½“å‰ Terminial åˆ†é¡µã€‚ Shift + F2 æ°´å¹³åˆ‡å‰² Terminialã€‚Ctrl +F2 å‚ç›´åˆ‡å‰² Terminialã€‚Shift + æ–¹å‘é”® åˆ‡æ¢ã€‚ åœ¨ byobu ä¸­æš‚æ—¶æ— æ³•ä½¿ç”¨ä¹‹å‰è®¾ç½®çš„ F4 æˆ– F5 å¿«æ·é”®ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥é€šè¿‡å‘½ä»¤ :set norelative æ¥å…³é—­ç›¸å¯¹è¡Œæ•°ã€‚ æ¨èè§‚çœ‹å½±ç‰‡ How to Do 90% of What Plugins Do (With Just Vim) æ¥æ‰©å±• Vim æ’ä»¶çš„ä½¿ç”¨å§¿åŠ¿ã€‚ ä»¥ä¸‹èµ„æºä¸º Cheat Sheetï¼Œéœ€è¦ä½¿ç”¨æ—¶å›æ¥å‚è€ƒå³å¯ã€‚ Vim Cheat Sheet Bash terminal Cheat Sheet ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:5:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"Makefile é€Ÿè§ˆæ•™å­¦æ–‡æ¡£ï¼Œä½œä¸ºå·¥å…·ä¹¦å†Œï¼Œåœ¨éœ€è¦ä½¿ç”¨æ—¶çŸ¥é“å¦‚ä½•æŸ¥è¯¢ã€‚ gcc çš„ -MMD å’Œ -MF å‚æ•°å¯¹æˆ‘ä»¬ç¼–å†™ Makefile æ˜¯ä¸€ä¸ªå·¨å¤§åˆ©å™¨ã€‚ç†è§£ Makefile çš„å„ç§å˜é‡å®šä¹‰çš„åŸç†ã€‚ å¯¹ä¹‹å‰çš„ test-stopwatch.c ç¼–å†™äº†ä¸€ä¸ª Makefile æ¥è‡ªåŠ¨åŒ–ç®¡ç†ã€‚ ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:6:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"Linux æ€§èƒ½åˆ†æå·¥å…·: Perf è®¤çœŸé˜…è¯»ï¼Œå¤ç°æ•™å­¦æ–‡æ¡£ä¸­çš„æ‰€æœ‰ä¾‹å­ï¼Œåˆæ­¥ä½“éªŒ perf åœ¨æ€§èƒ½åˆ†æä¸Šçš„å¼ºå¤§ã€‚ å®‰è£… perf å¹¶å°† kernel.perf_event_paranoid è®¾ç½®ä¸º 1ã€‚ åŠ¨æ‰‹ä½¿ç”¨ perf_top_example.cï¼Œä½“éªŒ perf çš„ä½œç”¨ã€‚ æ­é…å½±ç‰‡: Branch Prediction å¯¹ç…§é˜…è¯»: Fast and slow if-statements: branch prediction in modern processors ç¼–è¯‘å™¨æä¾›çš„è¾…åŠ©æœºåˆ¶: Branch Patterns, Using GCC åŠ¨æ‰‹ä½¿ç”¨ perf_top_while.cï¼Œä½“éªŒ perf top çš„ä½œç”¨ã€‚ åŠ¨æ‰‹ä½¿ç”¨ perf_stat_cache_miss.cï¼Œä½“éªŒ perf stat çš„ä½œç”¨ã€‚ï¼ˆåŸæ–‡çš„ç»“æœæœ‰äº›ä¸ç›´è§‚ï¼ŒåŠ¡å¿…äº²è‡ªåŠ¨æ‰‹éªŒè¯ï¼‰ åŠ¨æ‰‹ä½¿ç”¨ perf_record_example.cï¼Œä½“éªŒ perf record çš„ä½œç”¨ã€‚ï¼ˆåŸæ–‡çš„æ“ä½œä¸æ˜¯å¾ˆè¯¦ç»†ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„ Successï¼‰ Source æˆåŠŸ $ perf record -e branch-misses:u,branch-instructions:u ./perf_record_example [ perf record: Woken up 1 times to write data ] [ perf record: Captured and wrote 0.009 MB perf.data (94 samples) ] è¾“å‡ºç¬¬ä¸€è¡Œè¡¨ç¤º perf å·¥å…·åœ¨æ”¶é›†æ€§èƒ½æ•°æ®æ—¶è¢«å”¤é†’äº† 1 æ¬¡ï¼Œä»¥å°†æ•°æ®å†™å…¥è¾“å‡ºæ–‡ä»¶ã€‚ è¾“å‡ºç¬¬äºŒè¡Œè¡¨ç¤º perf å·¥å…·å·²ç»å–æ ·å¹¶å†™å…¥äº†ä¸€ä¸ªåä¸º perf.data çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ–‡ä»¶å¤§å°ä¸º 0.009 MBï¼Œå…¶ä¸­åŒ…å«äº† 94 ä¸ªé‡‡æ ·ã€‚ï¼ˆå¯ä»¥é€šè¿‡ ls å‘½ä»¤æ¥æ£€æŸ¥ perf.data æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼‰ æ¥ä¸‹æ¥é€šè¿‡ perf report å¯¹ä¹‹å‰è¾“å‡ºçš„äºŒè¿›åˆ¶æ–‡ä»¶ perf.data è¿›è¡Œåˆ†æã€‚å¯ä»¥é€šè¿‡æ–¹å‘é”®é€‰æ‹©ï¼Œå¹¶é€šè¿‡ ENTER è¿›å…¥ä¸‹ä¸€å±‚æŸ¥çœ‹åˆ†æç»“æœã€‚ $ perf report Available samples 5 branch-misses:u 89 branch-instructions:u æŠ€å·§ perf éœ€è¦åœ¨ root ä¸‹è¿›è¡Œæ€§èƒ½åˆ†æã€‚ perf top æ˜¯å¯¹äºå“ªä¸ªç¨‹åºæ˜¯æ€§èƒ½ç“¶é¢ˆæ²¡æœ‰å¤´ç»ªæ—¶ä½¿ç”¨ï¼Œå¯ä»¥æŸ¥çœ‹å“ªä¸ªç¨‹åºï¼ˆä»¥åŠç¨‹åºçš„å“ªä¸ªéƒ¨åˆ†ï¼‰æ˜¯çƒ­åº¦ç‚¹ã€‚ åœ¨ perf top æ—¶å¯ä»¥é€šè¿‡ h é”®å‘¼å‡ºå¸®åŠ©åˆ—è¡¨ã€‚ å¯ä»¥é€šè¿‡æ–¹å‘é”®é€‰æ‹©éœ€è¦è¿›ä¸€æ­¥åˆ†æçš„éƒ¨åˆ†ï¼Œå¹¶é€šè¿‡ a é”®æ¥æŸ¥çœ‹æŒ‡ä»¤çº§åˆ«ç²’åº¦çš„çƒ­ç‚¹ã€‚ perf stat æ˜¯å¯¹æŸä¸€ä¸ªè¦ä¼˜åŒ–çš„ç¨‹åºè¿›è¡Œæ€§èƒ½åˆ†æï¼Œå¯¹è¯¥ç¨‹åºæ¶‰åŠçš„ä¸€ç³»åˆ— events è¿›è¡Œå–æ ·æ£€æŸ¥ã€‚ perf record çš„ç²¾åº¦æ¯” perf stat æ›´é«˜ï¼Œå¯ä»¥å¯¹å–æ ·çš„ events è¿›è¡Œå‡½æ•°ç²’åº¦çš„åˆ†æã€‚ ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:7:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"Linux ç»˜å›¾å·¥å…·: gnuplot é˜…è¯»æ•™ç¨‹ï¼Œæ­é…æ•™å­¦å½±ç‰‡ è½»è½»æ¾æ¾å­¦ gnuplotï¼Œä½¿ç”¨ gnuplot å®Œæˆæ‰€ç»™ä¾‹å­ç›¸åº”å›¾åƒçš„ç»˜åˆ¶ã€‚ ä½¿ç”¨ runtime.gp å®Œæˆ runtime.png çš„ç»˜åˆ¶ç”Ÿæˆã€‚ ä½¿ç”¨ statistic.gp å®Œæˆé™é›¨é‡æŠ˜çº¿å›¾ statistic.png çš„ç»˜åˆ¶ç”Ÿæˆã€‚ æ³¨æ„ åŸæ–‡æ‰€ç»™çš„ statistic.gp æ˜¯ä½¿ç”¨ Times_New_Roman æ¥æ˜¾ç¤ºä¸­æ–‡çš„ï¼Œä½†ç¬”è€…çš„ Ubuntu ä¸­å¹¶æ²¡æœ‰è¿™ä¸ªå­—ä½“ï¼Œæ‰€ä»¥ä¼šæ˜¾ç¤ºä¹±ç ã€‚å¯ä»¥é€šè¿‡ fc-list :lang=zh å‘½ä»¤æ¥æŸ¥è¯¢å½“å‰ç³»ç»Ÿä¸­çš„å·²å®‰è£…çš„ä¸­æ–‡å­—ä½“ã€‚ Source å®‰è£… gnuplot: $ sudo apt-get install gnuplot gnuplot script çš„ä½¿ç”¨æµç¨‹ï¼š # åˆ›å»ºå¹¶ç¼–å†™ä¸€ä¸ªåç¼€åä¸º .gp çš„æ–‡ä»¶ $ vim script.gp # æ ¹æ® script å†…çš„æŒ‡ä»¤è¿›è¡Œç»˜å›¾ $ gnuplot script.gp # æ ¹æ® script æŒ‡å®šçš„å›¾ç‰‡ä¿å­˜è·¯å¾„æ‰“å¼€å›¾ç‰‡ $ eog [name of picture] ä¸‹é¢ä»¥ä¸€ä¸ª script è¿›è¡Œå¸¸ç”¨æŒ‡ä»¤çš„è¯´æ˜ï¼š reset set ylabel 'time(sec)' set style fill solid set title 'performance comparison' set term png enhanced font 'Verdana,10' set output 'runtime.png' plot [:][:0.100]'output.txt' using 2:xtic(1) with histogram title 'original', \\ '' using ($0-0.06):($2+0.001):2 with labels title ' ', \\ '' using 3:xtic(1) with histogram title 'optimized' , \\ '' using 4:xtic(1) with histogram title 'hash' , \\ '' using ($0+0.3):($3+0.0015):3 with labels title ' ', \\ '' using ($0+0.4):($4+0.0015):4 with labels title ' ' reset æŒ‡ä»¤çš„ä½œç”¨ä¸ºï¼Œå°†ä¹‹å‰ set æŒ‡ä»¤è®¾ç½®è¿‡çš„å†…å®¹å…¨éƒ¨é‡ç½®ã€‚ set style fill solid å°†ç»˜åˆ¶å‡ºçš„æŸ±å½¢æˆ–åŒºåŸŸä½¿ç”¨å®å¿ƒæ–¹å¼å¡«å……ã€‚ set term png enhanced font 'Verdana,10' term png ç”Ÿæˆçš„å›¾åƒä»¥ png æ ¼å¼è¿›è¡Œä¿å­˜ã€‚(term æ˜¯ terminial çš„ç¼©å†™) enhanced å¯ç”¨å¢å¼ºæ–‡æœ¬æ¨¡å¼ï¼Œå…è®¸åœ¨æ ‡ç­¾å’Œæ³¨é‡Šä¸­ä½¿ç”¨ç‰¹æ®Šçš„æ–‡æœ¬æ ¼å¼ï¼Œå¦‚ä¸Šä¸‹æ ‡ã€æ–œä½“ã€ä¸‹åˆ’çº¿ç­‰ã€‚ font 'Verdana,10' æŒ‡å®šæ‰€ä½¿ç”¨çš„å­—ä½“ä¸º Verdanaï¼Œå­—å·ä¸º10ã€‚å¯è¿›è¡Œè‡ªå®šä¹‰è®¾ç½®ã€‚ å…¶å®ƒæŒ‡ä»¤æŸ¥è¯¢åŸæ–‡æˆ–æ‰‹å†Œå³å¯ã€‚ $0 åœ¨ gnuplot ä¸­è¡¨ç¤ºä¼ªåˆ—ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºè¡Œå·ï¼Œä»¥ä¸‹ä¸ºç›¸åº”å›¾ç¤ºï¼š åŸå§‹æ•°æ®é›†ï¼š append() 0.048240 0.040298 0.057908 findName() 0.006495 0.002938 0.000001 ï¼ˆäººä¸ºï¼‰å¢åŠ äº† ä¼ªåˆ— è¡¨ç¤ºçš„æ•°æ®é›†ï¼ˆæœ€å·¦è¾¹ 0, 1 å³ä¸ºä¼ªåˆ—ï¼‰ï¼š 0 append() 0.048240 0.040298 0.057908 1 findName() 0.006495 0.002938 0.000001 æŠ€å·§ gnuplot åœ¨ç»˜åˆ¶ç”Ÿæˆå›¾åƒæ—¶æ˜¯å®‰è£…æŒ‡ä»¤çš„é¡ºåºè¿›è¡Œçš„ï¼Œå¹¶ä¸”å’Œä¸€èˆ¬çš„ç”»å›¾è½¯ä»¶ç±»ä¼¼ï¼Œåœ¨æœ€ä¸Šå±‚è¿›è¡Œç»˜åˆ¶ã€‚æ‰€ä»¥åœ¨ç¼–å†™ script çš„æŒ‡ä»¤æ—¶éœ€è¦æ³¨æ„é¡ºåºï¼Œå¦åˆ™ç”Ÿæˆå›¾åƒçš„éƒ¨åˆ†å¯èƒ½å¹¶ä¸åƒé¢„æœŸä¸€æ ·ä½äºæœ€ä¸Šå±‚ã€‚ï¼ˆæ€è€ƒä¸Šé¢ script çš„ 3, 4 åˆ—çš„ label çš„ç»˜åˆ¶é¡ºåºï¼‰ gnuplot script ä¸­çš„å­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨ '' æˆ–è€… \"\" æ¥åŒ…è£¹ï¼ŒåŒæ ·ç±»ä¼¼äº Pythonã€‚ ç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ gnuplot ä¼šè¿›å…¥äº¤äº’å¼çš„å‘½ä»¤ç•Œé¢ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ gnulpot æŒ‡ä»¤æ¥ç»˜å›¾ï¼ˆç±»ä¼¼ä¸ Pythonï¼‰ã€‚åœ¨è¿™ç§äº¤äº’å¼ç•Œé¢ç¯å¢ƒä¸­ï¼Œå¦‚æœéœ€è¦åœ¨è¾“å…¥å®ŒæŒ‡ä»¤åç«‹å³æ˜¾ç¤ºå›¾åƒåˆ°æ–°çª—å£ï¼Œè€Œä¸æ˜¯ä¿å­˜å›¾åƒå†æ‰“å¼€ï¼Œåªéœ€è¾“å…¥è¿›è¡ŒæŒ‡ä»¤ï¼š set term wxt ehanced persist raise term wxt å°†å›¾å½¢ç»ˆç«¯ç±»å‹è®¾ç½®ä¸ºWXTï¼Œè¿™ä¼šåœ¨æ–°çª—å£ä¸­æ˜¾ç¤ºç»˜å›¾ã€‚ ersist è¯¥é€‰é¡¹ä½¿ç»˜å›¾çª—å£ä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œå³ä½¿è„šæœ¬æ‰§è¡Œå®Œæ¯•ä¹Ÿä¸ä¼šè‡ªåŠ¨å…³é—­ã€‚ raise è¯¥é€‰é¡¹å°†ç»˜å›¾çª—å£ç½®äºå…¶ä»–çª—å£çš„å‰é¢ï¼Œä»¥ç¡®ä¿å®ƒåœ¨å±å¹•ä¸Šçš„å¯è§æ€§ã€‚ ä¸€äº›é¢å¤–çš„æ•™ç¨‹ï¼š Youtube - gnuplot Tutorlal è¿™ä¸ªæ•™ç¨‹æœ‰äº”éƒ¨å½±ç‰‡ï¼Œåˆ°å‘å¸ƒè€…çš„ä¸»é¡µæœå¯»å³å¯ã€‚ ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:8:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"Linux ç»˜å›¾å·¥å…·: Graphviz å®˜æ–¹ç½‘ç«™ ä¸€å°æ—¶å®è·µå…¥é—¨ Graphviz å®‰è£…: $ sudo apt install graphviz æŸ¥çœ‹å®‰è£…ç‰ˆæœ¬: $ dot -V dot - graphviz version 2.43.0 (0) é€šè¿‡è„šæœ¬ç”Ÿæˆå›¾åƒ: $ dot -Tpng example.dot -o example.png Graphviz åœ¨æ¯å‘¨æµ‹éªŒé¢˜çš„åŸç†è§£é‡Šåˆ†ææ—¶ä¼šå¤§é‡ä½¿ç”¨åˆ°ï¼Œè¯·åŠ¡å¿…æŒæ¡ä»¥å®ä½œå‡º Readable çš„æŠ¥å‘Šã€‚ ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:9:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"å…¶å®ƒå·¥å…· ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:10:0","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"cloc man 1 cloc cloc - Count, or compute differences of, lines of source code and comments. ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:10:1","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"top man 1 top top - display Linux processes ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:10:2","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Linux Kernel Internals"],"content":"htop man 1 htop htop - interactive process viewer ","date":"2023-12-25","objectID":"/posts/gnu-linux-dev/:10:3","tags":["Sysprog","Linux"],"title":"GNU/Linux å¼€å‘å·¥å…·","uri":"/posts/gnu-linux-dev/"},{"categories":["Mathematics"],"content":" ä¸­å¤§æ•¸å­¸ç³»é–‹æ”¾å¼èª²ç¨‹ å°å¤§é½éœ‡å®‡ æ•°å­¦æ½œæ°´è‰‡: https://equation.nidbox.com/diary/read/9028768 å¾®ç§¯åˆ† åˆ†æ å°å¤§è°¢é“­ä¼¦ - çº¿æ€§ä»£æ•° ","date":"2023-12-23","objectID":"/posts/math/:0:0","tags":["Mathematics"],"title":"æ•°å­¦å¼€æ”¾å¼è¯¾ç¨‹å­¦ä¹ æŒ‡å¼•","uri":"/posts/math/"},{"categories":["draft"],"content":"åšå®¢ï¼ˆè‹±è¯­ï¼šBlogï¼‰æ˜¯ä¸€ç§åœ¨çº¿æ—¥è®°å‹å¼çš„ä¸ªäººç½‘ç«™ï¼Œå€Ÿç”±å¼ å¸–å­ç« ã€å›¾ç‰‡æˆ–è§†é¢‘æ¥è®°å½•ç”Ÿæ´»ã€æŠ’å‘æƒ…æ„Ÿæˆ–åˆ†äº«ä¿¡æ¯ã€‚åšå®¢ä¸Šçš„æ–‡ç« é€šå¸¸æ ¹æ®å¼ è´´æ—¶é—´ï¼Œä»¥å€’åºæ–¹å¼ç”±æ–°åˆ°æ—§æ’åˆ—ã€‚ ","date":"2023-12-23","objectID":"/posts/hello_world/:0:0","tags":["draft"],"title":"Hello, World","uri":"/posts/hello_world/"},{"categories":["draft"],"content":"æ•°å­¦å…¬å¼ è¡Œå†…å…¬å¼ï¼š$N(b,d)=(b-1)M$ å…¬å¼å—ï¼š $$ \\int_{a}^{b}x(t)dt = \\dfrac{b - a}{N} \\\\ =\\sum_{k=1}^{N}x(t_k)\\cdot\\dfrac{b-a}{N} $$ $$ \\begin{aligned} \\int_{a}^{b}x(t)dt \u0026= \\dfrac{b - a}{N} \\\\ \u0026=\\sum_{k=1}^{N}x(t_k)\\cdot\\dfrac{b-a}{N} \\\\ \\end{aligned} $$ $$ \\mathrm{Integrals\\ are\\ numerically\\ approximated\\ as\\ finite\\ series}:\\\\ \\begin{split} \\int_{a}^{b}x(t)dt \u0026= \\dfrac{b - a}{N} \\\\ \u0026=\\sum_{k=1}^{N}x(t_k)\\cdot\\dfrac{b-a}{N} \\end{split} \\\\ where\\ t_k = a + (b-a)\\cdot k/N $$ $$ \\begin{align*} p(x) = 3x^6 + 14x^5y \u0026+ 590x^4y^2 + 19x^3y^3 \\\\ \u0026- 12x^2y^4 - 12xy^5 + 2y^6 - a^3b^3 - a^2b - ab + c^5d^3 + c^4d^3 - cd \\end{align*} $$ $$ \\begin{split} \u0026(X \\in B) = X^{-1}(B) = {s \\in S: X(s) \\in B} \\subset S \\\\ \u0026\\Rightarrow P(x \\in B) = P({s \\in S: X(s) \\in B}) \\end{split} $$ ","date":"2023-12-23","objectID":"/posts/hello_world/:1:0","tags":["draft"],"title":"Hello, World","uri":"/posts/hello_world/"},{"categories":["draft"],"content":"ä»£ç å— let i: i32 = 13; let v = vec![1, 2, 3, 4, 5, 65]; for x in v.iter() { println!(\"{}\", x); } typedef struct Block_t { int head; int data; } Block_t; ","date":"2023-12-23","objectID":"/posts/hello_world/:2:0","tags":["draft"],"title":"Hello, World","uri":"/posts/hello_world/"},{"categories":["draft"],"content":"Admonition æ³¨æ„ ä¸€ä¸ª æ³¨æ„ æ¨ªå¹… æ‘˜è¦ ä¸€ä¸ª æ‘˜è¦ æ¨ªå¹… ä¿¡æ¯ ä¸€ä¸ª ä¿¡æ¯ æ¨ªå¹… æŠ€å·§ ä¸€ä¸ª æŠ€å·§ æ¨ªå¹… æˆåŠŸ ä¸€ä¸ª æˆåŠŸ æ¨ªå¹… é—®é¢˜ ä¸€ä¸ª é—®é¢˜ æ¨ªå¹… è­¦å‘Š ä¸€ä¸ª è­¦å‘Š æ¨ªå¹… å¤±è´¥ ä¸€ä¸ª å¤±è´¥ æ¨ªå¹… å±é™© ä¸€ä¸ª å±é™© æ¨ªå¹… Bug ä¸€ä¸ª Bug æ¨ªå¹… ç¤ºä¾‹ ä¸€ä¸ª ç¤ºä¾‹ æ¨ªå¹… å¼•ç”¨ ä¸€ä¸ª å¼•ç”¨ æ¨ªå¹… ","date":"2023-12-23","objectID":"/posts/hello_world/:3:0","tags":["draft"],"title":"Hello, World","uri":"/posts/hello_world/"},{"categories":["draft"],"content":"References FixIt å¿«é€Ÿä¸Šæ‰‹ ä½¿ç”¨ Hugo + Github æ­å»ºä¸ªäººåšå®¢ Markdown åŸºæœ¬è¯­æ³• Emoji æ”¯æŒ æ‰©å±• Shortcodes æ¦‚è¿° å›¾è¡¨æ”¯æŒ URL management ","date":"2023-12-23","objectID":"/posts/hello_world/:4:0","tags":["draft"],"title":"Hello, World","uri":"/posts/hello_world/"}]