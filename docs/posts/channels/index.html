<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Crust of Rust: Channels - KZnight&#39;s Blog</title><meta name="author" content="ccrysisa">
<meta name="author-link" content="https://github.com/ccrysisa">
<meta name="description" content="
In this (fifth) Crust of Rust video, we cover multi-produce/single-consumer (mpsc) channels, by re-implementing some of the std::sync::mpsc types from the standard library. As part of that, we cover what channels are used for, how they work at a high level, different common channel variants, and common channel implementations. In the process, we go over some common Rust concurrency primitives like Mutex and Condvar.
" /><meta name="keywords" content='Rust, Channel' />
  <meta itemprop="name" content="Crust of Rust: Channels">
  <meta itemprop="description" content=" In this (fifth) Crust of Rust video, we cover multi-produce/single-consumer (mpsc) channels, by re-implementing some of the std::sync::mpsc types from the standard library. As part of that, we cover what channels are used for, how they work at a high level, different common channel variants, and common channel implementations. In the process, we go over some common Rust concurrency primitives like Mutex and Condvar.">
  <meta itemprop="datePublished" content="2024-02-29T20:30:30+08:00">
  <meta itemprop="dateModified" content="2024-03-04T23:05:35+08:00">
  <meta itemprop="wordCount" content="1543">
  <meta itemprop="image" content="https://ccrysisa.github.io/logo.png">
  <meta itemprop="keywords" content="Rust,Channel"><meta property="og:url" content="https://ccrysisa.github.io/posts/channels/">
  <meta property="og:site_name" content="KZnight&#39;s Blog">
  <meta property="og:title" content="Crust of Rust: Channels">
  <meta property="og:description" content=" In this (fifth) Crust of Rust video, we cover multi-produce/single-consumer (mpsc) channels, by re-implementing some of the std::sync::mpsc types from the standard library. As part of that, we cover what channels are used for, how they work at a high level, different common channel variants, and common channel implementations. In the process, we go over some common Rust concurrency primitives like Mutex and Condvar.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-29T20:30:30+08:00">
    <meta property="article:modified_time" content="2024-03-04T23:05:35+08:00">
    <meta property="article:tag" content="Rust">
    <meta property="article:tag" content="Channel">
    <meta property="og:image" content="https://ccrysisa.github.io/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://ccrysisa.github.io/logo.png">
  <meta name="twitter:title" content="Crust of Rust: Channels">
  <meta name="twitter:description" content=" In this (fifth) Crust of Rust video, we cover multi-produce/single-consumer (mpsc) channels, by re-implementing some of the std::sync::mpsc types from the standard library. As part of that, we cover what channels are used for, how they work at a high level, different common channel variants, and common channel implementations. In the process, we go over some common Rust concurrency primitives like Mutex and Condvar.">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://ccrysisa.github.io/posts/channels/" /><link rel="prev" href="https://ccrysisa.github.io/posts/c-standards/" /><link rel="next" href="https://ccrysisa.github.io/posts/riscv-optimization-guide/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Crust of Rust: Channels",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/ccrysisa.github.io\/posts\/channels\/"
    },"genre": "posts","keywords": "Rust, Channel","wordcount":  1543 ,
    "url": "https:\/\/ccrysisa.github.io\/posts\/channels\/","datePublished": "2024-02-29T20:30:30+08:00","dateModified": "2024-03-04T23:05:35+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "ccrysisa"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="KZnight&#39;s Blog"><img loading="lazy" src="/fixit.min.svg" alt="KZnight&#39;s Blog" data-title="KZnight&#39;s Blog" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-text">KZnight&#39;s Blog</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/friends/"
                
                
              ><i class="fa-solid fa-user-group fa-fw fa-sm" aria-hidden="true"></i> Friends</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="KZnight&#39;s Blog"><img loading="lazy" src="/fixit.min.svg" alt="/fixit.min.svg" data-title="/fixit.min.svg" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-text">KZnight&#39;s Blog</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/friends/"
                  
                  
                ><i class="fa-solid fa-user-group fa-fw fa-sm" aria-hidden="true"></i> Friends</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span title="转载" class="icon-repost"><i class="fa-solid fa-share fa-fw" aria-hidden="true"></i></span><span>Crust of Rust: Channels</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://github.com/ccrysisa" title="作者"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><img loading="lazy" src="https://avatars.githubusercontent.com/u/133117003?s=400&amp;v=4" alt="ccrysisa" data-title="ccrysisa" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;ccrysisa</a></span><span class="post-included-in">&nbsp;收录于 <a href="/categories/rust/" class="post-category" title="分类 - Rust"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Rust</a></span></div><div class="post-meta-line"><span title="发布于 2024-02-29 20:30:30"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2024-02-29">2024-02-29</time></span>&nbsp;<span title="更新于 2024-03-04 23:05:35"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2024-03-04">2024-03-04</time></span>&nbsp;<span title="1543 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 1600 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 4 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#channel">Channel</a>
      <ul>
        <li><a href="#concurrency-vs-parallelism">Concurrency vs Parallelism</a></li>
      </ul>
    </li>
    <li><a href="#影片注解">影片注解</a>
      <ul>
        <li><a href="#sender--receiver">Sender &amp; Receiver</a></li>
        <li><a href="#condition-variable">Condition Variable</a></li>
        <li><a href="#clone">Clone</a></li>
        <li><a href="#dbg">dbg</a></li>
        <li><a href="#performance-optimization">Performance optimization</a></li>
        <li><a href="#synchronous-channels">Synchronous channels</a></li>
        <li><a href="#channel-flavors">Channel flavors</a></li>
        <li><a href="#asyncawait">async/await</a></li>
      </ul>
    </li>
    <li><a href="#homework">Homework</a></li>
    <li><a href="#documentations">Documentations</a>
      <ul>
        <li><a href="#crate-stdhttpsdocrust-langorgstdindexhtml">Crate <a href="https://doc.rust-lang.org/std/index.html">std</a></a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><blockquote>
<p>In this (fifth) Crust of Rust video, we cover multi-produce/single-consumer (mpsc) channels, by re-implementing some of the std::sync::mpsc types from the standard library. As part of that, we cover what channels are used for, how they work at a high level, different common channel variants, and common channel implementations. In the process, we go over some common Rust concurrency primitives like Mutex and Condvar.</p>
</blockquote>
<ul>
<li>整理自 <a href="https://www.youtube.com/watch?v=b4mS5UPHh20"target="_blank" rel="external nofollow noopener noreferrer">John Gjengset 的影片</a></li>
</ul>
<h2 id="channel" class="heading-element">
  <a href="#channel" class="heading-mark"></a>Channel</h2><ul>
<li>Wikipedia: <a href="https://en.wikipedia.org/wiki/Channel_%28programming%29"target="_blank" rel="external nofollow noopener noreferrer">Channel</a></li>
</ul>
<div class="details admonition quote open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-quote-right fa-fw" aria-hidden="true"></i>引用<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">In computing, a <strong>channel</strong> is a model for <a href="https://en.wikipedia.org/wiki/Interprocess_communication"target="_blank" rel="external nofollow noopener noreferrer">interprocess communication</a> and <a href="https://en.wikipedia.org/wiki/Synchronization"target="_blank" rel="external nofollow noopener noreferrer">synchronization</a> via <a href="https://en.wikipedia.org/wiki/Message_passing"target="_blank" rel="external nofollow noopener noreferrer">message passing</a>. A message may be sent over a channel, and another process or thread is able to receive messages sent over a channel it has a <a href="https://en.wikipedia.org/wiki/Reference_%28computer_science%29"target="_blank" rel="external nofollow noopener noreferrer">reference</a> to, as a <a href="https://en.wikipedia.org/wiki/Stream_%28computing%29"target="_blank" rel="external nofollow noopener noreferrer">stream</a>.</div>
    </div>
  </div>
<ul>
<li>YouTube: <a href="https://www.youtube.com/watch?v=vFCTpxuGwpw"target="_blank" rel="external nofollow noopener noreferrer">Channels in Rust</a></li>
</ul>
<a class="lightgallery" href="https://marketsplash.com/content/images/2023/09/rust-channels.png?size=large" data-thumbnail="https://marketsplash.com/content/images/2023/09/rust-channels.png?size=small" data-sub-html="<h2>https://marketsplash.com/content/images/2023/09/rust-channels.png</h2>"><img loading="lazy" src="https://marketsplash.com/content/images/2023/09/rust-channels.png" alt="https://marketsplash.com/content/images/2023/09/rust-channels.png" srcset="https://marketsplash.com/content/images/2023/09/rust-channels.png?size=small, https://marketsplash.com/content/images/2023/09/rust-channels.png?size=medium 1.5x, https://marketsplash.com/content/images/2023/09/rust-channels.png?size=large 2x" sizes="auto" data-title="https://marketsplash.com/content/images/2023/09/rust-channels.png" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a>
<blockquote>
<p><a href="https://marketsplash.com/tutorials/rust/rust-channels/"target="_blank" rel="external nofollow noopener noreferrer">Source</a></p>
</blockquote>
<h3 id="concurrency-vs-parallelism" class="heading-element">
  <a href="#concurrency-vs-parallelism" class="heading-mark"></a>Concurrency vs Parallelism</h3><ul>
<li><a href="https://stackoverflow.com/questions/1050222/what-is-the-difference-between-concurrency-and-parallelism"target="_blank" rel="external nofollow noopener noreferrer">What is the difference between concurrency and parallelism?</a></li>
<li><a href="https://medium.com/@itIsMadhavan/concurrency-vs-parallelism-a-brief-review-b337c8dac350"target="_blank" rel="external nofollow noopener noreferrer">Concurrency vs. Parallelism — A brief view</a></li>
</ul>
<h2 id="影片注解" class="heading-element">
  <a href="#%e5%bd%b1%e7%89%87%e6%b3%a8%e8%a7%a3" class="heading-mark"></a>影片注解</h2><h3 id="sender--receiver" class="heading-element">
  <a href="#sender--receiver" class="heading-mark"></a>Sender &amp; Receiver</h3><figure><a class="lightgallery" href="/images/rust/mpsc.drawio.svg?size=large" data-thumbnail="/images/rust/mpsc.drawio.svg?size=small" data-sub-html="<h2>multi-produce/single-consumer (mpsc)</h2>"><img loading="lazy" src="/images/rust/mpsc.drawio.svg" alt="/images/rust/mpsc.drawio.svg" srcset="/images/rust/mpsc.drawio.svg?size=small, /images/rust/mpsc.drawio.svg?size=medium 1.5x, /images/rust/mpsc.drawio.svg?size=large 2x" sizes="auto" data-title="/images/rust/mpsc.drawio.svg" class="suffix-invalid suffix-invalid__small suffix-invalid__large" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a><figcaption class="image-caption">multi-produce/single-consumer (mpsc)</figcaption>
  </figure>
<ul>
<li>Why does the recevier type need to have an arc protected by mutex if the channel may only have a single consumer thread?</li>
</ul>
<blockquote>
<p>Because a send and a recevie might happen at the same time, and they need to be mutually exclusive to each other as well.</p>
</blockquote>
<ul>
<li>Why not use a boolean semaphore over the implementation in mutex?</li>
</ul>
<blockquote>
<p>A boolean semaphore is basically a boolean flag that you check and atomically update.
The problem there is if the flag is currently set (someone else is in the critical section), with a boolean semaphore, you have to spin, you have to repeatedly check it.
Whereas with a mutex, the operating system can put the thread to sleep and wake it back up when the mutex is available, which is generally more efficient although adds a little bit of latency.</p>
</blockquote>
<h3 id="condition-variable" class="heading-element">
  <a href="#condition-variable" class="heading-mark"></a>Condition Variable</h3><ul>
<li>method <a href="https://doc.rust-lang.org/std/sync/struct.Condvar.html#method.wait"target="_blank" rel="external nofollow noopener noreferrer">std::sync::Condvar::wait</a></li>
</ul>
<blockquote>
<p>This function will atomically unlock the mutex specified (represented by guard) and block the current thread. This means that any calls to notify_one or notify_all which happen logically after the mutex is unlocked are candidates to wake this thread up. When this function call returns, the lock specified will have been re-acquired.</p>
</blockquote>
<ul>
<li>method <a href="https://doc.rust-lang.org/std/sync/struct.Condvar.html#method.notify_one"target="_blank" rel="external nofollow noopener noreferrer">std::sync::Condvar::notify_one</a></li>
</ul>
<blockquote>
<p>If there is a blocked thread on this condition variable, then it will be woken up from its call to wait or wait_timeout. Calls to notify_one are not buffered in any way.</p>
</blockquote>
<figure><a class="lightgallery" href="/images/rust/send_recv.drawio.svg?size=large" data-thumbnail="/images/rust/send_recv.drawio.svg?size=small" data-sub-html="<h2>wait &amp; notify</h2>"><img loading="lazy" src="/images/rust/send_recv.drawio.svg" alt="/images/rust/send_recv.drawio.svg" srcset="/images/rust/send_recv.drawio.svg?size=small, /images/rust/send_recv.drawio.svg?size=medium 1.5x, /images/rust/send_recv.drawio.svg?size=large 2x" sizes="auto" data-title="/images/rust/send_recv.drawio.svg" class="suffix-invalid suffix-invalid__small suffix-invalid__large" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a><figcaption class="image-caption">wait &amp; notify</figcaption>
  </figure>
<h3 id="clone" class="heading-element">
  <a href="#clone" class="heading-mark"></a>Clone</h3><p>对 <code>struct Sender&lt;T&gt;</code> 标注属性宏 <code>#[derive(clone)]</code> 会实现以下的 triat:</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rs" data-lang="rs"><span class="line"><span class="cl"><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nb">Clone</span><span class="o">&gt;</span><span class="w"> </span><span class="nb">Clone</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Sender</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>但是对于 <code>Sender&lt;T&gt;</code> 的成员 <code>Arc&lt;Inner&lt;T&gt;&gt;</code> 来说，<code>Arc</code> 可以 clone 无论内部类型 <code>T</code> 是否实现了 Clone 这个 trait，所以我们需要手动实现 Clone 这个 trait。这也是 <code>#[derive(clone)]</code> 和手动实现 <code>impl Clone</code> 的一个细小差别。</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rs" data-lang="rs"><span class="line"><span class="cl"><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nb">Clone</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Sender</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>为了防止调用 clone 产生的二义性 (因为编译器会自动解引用)，建议使用 explict 方式来调用 <code>Arc::clone()</code>，这样编译器就会知道调用的是 Arc 的 clone 方法，而不是 Arc 内部 object 的 clone 方法。</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rs" data-lang="rs"><span class="line"><span class="cl"><span class="kd">let</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arc</span><span class="o">&lt;</span><span class="n">Inner</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">inner</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span><span class="w">      </span><span class="c1">// Inner&lt;T&gt;&#39;s clone method? or Arc::clone method?
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Arc</span>::<span class="n">clone</span><span class="p">(</span><span class="o">&amp;</span><span class="n">inner</span><span class="p">);</span><span class="w"> </span><span class="c1">// explict Arc::clone !
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="dbg" class="heading-element">
  <a href="#dbg" class="heading-mark"></a>dbg</h3><ul>
<li>Macro <a href="https://doc.rust-lang.org/std/macro.dbg.html"target="_blank" rel="external nofollow noopener noreferrer">std::dbg</a></li>
</ul>
<div class="details admonition quote open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-quote-right fa-fw" aria-hidden="true"></i>引用<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>Prints and returns the value of a given expression for quick and dirty debugging.</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-rs" data-lang="rs"><span class="line"><span class="cl"><span class="kd">let</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">let</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">dbg!</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//      ^-- prints: [src/main.rs:2] a * 2 = 4
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="fm">assert_eq!</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The macro works by using the Debug implementation of the type of the given expression to print the value to stderr along with the source location of the macro invocation as well as the source code of the expression.</p>
</div>
    </div>
  </div>
<p>调试的大杀器，作用类似于 kernel 中的 debugk 宏 &#x1f923; 常用于检测程序运行时是否执行了某些语句，以及这些语句的值如何。</p>
<h3 id="performance-optimization" class="heading-element">
  <a href="#performance-optimization" class="heading-mark"></a>Performance optimization</h3><blockquote>
<p>Every operation takes the lock and that's fine if you have a channel that is not very high performance, but if you wanted like super high performance, like you have a lot of sends that compete with each other, then you might not want the sends to contend with one another.</p>
<p>Image that you have 10 threads are trying to send at the same time, you could perhaps write an implementation that allows them to do that. The only thing that really needs to be synchronized is the senders with the receivers, as opposed to the senders with one another, whereas we're actually locking all of them.</p>
</blockquote>
<p>使用 <code>VecDeque</code> 作为缓冲区，会导致 send 时的效能问题。因为 send 是使用 <code>push_back</code> 方法来将 object 加入到 <code>VecDeque</code> 中，这个过程 <code>VecDeque</code> 可能会发生 resize 操作，这会花费较长时间并且在这个过程时 sender 仍然持有 Mutex，所以导致其他 sender 和 recevier 并不能使用 <code>VecDeque</code>，所以在实作中并不使用 <code>VecDeque</code> 以避免相应的效能损失。</p>
<p>因为只有一个 receiver，所以可以通过缓冲区来提高效能，一次性接受大批数据并进行缓存，而不是每次只接收一个数据就放弃 Mutex (Batch recv optimization)。当然这个如果使用 <code>VecDeque</code> 依然会在 recv 时出现上面的 resize 效能问题。</p>
<h3 id="synchronous-channels" class="heading-element">
  <a href="#synchronous-channels" class="heading-mark"></a>Synchronous channels</h3><ul>
<li>Module <a href="https://doc.rust-lang.org/std/sync/mpsc/index.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync::mpsc</a></li>
</ul>
<blockquote>
<p>These channels come in two flavors:</p>
<ol>
<li>
<p>An asynchronous, infinitely buffered channel. The <code>channel</code> function will return a <code>(Sender, Receiver)</code> tuple where all sends will be <strong>asynchronous</strong> (they never block). The channel conceptually has an infinite buffer.</p>
</li>
<li>
<p>A synchronous, bounded channel. The <code>sync_channel</code> function will return a (SyncSender, Receiver) tuple where the storage for pending messages is a pre-allocated buffer of a fixed size. All sends will be <strong>synchronous</strong> by blocking until there is buffer space available. Note that a bound of 0 is allowed, causing the channel to become a &ldquo;rendezvous&rdquo; channel where each sender atomically hands off a message to a receiver.</p>
</li>
</ol>
</blockquote>
<h3 id="channel-flavors" class="heading-element">
  <a href="#channel-flavors" class="heading-mark"></a>Channel flavors</h3><ul>
<li><strong>Synchronous channels</strong>: Channel where send() can block. Limited capacity.
<ul>
<li>Mutex + Condvar + VecDeque</li>
<li>Atomic VecDeque (atomic queue) + thread::park + thread::Thread::notify</li>
</ul>
</li>
<li><strong>Asynchronous channels</strong>: Channel where send() cannot block. Unbounded.
<ul>
<li>Mutex + Condvar + VecDeque</li>
<li>Mutex + Condvar + LinkedList</li>
<li>Atomic linked list, linked list of T</li>
<li>Atomic block linked list, linked list of atomic VecDeque<T></li>
</ul>
</li>
<li><strong>Rendezvous channels</strong>: Synchronous with capacity = 0. Used for thread synchronization.</li>
<li><strong>Oneshot channels</strong>: Any capacity. In practice, only one call to send().</li>
</ul>
<h3 id="asyncawait" class="heading-element">
  <a href="#asyncawait" class="heading-mark"></a>async/await</h3><ul>
<li>Module <a href="https://doc.rust-lang.org/std/future/index.html"target="_blank" rel="external nofollow noopener noreferrer">std::future</a></li>
<li>Keyword <a href="https://doc.rust-lang.org/std/keyword.async.html"target="_blank" rel="external nofollow noopener noreferrer">async</a></li>
<li>Keyword <a href="https://doc.rust-lang.org/std/keyword.await.html"target="_blank" rel="external nofollow noopener noreferrer">await</a></li>
</ul>
<h2 id="homework" class="heading-element">
  <a href="#homework" class="heading-mark"></a>Homework</h2><div class="details admonition info open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-info-circle fa-fw" aria-hidden="true"></i>信息<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content"><p>实作说明:</p>
<ul>
<li><i class="fa-regular fa-square fa-fw" aria-hidden="true"></i> 尝试实现 Synchronous channels
<ul>
<li>使用 Atomic 存储 senders 以提高效能</li>
<li>使用两个 ConVar 来指示 sender 和 receiver 进行 block 和 wake up</li>
<li>receiver 被 drop 时需要通知所有 senders 以释放资源</li>
<li>使用 linked list 来取代 VecDeque 以避免 resize 的效能损失</li>
</ul>
</li>
<li>尝试阅读 std 中 mpsc 的实现 <a href="https://doc.rust-lang.org/src/std/sync/mpsc/mod.rs.html#1-1246https://doc.rust-lang.org/src/std/sync/mpsc/mod.rs.html#1-1246"target="_blank" rel="external nofollow noopener noreferrer">Module std::sync::mpsc</a>
<ul>
<li>对比阅读其他库关于 channel 的实现: <a href="https://github.com/crossbeam-rs/crossbeam"target="_blank" rel="external nofollow noopener noreferrer">crossbeam</a>, <a href="https://github.com/zesterer/flume"target="_blank" rel="external nofollow noopener noreferrer">flume</a></li>
</ul>
</li>
</ul>
<p>参考资料:</p>
<ul>
<li>Module <a href="https://doc.rust-lang.org/std/sync/atomic/index.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync::atomic</a></li>
<li>Module <a href="https://doc.rust-lang.org/src/std/sync/mpsc/mod.rs.html#1-1246https://doc.rust-lang.org/src/std/sync/mpsc/mod.rs.html#1-1246"target="_blank" rel="external nofollow noopener noreferrer">std::sync::mpsc</a></li>
<li>Crate <a href="https://docs.rs/crossbeam/latest/crossbeam/"target="_blank" rel="external nofollow noopener noreferrer">crossbeam</a></li>
<li>Crate <a href="https://docs.rs/flume/latest/flume/"target="_blank" rel="external nofollow noopener noreferrer">flume</a></li>
</ul>
</div>
    </div>
  </div>
<h2 id="documentations" class="heading-element">
  <a href="#documentations" class="heading-mark"></a>Documentations</h2><p>这里列举视频中一些概念相关的 documentation</p>
<blockquote>
<p>学习的一手资料是官方文档，请务必自主学会阅读规格书之类的资料</p>
</blockquote>
<h3 id="crate-stdhttpsdocrust-langorgstdindexhtml" class="heading-element">
  <a href="#crate-stdhttpsdocrust-langorgstdindexhtml" class="heading-mark"></a>Crate <a href="https://doc.rust-lang.org/std/index.html"target="_blank" rel="external nofollow noopener noreferrer">std</a></h3><blockquote>
<p>可以使用这里提供的搜素栏进行搜索 (BTW 不要浪费时间在 Google 搜寻上！)</p>
</blockquote>
<ul>
<li>
<p>Module <a href="https://doc.rust-lang.org/std/sync/mpsc/index.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync::mpsc</a></p>
<ul>
<li>Function <a href="https://doc.rust-lang.org/std/sync/mpsc/fn.channel.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync::mpsc::channel</a></li>
<li>Struct <a href="https://doc.rust-lang.org/std/sync/mpsc/struct.Sender.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync::mpsc::Sender</a></li>
<li>Struct <a href="https://doc.rust-lang.org/std/sync/mpsc/struct.Receiver.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync::mpsc::Receiver</a></li>
</ul>
</li>
<li>
<p>Module <a href="https://doc.rust-lang.org/std/sync/index.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync</a></p>
<ul>
<li>Struct <a href="https://doc.rust-lang.org/std/sync/struct.Arc.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync::Arc</a></li>
<li>Struct <a href="https://doc.rust-lang.org/std/sync/struct.Mutex.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync::Mutex</a></li>
<li>Struct <a href="https://doc.rust-lang.org/std/sync/struct.Condvar.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync::Condvar</a>
<ul>
<li>method <a href="https://doc.rust-lang.org/std/sync/struct.Condvar.html#method.wait"target="_blank" rel="external nofollow noopener noreferrer">std::sync::Condvar::wait</a></li>
<li>method <a href="https://doc.rust-lang.org/std/sync/struct.Condvar.html#method.notify_one"target="_blank" rel="external nofollow noopener noreferrer">std::sync::Condvar::notify_one</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Module <a href="https://doc.rust-lang.org/std/sync/atomic/index.html"target="_blank" rel="external nofollow noopener noreferrer">std::sync::atomic</a></p>
</li>
<li>
<p>Trait <a href="https://doc.rust-lang.org/std/marker/trait.Send.html"target="_blank" rel="external nofollow noopener noreferrer">std::marker::Send</a></p>
</li>
<li>
<p>Struct <a href="https://doc.rust-lang.org/std/collections/struct.VecDeque.html"target="_blank" rel="external nofollow noopener noreferrer">std::collections::VecDeque</a></p>
</li>
<li>
<p>Function <a href="https://doc.rust-lang.org/std/mem/fn.take.html"target="_blank" rel="external nofollow noopener noreferrer">std::mem::take</a></p>
</li>
<li>
<p>Function <a href="https://doc.rust-lang.org/std/mem/fn.swap.html"target="_blank" rel="external nofollow noopener noreferrer">std::mem::swap</a></p>
</li>
<li>
<p>Macro <a href="https://doc.rust-lang.org/std/macro.dbg.html"target="_blank" rel="external nofollow noopener noreferrer">std::dbg</a></p>
</li>
</ul>
<h2 id="references" class="heading-element">
  <a href="#references" class="heading-mark"></a>References</h2><ul>
<li>Go 语言也有 channel: <a href="https://www.bilibili.com/video/BV1uv4y187p6"target="_blank" rel="external nofollow noopener noreferrer">解说 Go channel 底层原理</a> [bilibili]</li>
<li><a href="https://www.bilibili.com/video/BV1DK42147jb"target="_blank" rel="external nofollow noopener noreferrer">可能不是你看过最无聊的 Rust 入门喜剧 102 (3) 多线程并发</a> [bilibili]</li>
</ul></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2024-03-04 23:05:35">更新于 2024-03-04&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/posts/channels/index.md" title="阅读原始文档" class="link-to-markdown">阅读原始文档</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://ccrysisa.github.io/posts/channels/" data-title="Crust of Rust: Channels" data-hashtags="Rust,Channel"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://ccrysisa.github.io/posts/channels/" data-hashtag="Rust"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="https://ccrysisa.github.io/posts/channels/" data-title="Crust of Rust: Channels" data-web><i class="fa-brands fa-whatsapp fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://ccrysisa.github.io/posts/channels/" data-title="Crust of Rust: Channels"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://ccrysisa.github.io/posts/channels/" data-title="Crust of Rust: Channels"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Myspace" data-sharer="myspace" data-url="https://ccrysisa.github.io/posts/channels/" data-title="Crust of Rust: Channels" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Blogger" data-sharer="blogger" data-url="https://ccrysisa.github.io/posts/channels/" data-title="Crust of Rust: Channels" data-description=""><i class="fa-brands fa-blogger fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Evernote" data-sharer="evernote" data-url="https://ccrysisa.github.io/posts/channels/" data-title="Crust of Rust: Channels"><i class="fa-brands fa-evernote fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/rust/" class="post-tag" title="标签 - Rust">Rust</a><a href="/tags/channel/" class="post-tag" title="标签 - Channel">Channel</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/c-standards/" class="post-nav-item" rel="prev" title="你所不知道的 C 语言: 开发工具和规格标准"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>你所不知道的 C 语言: 开发工具和规格标准</a>
      <a href="/posts/riscv-optimization-guide/" class="post-nav-item" rel="next" title="RISC-V Optimization Guide">RISC-V Optimization Guide<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.131.0"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.2-RC"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2021 - 2024</span><span class="author" itemprop="copyrightHolder">
              <a href="https://github.com/ccrysisa"target="_blank" rel="external nofollow noopener noreferrer">ccrysisa</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='总访客数'><i class="fa-regular fa-user fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='总访问量'><i class="fa-regular fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async defer></script><script src="/js/flyfish.js" defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"enablePWA":true,"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
